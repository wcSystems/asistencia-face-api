(self.webpackChunkface_login=self.webpackChunkface_login||[]).push([[179],{874:(Ei,Ft,Xt)=>{"use strict";function Fe(e){return"function"==typeof e}function oo(e){const t=e(r=>{Error.call(r),r.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const nr=oo(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((r,o)=>`${o+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function wr(e,n){if(e){const t=e.indexOf(n);0<=t&&e.splice(t,1)}}class St{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const i of t)i.remove(this);else t.remove(this);const{initialTeardown:r}=this;if(Fe(r))try{r()}catch(i){n=i instanceof nr?i.errors:[i]}const{_finalizers:o}=this;if(o){this._finalizers=null;for(const i of o)try{Dt(i)}catch(a){n=n??[],a instanceof nr?n=[...n,...a.errors]:n.push(a)}}if(n)throw new nr(n)}}add(n){var t;if(n&&n!==this)if(this.closed)Dt(n);else{if(n instanceof St){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(n)}}_hasParent(n){const{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){const{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&wr(t,n)}remove(n){const{_finalizers:t}=this;t&&wr(t,n),n instanceof St&&n._removeParent(this)}}St.EMPTY=(()=>{const e=new St;return e.closed=!0,e})();const Eo=St.EMPTY;function Pt(e){return e instanceof St||e&&"closed"in e&&Fe(e.remove)&&Fe(e.add)&&Fe(e.unsubscribe)}function Dt(e){Fe(e)?e():e.unsubscribe()}const nn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},br={setTimeout(e,n,...t){const{delegate:r}=br;return r?.setTimeout?r.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){const{delegate:n}=br;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function io(e){br.setTimeout(()=>{const{onUnhandledError:n}=nn;if(!n)throw e;n(e)})}function rr(){}const Io=ns("C",void 0,void 0);function ns(e,n,t){return{kind:e,value:n,error:t}}let Pr=null;function ao(e){if(nn.useDeprecatedSynchronousErrorHandling){const n=!Pr;if(n&&(Pr={errorThrown:!1,error:null}),e(),n){const{errorThrown:t,error:r}=Pr;if(Pr=null,t)throw r}}else e()}class rs extends St{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Pt(n)&&n.add(this)):this.destination=Ii}static create(n,t,r){return new yt(n,t,r)}next(n){this.isStopped?Hn(function il(e){return ns("N",e,void 0)}(n),this):this._next(n)}error(n){this.isStopped?Hn(function ha(e){return ns("E",void 0,e)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?Hn(Io,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const au=Function.prototype.bind;function Le(e,n){return au.call(e,n)}class rt{constructor(n){this.partialObserver=n}next(n){const{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(r){ht(r)}}error(n){const{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(r){ht(r)}else ht(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){ht(t)}}}class yt extends rs{constructor(n,t,r){let o;if(super(),Fe(n)||!n)o={next:n??void 0,error:t??void 0,complete:r??void 0};else{let i;this&&nn.useDeprecatedNextContext?(i=Object.create(n),i.unsubscribe=()=>this.unsubscribe(),o={next:n.next&&Le(n.next,i),error:n.error&&Le(n.error,i),complete:n.complete&&Le(n.complete,i)}):o=n}this.destination=new rt(o)}}function ht(e){nn.useDeprecatedSynchronousErrorHandling?function iu(e){nn.useDeprecatedSynchronousErrorHandling&&Pr&&(Pr.errorThrown=!0,Pr.error=e)}(e):io(e)}function Hn(e,n){const{onStoppedNotification:t}=nn;t&&br.setTimeout(()=>t(e,n))}const Ii={closed:!0,next:rr,error:function dn(e){throw e},complete:rr},so="function"==typeof Symbol&&Symbol.observable||"@@observable";function Or(e){return e}function pa(e){return 0===e.length?Or:1===e.length?e[0]:function(t){return e.reduce((r,o)=>o(r),t)}}let Ot=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){const r=new e;return r.source=this,r.operator=t,r}subscribe(t,r,o){const i=function U(e){return e&&e instanceof rs||function Om(e){return e&&Fe(e.next)&&Fe(e.error)&&Fe(e.complete)}(e)&&Pt(e)}(t)?t:new yt(t,r,o);return ao(()=>{const{operator:a,source:s}=this;i.add(a?a.call(i,s):s?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return new(r=os(r))((o,i)=>{const a=new yt({next:s=>{try{t(s)}catch(u){i(u),a.unsubscribe()}},error:i,complete:o});this.subscribe(a)})}_subscribe(t){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(t)}[so](){return this}pipe(...t){return pa(t)(this)}toPromise(t){return new(t=os(t))((r,o)=>{let i;this.subscribe(a=>i=a,a=>o(a),()=>r(i))})}}return e.create=n=>new e(n),e})();function os(e){var n;return null!==(n=e??nn.Promise)&&void 0!==n?n:Promise}const Lm=oo(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Wn=(()=>{class e extends Ot{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const r=new al(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new Lm}next(t){ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(t)}})}error(t){ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:r,isStopped:o,observers:i}=this;return r||o?Eo:(this.currentObservers=null,i.push(t),new St(()=>{this.currentObservers=null,wr(i,t)}))}_checkFinalizedStatuses(t){const{hasError:r,thrownError:o,isStopped:i}=this;r?t.error(o):i&&t.complete()}asObservable(){const t=new Ot;return t.source=this,t}}return e.create=(n,t)=>new al(n,t),e})();class al extends Wn{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,n)}error(n){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,n)}complete(){var n,t;null===(t=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===t||t.call(n)}_subscribe(n){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(n))&&void 0!==r?r:Eo}}function su(e){return Fe(e?.lift)}function at(e){return n=>{if(su(n))return n.lift(function(t){try{return e(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function At(e,n,t,r,o){return new Uf(e,n,t,r,o)}class Uf extends rs{constructor(n,t,r,o,i,a){super(n),this.onFinalize=i,this.shouldUnsubscribe=a,this._next=t?function(s){try{t(s)}catch(u){n.error(u)}}:super._next,this._error=o?function(s){try{o(s)}catch(u){n.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(s){n.error(s)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function ft(e,n){return at((t,r)=>{let o=0;t.subscribe(At(r,i=>{r.next(e.call(n,i,o++))}))})}function or(e){return this instanceof or?(this.v=e,this):new or(e)}function ss(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function ga(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(a){return new Promise(function(s,u){!function o(i,a,s,u){Promise.resolve(u).then(function(c){i({value:c,done:s})},a)}(s,u,(a=e[i](a)).done,a.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const ml=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function vl(e){return Fe(e?.then)}function tt(e){return Fe(e[so])}function Br(e){return Symbol.asyncIterator&&Fe(e?.[Symbol.asyncIterator])}function Ao(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const un=function Ai(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function vn(e){return Fe(e?.[un])}function hu(e){return function va(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=t.apply(e,n||[]),i=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(f){r[f]&&(o[f]=function(h){return new Promise(function(p,m){i.push([f,h,p,m])>1||s(f,h)})})}function s(f,h){try{!function u(f){f.value instanceof or?Promise.resolve(f.value.v).then(c,l):d(i[0][2],f)}(r[f](h))}catch(p){d(i[0][3],p)}}function c(f){s("next",f)}function l(f){s("throw",f)}function d(f,h){f(h),i.shift(),i.length&&s(i[0][0],i[0][1])}}(this,arguments,function*(){const t=e.getReader();try{for(;;){const{value:r,done:o}=yield or(t.read());if(o)return yield or(void 0);yield yield or(r)}}finally{t.releaseLock()}})}function yl(e){return Fe(e?.getReader)}function yn(e){if(e instanceof Ot)return e;if(null!=e){if(tt(e))return function ar(e){return new Ot(n=>{const t=e[so]();if(Fe(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(ml(e))return function Wm(e){return new Ot(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}(e);if(vl(e))return function Hf(e){return new Ot(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,io)})}(e);if(Br(e))return pu(e);if(vn(e))return function Wf(e){return new Ot(n=>{for(const t of e)if(n.next(t),n.closed)return;n.complete()})}(e);if(yl(e))return function zm(e){return pu(hu(e))}(e)}throw Ao(e)}function pu(e){return new Ot(n=>{(function zf(e,n){var t,r,o,i;return function cl(e,n,t,r){return new(t||(t=Promise))(function(i,a){function s(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):function o(i){return i instanceof t?i:new t(function(a){a(i)})}(l.value).then(s,u)}c((r=r.apply(e,n||[])).next())})}(this,void 0,void 0,function*(){try{for(t=ss(e);!(r=yield t.next()).done;)if(n.next(r.value),n.closed)return}catch(a){o={error:a}}finally{try{r&&!r.done&&(i=t.return)&&(yield i.call(t))}finally{if(o)throw o.error}}n.complete()})})(e,n).catch(t=>n.error(t))})}function Mo(e,n,t,r=0,o=!1){const i=n.schedule(function(){t(),o?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(i),!o)return i}function Wt(e,n,t=1/0){return Fe(n)?Wt((r,o)=>ft((i,a)=>n(r,i,o,a))(yn(e(r,o))),t):("number"==typeof n&&(t=n),at((r,o)=>function $m(e,n,t,r,o,i,a,s){const u=[];let c=0,l=0,d=!1;const f=()=>{d&&!u.length&&!c&&n.complete()},h=m=>c<r?p(m):u.push(m),p=m=>{i&&n.next(m),c++;let v=!1;yn(t(m,l++)).subscribe(At(n,y=>{o?.(y),i?h(y):n.next(y)},()=>{v=!0},void 0,()=>{if(v)try{for(c--;u.length&&c<r;){const y=u.shift();a?Mo(n,a,()=>p(y)):p(y)}f()}catch(y){n.error(y)}}))};return e.subscribe(At(n,h,()=>{d=!0,f()})),()=>{s?.()}}(r,o,e,t)))}function ya(e=1/0){return Wt(Or,e)}const uo=new Ot(e=>e.complete());function us(e){return e[e.length-1]}function $f(e){return Fe(us(e))?e.pop():void 0}function cs(e){return function qm(e){return e&&Fe(e.schedule)}(us(e))?e.pop():void 0}function Gf(e,n=0){return at((t,r)=>{t.subscribe(At(r,o=>Mo(r,e,()=>r.next(o),n),()=>Mo(r,e,()=>r.complete(),n),o=>Mo(r,e,()=>r.error(o),n)))})}function qf(e,n=0){return at((t,r)=>{r.add(e.schedule(()=>t.subscribe(r),n))})}function Xf(e,n){if(!e)throw new Error("Iterable cannot be null");return new Ot(t=>{Mo(t,n,()=>{const r=e[Symbol.asyncIterator]();Mo(t,n,()=>{r.next().then(o=>{o.done?t.complete():t.next(o.value)})},0,!0)})})}function Te(e,n){return n?function Qm(e,n){if(null!=e){if(tt(e))return function Xm(e,n){return yn(e).pipe(qf(n),Gf(n))}(e,n);if(ml(e))return function Km(e,n){return new Ot(t=>{let r=0;return n.schedule(function(){r===e.length?t.complete():(t.next(e[r++]),t.closed||this.schedule())})})}(e,n);if(vl(e))return function wl(e,n){return yn(e).pipe(qf(n),Gf(n))}(e,n);if(Br(e))return Xf(e,n);if(vn(e))return function Ym(e,n){return new Ot(t=>{let r;return Mo(t,n,()=>{r=e[un](),Mo(t,n,()=>{let o,i;try{({value:o,done:i}=r.next())}catch(a){return void t.error(a)}i?t.complete():t.next(o)},0,!0)}),()=>Fe(r?.return)&&r.return()})}(e,n);if(yl(e))return function Zm(e,n){return Xf(hu(e),n)}(e,n)}throw Ao(e)}(e,n):yn(e)}class _r extends Wn{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){const{hasError:n,thrownError:t,_value:r}=this;if(n)throw t;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}}function _e(...e){return Te(e,cs(e))}function Kf(e={}){const{connector:n=(()=>new Wn),resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:o=!0}=e;return i=>{let a,s,u,c=0,l=!1,d=!1;const f=()=>{s?.unsubscribe(),s=void 0},h=()=>{f(),a=u=void 0,l=d=!1},p=()=>{const m=a;h(),m?.unsubscribe()};return at((m,v)=>{c++,!d&&!l&&f();const y=u=u??n();v.add(()=>{c--,0===c&&!d&&!l&&(s=bl(p,o))}),y.subscribe(v),!a&&c>0&&(a=new yt({next:b=>y.next(b),error:b=>{d=!0,f(),s=bl(h,t,b),y.error(b)},complete:()=>{l=!0,f(),s=bl(h,r),y.complete()}}),yn(m).subscribe(a))})(i)}}function bl(e,n,...t){if(!0===n)return void e();if(!1===n)return;const r=new yt({next:()=>{r.unsubscribe(),e()}});return yn(n(...t)).subscribe(r)}function Vr(e,n){return at((t,r)=>{let o=null,i=0,a=!1;const s=()=>a&&!o&&r.complete();t.subscribe(At(r,u=>{o?.unsubscribe();let c=0;const l=i++;yn(e(u,l)).subscribe(o=At(r,d=>r.next(n?n(u,d,l,c++):d),()=>{o=null,s()}))},()=>{a=!0,s()}))})}function ls(e,n){return e===n}function pt(e){for(let n in e)if(e[n]===pt)return n;throw Error("Could not find renamed property on target object.")}function Ti(e,n){for(const t in n)n.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Ve(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Ve).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const n=e.toString();if(null==n)return""+n;const t=n.indexOf("\n");return-1===t?n:n.substring(0,t)}function Cl(e,n){return null==e||""===e?null===n?"":n:null==n||""===n?e:e+" "+n}const ev=pt({__forward_ref__:pt});function Mt(e){return e.__forward_ref__=Mt,e.toString=function(){return Ve(this())},e}function De(e){return _l(e)?e():e}function _l(e){return"function"==typeof e&&e.hasOwnProperty(ev)&&e.__forward_ref__===Mt}function Dl(e){return e&&!!e.\u0275providers}const El="https://g.co/ng/security#xss";class ee extends Error{constructor(n,t){super(function ds(e,n){return`NG0${Math.abs(e)}${n?": "+n:""}`}(n,t)),this.code=n}}function Se(e){return"string"==typeof e?e:null==e?"":String(e)}function Il(e,n){throw new ee(-201,!1)}function Dr(e,n){null==e&&function Ee(e,n,t,r){throw new Error(`ASSERTION ERROR: ${e}`+(null==r?"":` [Expected=> ${t} ${r} ${n} <=Actual]`))}(n,e,null,"!=")}function ye(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function ur(e){return{providers:e.providers||[],imports:e.imports||[]}}function gu(e){return Yf(e,vu)||Yf(e,Ni)}function Yf(e,n){return e.hasOwnProperty(n)?e[n]:null}function mu(e){return e&&(e.hasOwnProperty(Al)||e.hasOwnProperty(fv))?e[Al]:null}const vu=pt({\u0275prov:pt}),Al=pt({\u0275inj:pt}),Ni=pt({ngInjectableDef:pt}),fv=pt({ngInjectorDef:pt});var ze=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(ze||{});let yu;function Kt(e){const n=yu;return yu=e,n}function Qf(e,n,t){const r=gu(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:t&ze.Optional?null:void 0!==n?n:void Il(Ve(e))}const mt=globalThis;class ue{constructor(n,t){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=ye({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const ps={},bu="__NG_DI_FLAG__",gs="ngTempTokenPath",gv=/\n/gm,eh="__source";let ki;function co(e){const n=ki;return ki=e,n}function th(e,n=ze.Default){if(void 0===ki)throw new ee(-203,!1);return null===ki?Qf(e,void 0,n):ki.get(e,n&ze.Optional?null:void 0,n)}function fe(e,n=ze.Default){return(function Zf(){return yu}()||th)(De(e),n)}function ie(e,n=ze.Default){return fe(e,_u(n))}function _u(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function Du(e){const n=[];for(let t=0;t<e.length;t++){const r=De(e[t]);if(Array.isArray(r)){if(0===r.length)throw new ee(900,!1);let o,i=ze.Default;for(let a=0;a<r.length;a++){const s=r[a],u=nh(s);"number"==typeof u?-1===u?o=s.token:i|=u:o=s}n.push(fe(o,i))}else n.push(fe(r))}return n}function wa(e,n){return e[bu]=n,e.prototype[bu]=n,e}function nh(e){return e[bu]}function lo(e){return{toString:e}.toString()}var ms=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(ms||{}),Er=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(Er||{});const Ur={},$e=[],Eu=pt({\u0275cmp:pt}),Rl=pt({\u0275dir:pt}),Nl=pt({\u0275pipe:pt}),kl=pt({\u0275mod:pt}),fo=pt({\u0275fac:pt}),ba=pt({__NG_ELEMENT_ID__:pt}),ih=pt({__NG_ENV_ID__:pt});function ah(e,n,t){let r=e.length;for(;;){const o=e.indexOf(n,t);if(-1===o)return o;if(0===o||e.charCodeAt(o-1)<=32){const i=n.length;if(o+i===r||e.charCodeAt(o+i)<=32)return o}t=o+1}}function Fl(e,n,t){let r=0;for(;r<t.length;){const o=t[r];if("number"==typeof o){if(0!==o)break;r++;const i=t[r++],a=t[r++],s=t[r++];e.setAttribute(n,a,s,i)}else{const i=o,a=t[++r];Pl(i)?e.setProperty(n,i,a):e.setAttribute(n,i,a),r++}}return r}function sh(e){return 3===e||4===e||6===e}function Pl(e){return 64===e.charCodeAt(0)}function vs(e,n){if(null!==n&&0!==n.length)if(null===e||0===e.length)e=n.slice();else{let t=-1;for(let r=0;r<n.length;r++){const o=n[r];"number"==typeof o?t=o:0===t||Ol(e,t,o,null,-1===t||2===t?n[++r]:null)}}return e}function Ol(e,n,t,r,o){let i=0,a=e.length;if(-1===n)a=-1;else for(;i<e.length;){const s=e[i++];if("number"==typeof s){if(s===n){a=-1;break}if(s>n){a=i-1;break}}}for(;i<e.length;){const s=e[i];if("number"==typeof s)break;if(s===t){if(null===r)return void(null!==o&&(e[i+1]=o));if(r===e[i+1])return void(e[i+2]=o)}i++,null!==r&&i++,null!==o&&i++}-1!==a&&(e.splice(a,0,n),i=a+1),e.splice(i++,0,t),null!==r&&e.splice(i++,0,r),null!==o&&e.splice(i++,0,o)}const uh="ng-template";function ch(e,n,t){let r=0,o=!0;for(;r<e.length;){let i=e[r++];if("string"==typeof i&&o){const a=e[r++];if(t&&"class"===i&&-1!==ah(a.toLowerCase(),n,0))return!0}else{if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===n)return!0;return!1}"number"==typeof i&&(o=!1)}}return!1}function Iu(e){return 4===e.type&&e.value!==uh}function yv(e,n,t){return n===(4!==e.type||t?e.value:uh)}function wv(e,n,t){let r=4;const o=e.attrs||[],i=function Cv(e){for(let n=0;n<e.length;n++)if(sh(e[n]))return n;return e.length}(o);let a=!1;for(let s=0;s<n.length;s++){const u=n[s];if("number"!=typeof u){if(!a)if(4&r){if(r=2|1&r,""!==u&&!yv(e,u,t)||""===u&&1===n.length){if(jr(r))return!1;a=!0}}else{const c=8&r?u:n[++s];if(8&r&&null!==e.attrs){if(!ch(e.attrs,c,t)){if(jr(r))return!1;a=!0}continue}const d=bv(8&r?"class":u,o,Iu(e),t);if(-1===d){if(jr(r))return!1;a=!0;continue}if(""!==c){let f;f=d>i?"":o[d+1].toLowerCase();const h=8&r?f:null;if(h&&-1!==ah(h,c,0)||2&r&&c!==f){if(jr(r))return!1;a=!0}}}}else{if(!a&&!jr(r)&&!jr(u))return!1;if(a&&jr(u))continue;a=!1,r=u|1&r}}return jr(r)||a}function jr(e){return 0==(1&e)}function bv(e,n,t,r){if(null===n)return-1;let o=0;if(r||!t){let i=!1;for(;o<n.length;){const a=n[o];if(a===e)return o;if(3===a||6===a)i=!0;else{if(1===a||2===a){let s=n[++o];for(;"string"==typeof s;)s=n[++o];continue}if(4===a)break;if(0===a){o+=4;continue}}o+=i?1:2}return-1}return function _v(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){const r=e[t];if("number"==typeof r)return-1;if(r===n)return t;t++}return-1}(n,e)}function ys(e,n,t=!1){for(let r=0;r<n.length;r++)if(wv(e,n[r],t))return!0;return!1}function Ll(e,n){return e?":not("+n.trim()+")":n}function Ev(e){let n=e[0],t=1,r=2,o="",i=!1;for(;t<e.length;){let a=e[t];if("string"==typeof a)if(2&r){const s=e[++t];o+="["+a+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?o+="."+a:4&r&&(o+=" "+a);else""!==o&&!jr(a)&&(n+=Ll(i,o),o=""),r=a,i=i||!jr(r);t++}return""!==o&&(n+=Ll(i,o)),n}function In(e){return lo(()=>{const n=fh(e),t={...n,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===ms.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||Er.Emulated,styles:e.styles||$e,_:null,schemas:e.schemas||null,tView:null,id:""};hh(t);const r=e.dependencies;return t.directiveDefs=Su(r,!1),t.pipeDefs=Su(r,!0),t.id=function Rv(e){let n=0;const t=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const o of t)n=Math.imul(31,n)+o.charCodeAt(0)<<0;return n+=2147483648,"c"+n}(t),t})}function dh(e){return nt(e)||wn(e)}function Av(e){return null!==e}function Hr(e){return lo(()=>({type:e.type,bootstrap:e.bootstrap||$e,declarations:e.declarations||$e,imports:e.imports||$e,exports:e.exports||$e,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function Bl(e,n){if(null==e)return Ur;const t={};for(const r in e)if(e.hasOwnProperty(r)){let o=e[r],i=o;Array.isArray(o)&&(i=o[1],o=o[0]),t[o]=r,n&&(n[o]=i)}return t}function Ce(e){return lo(()=>{const n=fh(e);return hh(n),n})}function nt(e){return e[Eu]||null}function wn(e){return e[Rl]||null}function Rn(e){return e[Nl]||null}function cr(e,n){const t=e[kl]||null;if(!t&&!0===n)throw new Error(`Type ${Ve(e)} does not have '\u0275mod' property.`);return t}function fh(e){const n={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:e.inputs||Ur,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||$e,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Bl(e.inputs,n),outputs:Bl(e.outputs)}}function hh(e){e.features?.forEach(n=>n(e))}function Su(e,n){if(!e)return null;const t=n?Rn:dh;return()=>("function"==typeof e?e():e).map(r=>t(r)).filter(Av)}const $t=0,se=1,Ne=2,vt=3,Ir=4,ws=5,Sn=6,xa=7,Yt=8,Xo=9,Pi=10,Ae=11,bs=12,ph=13,Nn=14,Lt=15,Rt=16,Ca=17,ho=18,xs=19,gh=20,Ko=21,To=22,Cs=23,_a=24,He=25,D=1,g=2,w=7,k=9,oe=11;function xe(e){return Array.isArray(e)&&"object"==typeof e[D]}function Ye(e){return Array.isArray(e)&&!0===e[D]}function Oi(e){return 0!=(4&e.flags)}function _s(e){return e.componentOffset>-1}function mh(e){return 1==(1&e.flags)}function Ro(e){return!!e.template}function Nv(e){return 0!=(512&e[Ne])}function Ds(e,n){return e.hasOwnProperty(fo)?e[fo]:null}let kn=null,vh=!1;function po(e){const n=kn;return kn=e,n}const c1={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function d1(e){if(!Ul(e)||e.dirty){if(!e.producerMustRecompute(e)&&!p1(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function h1(e){e.dirty=!0,function f1(e){if(void 0===e.liveConsumerNode)return;const n=vh;vh=!0;try{for(const t of e.liveConsumerNode)t.dirty||h1(t)}finally{vh=n}}(e),e.consumerMarkedDirty?.(e)}function Fv(e){return e&&(e.nextProducerIndex=0),po(e)}function Pv(e,n){if(po(n),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(Ul(e))for(let t=e.nextProducerIndex;t<e.producerNode.length;t++)yh(e.producerNode[t],e.producerIndexOfThis[t]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function p1(e){Au(e);for(let n=0;n<e.producerNode.length;n++){const t=e.producerNode[n],r=e.producerLastReadVersion[n];if(r!==t.version||(d1(t),r!==t.version))return!0}return!1}function g1(e){if(Au(e),Ul(e))for(let n=0;n<e.producerNode.length;n++)yh(e.producerNode[n],e.producerIndexOfThis[n]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function yh(e,n){if(function v1(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),Au(e),1===e.liveConsumerNode.length)for(let r=0;r<e.producerNode.length;r++)yh(e.producerNode[r],e.producerIndexOfThis[r]);const t=e.liveConsumerNode.length-1;if(e.liveConsumerNode[n]=e.liveConsumerNode[t],e.liveConsumerIndexOfThis[n]=e.liveConsumerIndexOfThis[t],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,n<e.liveConsumerNode.length){const r=e.liveConsumerIndexOfThis[n],o=e.liveConsumerNode[n];Au(o),o.producerIndexOfThis[r]=n}}function Ul(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function Au(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let y1=null;const C1=()=>{},xP=(()=>({...c1,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:C1}))();class CP{constructor(n,t,r){this.previousValue=n,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}}function go(){return _1}function _1(e){return e.type.prototype.ngOnChanges&&(e.setInput=DP),_P}function _P(){const e=E1(this),n=e?.current;if(n){const t=e.previous;if(t===Ur)e.previous=n;else for(let r in n)t[r]=n[r];e.current=null,this.ngOnChanges(n)}}function DP(e,n,t,r){const o=this.declaredInputs[t],i=E1(e)||function EP(e,n){return e[D1]=n}(e,{previous:Ur,current:null}),a=i.current||(i.current={}),s=i.previous,u=s[o];a[o]=new CP(u&&u.currentValue,n,s===Ur),e[r]=n}go.ngInherit=!0;const D1="__ngSimpleChanges__";function E1(e){return e[D1]||null}const Yo=function(e,n,t){};function Bt(e){for(;Array.isArray(e);)e=e[$t];return e}function wh(e,n){return Bt(n[e])}function Sr(e,n){return Bt(n[e.index])}function A1(e,n){return e.data[n]}function Wr(e,n){const t=n[e];return xe(t)?t:t[$t]}function Ea(e,n){return null==n?null:e[n]}function M1(e){e[Ca]=0}function RP(e){1024&e[Ne]||(e[Ne]|=1024,R1(e,1))}function T1(e){1024&e[Ne]&&(e[Ne]&=-1025,R1(e,-1))}function R1(e,n){let t=e[vt];if(null===t)return;t[ws]+=n;let r=t;for(t=t[vt];null!==t&&(1===n&&1===r[ws]||-1===n&&0===r[ws]);)t[ws]+=n,r=t,t=t[vt]}const Ie={lFrame:z1(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function F1(){return Ie.bindingsEnabled}function Z(){return Ie.lFrame.lView}function st(){return Ie.lFrame.tView}function Fn(){let e=L1();for(;null!==e&&64===e.type;)e=e.parent;return e}function L1(){return Ie.lFrame.currentTNode}function Zo(e,n){const t=Ie.lFrame;t.currentTNode=e,t.isParent=n}function Uv(){return Ie.lFrame.isParent}function Ru(){return Ie.lFrame.bindingIndex++}function WP(e,n){const t=Ie.lFrame;t.bindingIndex=t.bindingRootIndex=e,Hv(n)}function Hv(e){Ie.lFrame.currentDirectiveIndex=e}function j1(){return Ie.lFrame.currentQueryIndex}function zv(e){Ie.lFrame.currentQueryIndex=e}function $P(e){const n=e[se];return 2===n.type?n.declTNode:1===n.type?e[Sn]:null}function H1(e,n,t){if(t&ze.SkipSelf){let o=n,i=e;for(;!(o=o.parent,null!==o||t&ze.Host||(o=$P(i),null===o||(i=i[Nn],10&o.type))););if(null===o)return!1;n=o,e=i}const r=Ie.lFrame=W1();return r.currentTNode=n,r.lView=e,!0}function $v(e){const n=W1(),t=e[se];Ie.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function W1(){const e=Ie.lFrame,n=null===e?null:e.child;return null===n?z1(e):n}function z1(e){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=n),n}function $1(){const e=Ie.lFrame;return Ie.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const G1=$1;function Gv(){const e=$1();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function dr(){return Ie.lFrame.selectedIndex}function Es(e){Ie.lFrame.selectedIndex=e}function Zt(){const e=Ie.lFrame;return A1(e.tView,e.selectedIndex)}let X1=!0;function bh(){return X1}function Ia(e){X1=e}function xh(e,n){for(let t=n.directiveStart,r=n.directiveEnd;t<r;t++){const i=e.data[t].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:s,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:l}=i;a&&(e.contentHooks??=[]).push(-t,a),s&&((e.contentHooks??=[]).push(t,s),(e.contentCheckHooks??=[]).push(t,s)),u&&(e.viewHooks??=[]).push(-t,u),c&&((e.viewHooks??=[]).push(t,c),(e.viewCheckHooks??=[]).push(t,c)),null!=l&&(e.destroyHooks??=[]).push(t,l)}}function Ch(e,n,t){K1(e,n,3,t)}function _h(e,n,t,r){(3&e[Ne])===t&&K1(e,n,t,r)}function qv(e,n){let t=e[Ne];(3&t)===n&&(t&=8191,t+=1,e[Ne]=t)}function K1(e,n,t,r){const i=r??-1,a=n.length-1;let s=0;for(let u=void 0!==r?65535&e[Ca]:0;u<a;u++)if("number"==typeof n[u+1]){if(s=n[u],null!=r&&s>=r)break}else n[u]<0&&(e[Ca]+=65536),(s<i||-1==i)&&(JP(e,t,n,u),e[Ca]=(4294901760&e[Ca])+u+2),u++}function Y1(e,n){Yo(4,e,n);const t=po(null);try{n.call(e)}finally{po(t),Yo(5,e,n)}}function JP(e,n,t,r){const o=t[r]<0,i=t[r+1],s=e[o?-t[r]:t[r]];o?e[Ne]>>13<e[Ca]>>16&&(3&e[Ne])===n&&(e[Ne]+=8192,Y1(s,i)):Y1(s,i)}const Nu=-1;class Hl{constructor(n,t,r){this.factory=n,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}}function Kv(e){return e!==Nu}function Wl(e){return 32767&e}function zl(e,n){let t=function rO(e){return e>>16}(e),r=n;for(;t>0;)r=r[Nn],t--;return r}let Yv=!0;function Dh(e){const n=Yv;return Yv=e,n}const Z1=255,Q1=5;let oO=0;const Qo={};function Eh(e,n){const t=J1(e,n);if(-1!==t)return t;const r=n[se];r.firstCreatePass&&(e.injectorIndex=n.length,Zv(r.data,e),Zv(n,null),Zv(r.blueprint,null));const o=Ih(e,n),i=e.injectorIndex;if(Kv(o)){const a=Wl(o),s=zl(o,n),u=s[se].data;for(let c=0;c<8;c++)n[i+c]=s[a+c]|u[a+c]}return n[i+8]=o,i}function Zv(e,n){e.push(0,0,0,0,0,0,0,0,n)}function J1(e,n){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===n[e.injectorIndex+8]?-1:e.injectorIndex}function Ih(e,n){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let t=0,r=null,o=n;for(;null!==o;){if(r=a_(o),null===r)return Nu;if(t++,o=o[Nn],-1!==r.injectorIndex)return r.injectorIndex|t<<16}return Nu}function Qv(e,n,t){!function iO(e,n,t){let r;"string"==typeof t?r=t.charCodeAt(0)||0:t.hasOwnProperty(ba)&&(r=t[ba]),null==r&&(r=t[ba]=oO++);const o=r&Z1;n.data[e+(o>>Q1)]|=1<<o}(e,n,t)}function e_(e,n,t){if(t&ze.Optional||void 0!==e)return e;Il()}function t_(e,n,t,r){if(t&ze.Optional&&void 0===r&&(r=null),!(t&(ze.Self|ze.Host))){const o=e[Xo],i=Kt(void 0);try{return o?o.get(n,r,t&ze.Optional):Qf(n,r,t&ze.Optional)}finally{Kt(i)}}return e_(r,0,t)}function n_(e,n,t,r=ze.Default,o){if(null!==e){if(2048&n[Ne]&&!(r&ze.Self)){const a=function dO(e,n,t,r,o){let i=e,a=n;for(;null!==i&&null!==a&&2048&a[Ne]&&!(512&a[Ne]);){const s=r_(i,a,t,r|ze.Self,Qo);if(s!==Qo)return s;let u=i.parent;if(!u){const c=a[gh];if(c){const l=c.get(t,Qo,r);if(l!==Qo)return l}u=a_(a),a=a[Nn]}i=u}return o}(e,n,t,r,Qo);if(a!==Qo)return a}const i=r_(e,n,t,r,Qo);if(i!==Qo)return i}return t_(n,t,r,o)}function r_(e,n,t,r,o){const i=function uO(e){if("string"==typeof e)return e.charCodeAt(0)||0;const n=e.hasOwnProperty(ba)?e[ba]:void 0;return"number"==typeof n?n>=0?n&Z1:lO:n}(t);if("function"==typeof i){if(!H1(n,e,r))return r&ze.Host?e_(o,0,r):t_(n,t,r,o);try{let a;if(a=i(r),null!=a||r&ze.Optional)return a;Il()}finally{G1()}}else if("number"==typeof i){let a=null,s=J1(e,n),u=Nu,c=r&ze.Host?n[Lt][Sn]:null;for((-1===s||r&ze.SkipSelf)&&(u=-1===s?Ih(e,n):n[s+8],u!==Nu&&i_(r,!1)?(a=n[se],s=Wl(u),n=zl(u,n)):s=-1);-1!==s;){const l=n[se];if(o_(i,s,l.data)){const d=sO(s,n,t,a,r,c);if(d!==Qo)return d}u=n[s+8],u!==Nu&&i_(r,n[se].data[s+8]===c)&&o_(i,s,n)?(a=l,s=Wl(u),n=zl(u,n)):s=-1}}return o}function sO(e,n,t,r,o,i){const a=n[se],s=a.data[e+8],l=Sh(s,a,t,null==r?_s(s)&&Yv:r!=a&&0!=(3&s.type),o&ze.Host&&i===s);return null!==l?Is(n,a,l,s):Qo}function Sh(e,n,t,r,o){const i=e.providerIndexes,a=n.data,s=1048575&i,u=e.directiveStart,l=i>>20,f=o?s+l:e.directiveEnd;for(let h=r?s:s+l;h<f;h++){const p=a[h];if(h<u&&t===p||h>=u&&p.type===t)return h}if(o){const h=a[u];if(h&&Ro(h)&&h.type===t)return u}return null}function Is(e,n,t,r){let o=e[t];const i=n.data;if(function eO(e){return e instanceof Hl}(o)){const a=o;a.resolving&&function tv(e,n){const t=n?`. Dependency path: ${n.join(" > ")} > ${e}`:"";throw new ee(-200,`Circular dependency in DI detected for ${e}${t}`)}(function gt(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Se(e)}(i[t]));const s=Dh(a.canSeeViewProviders);a.resolving=!0;const c=a.injectImpl?Kt(a.injectImpl):null;H1(e,r,ze.Default);try{o=e[t]=a.factory(void 0,i,e,r),n.firstCreatePass&&t>=r.directiveStart&&function QP(e,n,t){const{ngOnChanges:r,ngOnInit:o,ngDoCheck:i}=n.type.prototype;if(r){const a=_1(n);(t.preOrderHooks??=[]).push(e,a),(t.preOrderCheckHooks??=[]).push(e,a)}o&&(t.preOrderHooks??=[]).push(0-e,o),i&&((t.preOrderHooks??=[]).push(e,i),(t.preOrderCheckHooks??=[]).push(e,i))}(t,i[t],n)}finally{null!==c&&Kt(c),Dh(s),a.resolving=!1,G1()}}return o}function o_(e,n,t){return!!(t[n+(e>>Q1)]&1<<e)}function i_(e,n){return!(e&ze.Self||e&ze.Host&&n)}class fr{constructor(n,t){this._tNode=n,this._lView=t}get(n,t,r){return n_(this._tNode,this._lView,n,_u(r),t)}}function lO(){return new fr(Fn(),Z())}function Pn(e){return lo(()=>{const n=e.prototype.constructor,t=n[fo]||Jv(n),r=Object.prototype;let o=Object.getPrototypeOf(e.prototype).constructor;for(;o&&o!==r;){const i=o[fo]||Jv(o);if(i&&i!==t)return i;o=Object.getPrototypeOf(o)}return i=>new i})}function Jv(e){return _l(e)?()=>{const n=Jv(De(e));return n&&n()}:Ds(e)}function a_(e){const n=e[se],t=n.type;return 2===t?n.declTNode:1===t?e[Sn]:null}const Fu="__parameters__";function Ou(e,n,t){return lo(()=>{const r=function ey(e){return function(...t){if(e){const r=e(...t);for(const o in r)this[o]=r[o]}}}(n);function o(...i){if(this instanceof o)return r.apply(this,i),this;const a=new o(...i);return s.annotation=a,s;function s(u,c,l){const d=u.hasOwnProperty(Fu)?u[Fu]:Object.defineProperty(u,Fu,{value:[]})[Fu];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(a),u}}return t&&(o.prototype=Object.create(t.prototype)),o.prototype.ngMetadataName=e,o.annotationCls=o,o})}function Bu(e,n){e.forEach(t=>Array.isArray(t)?Bu(t,n):n(t))}function u_(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function Mh(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function zr(e,n,t){let r=Vu(e,n);return r>=0?e[1|r]=t:(r=~r,function yO(e,n,t,r){let o=e.length;if(o==n)e.push(t,r);else if(1===o)e.push(r,e[0]),e[0]=t;else{for(o--,e.push(e[o-1],e[o]);o>n;)e[o]=e[o-2],o--;e[n]=t,e[n+1]=r}}(e,r,n,t)),r}function ty(e,n){const t=Vu(e,n);if(t>=0)return e[1|t]}function Vu(e,n){return function c_(e,n,t){let r=0,o=e.length>>t;for(;o!==r;){const i=r+(o-r>>1),a=e[i<<t];if(n===a)return i<<t;a>n?o=i:r=i+1}return~(o<<t)}(e,n,1)}const Rh=wa(Ou("Optional"),8),Nh=wa(Ou("SkipSelf"),4);function Lh(e){return 128==(128&e.flags)}var Sa=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(Sa||{});const ay=new Map;let HO=0;const uy="__ngContext__";function Gn(e,n){xe(n)?(e[uy]=n[xs],function zO(e){ay.set(e[xs],e)}(n)):e[uy]=n}let cy;function ly(e,n){return cy(e,n)}function Yl(e){const n=e[vt];return Ye(n)?n[vt]:n}function M_(e){return R_(e[bs])}function T_(e){return R_(e[Ir])}function R_(e){for(;null!==e&&!Ye(e);)e=e[Ir];return e}function Hu(e,n,t,r,o){if(null!=r){let i,a=!1;Ye(r)?i=r:xe(r)&&(a=!0,r=r[$t]);const s=Bt(r);0===e&&null!==t?null==o?P_(n,t,s):Ss(n,t,s,o||null,!0):1===e&&null!==t?Ss(n,t,s,o||null,!0):2===e?function zh(e,n,t){const r=Hh(e,n);r&&function cL(e,n,t,r){e.removeChild(n,t,r)}(e,r,n,t)}(n,s,a):3===e&&n.destroyNode(s),null!=i&&function fL(e,n,t,r,o){const i=t[w];i!==Bt(t)&&Hu(n,e,r,i,o);for(let s=oe;s<t.length;s++){const u=t[s];Ql(u[se],u,e,n,r,i)}}(n,e,i,t,o)}}function Uh(e,n,t){return e.createElement(n,t)}function k_(e,n){const t=e[k],r=t.indexOf(n);T1(n),t.splice(r,1)}function jh(e,n){if(e.length<=oe)return;const t=oe+n,r=e[t];if(r){const o=r[Rt];null!==o&&o!==e&&k_(o,r),n>0&&(e[t-1][Ir]=r[Ir]);const i=Mh(e,oe+n);!function tL(e,n){Ql(e,n,n[Ae],2,null,null),n[$t]=null,n[Sn]=null}(r[se],r);const a=i[ho];null!==a&&a.detachView(i[se]),r[vt]=null,r[Ir]=null,r[Ne]&=-129}return r}function fy(e,n){if(!(256&n[Ne])){const t=n[Ae];n[Cs]&&g1(n[Cs]),n[_a]&&g1(n[_a]),t.destroyNode&&Ql(e,n,t,3,null,null),function oL(e){let n=e[bs];if(!n)return hy(e[se],e);for(;n;){let t=null;if(xe(n))t=n[bs];else{const r=n[oe];r&&(t=r)}if(!t){for(;n&&!n[Ir]&&n!==e;)xe(n)&&hy(n[se],n),n=n[vt];null===n&&(n=e),xe(n)&&hy(n[se],n),t=n&&n[Ir]}n=t}}(n)}}function hy(e,n){if(!(256&n[Ne])){n[Ne]&=-129,n[Ne]|=256,function uL(e,n){let t;if(null!=e&&null!=(t=e.destroyHooks))for(let r=0;r<t.length;r+=2){const o=n[t[r]];if(!(o instanceof Hl)){const i=t[r+1];if(Array.isArray(i))for(let a=0;a<i.length;a+=2){const s=o[i[a]],u=i[a+1];Yo(4,s,u);try{u.call(s)}finally{Yo(5,s,u)}}else{Yo(4,o,i);try{i.call(o)}finally{Yo(5,o,i)}}}}}(e,n),function sL(e,n){const t=e.cleanup,r=n[xa];if(null!==t)for(let i=0;i<t.length-1;i+=2)if("string"==typeof t[i]){const a=t[i+3];a>=0?r[a]():r[-a].unsubscribe(),i+=2}else t[i].call(r[t[i+1]]);null!==r&&(n[xa]=null);const o=n[Ko];if(null!==o){n[Ko]=null;for(let i=0;i<o.length;i++)(0,o[i])()}}(e,n),1===n[se].type&&n[Ae].destroy();const t=n[Rt];if(null!==t&&Ye(n[vt])){t!==n[vt]&&k_(t,n);const r=n[ho];null!==r&&r.detachView(e)}!function $O(e){ay.delete(e[xs])}(n)}}function py(e,n,t){return function F_(e,n,t){let r=n;for(;null!==r&&40&r.type;)r=(n=r).parent;if(null===r)return t[$t];{const{componentOffset:o}=r;if(o>-1){const{encapsulation:i}=e.data[r.directiveStart+o];if(i===Er.None||i===Er.Emulated)return null}return Sr(r,t)}}(e,n.parent,t)}function Ss(e,n,t,r,o){e.insertBefore(n,t,r,o)}function P_(e,n,t){e.appendChild(n,t)}function O_(e,n,t,r,o){null!==r?Ss(e,n,t,r,o):P_(e,n,t)}function Hh(e,n){return e.parentNode(n)}let gy,wy,Gh,V_=function B_(e,n,t){return 40&e.type?Sr(e,t):null};function Wh(e,n,t,r){const o=py(e,r,n),i=n[Ae],s=function L_(e,n,t){return V_(e,n,t)}(r.parent||n[Sn],r,n);if(null!=o)if(Array.isArray(t))for(let u=0;u<t.length;u++)O_(i,o,t[u],s,!1);else O_(i,o,t,s,!1);void 0!==gy&&gy(i,r,n,t,o)}function Zl(e,n){if(null!==n){const t=n.type;if(3&t)return Sr(n,e);if(4&t)return my(-1,e[n.index]);if(8&t){const r=n.child;if(null!==r)return Zl(e,r);{const o=e[n.index];return Ye(o)?my(-1,o):Bt(o)}}if(32&t)return ly(n,e)()||Bt(e[n.index]);{const r=j_(e,n);return null!==r?Array.isArray(r)?r[0]:Zl(Yl(e[Lt]),r):Zl(e,n.next)}}return null}function j_(e,n){return null!==n?e[Lt][Sn].projection[n.projection]:null}function my(e,n){const t=oe+e+1;if(t<n.length){const r=n[t],o=r[se].firstChild;if(null!==o)return Zl(r,o)}return n[w]}function vy(e,n,t,r,o,i,a){for(;null!=t;){const s=r[t.index],u=t.type;if(a&&0===n&&(s&&Gn(Bt(s),r),t.flags|=2),32!=(32&t.flags))if(8&u)vy(e,n,t.child,r,o,i,!1),Hu(n,e,o,s,i);else if(32&u){const c=ly(t,r);let l;for(;l=c();)Hu(n,e,o,l,i);Hu(n,e,o,s,i)}else 16&u?W_(e,n,r,t,o,i):Hu(n,e,o,s,i);t=a?t.projectionNext:t.next}}function Ql(e,n,t,r,o,i){vy(t,r,e.firstChild,n,o,i,!1)}function W_(e,n,t,r,o,i){const a=t[Lt],u=a[Sn].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++)Hu(n,e,o,u[c],i);else{let c=u;const l=a[vt];Lh(r)&&(c.flags|=128),vy(e,n,c,l,o,i,!0)}}function z_(e,n,t){""===t?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function $_(e,n,t){const{mergedAttrs:r,classes:o,styles:i}=t;null!==r&&Fl(e,n,r),null!==o&&z_(e,n,o),null!==i&&function pL(e,n,t){e.setAttribute(n,"style",t)}(e,n,i)}function X_(e){return function by(){if(void 0===Gh&&(Gh=null,mt.trustedTypes))try{Gh=mt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Gh}()?.createScriptURL(e)||e}class K_{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${El})`}}function Aa(e){return e instanceof K_?e.changingThisBreaksApplicationSecurity:e}function Jl(e,n){const t=function DL(e){return e instanceof K_&&e.getTypeName()||null}(e);if(null!=t&&t!==n){if("ResourceURL"===t&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${El})`)}return t===n}const AL=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var $u=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}($u||{});function Xh(e){const n=td();return n?n.sanitize($u.URL,e)||"":Jl(e,"URL")?Aa(e):function xy(e){return(e=String(e)).match(AL)?e:"unsafe:"+e}(Se(e))}function nD(e){const n=td();if(n)return X_(n.sanitize($u.RESOURCE_URL,e)||"");if(Jl(e,"ResourceURL"))return X_(Aa(e));throw new ee(904,!1)}function td(){const e=Z();return e&&e[Pi].sanitizer}const nd=new ue("ENVIRONMENT_INITIALIZER"),oD=new ue("INJECTOR",-1),iD=new ue("INJECTOR_DEF_TYPES");class Ey{get(n,t=ps){if(t===ps){const r=new Error(`NullInjectorError: No provider for ${Ve(n)}!`);throw r.name="NullInjectorError",r}return t}}function jL(...e){return{\u0275providers:aD(0,e),\u0275fromNgModule:!0}}function aD(e,...n){const t=[],r=new Set;let o;const i=a=>{t.push(a)};return Bu(n,a=>{const s=a;Kh(s,i,[],r)&&(o||=[],o.push(s))}),void 0!==o&&sD(o,i),t}function sD(e,n){for(let t=0;t<e.length;t++){const{ngModule:r,providers:o}=e[t];Sy(o,i=>{n(i,r)})}}function Kh(e,n,t,r){if(!(e=De(e)))return!1;let o=null,i=mu(e);const a=!i&&nt(e);if(i||a){if(a&&!a.standalone)return!1;o=e}else{const u=e.ngModule;if(i=mu(u),!i)return!1;o=u}const s=r.has(o);if(a){if(s)return!1;if(r.add(o),a.dependencies){const u="function"==typeof a.dependencies?a.dependencies():a.dependencies;for(const c of u)Kh(c,n,t,r)}}else{if(!i)return!1;{if(null!=i.imports&&!s){let c;r.add(o);try{Bu(i.imports,l=>{Kh(l,n,t,r)&&(c||=[],c.push(l))})}finally{}void 0!==c&&sD(c,n)}if(!s){const c=Ds(o)||(()=>new o);n({provide:o,useFactory:c,deps:$e},o),n({provide:iD,useValue:o,multi:!0},o),n({provide:nd,useValue:()=>fe(o),multi:!0},o)}const u=i.providers;if(null!=u&&!s){const c=e;Sy(u,l=>{n(l,c)})}}}return o!==e&&void 0!==e.providers}function Sy(e,n){for(let t of e)Dl(t)&&(t=t.\u0275providers),Array.isArray(t)?Sy(t,n):n(t)}const HL=pt({provide:String,useValue:pt});function Ay(e){return null!==e&&"object"==typeof e&&HL in e}function As(e){return"function"==typeof e}const My=new ue("Set Injector scope."),Yh={},zL={};let Ty;function Zh(){return void 0===Ty&&(Ty=new Ey),Ty}class $r{}class Gu extends $r{get destroyed(){return this._destroyed}constructor(n,t,r,o){super(),this.parent=t,this.source=r,this.scopes=o,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ny(n,a=>this.processProvider(a)),this.records.set(oD,qu(void 0,this)),o.has("environment")&&this.records.set($r,qu(void 0,this));const i=this.records.get(My);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(iD.multi,$e,ze.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of n)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const t=co(this),r=Kt(void 0);try{return n()}finally{co(t),Kt(r)}}get(n,t=ps,r=ze.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(ih))return n[ih](this);r=_u(r);const i=co(this),a=Kt(void 0);try{if(!(r&ze.SkipSelf)){let u=this.records.get(n);if(void 0===u){const c=function KL(e){return"function"==typeof e||"object"==typeof e&&e instanceof ue}(n)&&gu(n);u=c&&this.injectableDefInScope(c)?qu(Ry(n),Yh):null,this.records.set(n,u)}if(null!=u)return this.hydrate(n,u)}return(r&ze.Self?Zh():this.parent).get(n,t=r&ze.Optional&&t===ps?null:t)}catch(s){if("NullInjectorError"===s.name){if((s[gs]=s[gs]||[]).unshift(Ve(n)),i)throw s;return function rh(e,n,t,r){const o=e[gs];throw n[eh]&&o.unshift(n[eh]),e.message=function oh(e,n,t,r=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let o=Ve(n);if(Array.isArray(n))o=n.map(Ve).join(" -> ");else if("object"==typeof n){let i=[];for(let a in n)if(n.hasOwnProperty(a)){let s=n[a];i.push(a+":"+("string"==typeof s?JSON.stringify(s):Ve(s)))}o=`{${i.join(", ")}}`}return`${t}${r?"("+r+")":""}[${o}]: ${e.replace(gv,"\n  ")}`}("\n"+e.message,o,t,r),e.ngTokenPath=o,e[gs]=null,e}(s,n,"R3InjectorError",this.source)}throw s}finally{Kt(a),co(i)}}resolveInjectorInitializers(){const n=co(this),t=Kt(void 0);try{const o=this.get(nd.multi,$e,ze.Self);for(const i of o)i()}finally{co(n),Kt(t)}}toString(){const n=[],t=this.records;for(const r of t.keys())n.push(Ve(r));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ee(205,!1)}processProvider(n){let t=As(n=De(n))?n:De(n&&n.provide);const r=function GL(e){return Ay(e)?qu(void 0,e.useValue):qu(lD(e),Yh)}(n);if(As(n)||!0!==n.multi)this.records.get(t);else{let o=this.records.get(t);o||(o=qu(void 0,Yh,!0),o.factory=()=>Du(o.multi),this.records.set(t,o)),t=n,o.multi.push(n)}this.records.set(t,r)}hydrate(n,t){return t.value===Yh&&(t.value=zL,t.value=t.factory()),"object"==typeof t.value&&t.value&&function XL(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(n){if(!n.providedIn)return!1;const t=De(n.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(n){const t=this._onDestroyHooks.indexOf(n);-1!==t&&this._onDestroyHooks.splice(t,1)}}function Ry(e){const n=gu(e),t=null!==n?n.factory:Ds(e);if(null!==t)return t;if(e instanceof ue)throw new ee(204,!1);if(e instanceof Function)return function $L(e){const n=e.length;if(n>0)throw function ql(e,n){const t=[];for(let r=0;r<e;r++)t.push(n);return t}(n,"?"),new ee(204,!1);const t=function dv(e){return e&&(e[vu]||e[Ni])||null}(e);return null!==t?()=>t.factory(e):()=>new e}(e);throw new ee(204,!1)}function lD(e,n,t){let r;if(As(e)){const o=De(e);return Ds(o)||Ry(o)}if(Ay(e))r=()=>De(e.useValue);else if(function cD(e){return!(!e||!e.useFactory)}(e))r=()=>e.useFactory(...Du(e.deps||[]));else if(function uD(e){return!(!e||!e.useExisting)}(e))r=()=>fe(De(e.useExisting));else{const o=De(e&&(e.useClass||e.provide));if(!function qL(e){return!!e.deps}(e))return Ds(o)||Ry(o);r=()=>new o(...Du(e.deps))}return r}function qu(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function Ny(e,n){for(const t of e)Array.isArray(t)?Ny(t,n):t&&Dl(t)?Ny(t.\u0275providers,n):n(t)}const Qh=new ue("AppId",{providedIn:"root",factory:()=>YL}),YL="ng",dD=new ue("Platform Initializer"),Ms=new ue("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),fD=new ue("CSP nonce",{providedIn:"root",factory:()=>function zu(){if(void 0!==wy)return wy;if(typeof document<"u")return document;throw new ee(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let hD=(e,n,t)=>null;function Uy(e,n,t=!1){return hD(e,n,t)}class aB{}class mD{}class uB{resolveComponentFactory(n){throw function sB(e){const n=Error(`No component factory found for ${Ve(e)}.`);return n.ngComponent=e,n}(n)}}let op=(()=>{class e{static#e=this.NULL=new uB}return e})();function cB(){return Yu(Fn(),Z())}function Yu(e,n){return new Gr(Sr(e,n))}let Gr=(()=>{class e{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=cB}return e})();function lB(e){return e instanceof Gr?e.nativeElement:e}class yD{}let Jo=(()=>{class e{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function dB(){const e=Z(),t=Wr(Fn().index,e);return(xe(t)?t:e)[Ae]}()}return e})(),fB=(()=>{class e{static#e=this.\u0275prov=ye({token:e,providedIn:"root",factory:()=>null})}return e})();class id{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const hB=new id("16.2.12"),Wy={};function CD(e,n=null,t=null,r){const o=_D(e,n,t,r);return o.resolveInjectorInitializers(),o}function _D(e,n=null,t=null,r,o=new Set){const i=[t||$e,jL(e)];return r=r||("object"==typeof e?void 0:Ve(e)),new Gu(i,n||Zh(),r||null,o)}let qr=(()=>{class e{static#e=this.THROW_IF_NOT_FOUND=ps;static#t=this.NULL=new Ey;static create(t,r){if(Array.isArray(t))return CD({name:""},r,t,"");{const o=t.name??"";return CD({name:o},t.parent,t.providers,o)}}static#n=this.\u0275prov=ye({token:e,providedIn:"any",factory:()=>fe(oD)});static#r=this.__NG_ELEMENT_ID__=-1}return e})();function $y(e){return e.ngOriginalError}class Ui{constructor(){this._console=console}handleError(n){const t=this._findOriginalError(n);this._console.error("ERROR",n),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(n){let t=n&&$y(n);for(;t&&$y(t);)t=$y(t);return t||null}}function qy(e){return n=>{setTimeout(e,void 0,n)}}const rn=class bB extends Wn{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,t,r){let o=n,i=t||(()=>null),a=r;if(n&&"object"==typeof n){const u=n;o=u.next?.bind(u),i=u.error?.bind(u),a=u.complete?.bind(u)}this.__isAsync&&(i=qy(i),o&&(o=qy(o)),a&&(a=qy(a)));const s=super.subscribe({next:o,error:i,complete:a});return n instanceof St&&n.add(s),s}};function ED(...e){}class Vt{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new rn(!1),this.onMicrotaskEmpty=new rn(!1),this.onStable=new rn(!1),this.onError=new rn(!1),typeof Zone>"u")throw new ee(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&t,o.shouldCoalesceRunChangeDetection=r,o.lastRequestAnimationFrameId=-1,o.nativeRequestAnimationFrame=function xB(){const e="function"==typeof mt.requestAnimationFrame;let n=mt[e?"requestAnimationFrame":"setTimeout"],t=mt[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&t){const r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r);const o=t[Zone.__symbol__("OriginalDelegate")];o&&(t=o)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function DB(e){const n=()=>{!function _B(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(mt,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Ky(e),e.isCheckStableRunning=!0,Xy(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Ky(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,o,i,a,s)=>{if(function IB(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(s))return t.invokeTask(o,i,a,s);try{return ID(e),t.invokeTask(o,i,a,s)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||e.shouldCoalesceRunChangeDetection)&&n(),SD(e)}},onInvoke:(t,r,o,i,a,s,u)=>{try{return ID(e),t.invoke(o,i,a,s,u)}finally{e.shouldCoalesceRunChangeDetection&&n(),SD(e)}},onHasTask:(t,r,o,i)=>{t.hasTask(o,i),r===o&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,Ky(e),Xy(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:(t,r,o,i)=>(t.handleError(o,i),e.runOutsideAngular(()=>e.onError.emit(i)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Vt.isInAngularZone())throw new ee(909,!1)}static assertNotInAngularZone(){if(Vt.isInAngularZone())throw new ee(909,!1)}run(n,t,r){return this._inner.run(n,t,r)}runTask(n,t,r,o){const i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+o,n,CB,ED,ED);try{return i.runTask(a,t,r)}finally{i.cancelTask(a)}}runGuarded(n,t,r){return this._inner.runGuarded(n,t,r)}runOutsideAngular(n){return this._outer.run(n)}}const CB={};function Xy(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Ky(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function ID(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function SD(e){e._nesting--,Xy(e)}class EB{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new rn,this.onMicrotaskEmpty=new rn,this.onStable=new rn,this.onError=new rn}run(n,t,r){return n.apply(t,r)}runGuarded(n,t,r){return n.apply(t,r)}runOutsideAngular(n){return n()}runTask(n,t,r,o){return n.apply(t,r)}}const AD=new ue("",{providedIn:"root",factory:MD});function MD(){const e=ie(Vt);let n=!0;return function Jm(...e){const n=cs(e),t=function Mi(e,n){return"number"==typeof us(e)?e.pop():n}(e,1/0),r=e;return r.length?1===r.length?yn(r[0]):ya(t)(Te(r,n)):uo}(new Ot(o=>{n=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{o.next(n),o.complete()})}),new Ot(o=>{let i;e.runOutsideAngular(()=>{i=e.onStable.subscribe(()=>{Vt.assertNotInAngularZone(),queueMicrotask(()=>{!n&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(n=!0,o.next(!0))})})});const a=e.onUnstable.subscribe(()=>{Vt.assertInAngularZone(),n&&(n=!1,e.runOutsideAngular(()=>{o.next(!1)}))});return()=>{i.unsubscribe(),a.unsubscribe()}}).pipe(Kf()))}function ji(e){return e instanceof Function?e():e}let Yy=(()=>{class e{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=ye({token:e,providedIn:"root",factory:()=>new e})}return e})();function ad(e){for(;e;){e[Ne]|=64;const n=Yl(e);if(Nv(e)&&!n)return e;e=n}return null}const FD=new ue("",{providedIn:"root",factory:()=>!1});let ap=null;function BD(e,n){return e[n]??jD()}function VD(e,n){const t=jD();t.producerNode?.length&&(e[n]=ap,t.lView=e,ap=UD())}const OB={...c1,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{ad(e.lView)},lView:null};function UD(){return Object.create(OB)}function jD(){return ap??=UD(),ap}const Pe={};function We(e){HD(st(),Z(),dr()+e,!1)}function HD(e,n,t,r){if(!r)if(3==(3&n[Ne])){const i=e.preOrderCheckHooks;null!==i&&Ch(n,i,t)}else{const i=e.preOrderHooks;null!==i&&_h(n,i,0,t)}Es(t)}function te(e,n=ze.Default){const t=Z();return null===t?fe(e,n):n_(Fn(),t,De(e),n)}function sp(e,n,t,r,o,i,a,s,u,c,l){const d=n.blueprint.slice();return d[$t]=o,d[Ne]=140|r,(null!==c||e&&2048&e[Ne])&&(d[Ne]|=2048),M1(d),d[vt]=d[Nn]=e,d[Yt]=t,d[Pi]=a||e&&e[Pi],d[Ae]=s||e&&e[Ae],d[Xo]=u||e&&e[Xo]||null,d[Sn]=i,d[xs]=function WO(){return HO++}(),d[To]=l,d[gh]=c,d[Lt]=2==n.type?e[Lt]:d,d}function Ju(e,n,t,r,o){let i=e.data[n];if(null===i)i=function Zy(e,n,t,r,o){const i=L1(),a=Uv(),u=e.data[n]=function zB(e,n,t,r,o,i){let a=n?n.injectorIndex:-1,s=0;return function Tu(){return null!==Ie.skipHydrationRootTNode}()&&(s|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:a,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:s,providerIndexes:0,value:o,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?i:i&&i.parent,t,n,r,o);return null===e.firstChild&&(e.firstChild=u),null!==i&&(a?null==i.child&&null!==u.parent&&(i.child=u):null===i.next&&(i.next=u,u.prev=i)),u}(e,n,t,r,o),function HP(){return Ie.lFrame.inI18n}()&&(i.flags|=32);else if(64&i.type){i.type=t,i.value=r,i.attrs=o;const a=function jl(){const e=Ie.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}();i.injectorIndex=null===a?-1:a.injectorIndex}return Zo(i,!0),i}function sd(e,n,t,r){if(0===t)return-1;const o=n.length;for(let i=0;i<t;i++)n.push(r),e.blueprint.push(r),e.data.push(null);return o}function zD(e,n,t,r,o){const i=BD(n,Cs),a=dr(),s=2&r;try{Es(-1),s&&n.length>He&&HD(e,n,He,!1),Yo(s?2:0,o);const c=s?i:null,l=Fv(c);try{null!==c&&(c.dirty=!1),t(r,o)}finally{Pv(c,l)}}finally{s&&null===n[Cs]&&VD(n,Cs),Es(a),Yo(s?3:1,o)}}function Qy(e,n,t){if(Oi(n)){const r=po(null);try{const i=n.directiveEnd;for(let a=n.directiveStart;a<i;a++){const s=e.data[a];s.contentQueries&&s.contentQueries(1,t[a],a)}}finally{po(r)}}}function $D(e){const n=e.tView;return null===n||n.incompleteFirstPass?e.tView=tw(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):n}function tw(e,n,t,r,o,i,a,s,u,c,l){const d=He+r,f=d+o,h=function BB(e,n){const t=[];for(let r=0;r<n;r++)t.push(r<e?null:Pe);return t}(d,f),p="function"==typeof c?c():c;return h[se]={type:e,blueprint:h,template:t,queries:null,viewQuery:s,declTNode:n,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:u,consts:p,incompleteFirstPass:!1,ssrId:l}}let GD=e=>null;function qD(e,n,t,r){for(let o in e)if(e.hasOwnProperty(o)){t=null===t?{}:t;const i=e[o];null===r?XD(t,n,o,i):r.hasOwnProperty(o)&&XD(t,n,r[o],i)}return t}function XD(e,n,t,r){e.hasOwnProperty(t)?e[t].push(n,r):e[t]=[n,r]}function Xr(e,n,t,r,o,i,a,s){const u=Sr(n,t);let l,c=n.inputs;!s&&null!=c&&(l=c[r])?(aw(e,t,l,r,o),_s(n)&&function qB(e,n){const t=Wr(n,e);16&t[Ne]||(t[Ne]|=64)}(t,n.index)):3&n.type&&(r=function GB(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),o=null!=a?a(o,n.value||"",r):o,i.setProperty(u,r,o))}function KD(e,n,t,r,o,i){for(let c=0;c<r.length;c++)Qv(Eh(t,n),e,r[c].type);!function n3(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}(t,e.data.length,r.length);for(let c=0;c<r.length;c++){const l=r[c];l.providersResolver&&l.providersResolver(l)}let a=!1,s=!1,u=sd(e,n,r.length,null);for(let c=0;c<r.length;c++){const l=r[c];t.mergedAttrs=vs(t.mergedAttrs,l.hostAttrs),r3(e,t,n,u,l),t3(u,l,o),null!==l.contentQueries&&(t.flags|=4),(null!==l.hostBindings||null!==l.hostAttrs||0!==l.hostVars)&&(t.flags|=64);const d=l.type.prototype;!a&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((e.preOrderHooks??=[]).push(t.index),a=!0),!s&&(d.ngOnChanges||d.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(t.index),s=!0),u++}!function $B(e,n,t){const o=n.directiveEnd,i=e.data,a=n.attrs,s=[];let u=null,c=null;for(let l=n.directiveStart;l<o;l++){const d=i[l],f=t?t.get(d):null,p=f?f.outputs:null;u=qD(d.inputs,l,u,f?f.inputs:null),c=qD(d.outputs,l,c,p);const m=null===u||null===a||Iu(n)?null:a3(u,l,a);s.push(m)}null!==u&&(u.hasOwnProperty("class")&&(n.flags|=8),u.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=s,n.inputs=u,n.outputs=c}(e,t,i)}function YD(e,n,t){const r=t.directiveStart,o=t.directiveEnd,i=t.index,a=function zP(){return Ie.lFrame.currentDirectiveIndex}();try{Es(i);for(let s=r;s<o;s++){const u=e.data[s],c=n[s];Hv(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&QB(u,c)}}finally{Es(-1),Hv(a)}}function QB(e,n){null!==e.hostBindings&&e.hostBindings(1,n)}function rw(e,n,t){n.componentOffset=t,(e.components??=[]).push(n.index)}function t3(e,n,t){if(t){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)t[n.exportAs[r]]=e;Ro(n)&&(t[""]=e)}}function r3(e,n,t,r,o){e.data[r]=o;const i=o.factory||(o.factory=Ds(o.type)),a=new Hl(i,Ro(o),te);e.blueprint[r]=a,t[r]=a,function KB(e,n,t,r,o){const i=o.hostBindings;if(i){let a=e.hostBindingOpCodes;null===a&&(a=e.hostBindingOpCodes=[]);const s=~n.index;(function YB(e){let n=e.length;for(;n>0;){const t=e[--n];if("number"==typeof t&&t<0)return t}return 0})(a)!=s&&a.push(s),a.push(t,r,i)}}(e,n,r,sd(e,t,o.hostVars,Pe),o)}function ei(e,n,t,r,o,i){const a=Sr(e,n);!function ow(e,n,t,r,o,i,a){if(null==i)e.removeAttribute(n,o,t);else{const s=null==a?Se(i):a(i,r||"",o);e.setAttribute(n,o,s,t)}}(n[Ae],a,i,e.value,t,r,o)}function i3(e,n,t,r,o,i){const a=i[n];if(null!==a)for(let s=0;s<a.length;)ZD(r,t,a[s++],a[s++],a[s++])}function ZD(e,n,t,r,o){const i=po(null);try{const a=e.inputTransforms;null!==a&&a.hasOwnProperty(r)&&(o=a[r].call(n,o)),null!==e.setInput?e.setInput(n,o,t,r):n[r]=o}finally{po(i)}}function a3(e,n,t){let r=null,o=0;for(;o<t.length;){const i=t[o];if(0!==i)if(5!==i){if("number"==typeof i)break;if(e.hasOwnProperty(i)){null===r&&(r=[]);const a=e[i];for(let s=0;s<a.length;s+=2)if(a[s]===n){r.push(i,a[s+1],t[o+1]);break}}o+=2}else o+=2;else o+=4}return r}function JD(e,n){const t=e.contentQueries;if(null!==t)for(let r=0;r<t.length;r+=2){const i=t[r+1];if(-1!==i){const a=e.data[i];zv(t[r]),a.contentQueries(2,n[i],i)}}}function up(e,n){return e[bs]?e[ph][Ir]=n:e[bs]=n,e[ph]=n,n}function iw(e,n,t){zv(0);const r=po(null);try{n(e,t)}finally{po(r)}}function eE(e){return e[xa]||(e[xa]=[])}function tE(e){return e.cleanup||(e.cleanup=[])}function rE(e,n){const t=e[Xo],r=t?t.get(Ui,null):null;r&&r.handleError(n)}function aw(e,n,t,r,o){for(let i=0;i<t.length;){const a=t[i++],s=t[i++];ZD(e.data[a],n[a],r,s,o)}}function s3(e,n){const t=Wr(n,e),r=t[se];!function u3(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])}(r,t);const o=t[$t];null!==o&&null===t[To]&&(t[To]=Uy(o,t[Xo])),sw(r,t,t[Yt])}function sw(e,n,t){$v(n);try{const r=e.viewQuery;null!==r&&iw(1,r,t);const o=e.template;null!==o&&zD(e,n,o,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&JD(e,n),e.staticViewQueries&&iw(2,e.viewQuery,t);const i=e.components;null!==i&&function c3(e,n){for(let t=0;t<n.length;t++)s3(e,n[t])}(n,i)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{n[Ne]&=-5,Gv()}}let oE=(()=>{class e{constructor(){this.all=new Set,this.queue=new Map}create(t,r,o){const i=typeof Zone>"u"?null:Zone.current,a=function bP(e,n,t){const r=Object.create(xP);t&&(r.consumerAllowSignalWrites=!0),r.fn=e,r.schedule=n;const o=a=>{r.cleanupFn=a};return r.ref={notify:()=>h1(r),run:()=>{if(r.dirty=!1,r.hasRun&&!p1(r))return;r.hasRun=!0;const a=Fv(r);try{r.cleanupFn(),r.cleanupFn=C1,r.fn(o)}finally{Pv(r,a)}},cleanup:()=>r.cleanupFn()},r.ref}(t,c=>{this.all.has(c)&&this.queue.set(c,i)},o);let s;this.all.add(a),a.notify();const u=()=>{a.cleanup(),s?.(),this.all.delete(a),this.queue.delete(a)};return s=r?.onDestroy(u),{destroy:u}}flush(){if(0!==this.queue.size)for(const[t,r]of this.queue)this.queue.delete(t),r?r.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=ye({token:e,providedIn:"root",factory:()=>new e})}return e})();function cp(e,n,t){let r=t?e.styles:null,o=t?e.classes:null,i=0;if(null!==n)for(let a=0;a<n.length;a++){const s=n[a];"number"==typeof s?i=s:1==i?o=Cl(o,s):2==i&&(r=Cl(r,s+": "+n[++a]+";"))}t?e.styles=r:e.stylesWithoutHost=r,t?e.classes=o:e.classesWithoutHost=o}function ud(e,n,t,r,o=!1){for(;null!==t;){const i=n[t.index];null!==i&&r.push(Bt(i)),Ye(i)&&iE(i,r);const a=t.type;if(8&a)ud(e,n,t.child,r);else if(32&a){const s=ly(t,n);let u;for(;u=s();)r.push(u)}else if(16&a){const s=j_(n,t);if(Array.isArray(s))r.push(...s);else{const u=Yl(n[Lt]);ud(u[se],u,s,r,!0)}}t=o?t.projectionNext:t.next}return r}function iE(e,n){for(let t=oe;t<e.length;t++){const r=e[t],o=r[se].firstChild;null!==o&&ud(r[se],r,o,n)}e[w]!==e[$t]&&n.push(e[w])}function lp(e,n,t,r=!0){const o=n[Pi],i=o.rendererFactory,a=o.afterRenderEventManager;i.begin?.(),a?.begin();try{aE(e,n,e.template,t)}catch(u){throw r&&rE(n,u),u}finally{i.end?.(),o.effectManager?.flush(),a?.end()}}function aE(e,n,t,r){const o=n[Ne];if(256!=(256&o)){n[Pi].effectManager?.flush(),$v(n);try{M1(n),function V1(e){return Ie.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==t&&zD(e,n,t,2,r);const a=3==(3&o);if(a){const c=e.preOrderCheckHooks;null!==c&&Ch(n,c,null)}else{const c=e.preOrderHooks;null!==c&&_h(n,c,0,null),qv(n,0)}if(function f3(e){for(let n=M_(e);null!==n;n=T_(n)){if(!n[g])continue;const t=n[k];for(let r=0;r<t.length;r++){RP(t[r])}}}(n),sE(n,2),null!==e.contentQueries&&JD(e,n),a){const c=e.contentCheckHooks;null!==c&&Ch(n,c)}else{const c=e.contentHooks;null!==c&&_h(n,c,1),qv(n,1)}!function LB(e,n){const t=e.hostBindingOpCodes;if(null===t)return;const r=BD(n,_a);try{for(let o=0;o<t.length;o++){const i=t[o];if(i<0)Es(~i);else{const a=i,s=t[++o],u=t[++o];WP(s,a),r.dirty=!1;const c=Fv(r);try{u(2,n[a])}finally{Pv(r,c)}}}}finally{null===n[_a]&&VD(n,_a),Es(-1)}}(e,n);const s=e.components;null!==s&&cE(n,s,0);const u=e.viewQuery;if(null!==u&&iw(2,u,r),a){const c=e.viewCheckHooks;null!==c&&Ch(n,c)}else{const c=e.viewHooks;null!==c&&_h(n,c,2),qv(n,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),n[Ne]&=-73,T1(n)}finally{Gv()}}}function sE(e,n){for(let t=M_(e);null!==t;t=T_(t))for(let r=oe;r<t.length;r++)uE(t[r],n)}function h3(e,n,t){uE(Wr(n,e),t)}function uE(e,n){if(!function MP(e){return 128==(128&e[Ne])}(e))return;const t=e[se],r=e[Ne];if(80&r&&0===n||1024&r||2===n)aE(t,e,t.template,e[Yt]);else if(e[ws]>0){sE(e,1);const o=t.components;null!==o&&cE(e,o,1)}}function cE(e,n,t){for(let r=0;r<n.length;r++)h3(e,n[r],t)}class cd{get rootNodes(){const n=this._lView,t=n[se];return ud(t,n,t.firstChild,[])}constructor(n,t){this._lView=n,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Yt]}set context(n){this._lView[Yt]=n}get destroyed(){return 256==(256&this._lView[Ne])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[vt];if(Ye(n)){const t=n[8],r=t?t.indexOf(this):-1;r>-1&&(jh(n,r),Mh(t,r))}this._attachedToViewContainer=!1}fy(this._lView[se],this._lView)}onDestroy(n){!function N1(e,n){if(256==(256&e[Ne]))throw new ee(911,!1);null===e[Ko]&&(e[Ko]=[]),e[Ko].push(n)}(this._lView,n)}markForCheck(){ad(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ne]&=-129}reattach(){this._lView[Ne]|=128}detectChanges(){lp(this._lView[se],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ee(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function rL(e,n){Ql(e,n,n[Ae],2,null,null)}(this._lView[se],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new ee(902,!1);this._appRef=n}}class p3 extends cd{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;lp(n[se],n,n[Yt],!1)}checkNoChanges(){}get context(){return null}}class lE extends op{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const t=nt(n);return new ld(t,this.ngModule)}}function dE(e){const n=[];for(let t in e)e.hasOwnProperty(t)&&n.push({propName:e[t],templateName:t});return n}class m3{constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,r){r=_u(r);const o=this.injector.get(n,Wy,r);return o!==Wy||t===Wy?o:this.parentInjector.get(n,t,r)}}class ld extends mD{get inputs(){const n=this.componentDef,t=n.inputTransforms,r=dE(n.inputs);if(null!==t)for(const o of r)t.hasOwnProperty(o.propName)&&(o.transform=t[o.propName]);return r}get outputs(){return dE(this.componentDef.outputs)}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=function Iv(e){return e.map(Ev).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!t}create(n,t,r,o){let i=(o=o||this.ngModule)instanceof $r?o:o?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const a=i?new m3(n,i):n,s=a.get(yD,null);if(null===s)throw new ee(407,!1);const d={rendererFactory:s,sanitizer:a.get(fB,null),effectManager:a.get(oE,null),afterRenderEventManager:a.get(Yy,null)},f=s.createRenderer(null,this.componentDef),h=this.componentDef.selectors[0][0]||"div",p=r?function VB(e,n,t,r){const i=r.get(FD,!1)||t===Er.ShadowDom,a=e.selectRootElement(n,i);return function UB(e){GD(e)}(a),a}(f,r,this.componentDef.encapsulation,a):Uh(f,h,function g3(e){const n=e.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(h)),y=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let b=null;null!==p&&(b=Uy(p,a,!0));const C=tw(0,null,null,1,0,null,null,null,null,null,null),x=sp(null,C,null,y,null,null,d,f,a,null,b);let E,I;$v(x);try{const N=this.componentDef;let R,M=null;N.findHostDirectiveDefs?(R=[],M=new Map,N.findHostDirectiveDefs(N,R,M),R.push(N)):R=[N];const T=function y3(e,n){const t=e[se],r=He;return e[r]=n,Ju(t,r,2,"#host",null)}(x,p),L=function w3(e,n,t,r,o,i,a){const s=o[se];!function b3(e,n,t,r){for(const o of e)n.mergedAttrs=vs(n.mergedAttrs,o.hostAttrs);null!==n.mergedAttrs&&(cp(n,n.mergedAttrs,!0),null!==t&&$_(r,t,n))}(r,e,n,a);let u=null;null!==n&&(u=Uy(n,o[Xo]));const c=i.rendererFactory.createRenderer(n,t);let l=16;t.signals?l=4096:t.onPush&&(l=64);const d=sp(o,$D(t),null,l,o[e.index],e,i,c,null,null,u);return s.firstCreatePass&&rw(s,e,r.length-1),up(o,d),o[e.index]=d}(T,p,N,R,x,d,f);I=A1(C,He),p&&function C3(e,n,t,r){if(r)Fl(e,t,["ng-version",hB.full]);else{const{attrs:o,classes:i}=function Sv(e){const n=[],t=[];let r=1,o=2;for(;r<e.length;){let i=e[r];if("string"==typeof i)2===o?""!==i&&n.push(i,e[++r]):8===o&&t.push(i);else{if(!jr(o))break;o=i}r++}return{attrs:n,classes:t}}(n.selectors[0]);o&&Fl(e,t,o),i&&i.length>0&&z_(e,t,i.join(" "))}}(f,N,p,r),void 0!==t&&function _3(e,n,t){const r=e.projection=[];for(let o=0;o<n.length;o++){const i=t[o];r.push(null!=i?Array.from(i):null)}}(I,this.ngContentSelectors,t),E=function x3(e,n,t,r,o,i){const a=Fn(),s=o[se],u=Sr(a,o);KD(s,o,a,t,null,r);for(let l=0;l<t.length;l++)Gn(Is(o,s,a.directiveStart+l,a),o);YD(s,o,a),u&&Gn(u,o);const c=Is(o,s,a.directiveStart+a.componentOffset,a);if(e[Yt]=o[Yt]=c,null!==i)for(const l of i)l(c,n);return Qy(s,a,e),c}(L,N,R,M,x,[D3]),sw(C,x,null)}finally{Gv()}return new v3(this.componentType,E,Yu(I,x),x,I)}}class v3 extends aB{constructor(n,t,r,o,i){super(),this.location=r,this._rootLView=o,this._tNode=i,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new p3(o),this.componentType=n}setInput(n,t){const r=this._tNode.inputs;let o;if(null!==r&&(o=r[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),t))return;const i=this._rootLView;aw(i[se],i,o,n,t),this.previousInputValues.set(n,t),ad(Wr(this._tNode.index,i))}}get injector(){return new fr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function D3(){const e=Fn();xh(Z()[se],e)}function Et(e){let n=function fE(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),t=!0;const r=[e];for(;n;){let o;if(Ro(e))o=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new ee(903,!1);o=n.\u0275dir}if(o){if(t){r.push(o);const a=e;a.inputs=dp(e.inputs),a.inputTransforms=dp(e.inputTransforms),a.declaredInputs=dp(e.declaredInputs),a.outputs=dp(e.outputs);const s=o.hostBindings;s&&A3(e,s);const u=o.viewQuery,c=o.contentQueries;if(u&&I3(e,u),c&&S3(e,c),Ti(e.inputs,o.inputs),Ti(e.declaredInputs,o.declaredInputs),Ti(e.outputs,o.outputs),null!==o.inputTransforms&&(null===a.inputTransforms&&(a.inputTransforms={}),Ti(a.inputTransforms,o.inputTransforms)),Ro(o)&&o.data.animation){const l=e.data;l.animation=(l.animation||[]).concat(o.data.animation)}}const i=o.features;if(i)for(let a=0;a<i.length;a++){const s=i[a];s&&s.ngInherit&&s(e),s===Et&&(t=!1)}}n=Object.getPrototypeOf(n)}!function E3(e){let n=0,t=null;for(let r=e.length-1;r>=0;r--){const o=e[r];o.hostVars=n+=o.hostVars,o.hostAttrs=vs(o.hostAttrs,t=vs(t,o.hostAttrs))}}(r)}function dp(e){return e===Ur?{}:e===$e?[]:e}function I3(e,n){const t=e.viewQuery;e.viewQuery=t?(r,o)=>{n(r,o),t(r,o)}:n}function S3(e,n){const t=e.contentQueries;e.contentQueries=t?(r,o,i)=>{n(r,o,i),t(r,o,i)}:n}function A3(e,n){const t=e.hostBindings;e.hostBindings=t?(r,o)=>{n(r,o),t(r,o)}:n}function mE(e){const n=e.inputConfig,t={};for(const r in n)if(n.hasOwnProperty(r)){const o=n[r];Array.isArray(o)&&o[2]&&(t[r]=o[2])}e.inputTransforms=t}function qn(e,n,t){return!Object.is(e[n],t)&&(e[n]=t,!0)}function ni(e,n,t,r){const o=Z();return qn(o,Ru(),n)&&(st(),ei(Zt(),o,e,n,t,r)),ni}function tc(e,n,t,r){return qn(e,Ru(),t)?n+Se(t)+r:Pe}function Xn(e,n,t){const r=Z();return qn(r,Ru(),n)&&Xr(st(),Zt(),r,e,n,r[Ae],t,!1),Xn}function pw(e,n,t,r,o){const a=o?"class":"style";aw(e,t,n.inputs[a],a,r)}function W(e,n,t,r){const o=Z(),i=st(),a=He+e,s=o[Ae],u=i.firstCreatePass?function oV(e,n,t,r,o,i){const a=n.consts,u=Ju(n,e,2,r,Ea(a,o));return function nw(e,n,t,r){if(F1()){const o=null===r?null:{"":-1},i=function JB(e,n){const t=e.directiveRegistry;let r=null,o=null;if(t)for(let i=0;i<t.length;i++){const a=t[i];if(ys(n,a.selectors,!1))if(r||(r=[]),Ro(a))if(null!==a.findHostDirectiveDefs){const s=[];o=o||new Map,a.findHostDirectiveDefs(a,s,o),r.unshift(...s,a),rw(e,n,s.length)}else r.unshift(a),rw(e,n,0);else o=o||new Map,a.findHostDirectiveDefs?.(a,r,o),r.push(a)}return null===r?null:[r,o]}(e,t);let a,s;null===i?a=s=null:[a,s]=i,null!==a&&KD(e,n,t,a,o,s),o&&function e3(e,n,t){if(n){const r=e.localNames=[];for(let o=0;o<n.length;o+=2){const i=t[n[o+1]];if(null==i)throw new ee(-301,!1);r.push(n[o],i)}}}(t,r,o)}t.mergedAttrs=vs(t.mergedAttrs,t.attrs)}(n,t,u,Ea(a,i)),null!==u.attrs&&cp(u,u.attrs,!1),null!==u.mergedAttrs&&cp(u,u.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,u),u}(a,i,o,n,t,r):i.data[a],c=NE(i,o,u,s,n,e);o[a]=c;const l=mh(u);return Zo(u,!0),$_(s,c,u),32!=(32&u.flags)&&bh()&&Wh(i,o,c,u),0===function kP(){return Ie.lFrame.elementDepthCount}()&&Gn(c,o),function FP(){Ie.lFrame.elementDepthCount++}(),l&&(function Jy(e,n,t){F1()&&(function ZB(e,n,t,r){const o=t.directiveStart,i=t.directiveEnd;_s(t)&&function o3(e,n,t){const r=Sr(n,e),o=$D(t);let a=16;t.signals?a=4096:t.onPush&&(a=64);const s=up(e,sp(e,o,null,a,r,n,null,e[Pi].rendererFactory.createRenderer(r,t),null,null,null));e[n.index]=s}(n,t,e.data[o+t.componentOffset]),e.firstCreatePass||Eh(t,n),Gn(r,n);const a=t.initialInputs;for(let s=o;s<i;s++){const u=e.data[s],c=Is(n,e,s,t);Gn(c,n),null!==a&&i3(0,s-o,c,u,0,a),Ro(u)&&(Wr(t.index,n)[Yt]=Is(n,e,s,t))}}(e,n,t,Sr(t,n)),64==(64&t.flags)&&YD(e,n,t))}(i,o,u),Qy(i,u,o)),null!==r&&function ew(e,n,t=Sr){const r=n.localNames;if(null!==r){let o=n.index+1;for(let i=0;i<r.length;i+=2){const a=r[i+1],s=-1===a?t(n,e):e[a];e[o++]=s}}}(o,u),W}function z(){let e=Fn();Uv()?function jv(){Ie.lFrame.isParent=!1}():(e=e.parent,Zo(e,!1));const n=e;(function OP(e){return Ie.skipHydrationRootTNode===e})(n)&&function UP(){Ie.skipHydrationRootTNode=null}(),function PP(){Ie.lFrame.elementDepthCount--}();const t=st();return t.firstCreatePass&&(xh(t,e),Oi(e)&&t.queries.elementEnd(e)),null!=n.classesWithoutHost&&function tO(e){return 0!=(8&e.flags)}(n)&&pw(t,n,Z(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function nO(e){return 0!=(16&e.flags)}(n)&&pw(t,n,Z(),n.stylesWithoutHost,!1),z}function Ue(e,n,t,r){return W(e,n,t,r),z(),Ue}let NE=(e,n,t,r,o,i)=>(Ia(!0),Uh(r,o,function q1(){return Ie.lFrame.currentNamespace}()));function gd(e){return!!e&&"function"==typeof e.then}function OE(e){return!!e&&"function"==typeof e.subscribe}function On(e,n,t,r){const o=Z(),i=st(),a=Fn();return function BE(e,n,t,r,o,i,a){const s=mh(r),c=e.firstCreatePass&&tE(e),l=n[Yt],d=eE(n);let f=!0;if(3&r.type||a){const m=Sr(r,n),v=a?a(m):m,y=d.length,b=a?x=>a(Bt(x[r.index])):r.index;let C=null;if(!a&&s&&(C=function lV(e,n,t,r){const o=e.cleanup;if(null!=o)for(let i=0;i<o.length-1;i+=2){const a=o[i];if(a===t&&o[i+1]===r){const s=n[xa],u=o[i+2];return s.length>u?s[u]:null}"string"==typeof a&&(i+=2)}return null}(e,n,o,r.index)),null!==C)(C.__ngLastListenerFn__||C).__ngNextListenerFn__=i,C.__ngLastListenerFn__=i,f=!1;else{i=UE(r,n,l,i,!1);const x=t.listen(v,o,i);d.push(i,x),c&&c.push(o,b,y,y+1)}}else i=UE(r,n,l,i,!1);const h=r.outputs;let p;if(f&&null!==h&&(p=h[o])){const m=p.length;if(m)for(let v=0;v<m;v+=2){const E=n[p[v]][p[v+1]].subscribe(i),I=d.length;d.push(i,E),c&&c.push(o,r.index,I,-(I+1))}}}(i,o,o[Ae],a,e,n,r),On}function VE(e,n,t,r){try{return Yo(6,n,t),!1!==t(r)}catch(o){return rE(e,o),!1}finally{Yo(7,n,t)}}function UE(e,n,t,r,o){return function i(a){if(a===Function)return r;ad(e.componentOffset>-1?Wr(e.index,n):n);let u=VE(n,t,r,a),c=i.__ngNextListenerFn__;for(;c;)u=VE(n,t,c,a)&&u,c=c.__ngNextListenerFn__;return o&&!1===u&&a.preventDefault(),u}}function vw(e,n,t){return yw(e,"",n,"",t),vw}function yw(e,n,t,r,o){const i=Z(),a=tc(i,n,t,r);return a!==Pe&&Xr(st(),Zt(),i,e,a,i[Ae],o,!1),yw}function vp(e,n){return e<<17|n<<2}function Ma(e){return e>>17&32767}function ww(e){return 2|e}function Rs(e){return(131068&e)>>2}function bw(e,n){return-131069&e|n<<2}function xw(e){return 1|e}function KE(e,n,t,r,o){const i=e[t+1],a=null===n;let s=r?Ma(i):Rs(i),u=!1;for(;0!==s&&(!1===u||a);){const l=e[s+1];bV(e[s],n)&&(u=!0,e[s+1]=r?xw(l):ww(l)),s=r?Ma(l):Rs(l)}u&&(e[t+1]=r?ww(i):xw(i))}function bV(e,n){return null===e||null==n||(Array.isArray(e)?e[1]:e)===n||!(!Array.isArray(e)||"string"!=typeof n)&&Vu(e,n)>=0}function Je(e,n,t){return No(e,n,t,!1),Je}function yp(e,n){return No(e,n,null,!0),yp}function No(e,n,t,r){const o=Z(),i=st(),a=function Bi(e){const n=Ie.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}(2);i.firstUpdatePass&&function r2(e,n,t,r){const o=e.data;if(null===o[t+1]){const i=o[dr()],a=function n2(e,n){return n>=e.expandoStartIndex}(e,t);(function s2(e,n){return 0!=(e.flags&(n?8:16))})(i,r)&&null===n&&!a&&(n=!1),n=function MV(e,n,t,r){const o=function Wv(e){const n=Ie.lFrame.currentDirectiveIndex;return-1===n?null:e[n]}(e);let i=r?n.residualClasses:n.residualStyles;if(null===o)0===(r?n.classBindings:n.styleBindings)&&(t=md(t=Cw(null,e,n,t,r),n.attrs,r),i=null);else{const a=n.directiveStylingLast;if(-1===a||e[a]!==o)if(t=Cw(o,e,n,t,r),null===i){let u=function TV(e,n,t){const r=t?n.classBindings:n.styleBindings;if(0!==Rs(r))return e[Ma(r)]}(e,n,r);void 0!==u&&Array.isArray(u)&&(u=Cw(null,e,n,u[1],r),u=md(u,n.attrs,r),function RV(e,n,t,r){e[Ma(t?n.classBindings:n.styleBindings)]=r}(e,n,r,u))}else i=function NV(e,n,t){let r;const o=n.directiveEnd;for(let i=1+n.directiveStylingLast;i<o;i++)r=md(r,e[i].hostAttrs,t);return md(r,n.attrs,t)}(e,n,r)}return void 0!==i&&(r?n.residualClasses=i:n.residualStyles=i),t}(o,i,n,r),function yV(e,n,t,r,o,i){let a=i?n.classBindings:n.styleBindings,s=Ma(a),u=Rs(a);e[r]=t;let l,c=!1;if(Array.isArray(t)?(l=t[1],(null===l||Vu(t,l)>0)&&(c=!0)):l=t,o)if(0!==u){const f=Ma(e[s+1]);e[r+1]=vp(f,s),0!==f&&(e[f+1]=bw(e[f+1],r)),e[s+1]=function mV(e,n){return 131071&e|n<<17}(e[s+1],r)}else e[r+1]=vp(s,0),0!==s&&(e[s+1]=bw(e[s+1],r)),s=r;else e[r+1]=vp(u,0),0===s?s=r:e[u+1]=bw(e[u+1],r),u=r;c&&(e[r+1]=ww(e[r+1])),KE(e,l,r,!0),KE(e,l,r,!1),function wV(e,n,t,r,o){const i=o?e.residualClasses:e.residualStyles;null!=i&&"string"==typeof n&&Vu(i,n)>=0&&(t[r+1]=xw(t[r+1]))}(n,l,e,r,i),a=vp(s,u),i?n.classBindings=a:n.styleBindings=a}(o,i,n,t,a,r)}}(i,e,a,r),n!==Pe&&qn(o,a,n)&&function i2(e,n,t,r,o,i,a,s){if(!(3&n.type))return;const u=e.data,c=u[s+1],l=function vV(e){return 1==(1&e)}(c)?a2(u,n,t,o,Rs(c),a):void 0;wp(l)||(wp(i)||function gV(e){return 2==(2&e)}(c)&&(i=a2(u,null,t,o,s,a)),function hL(e,n,t,r,o){if(n)o?e.addClass(t,r):e.removeClass(t,r);else{let i=-1===r.indexOf("-")?void 0:Sa.DashCase;null==o?e.removeStyle(t,r,i):("string"==typeof o&&o.endsWith("!important")&&(o=o.slice(0,-10),i|=Sa.Important),e.setStyle(t,r,o,i))}}(r,a,wh(dr(),t),o,i))}(i,i.data[dr()],o,o[Ae],e,o[a+1]=function OV(e,n){return null==e||""===e||("string"==typeof n?e+=n:"object"==typeof e&&(e=Ve(Aa(e)))),e}(n,t),r,a)}function Cw(e,n,t,r,o){let i=null;const a=t.directiveEnd;let s=t.directiveStylingLast;for(-1===s?s=t.directiveStart:s++;s<a&&(i=n[s],r=md(r,i.hostAttrs,o),i!==e);)s++;return null!==e&&(t.directiveStylingLast=s),r}function md(e,n,t){const r=t?1:2;let o=-1;if(null!==n)for(let i=0;i<n.length;i++){const a=n[i];"number"==typeof a?o=a:o===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),zr(e,a,!!t||n[++i]))}return void 0===e?null:e}function a2(e,n,t,r,o,i){const a=null===n;let s;for(;o>0;){const u=e[o],c=Array.isArray(u),l=c?u[1]:u,d=null===l;let f=t[o+1];f===Pe&&(f=d?$e:void 0);let h=d?ty(f,r):l===r?f:void 0;if(c&&!wp(h)&&(h=ty(u,r)),wp(h)&&(s=h,a))return s;const p=e[o+1];o=a?Ma(p):Rs(p)}if(null!==n){let u=i?n.residualClasses:n.residualStyles;null!=u&&(s=ty(u,r))}return s}function wp(e){return void 0!==e}function K(e,n=""){const t=Z(),r=st(),o=e+He,i=r.firstCreatePass?Ju(r,o,1,n,null):r.data[o],a=u2(r,t,i,n,e);t[o]=a,bh()&&Wh(r,t,a,i),Zo(i,!1)}let u2=(e,n,t,r,o)=>(Ia(!0),function Vh(e,n){return e.createText(n)}(n[Ae],r));function bp(e,n,t){const r=Z(),o=tc(r,e,n,t);return o!==Pe&&function Hi(e,n,t){const r=wh(n,e);!function N_(e,n,t){e.setValue(n,t)}(e[Ae],r,t)}(r,dr(),o),bp}const dc="en-US";let R2=dc;function Ew(e,n,t,r,o){if(e=De(e),Array.isArray(e))for(let i=0;i<e.length;i++)Ew(e[i],n,t,r,o);else{const i=st(),a=Z(),s=Fn();let u=As(e)?e:De(e.provide);const c=lD(e),l=1048575&s.providerIndexes,d=s.directiveStart,f=s.providerIndexes>>20;if(As(e)||!e.multi){const h=new Hl(c,o,te),p=Sw(u,n,o?l:l+f,d);-1===p?(Qv(Eh(s,a),i,u),Iw(i,e,n.length),n.push(u),s.directiveStart++,s.directiveEnd++,o&&(s.providerIndexes+=1048576),t.push(h),a.push(h)):(t[p]=h,a[p]=h)}else{const h=Sw(u,n,l+f,d),p=Sw(u,n,l,l+f),v=p>=0&&t[p];if(o&&!v||!o&&!(h>=0&&t[h])){Qv(Eh(s,a),i,u);const y=function rU(e,n,t,r,o){const i=new Hl(e,t,te);return i.multi=[],i.index=n,i.componentProviders=0,nI(i,o,r&&!t),i}(o?nU:tU,t.length,o,r,c);!o&&v&&(t[p].providerFactory=y),Iw(i,e,n.length,0),n.push(u),s.directiveStart++,s.directiveEnd++,o&&(s.providerIndexes+=1048576),t.push(y),a.push(y)}else Iw(i,e,h>-1?h:p,nI(t[o?p:h],c,!o&&r));!o&&r&&v&&t[p].componentProviders++}}}function Iw(e,n,t,r){const o=As(n),i=function WL(e){return!!e.useClass}(n);if(o||i){const u=(i?De(n.useClass):n).prototype.ngOnDestroy;if(u){const c=e.destroyHooks||(e.destroyHooks=[]);if(!o&&n.multi){const l=c.indexOf(t);-1===l?c.push(t,[r,u]):c[l+1].push(r,u)}else c.push(t,u)}}}function nI(e,n,t){return t&&e.componentProviders++,e.multi.push(n)-1}function Sw(e,n,t,r){for(let o=t;o<r;o++)if(n[o]===e)return o;return-1}function tU(e,n,t,r){return Aw(this.multi,[])}function nU(e,n,t,r){const o=this.multi;let i;if(this.providerFactory){const a=this.providerFactory.componentProviders,s=Is(t,t[se],this.providerFactory.index,r);i=s.slice(0,a),Aw(o,i);for(let u=a;u<s.length;u++)i.push(s[u])}else i=[],Aw(o,i);return i}function Aw(e,n){for(let t=0;t<e.length;t++)n.push((0,e[t])());return n}function Gt(e,n=[]){return t=>{t.providersResolver=(r,o)=>function eU(e,n,t){const r=st();if(r.firstCreatePass){const o=Ro(e);Ew(t,r.data,r.blueprint,o,!0),Ew(n,r.data,r.blueprint,o,!1)}}(r,o?o(e):e,n)}}class ks{}class rI{}class Mw extends ks{constructor(n,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new lE(this);const o=cr(n);this._bootstrapComponents=ji(o.bootstrap),this._r3Injector=_D(n,t,[{provide:ks,useValue:this},{provide:op,useValue:this.componentFactoryResolver},...r],Ve(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class Tw extends rI{constructor(n){super(),this.moduleType=n}create(n){return new Mw(this.moduleType,n,[])}}class oI extends ks{constructor(n){super(),this.componentFactoryResolver=new lE(this),this.instance=null;const t=new Gu([...n.providers,{provide:ks,useValue:this},{provide:op,useValue:this.componentFactoryResolver}],n.parent||Zh(),n.debugName,new Set(["environment"]));this.injector=t,n.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function Rw(e,n,t=null){return new oI({providers:e,parent:n,debugName:t,runEnvironmentInitializers:!0}).injector}let aU=(()=>{class e{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const r=aD(0,t.type),o=r.length>0?Rw([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,o)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=ye({token:e,providedIn:"environment",factory:()=>new e(fe($r))})}return e})();function iI(e){e.getStandaloneInjector=n=>n.get(aU).getOrCreateStandaloneInjector(e)}function yo(e,n,t){const r=function lr(){const e=Ie.lFrame;let n=e.bindingRootIndex;return-1===n&&(n=e.bindingRootIndex=e.tView.bindingStartIndex),n}()+e,o=Z();return o[r]===Pe?function ti(e,n,t){return e[n]=t}(o,r,t?n.call(t):n()):function dd(e,n){return e[n]}(o,r)}function RU(){return this._results[Symbol.iterator]()}class kw{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new rn)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=kw.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=RU)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,t){return this._results.reduce(n,t)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,t){const r=this;r.dirty=!1;const o=function mo(e){return e.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function mO(e,n,t){if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++){let o=e[r],i=n[r];if(t&&(o=t(o),i=t(i)),i!==o)return!1}return!0}(r._results,o,t))&&(r._results=o,r.length=o.length,r.last=o[this.length-1],r.first=o[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function kU(e,n,t,r=!0){const o=n[se];if(function iL(e,n,t,r){const o=oe+r,i=t.length;r>0&&(t[o-1][Ir]=n),r<i-oe?(n[Ir]=t[o],u_(t,oe+r,n)):(t.push(n),n[Ir]=null),n[vt]=t;const a=n[Rt];null!==a&&t!==a&&function aL(e,n){const t=e[k];n[Lt]!==n[vt][vt][Lt]&&(e[g]=!0),null===t?e[k]=[n]:t.push(n)}(a,n);const s=n[ho];null!==s&&s.insertView(e),n[Ne]|=128}(o,n,e,t),r){const i=my(t,e),a=n[Ae],s=Hh(a,e[w]);null!==s&&function nL(e,n,t,r,o,i){r[$t]=o,r[Sn]=n,Ql(e,r,t,1,o,i)}(o,e[Sn],a,n,s,i)}}let Wi=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=OU}return e})();const FU=Wi,PU=class extends FU{constructor(n,t,r){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,r){const o=function NU(e,n,t,r){const o=n.tView,s=sp(e,o,t,4096&e[Ne]?4096:16,null,n,null,null,null,r?.injector??null,r?.hydrationInfo??null);s[Rt]=e[n.index];const c=e[ho];return null!==c&&(s[ho]=c.createEmbeddedView(o)),sw(o,s,t),s}(this._declarationLView,this._declarationTContainer,n,{injector:t,hydrationInfo:r});return new cd(o)}};function OU(){return Ep(Fn(),Z())}function Ep(e,n){return 4&e.type?new PU(n,e,Yu(e,n)):null}let Fo=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=HU}return e})();function HU(){return _I(Fn(),Z())}const WU=Fo,xI=class extends WU{constructor(n,t,r){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=r}get element(){return Yu(this._hostTNode,this._hostLView)}get injector(){return new fr(this._hostTNode,this._hostLView)}get parentInjector(){const n=Ih(this._hostTNode,this._hostLView);if(Kv(n)){const t=zl(n,this._hostLView),r=Wl(n);return new fr(t[se].data[r+8],t)}return new fr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const t=CI(this._lContainer);return null!==t&&t[n]||null}get length(){return this._lContainer.length-oe}createEmbeddedView(n,t,r){let o,i;"number"==typeof r?o=r:null!=r&&(o=r.index,i=r.injector);const s=n.createEmbeddedViewImpl(t||{},i,null);return this.insertImpl(s,o,false),s}createComponent(n,t,r,o,i){const a=n&&!function Gl(e){return"function"==typeof e}(n);let s;if(a)s=t;else{const m=t||{};s=m.index,r=m.injector,o=m.projectableNodes,i=m.environmentInjector||m.ngModuleRef}const u=a?n:new ld(nt(n)),c=r||this.parentInjector;if(!i&&null==u.ngModule){const v=(a?c:this.parentInjector).get($r,null);v&&(i=v)}nt(u.componentType??{});const h=u.create(c,o,null,i);return this.insertImpl(h.hostView,s,false),h}insert(n,t){return this.insertImpl(n,t,!1)}insertImpl(n,t,r){const o=n._lView;if(function TP(e){return Ye(e[vt])}(o)){const u=this.indexOf(n);if(-1!==u)this.detach(u);else{const c=o[vt],l=new xI(c,c[Sn],c[vt]);l.detach(l.indexOf(n))}}const a=this._adjustIndex(t),s=this._lContainer;return kU(s,o,a,!r),n.attachToViewContainerRef(),u_(Fw(s),a,n),n}move(n,t){return this.insert(n,t)}indexOf(n){const t=CI(this._lContainer);return null!==t?t.indexOf(n):-1}remove(n){const t=this._adjustIndex(n,-1),r=jh(this._lContainer,t);r&&(Mh(Fw(this._lContainer),t),fy(r[se],r))}detach(n){const t=this._adjustIndex(n,-1),r=jh(this._lContainer,t);return r&&null!=Mh(Fw(this._lContainer),t)?new cd(r):null}_adjustIndex(n,t=0){return n??this.length+t}};function CI(e){return e[8]}function Fw(e){return e[8]||(e[8]=[])}function _I(e,n){let t;const r=n[e.index];return Ye(r)?t=r:(t=function QD(e,n,t,r){return[e,!0,!1,n,null,0,r,t,null,null,null]}(r,n,null,e),n[e.index]=t,up(n,t)),DI(t,n,e,r),new xI(t,e,n)}let DI=function EI(e,n,t,r){if(e[w])return;let o;o=8&t.type?Bt(r):function zU(e,n){const t=e[Ae],r=t.createComment(""),o=Sr(n,e);return Ss(t,Hh(t,o),r,function lL(e,n){return e.nextSibling(n)}(t,o),!1),r}(n,t),e[w]=o};class Pw{constructor(n){this.queryList=n,this.matches=null}clone(){return new Pw(this.queryList)}setDirty(){this.queryList.setDirty()}}class Ow{constructor(n=[]){this.queries=n}createEmbeddedView(n){const t=n.queries;if(null!==t){const r=null!==n.contentQueries?n.contentQueries[0]:t.length,o=[];for(let i=0;i<r;i++){const a=t.getByIndex(i);o.push(this.queries[a.indexInDeclarationView].clone())}return new Ow(o)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let t=0;t<this.queries.length;t++)null!==RI(n,t).matches&&this.queries[t].setDirty()}}class II{constructor(n,t,r=null){this.predicate=n,this.flags=t,this.read=r}}class Lw{constructor(n=[]){this.queries=n}elementStart(n,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(n,t)}elementEnd(n){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(n)}embeddedTView(n){let t=null;for(let r=0;r<this.length;r++){const o=null!==t?t.length:0,i=this.getByIndex(r).embeddedTView(n,o);i&&(i.indexInDeclarationView=r,null!==t?t.push(i):t=[i])}return null!==t?new Lw(t):null}template(n,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(n,t)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class Bw{constructor(n,t=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(n,t){this.isApplyingToNode(t)&&this.matchTNode(n,t)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,t){this.elementStart(n,t)}embeddedTView(n,t){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,t),new Bw(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let r=n.parent;for(;null!==r&&8&r.type&&r.index!==t;)r=r.parent;return t===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(n,t){const r=this.metadata.predicate;if(Array.isArray(r))for(let o=0;o<r.length;o++){const i=r[o];this.matchTNodeWithReadOption(n,t,qU(t,i)),this.matchTNodeWithReadOption(n,t,Sh(t,n,i,!1,!1))}else r===Wi?4&t.type&&this.matchTNodeWithReadOption(n,t,-1):this.matchTNodeWithReadOption(n,t,Sh(t,n,r,!1,!1))}matchTNodeWithReadOption(n,t,r){if(null!==r){const o=this.metadata.read;if(null!==o)if(o===Gr||o===Fo||o===Wi&&4&t.type)this.addMatch(t.index,-2);else{const i=Sh(t,n,o,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,r)}}addMatch(n,t){null===this.matches?this.matches=[n,t]:this.matches.push(n,t)}}function qU(e,n){const t=e.localNames;if(null!==t)for(let r=0;r<t.length;r+=2)if(t[r]===n)return t[r+1];return null}function KU(e,n,t,r){return-1===t?function XU(e,n){return 11&e.type?Yu(e,n):4&e.type?Ep(e,n):null}(n,e):-2===t?function YU(e,n,t){return t===Gr?Yu(n,e):t===Wi?Ep(n,e):t===Fo?_I(n,e):void 0}(e,n,r):Is(e,e[se],t,n)}function SI(e,n,t,r){const o=n[ho].queries[r];if(null===o.matches){const i=e.data,a=t.matches,s=[];for(let u=0;u<a.length;u+=2){const c=a[u];s.push(c<0?null:KU(n,i[c],a[u+1],t.metadata.read))}o.matches=s}return o.matches}function Vw(e,n,t,r){const o=e.queries.getByIndex(t),i=o.matches;if(null!==i){const a=SI(e,n,o,t);for(let s=0;s<i.length;s+=2){const u=i[s];if(u>0)r.push(a[s/2]);else{const c=i[s+1],l=n[-u];for(let d=oe;d<l.length;d++){const f=l[d];f[Rt]===f[vt]&&Vw(f[se],f,c,r)}if(null!==l[k]){const d=l[k];for(let f=0;f<d.length;f++){const h=d[f];Vw(h[se],h,c,r)}}}}}return r}function Dd(e){const n=Z(),t=st(),r=j1();zv(r+1);const o=RI(t,r);if(e.dirty&&function AP(e){return 4==(4&e[Ne])}(n)===(2==(2&o.metadata.flags))){if(null===o.matches)e.reset([]);else{const i=o.crossesNgTemplate?Vw(t,n,r,[]):SI(t,n,o,r);e.reset(i,lB),e.notifyOnChanges()}return!0}return!1}function Sp(e,n,t){const r=st();r.firstCreatePass&&(function TI(e,n,t){null===e.queries&&(e.queries=new Lw),e.queries.track(new Bw(n,t))}(r,new II(e,n,t),-1),2==(2&n)&&(r.staticViewQueries=!0)),function MI(e,n,t){const r=new kw(4==(4&t));(function WB(e,n,t,r){const o=eE(n);o.push(t),e.firstCreatePass&&tE(e).push(r,o.length-1)})(e,n,r,r.destroy),null===n[ho]&&(n[ho]=new Ow),n[ho].queries.push(new Pw(r))}(r,Z(),n)}function Ed(){return function ZU(e,n){return e[ho].queries[n].queryList}(Z(),j1())}function RI(e,n){return e.queries.getByIndex(n)}const $w=new ue("Application Initializer");let Gw=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=ie($w,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const o of this.appInits){const i=o();if(gd(i))t.push(i);else if(OE(i)){const a=new Promise((s,u)=>{i.subscribe({complete:s,error:u})});t.push(a)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(o=>{this.reject(o)}),0===t.length&&r(),this.initialized=!0}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),XI=(()=>{class e{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();const zi=new ue("LocaleId",{providedIn:"root",factory:()=>ie(zi,ze.Optional|ze.SkipSelf)||function bj(){return typeof $localize<"u"&&$localize.locale||dc}()});let Mp=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new _r(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class _j{constructor(n,t){this.ngModuleFactory=n,this.componentFactories=t}}let KI=(()=>{class e{compileModuleSync(t){return new Tw(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const r=this.compileModuleSync(t),i=ji(cr(t).declarations).reduce((a,s)=>{const u=nt(s);return u&&a.push(new ld(u)),a},[]);return new _j(r,i)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const JI=new ue(""),Rp=new ue("");let Zw,Kw=(()=>{class e{constructor(t,r,o){this._ngZone=t,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Zw||(function $j(e){Zw=e}(o),o.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Vt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(t)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,o){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==i),t(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:t,timeoutId:i,updateCb:o})}whenStable(t,r,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,o){return[]}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Vt),fe(Yw),fe(Rp))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})(),Yw=(()=>{class e{constructor(){this._applications=new Map}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return Zw?.findTestabilityInTree(this,t,r)??null}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),Ta=null;const eS=new ue("AllowMultipleToken"),Qw=new ue("PlatformDestroyListeners"),Jw=new ue("appBootstrapListener");class nS{constructor(n,t){this.name=n,this.token=t}}function oS(e,n,t=[]){const r=`Platform: ${n}`,o=new ue(r);return(i=[])=>{let a=eb();if(!a||a.injector.get(eS,!1)){const s=[...t,...i,{provide:o,useValue:!0}];e?e(s):function Xj(e){if(Ta&&!Ta.get(eS,!1))throw new ee(400,!1);(function tS(){!function gP(e){y1=e}(()=>{throw new ee(600,!1)})})(),Ta=e;const n=e.get(aS);(function rS(e){e.get(dD,null)?.forEach(t=>t())})(e)}(function iS(e=[],n){return qr.create({name:n,providers:[{provide:My,useValue:"platform"},{provide:Qw,useValue:new Set([()=>Ta=null])},...e]})}(s,r))}return function Yj(e){const n=eb();if(!n)throw new ee(401,!1);return n}()}}function eb(){return Ta?.get(aS)??null}let aS=(()=>{class e{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){const o=function Zj(e="zone.js",n){return"noop"===e?new EB:"zone.js"===e?new Vt(n):e}(r?.ngZone,function sS(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return o.run(()=>{const i=function iU(e,n,t){return new Mw(e,n,t)}(t.moduleType,this.injector,function fS(e){return[{provide:Vt,useFactory:e},{provide:nd,multi:!0,useFactory:()=>{const n=ie(Jj,{optional:!0});return()=>n.initialize()}},{provide:dS,useFactory:Qj},{provide:AD,useFactory:MD}]}(()=>o)),a=i.injector.get(Ui,null);return o.runOutsideAngular(()=>{const s=o.onError.subscribe({next:u=>{a.handleError(u)}});i.onDestroy(()=>{Np(this._modules,i),s.unsubscribe()})}),function uS(e,n,t){try{const r=t();return gd(r)?r.catch(o=>{throw n.runOutsideAngular(()=>e.handleError(o)),o}):r}catch(r){throw n.runOutsideAngular(()=>e.handleError(r)),r}}(a,o,()=>{const s=i.injector.get(Gw);return s.runInitializers(),s.donePromise.then(()=>(function N2(e){Dr(e,"Expected localeId to be defined"),"string"==typeof e&&(R2=e.toLowerCase().replace(/_/g,"-"))}(i.injector.get(zi,dc)||dc),this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,r=[]){const o=cS({},r);return function Gj(e,n,t){const r=new Tw(t);return Promise.resolve(r)}(0,0,t).then(i=>this.bootstrapModuleFactory(i,o))}_moduleDoBootstrap(t){const r=t.injector.get(pc);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(o=>r.bootstrap(o));else{if(!t.instance.ngDoBootstrap)throw new ee(-403,!1);t.instance.ngDoBootstrap(r)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ee(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const t=this._injector.get(Qw,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(r){return new(r||e)(fe(qr))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function cS(e,n){return Array.isArray(n)?n.reduce(cS,e):{...e,...n}}let pc=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ie(dS),this.zoneIsStable=ie(AD),this.componentTypes=[],this.components=[],this.isStable=ie(Mp).hasPendingTasks.pipe(Vr(t=>t?_e(!1):this.zoneIsStable),function xl(e,n=Or){return e=e??ls,at((t,r)=>{let o,i=!0;t.subscribe(At(r,a=>{const s=n(a);(i||!e(o,s))&&(i=!1,o=s,r.next(a))}))})}(),Kf()),this._injector=ie($r)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,r){const o=t instanceof mD;if(!this._injector.get(Gw).done)throw!o&&function Fi(e){const n=nt(e)||wn(e)||Rn(e);return null!==n&&n.standalone}(t),new ee(405,!1);let a;a=o?t:this._injector.get(op).resolveComponentFactory(t),this.componentTypes.push(a.componentType);const s=function qj(e){return e.isBoundToModule}(a)?void 0:this._injector.get(ks),c=a.create(qr.NULL,[],r||a.selector,s),l=c.location.nativeElement,d=c.injector.get(JI,null);return d?.registerApplication(l),c.onDestroy(()=>{this.detachView(c.hostView),Np(this.components,c),d?.unregisterApplication(l)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new ee(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){const r=t;Np(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const r=this._injector.get(Jw,[]);r.push(...this._bootstrapListeners),r.forEach(o=>o(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Np(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ee(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Np(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}const dS=new ue("",{providedIn:"root",factory:()=>ie(Ui).handleError.bind(void 0)});function Qj(){const e=ie(Vt),n=ie(Ui);return t=>e.runOutsideAngular(()=>n.handleError(t))}let Jj=(()=>{class e{constructor(){this.zone=ie(Vt),this.applicationRef=ie(pc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();let kp=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=tH}return e})();function tH(e){return function nH(e,n,t){if(_s(e)&&!t){const r=Wr(e.index,n);return new cd(r,r)}return 47&e.type?new cd(n[Lt],n):null}(Fn(),Z(),16==(16&e))}const gH=oS(null,"core",[]);let mH=(()=>{class e{constructor(t){}static#e=this.\u0275fac=function(r){return new(r||e)(fe(pc))};static#t=this.\u0275mod=Hr({type:e});static#n=this.\u0275inj=ur({})}return e})();function gc(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}let ab=null;function Ra(){return ab}class TH{}const Kr=new ue("DocumentToken");let sb=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:function(){return ie(NH)},providedIn:"platform"})}return e})();const RH=new ue("Location Initialized");let NH=(()=>{class e extends sb{constructor(){super(),this._doc=ie(Kr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ra().getBaseHref(this._doc)}onPopState(t){const r=Ra().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=Ra().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,o){this._history.pushState(t,r,o)}replaceState(t,r,o){this._history.replaceState(t,r,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:function(){return new e},providedIn:"platform"})}return e})();function ub(e,n){if(0==e.length)return n;if(0==n.length)return e;let t=0;return e.endsWith("/")&&t++,n.startsWith("/")&&t++,2==t?e+n.substring(1):1==t?e+n:e+"/"+n}function TS(e){const n=e.match(/#|\?|$/),t=n&&n.index||e.length;return e.slice(0,t-("/"===e[t-1]?1:0))+e.slice(t)}function $i(e){return e&&"?"!==e[0]?"?"+e:e}let Na=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:function(){return ie(NS)},providedIn:"root"})}return e})();const RS=new ue("appBaseHref");let NS=(()=>{class e extends Na{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??ie(Kr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return ub(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+$i(this._platformLocation.search),o=this._platformLocation.hash;return o&&t?`${r}${o}`:r}pushState(t,r,o,i){const a=this.prepareExternalUrl(o+$i(i));this._platformLocation.pushState(t,r,a)}replaceState(t,r,o,i){const a=this.prepareExternalUrl(o+$i(i));this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(r){return new(r||e)(fe(sb),fe(RS,8))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),kS=(()=>{class e extends Na{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=ub(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,o,i){let a=this.prepareExternalUrl(o+$i(i));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(t,r,a)}replaceState(t,r,o,i){let a=this.prepareExternalUrl(o+$i(i));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(r){return new(r||e)(fe(sb),fe(RS,8))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})(),cb=(()=>{class e{constructor(t){this._subject=new rn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._basePath=function PH(e){if(new RegExp("^(https?:)?//").test(e)){const[,t]=e.split(/\/\/[^\/]+/);return t}return e}(TS(FS(r))),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+$i(r))}normalize(t){return e.stripTrailingSlash(function FH(e,n){if(!e||!n.startsWith(e))return n;const t=n.substring(e.length);return""===t||["/",";","?","#"].includes(t[0])?t:n}(this._basePath,FS(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",o=null){this._locationStrategy.pushState(o,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+$i(r)),o)}replaceState(t,r="",o=null){this._locationStrategy.replaceState(o,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+$i(r)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(o=>o(t,r))}subscribe(t,r,o){return this._subject.subscribe({next:t,error:r,complete:o})}static#e=this.normalizeQueryParams=$i;static#t=this.joinWithSlash=ub;static#n=this.stripTrailingSlash=TS;static#r=this.\u0275fac=function(r){return new(r||e)(fe(Na))};static#o=this.\u0275prov=ye({token:e,factory:function(){return function kH(){return new cb(fe(Na))}()},providedIn:"root"})}return e})();function FS(e){return e.replace(/\/index.html$/,"")}function WS(e,n){n=encodeURIComponent(n);for(const t of e.split(";")){const r=t.indexOf("="),[o,i]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(o.trim()===n)return decodeURIComponent(i)}return null}let KW=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Hr({type:e});static#n=this.\u0275inj=ur({})}return e})();function ZS(e){return"server"===e}let JW=(()=>{class e{static#e=this.\u0275prov=ye({token:e,providedIn:"root",factory:()=>new e5(fe(Kr),window)})}return e})();class e5{constructor(n,t){this.document=n,this.window=t,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const t=function t5(e,n){const t=e.getElementById(n)||e.getElementsByName(n)[0];if(t)return t;if("function"==typeof e.createTreeWalker&&e.body&&"function"==typeof e.body.attachShadow){const r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let o=r.currentNode;for(;o;){const i=o.shadowRoot;if(i){const a=i.getElementById(n)||i.querySelector(`[name="${n}"]`);if(a)return a}o=r.nextNode()}}return null}(this.document,n);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(n){this.supportsScrolling()&&(this.window.history.scrollRestoration=n)}scrollToElement(n){const t=n.getBoundingClientRect(),r=t.left+this.window.pageXOffset,o=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],o-i[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class QS{}class D5 extends TH{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Ib extends D5{static makeCurrent(){!function MH(e){ab||(ab=e)}(new Ib)}onAndCancel(n,t,r){return n.addEventListener(t,r),()=>{n.removeEventListener(t,r)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,t){return(t=t||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return"window"===t?window:"document"===t?n:"body"===t?n.body:null}getBaseHref(n){const t=function E5(){return Nd=Nd||document.querySelector("base"),Nd?Nd.getAttribute("href"):null}();return null==t?null:function I5(e){Yp=Yp||document.createElement("a"),Yp.setAttribute("href",e);const n=Yp.pathname;return"/"===n.charAt(0)?n:`/${n}`}(t)}resetBaseElement(){Nd=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return WS(document.cookie,n)}}let Yp,Nd=null,A5=(()=>{class e{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();const Sb=new ue("EventManagerPlugins");let rA=(()=>{class e{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(o=>{o.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,o){return this._findPluginFor(r).addEventListener(t,r,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(i=>i.supports(t)),!r)throw new ee(5101,!1);return this._eventNameToPlugin.set(t,r),r}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Sb),fe(Vt))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();class oA{constructor(n){this._doc=n}}const Ab="ng-app-id";let iA=(()=>{class e{constructor(t,r,o,i={}){this.doc=t,this.appId=r,this.nonce=o,this.platformId=i,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=ZS(i),this.resetHostNodes()}addStyles(t){for(const r of t)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(t){for(const r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){const r=this.styleRef;r.get(t)?.elements?.forEach(o=>o.remove()),r.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${Ab}="${this.appId}"]`);if(t?.length){const r=new Map;return t.forEach(o=>{null!=o.textContent&&r.set(o.textContent,o)}),r}return null}changeUsageCount(t,r){const o=this.styleRef;if(o.has(t)){const i=o.get(t);return i.usage+=r,i.usage}return o.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){const o=this.styleNodesInDOM,i=o?.get(r);if(i?.parentNode===t)return o.delete(r),i.removeAttribute(Ab),i;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(Ab,this.appId),a}}addStyleToHost(t,r){const o=this.getStyleElement(t,r);t.appendChild(o);const i=this.styleRef,a=i.get(r)?.elements;a?a.push(o):i.set(r,{elements:[o],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Kr),fe(Qh),fe(fD,8),fe(Ms))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();const Mb={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Tb=/%COMP%/g,N5=new ue("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function sA(e,n){return n.map(t=>t.replace(Tb,e))}let uA=(()=>{class e{constructor(t,r,o,i,a,s,u,c=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=i,this.doc=a,this.platformId=s,this.ngZone=u,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=ZS(s),this.defaultRenderer=new Rb(t,a,u,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Er.ShadowDom&&(r={...r,encapsulation:Er.Emulated});const o=this.getOrCreateRenderer(t,r);return o instanceof lA?o.applyToHost(t):o instanceof Nb&&o.applyStyles(),o}getOrCreateRenderer(t,r){const o=this.rendererByCompId;let i=o.get(r.id);if(!i){const a=this.doc,s=this.ngZone,u=this.eventManager,c=this.sharedStylesHost,l=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(r.encapsulation){case Er.Emulated:i=new lA(u,c,r,this.appId,l,a,s,d);break;case Er.ShadowDom:return new O5(u,c,t,r,a,s,this.nonce,d);default:i=new Nb(u,c,r,l,a,s,d)}o.set(r.id,i)}return i}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(r){return new(r||e)(fe(rA),fe(iA),fe(Qh),fe(N5),fe(Kr),fe(Ms),fe(Vt),fe(fD))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();class Rb{constructor(n,t,r,o){this.eventManager=n,this.doc=t,this.ngZone=r,this.platformIsServer=o,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,t){return t?this.doc.createElementNS(Mb[t]||t,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,t){(cA(n)?n.content:n).appendChild(t)}insertBefore(n,t,r){n&&(cA(n)?n.content:n).insertBefore(t,r)}removeChild(n,t){n&&n.removeChild(t)}selectRootElement(n,t){let r="string"==typeof n?this.doc.querySelector(n):n;if(!r)throw new ee(-5104,!1);return t||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,r,o){if(o){t=o+":"+t;const i=Mb[o];i?n.setAttributeNS(i,t,r):n.setAttribute(t,r)}else n.setAttribute(t,r)}removeAttribute(n,t,r){if(r){const o=Mb[r];o?n.removeAttributeNS(o,t):n.removeAttribute(`${r}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,r,o){o&(Sa.DashCase|Sa.Important)?n.style.setProperty(t,r,o&Sa.Important?"important":""):n.style[t]=r}removeStyle(n,t,r){r&Sa.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,r){n[t]=r}setValue(n,t){n.nodeValue=t}listen(n,t,r){if("string"==typeof n&&!(n=Ra().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${t}`);return this.eventManager.addEventListener(n,t,this.decoratePreventDefault(r))}decoratePreventDefault(n){return t=>{if("__ngUnwrap__"===t)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(t)):n(t))&&t.preventDefault()}}}function cA(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class O5 extends Rb{constructor(n,t,r,o,i,a,s,u){super(n,i,a,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=sA(o.id,o.styles);for(const l of c){const d=document.createElement("style");s&&d.setAttribute("nonce",s),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,r){return super.insertBefore(this.nodeOrShadowRoot(n),t,r)}removeChild(n,t){return super.removeChild(this.nodeOrShadowRoot(n),t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Nb extends Rb{constructor(n,t,r,o,i,a,s,u){super(n,i,a,s),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=o,this.styles=u?sA(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class lA extends Nb{constructor(n,t,r,o,i,a,s,u){const c=o+"-"+r.id;super(n,t,r,i,a,s,u,c),this.contentAttr=function k5(e){return"_ngcontent-%COMP%".replace(Tb,e)}(c),this.hostAttr=function F5(e){return"_nghost-%COMP%".replace(Tb,e)}(c)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){const r=super.createElement(n,t);return super.setAttribute(r,this.contentAttr,""),r}}let L5=(()=>{class e extends oA{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,o){return t.addEventListener(r,o,!1),()=>this.removeEventListener(t,r,o)}removeEventListener(t,r,o){return t.removeEventListener(r,o)}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Kr))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();const dA=["alt","control","meta","shift"],B5={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},V5={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let U5=(()=>{class e extends oA{constructor(t){super(t)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,r,o){const i=e.parseEventName(r),a=e.eventCallback(i.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ra().onAndCancel(t,i.domEventName,a))}static parseEventName(t){const r=t.toLowerCase().split("."),o=r.shift();if(0===r.length||"keydown"!==o&&"keyup"!==o)return null;const i=e._normalizeKey(r.pop());let a="",s=r.indexOf("code");if(s>-1&&(r.splice(s,1),a="code."),dA.forEach(c=>{const l=r.indexOf(c);l>-1&&(r.splice(l,1),a+=c+".")}),a+=i,0!=r.length||0===i.length)return null;const u={};return u.domEventName=o,u.fullKey=a,u}static matchEventFullKeyCode(t,r){let o=B5[t.key]||t.key,i="";return r.indexOf("code.")>-1&&(o=t.code,i="code."),!(null==o||!o)&&(o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),dA.forEach(a=>{a!==o&&(0,V5[a])(t)&&(i+=a+".")}),i+=o,i===r)}static eventCallback(t,r,o){return i=>{e.matchEventFullKeyCode(i,t)&&o.runGuarded(()=>r(i))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Kr))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();const hA=[{provide:Ms,useValue:"browser"},{provide:dD,useValue:function j5(){Ib.makeCurrent()},multi:!0},{provide:Kr,useFactory:function W5(){return function yL(e){wy=e}(document),document},deps:[]}],z5=oS(gH,"browser",hA),$5=new ue(""),pA=[{provide:Rp,useClass:class S5{addToWindow(n){mt.getAngularTestability=(r,o=!0)=>{const i=n.findTestabilityInTree(r,o);if(null==i)throw new ee(5103,!1);return i},mt.getAllAngularTestabilities=()=>n.getAllTestabilities(),mt.getAllAngularRootElements=()=>n.getAllRootElements(),mt.frameworkStabilizers||(mt.frameworkStabilizers=[]),mt.frameworkStabilizers.push(r=>{const o=mt.getAllAngularTestabilities();let i=o.length,a=!1;const s=function(u){a=a||u,i--,0==i&&r(a)};o.forEach(u=>{u.whenStable(s)})})}findTestabilityInTree(n,t,r){return null==t?null:n.getTestability(t)??(r?Ra().isShadowRoot(t)?this.findTestabilityInTree(n,t.host,!0):this.findTestabilityInTree(n,t.parentElement,!0):null)}},deps:[]},{provide:JI,useClass:Kw,deps:[Vt,Yw,Rp]},{provide:Kw,useClass:Kw,deps:[Vt,Yw,Rp]}],gA=[{provide:My,useValue:"root"},{provide:Ui,useFactory:function H5(){return new Ui},deps:[]},{provide:Sb,useClass:L5,multi:!0,deps:[Kr,Vt,Ms]},{provide:Sb,useClass:U5,multi:!0,deps:[Kr]},uA,iA,rA,{provide:yD,useExisting:uA},{provide:QS,useClass:A5,deps:[]},[]];let G5=(()=>{class e{constructor(t){}static withServerTransition(t){return{ngModule:e,providers:[{provide:Qh,useValue:t.appId}]}}static#e=this.\u0275fac=function(r){return new(r||e)(fe($5,12))};static#t=this.\u0275mod=Hr({type:e});static#n=this.\u0275inj=ur({providers:[...gA,...pA],imports:[KW,mH]})}return e})(),mA=(()=>{class e{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Kr))};static#t=this.\u0275prov=ye({token:e,factory:function(r){let o=null;return o=r?new r:function X5(){return new mA(fe(Kr))}(),o},providedIn:"root"})}return e})();function vc(e,n){return Fe(n)?Wt(e,n,1):Wt(e,1)}function Xi(e,n){return at((t,r)=>{let o=0;t.subscribe(At(r,i=>e.call(n,i,o++)&&r.next(i)))})}function kd(e){return at((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}typeof window<"u"&&window;class Zp{}class Qp{}class ii{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(t=>{const r=t.indexOf(":");if(r>0){const o=t.slice(0,r),i=o.toLowerCase(),a=t.slice(r+1).trim();this.maybeSetNormalizedName(o,i),this.headers.has(i)?this.headers.get(i).push(a):this.headers.set(i,[a])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof ii?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){const t=new ii;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof ii?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){const t=n.name.toLowerCase();switch(n.op){case"a":case"s":let r=n.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(n.name,t);const o=("a"===n.op?this.headers.get(t):void 0)||[];o.push(...r),this.headers.set(t,o);break;case"d":const i=n.value;if(i){let a=this.headers.get(t);if(!a)return;a=a.filter(s=>-1===i.indexOf(s)),0===a.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(n,t){const r=(Array.isArray(t)?t:[t]).map(i=>i.toString()),o=n.toLowerCase();this.headers.set(o,r),this.maybeSetNormalizedName(n,o)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}}class J5{encodeKey(n){return bA(n)}encodeValue(n){return bA(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const tz=/%(\d[a-f0-9])/gi,nz={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function bA(e){return encodeURIComponent(e).replace(tz,(n,t)=>nz[t]??n)}function Jp(e){return`${e}`}class Fa{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new J5,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function ez(e,n){const t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(o=>{const i=o.indexOf("="),[a,s]=-1==i?[n.decodeKey(o),""]:[n.decodeKey(o.slice(0,i)),n.decodeValue(o.slice(i+1))],u=t.get(a)||[];u.push(s),t.set(a,u)}),t}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{const r=n.fromObject[t],o=Array.isArray(r)?r.map(Jp):[Jp(r)];this.map.set(t,o)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){const t=[];return Object.keys(n).forEach(r=>{const o=n[r];Array.isArray(o)?o.forEach(i=>{t.push({param:r,value:i,op:"a"})}):t.push({param:r,value:o,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const t=this.encoder.encodeKey(n);return this.map.get(n).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const t=new Fa({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const t=("a"===n.op?this.map.get(n.param):void 0)||[];t.push(Jp(n.value)),this.map.set(n.param,t);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let r=this.map.get(n.param)||[];const o=r.indexOf(Jp(n.value));-1!==o&&r.splice(o,1),r.length>0?this.map.set(n.param,r):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class rz{constructor(){this.map=new Map}set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function xA(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function CA(e){return typeof Blob<"u"&&e instanceof Blob}function _A(e){return typeof FormData<"u"&&e instanceof FormData}class Fd{constructor(n,t,r,o){let i;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function oz(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||o?(this.body=void 0!==r?r:null,i=o):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new ii),this.context||(this.context=new rz),this.params){const a=this.params.toString();if(0===a.length)this.urlWithParams=t;else{const s=t.indexOf("?");this.urlWithParams=t+(-1===s?"?":s<t.length-1?"&":"")+a}}else this.params=new Fa,this.urlWithParams=t}serializeBody(){return null===this.body?null:xA(this.body)||CA(this.body)||_A(this.body)||function iz(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Fa?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||_A(this.body)?null:CA(this.body)?this.body.type||null:xA(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Fa?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const t=n.method||this.method,r=n.url||this.url,o=n.responseType||this.responseType,i=void 0!==n.body?n.body:this.body,a=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,s=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let u=n.headers||this.headers,c=n.params||this.params;const l=n.context??this.context;return void 0!==n.setHeaders&&(u=Object.keys(n.setHeaders).reduce((d,f)=>d.set(f,n.setHeaders[f]),u)),n.setParams&&(c=Object.keys(n.setParams).reduce((d,f)=>d.set(f,n.setParams[f]),c)),new Fd(t,r,i,{params:c,headers:u,context:l,reportProgress:s,responseType:o,withCredentials:a})}}var yc=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(yc||{});class Fb{constructor(n,t=200,r="OK"){this.headers=n.headers||new ii,this.status=void 0!==n.status?n.status:t,this.statusText=n.statusText||r,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class Pb extends Fb{constructor(n={}){super(n),this.type=yc.ResponseHeader}clone(n={}){return new Pb({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class wc extends Fb{constructor(n={}){super(n),this.type=yc.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new wc({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class DA extends Fb{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function Ob(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let Pd=(()=>{class e{constructor(t){this.handler=t}request(t,r,o={}){let i;if(t instanceof Fd)i=t;else{let u,c;u=o.headers instanceof ii?o.headers:new ii(o.headers),o.params&&(c=o.params instanceof Fa?o.params:new Fa({fromObject:o.params})),i=new Fd(t,r,void 0!==o.body?o.body:null,{headers:u,context:o.context,params:c,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials})}const a=_e(i).pipe(vc(u=>this.handler.handle(u)));if(t instanceof Fd||"events"===o.observe)return a;const s=a.pipe(Xi(u=>u instanceof wc));switch(o.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return s.pipe(ft(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return s.pipe(ft(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return s.pipe(ft(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return s.pipe(ft(u=>u.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:(new Fa).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,o={}){return this.request("PATCH",t,Ob(o,r))}post(t,r,o={}){return this.request("POST",t,Ob(o,r))}put(t,r,o={}){return this.request("PUT",t,Ob(o,r))}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Zp))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();function SA(e,n){return n(e)}function sz(e,n){return(t,r)=>n.intercept(t,{handle:o=>e(o,r)})}const cz=new ue(""),Od=new ue(""),AA=new ue("");function lz(){let e=null;return(n,t)=>{null===e&&(e=(ie(cz,{optional:!0})??[]).reduceRight(sz,SA));const r=ie(Mp),o=r.add();return e(n,t).pipe(kd(()=>r.remove(o)))}}let MA=(()=>{class e extends Zp{constructor(t,r){super(),this.backend=t,this.injector=r,this.chain=null,this.pendingTasks=ie(Mp)}handle(t){if(null===this.chain){const o=Array.from(new Set([...this.injector.get(Od),...this.injector.get(AA,[])]));this.chain=o.reduceRight((i,a)=>function uz(e,n,t){return(r,o)=>t.runInContext(()=>n(r,i=>e(i,o)))}(i,a,this.injector),SA)}const r=this.pendingTasks.add();return this.chain(t,o=>this.backend.handle(o)).pipe(kd(()=>this.pendingTasks.remove(r)))}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Qp),fe($r))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();const pz=/^\)\]\}',?\n/;let RA=(()=>{class e{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new ee(-2800,!1);const r=this.xhrFactory;return(r.\u0275loadImpl?Te(r.\u0275loadImpl()):_e(null)).pipe(Vr(()=>new Ot(i=>{const a=r.build();if(a.open(t.method,t.urlWithParams),t.withCredentials&&(a.withCredentials=!0),t.headers.forEach((m,v)=>a.setRequestHeader(m,v.join(","))),t.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const m=t.detectContentTypeHeader();null!==m&&a.setRequestHeader("Content-Type",m)}if(t.responseType){const m=t.responseType.toLowerCase();a.responseType="json"!==m?m:"text"}const s=t.serializeBody();let u=null;const c=()=>{if(null!==u)return u;const m=a.statusText||"OK",v=new ii(a.getAllResponseHeaders()),y=function gz(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(a)||t.url;return u=new Pb({headers:v,status:a.status,statusText:m,url:y}),u},l=()=>{let{headers:m,status:v,statusText:y,url:b}=c(),C=null;204!==v&&(C=typeof a.response>"u"?a.responseText:a.response),0===v&&(v=C?200:0);let x=v>=200&&v<300;if("json"===t.responseType&&"string"==typeof C){const E=C;C=C.replace(pz,"");try{C=""!==C?JSON.parse(C):null}catch(I){C=E,x&&(x=!1,C={error:I,text:C})}}x?(i.next(new wc({body:C,headers:m,status:v,statusText:y,url:b||void 0})),i.complete()):i.error(new DA({error:C,headers:m,status:v,statusText:y,url:b||void 0}))},d=m=>{const{url:v}=c(),y=new DA({error:m,status:a.status||0,statusText:a.statusText||"Unknown Error",url:v||void 0});i.error(y)};let f=!1;const h=m=>{f||(i.next(c()),f=!0);let v={type:yc.DownloadProgress,loaded:m.loaded};m.lengthComputable&&(v.total=m.total),"text"===t.responseType&&a.responseText&&(v.partialText=a.responseText),i.next(v)},p=m=>{let v={type:yc.UploadProgress,loaded:m.loaded};m.lengthComputable&&(v.total=m.total),i.next(v)};return a.addEventListener("load",l),a.addEventListener("error",d),a.addEventListener("timeout",d),a.addEventListener("abort",d),t.reportProgress&&(a.addEventListener("progress",h),null!==s&&a.upload&&a.upload.addEventListener("progress",p)),a.send(s),i.next({type:yc.Sent}),()=>{a.removeEventListener("error",d),a.removeEventListener("abort",d),a.removeEventListener("load",l),a.removeEventListener("timeout",d),t.reportProgress&&(a.removeEventListener("progress",h),null!==s&&a.upload&&a.upload.removeEventListener("progress",p)),a.readyState!==a.DONE&&a.abort()}})))}static#e=this.\u0275fac=function(r){return new(r||e)(fe(QS))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();const Lb=new ue("XSRF_ENABLED"),NA=new ue("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),kA=new ue("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class FA{}let yz=(()=>{class e{constructor(t,r,o){this.doc=t,this.platform=r,this.cookieName=o,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=WS(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Kr),fe(Ms),fe(NA))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();function wz(e,n){const t=e.url.toLowerCase();if(!ie(Lb)||"GET"===e.method||"HEAD"===e.method||t.startsWith("http://")||t.startsWith("https://"))return n(e);const r=ie(FA).getToken(),o=ie(kA);return null!=r&&!e.headers.has(o)&&(e=e.clone({headers:e.headers.set(o,r)})),n(e)}var Pa=function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e}(Pa||{});function bz(...e){const n=[Pd,RA,MA,{provide:Zp,useExisting:MA},{provide:Qp,useExisting:RA},{provide:Od,useValue:wz,multi:!0},{provide:Lb,useValue:!0},{provide:FA,useClass:yz}];for(const t of e)n.push(...t.\u0275providers);return function Iy(e){return{\u0275providers:e}}(n)}const PA=new ue("LEGACY_INTERCEPTOR_FN");function xz(){return function Ps(e,n){return{\u0275kind:e,\u0275providers:n}}(Pa.LegacyInterceptors,[{provide:PA,useFactory:lz},{provide:Od,useExisting:PA,multi:!0}])}let Cz=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Hr({type:e});static#n=this.\u0275inj=ur({providers:[bz(xz())]})}return e})();const{isArray:Az}=Array,{getPrototypeOf:Mz,prototype:Tz,keys:Rz}=Object;function OA(e){if(1===e.length){const n=e[0];if(Az(n))return{args:n,keys:null};if(function Nz(e){return e&&"object"==typeof e&&Mz(e)===Tz}(n)){const t=Rz(n);return{args:t.map(r=>n[r]),keys:t}}}return{args:e,keys:null}}const{isArray:kz}=Array;function LA(e){return ft(n=>function Fz(e,n){return kz(n)?e(...n):e(n)}(e,n))}function BA(e,n){return e.reduce((t,r,o)=>(t[r]=n[o],t),{})}let VA=(()=>{class e{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(r){return new(r||e)(te(Jo),te(Gr))};static#t=this.\u0275dir=Ce({type:e})}return e})(),Os=(()=>{class e extends VA{static#e=this.\u0275fac=function(){let t;return function(o){return(t||(t=Pn(e)))(o||e)}}();static#t=this.\u0275dir=Ce({type:e,features:[Et]})}return e})();const ai=new ue("NgValueAccessor"),Lz={provide:ai,useExisting:Mt(()=>tg),multi:!0},Vz=new ue("CompositionEventMode");let tg=(()=>{class e extends VA{constructor(t,r,o){super(t,r),this._compositionMode=o,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Bz(){const e=Ra()?Ra().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(r){return new(r||e)(te(Jo),te(Gr),te(Vz,8))};static#t=this.\u0275dir=Ce({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,o){1&r&&On("input",function(a){return o._handleInput(a.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(a){return o._compositionEnd(a.target.value)})},features:[Gt([Lz]),Et]})}return e})();const Kn=new ue("NgValidators"),La=new ue("NgAsyncValidators");function zA(e){return function Oa(e){return null==e||("string"==typeof e||Array.isArray(e))&&0===e.length}(e.value)?{required:!0}:null}function ng(e){return null}function YA(e){return null!=e}function ZA(e){return gd(e)?Te(e):e}function QA(e){let n={};return e.forEach(t=>{n=null!=t?{...n,...t}:n}),0===Object.keys(n).length?null:n}function JA(e,n){return n.map(t=>t(e))}function eM(e){return e.map(n=>function jz(e){return!e.validate}(n)?n:t=>n.validate(t))}function Bb(e){return null!=e?function tM(e){if(!e)return null;const n=e.filter(YA);return 0==n.length?null:function(t){return QA(JA(t,n))}}(eM(e)):null}function Vb(e){return null!=e?function nM(e){if(!e)return null;const n=e.filter(YA);return 0==n.length?null:function(t){return function Pz(...e){const n=$f(e),{args:t,keys:r}=OA(e),o=new Ot(i=>{const{length:a}=t;if(!a)return void i.complete();const s=new Array(a);let u=a,c=a;for(let l=0;l<a;l++){let d=!1;yn(t[l]).subscribe(At(i,f=>{d||(d=!0,c--),s[l]=f},()=>u--,void 0,()=>{(!u||!d)&&(c||i.next(r?BA(r,s):s),i.complete())}))}});return n?o.pipe(LA(n)):o}(JA(t,n).map(ZA)).pipe(ft(QA))}}(eM(e)):null}function rM(e,n){return null===e?[n]:Array.isArray(e)?[...e,n]:[e,n]}function Ub(e){return e?Array.isArray(e)?e:[e]:[]}function rg(e,n){return Array.isArray(e)?e.includes(n):e===n}function aM(e,n){const t=Ub(n);return Ub(e).forEach(o=>{rg(t,o)||t.push(o)}),t}function sM(e,n){return Ub(n).filter(t=>!rg(e,t))}class uM{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=Bb(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=Vb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,t){return!!this.control&&this.control.hasError(n,t)}getError(n,t){return this.control?this.control.getError(n,t):null}}class mr extends uM{get formDirective(){return null}get path(){return null}}class Ba extends uM{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class cM{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let lM=(()=>{class e extends cM{constructor(t){super(t)}static#e=this.\u0275fac=function(r){return new(r||e)(te(Ba,2))};static#t=this.\u0275dir=Ce({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,o){2&r&&yp("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[Et]})}return e})(),si=(()=>{class e extends cM{constructor(t){super(t)}static#e=this.\u0275fac=function(r){return new(r||e)(te(mr,10))};static#t=this.\u0275dir=Ce({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,o){2&r&&yp("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},features:[Et]})}return e})();const Ld="VALID",ig="INVALID",bc="PENDING",Bd="DISABLED";function Wb(e){return(ag(e)?e.validators:e)||null}function zb(e,n){return(ag(n)?n.asyncValidators:e)||null}function ag(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class pM{constructor(n,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===Ld}get invalid(){return this.status===ig}get pending(){return this.status==bc}get disabled(){return this.status===Bd}get enabled(){return this.status!==Bd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(aM(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(aM(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(sM(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(sM(n,this._rawAsyncValidators))}hasValidator(n){return rg(this._rawValidators,n)}hasAsyncValidator(n){return rg(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=bc,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=Bd,this.errors=null,this._forEachChild(r=>{r.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!0))}enable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=Ld,this._forEachChild(r=>{r.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ld||this.status===bc)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Bd:Ld}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=bc,this._hasOwnPendingAsyncValidator=!0;const t=ZA(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,t={}){this.errors=n,this._updateControlsErrors(!1!==t.emitEvent)}get(n){let t=n;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((r,o)=>r&&r._find(o),this)}getError(n,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[n]:null}hasError(n,t){return!!this.getError(n,t)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new rn,this.statusChanges=new rn}_calculateStatus(){return this._allControlsDisabled()?Bd:this.errors?ig:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(bc)?bc:this._anyControlsHaveStatus(ig)?ig:Ld}_anyControlsHaveStatus(n){return this._anyControls(t=>t.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){ag(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function $z(e){return Array.isArray(e)?Bb(e):e||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function Gz(e){return Array.isArray(e)?Vb(e):e||null}(this._rawAsyncValidators)}}class $b extends pM{constructor(n,t,r){super(Wb(t),zb(r,t)),this.controls=n,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,t){return this.controls[n]?this.controls[n]:(this.controls[n]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(n,t,r={}){this.registerControl(n,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(n,t={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(n,t,r={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],t&&this.registerControl(n,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,t={}){(function hM(e,n,t){e._forEachChild((r,o)=>{if(void 0===t[o])throw new ee(1002,"")})})(this,0,n),Object.keys(n).forEach(r=>{(function fM(e,n,t){const r=e.controls;if(!(n?Object.keys(r):r).length)throw new ee(1e3,"");if(!r[t])throw new ee(1001,"")})(this,!0,r),this.controls[r].setValue(n[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(n,t={}){null!=n&&(Object.keys(n).forEach(r=>{const o=this.controls[r];o&&o.patchValue(n[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(n={},t={}){this._forEachChild((r,o)=>{r.reset(n?n[o]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(n,t,r)=>(n[r]=t.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&n(r,t)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[t,r]of Object.entries(this.controls))if(this.contains(t)&&n(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,r,o)=>((r.enabled||this.disabled)&&(t[o]=r.value),t))}_reduceChildren(n,t){let r=n;return this._forEachChild((o,i)=>{r=t(r,o,i)}),r}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}const xc=new ue("CallSetDisabledState",{providedIn:"root",factory:()=>sg}),sg="always";function Vd(e,n,t=sg){Gb(e,n),n.valueAccessor.writeValue(e.value),(e.disabled||"always"===t)&&n.valueAccessor.setDisabledState?.(e.disabled),function Kz(e,n){n.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&gM(e,n)})}(e,n),function Zz(e,n){const t=(r,o)=>{n.valueAccessor.writeValue(r),o&&n.viewToModelUpdate(r)};e.registerOnChange(t),n._registerOnDestroy(()=>{e._unregisterOnChange(t)})}(e,n),function Yz(e,n){n.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&gM(e,n),"submit"!==e.updateOn&&e.markAsTouched()})}(e,n),function Xz(e,n){if(n.valueAccessor.setDisabledState){const t=r=>{n.valueAccessor.setDisabledState(r)};e.registerOnDisabledChange(t),n._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}(e,n)}function lg(e,n){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(n)})}function Gb(e,n){const t=function oM(e){return e._rawValidators}(e);null!==n.validator?e.setValidators(rM(t,n.validator)):"function"==typeof t&&e.setValidators([t]);const r=function iM(e){return e._rawAsyncValidators}(e);null!==n.asyncValidator?e.setAsyncValidators(rM(r,n.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);const o=()=>e.updateValueAndValidity();lg(n._rawValidators,o),lg(n._rawAsyncValidators,o)}function gM(e,n){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}const n6={provide:mr,useExisting:Mt(()=>xo)},Ud=(()=>Promise.resolve())();let xo=(()=>{class e extends mr{constructor(t,r,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._directives=new Set,this.ngSubmit=new rn,this.form=new $b({},Bb(t),Vb(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Ud.then(()=>{const r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),Vd(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Ud.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Ud.then(()=>{const r=this._findContainer(t.path),o=new $b({});(function mM(e,n){Gb(e,n)})(o,t),r.registerControl(t.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Ud.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){Ud.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,function vM(e,n){e._syncPendingControls(),n.forEach(t=>{const r=t.control;"submit"===r.updateOn&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static#e=this.\u0275fac=function(r){return new(r||e)(te(Kn,10),te(La,10),te(xc,8))};static#t=this.\u0275dir=Ce({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,o){1&r&&On("submit",function(a){return o.onSubmit(a)})("reset",function(){return o.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Gt([n6]),Et]})}return e})();function yM(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}function wM(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}const bM=class extends pM{constructor(n=null,t,r){super(Wb(t),zb(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ag(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=wM(n)?n.value:n)}setValue(n,t={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(n,t={}){this.setValue(n,t)}reset(n=this.defaultValue,t={}){this._applyFormState(n),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){yM(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){yM(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){wM(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},i6={provide:Ba,useExisting:Mt(()=>Yb)},_M=(()=>Promise.resolve())();let Yb=(()=>{class e extends Ba{constructor(t,r,o,i,a,s){super(),this._changeDetectorRef=a,this.callSetDisabledState=s,this.control=new bM,this._registered=!1,this.name="",this.update=new rn,this._parent=t,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=function Kb(e,n){if(!n)return null;let t,r,o;return Array.isArray(n),n.forEach(i=>{i.constructor===tg?t=i:function e6(e){return Object.getPrototypeOf(e.constructor)===Os}(i)?r=i:o=i}),o||r||t||null}(0,i)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function Xb(e,n){if(!e.hasOwnProperty("model"))return!1;const t=e.model;return!!t.isFirstChange()||!Object.is(n,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Vd(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){_M.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const r=t.isDisabled.currentValue,o=0!==r&&gc(r);_M.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function ug(e,n){return[...n.path,e]}(t,this._parent):[t]}static#e=this.\u0275fac=function(r){return new(r||e)(te(mr,9),te(Kn,10),te(La,10),te(ai,10),te(kp,8),te(xc,8))};static#t=this.\u0275dir=Ce({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Gt([i6]),Et,go]})}return e})(),ui=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275dir=Ce({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return e})(),EM=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Hr({type:e});static#n=this.\u0275inj=ur({})}return e})();const g6={provide:ai,useExisting:Mt(()=>e0),multi:!0};function NM(e,n){return null==e?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${e}: ${n}`.slice(0,50))}let e0=(()=>{class e extends Os{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const o=NM(this._getOptionId(t),t);this.setProperty("value",o)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){const r=function m6(e){return e.split(":")[0]}(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static#e=this.\u0275fac=function(){let t;return function(o){return(t||(t=Pn(e)))(o||e)}}();static#t=this.\u0275dir=Ce({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,o){1&r&&On("change",function(a){return o.onChange(a.target.value)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},features:[Gt([g6]),Et]})}return e})(),fg=(()=>{class e{constructor(t,r,o){this._element=t,this._renderer=r,this._select=o,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(NM(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(r){return new(r||e)(te(Gr),te(Jo),te(e0,9))};static#t=this.\u0275dir=Ce({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return e})();const v6={provide:ai,useExisting:Mt(()=>t0),multi:!0};function kM(e,n){return null==e?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${e}: ${n}`.slice(0,50))}let t0=(()=>{class e extends Os{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let r;if(this.value=t,Array.isArray(t)){const o=t.map(i=>this._getOptionId(i));r=(i,a)=>{i._setSelected(o.indexOf(a.toString())>-1)}}else r=(o,i)=>{o._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{const o=[],i=r.selectedOptions;if(void 0!==i){const a=i;for(let s=0;s<a.length;s++){const c=this._getOptionValue(a[s].value);o.push(c)}}else{const a=r.options;for(let s=0;s<a.length;s++){const u=a[s];if(u.selected){const c=this._getOptionValue(u.value);o.push(c)}}}this.value=o,t(o)}}_registerOption(t){const r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(const r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){const r=function y6(e){return e.split(":")[0]}(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static#e=this.\u0275fac=function(){let t;return function(o){return(t||(t=Pn(e)))(o||e)}}();static#t=this.\u0275dir=Ce({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,o){1&r&&On("change",function(a){return o.onChange(a.target)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},features:[Gt([v6]),Et]})}return e})(),hg=(()=>{class e{constructor(t,r,o){this._element=t,this._renderer=r,this._select=o,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(kM(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(kM(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(r){return new(r||e)(te(Gr),te(Jo),te(t0,9))};static#t=this.\u0275dir=Ce({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return e})(),Ls=(()=>{class e{constructor(){this._validator=ng}ngOnChanges(t){if(this.inputName in t){const r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):ng,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return null!=t}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275dir=Ce({type:e,features:[go]})}return e})();const x6={provide:Kn,useExisting:Mt(()=>pg),multi:!0};let pg=(()=>{class e extends Ls{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=gc,this.createValidator=t=>zA}enabled(t){return t}static#e=this.\u0275fac=function(){let t;return function(o){return(t||(t=Pn(e)))(o||e)}}();static#t=this.\u0275dir=Ce({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,o){2&r&&ni("required",o._enabled?"":null)},inputs:{required:"required"},features:[Gt([x6]),Et]})}return e})(),S6=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Hr({type:e});static#n=this.\u0275inj=ur({imports:[EM]})}return e})(),M6=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:xc,useValue:t.callSetDisabledState??sg}]}}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Hr({type:e});static#n=this.\u0275inj=ur({imports:[S6]})}return e})();function n0(...e){const n=cs(e),t=$f(e),{args:r,keys:o}=OA(e);if(0===r.length)return Te([],n);const i=new Ot(function R6(e,n,t=Or){return r=>{WM(n,()=>{const{length:o}=e,i=new Array(o);let a=o,s=o;for(let u=0;u<o;u++)WM(n,()=>{const c=Te(e[u],n);let l=!1;c.subscribe(At(r,d=>{i[u]=d,l||(l=!0,s--),s||r.next(t(i.slice()))},()=>{--a||r.complete()}))},r)},r)}}(r,n,o?a=>BA(o,a):Or));return t?i.pipe(LA(t)):i}function WM(e,n,t){e?Mo(t,e,n):n()}const gg=oo(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function r0(...e){return function N6(){return ya(1)}()(Te(e,cs(e)))}function zM(e){return new Ot(n=>{yn(e()).subscribe(n)})}function jd(e,n){const t=Fe(e)?e:()=>e,r=o=>o.error(t());return new Ot(n?o=>n.schedule(r,0,o):r)}function o0(){return at((e,n)=>{let t=null;e._refCount++;const r=At(n,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(t=null);const o=e._connection,i=t;t=null,o&&(!i||o===i)&&o.unsubscribe(),n.unsubscribe()});e.subscribe(r),r.closed||(t=e.connect())})}class $M extends Ot{constructor(n,t){super(),this.source=n,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,su(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new St;const t=this.getSubject();n.add(this.source.subscribe(At(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),n.closed&&(this._connection=null,n=St.EMPTY)}return n}refCount(){return o0()(this)}}function Cc(e){return e<=0?()=>uo:at((n,t)=>{let r=0;n.subscribe(At(t,o=>{++r<=e&&(t.next(o),e<=r&&t.complete())}))})}function mg(e){return at((n,t)=>{let r=!1;n.subscribe(At(t,o=>{r=!0,t.next(o)},()=>{r||t.next(e),t.complete()}))})}function GM(e=F6){return at((n,t)=>{let r=!1;n.subscribe(At(t,o=>{r=!0,t.next(o)},()=>r?t.complete():t.error(e())))})}function F6(){return new gg}function Bs(e,n){const t=arguments.length>=2;return r=>r.pipe(e?Xi((o,i)=>e(o,i,r)):Or,Cc(1),t?mg(n):GM(()=>new gg))}function Yn(e,n,t){const r=Fe(e)||n||t?{next:e,error:n,complete:t}:e;return r?at((o,i)=>{var a;null===(a=r.subscribe)||void 0===a||a.call(r);let s=!0;o.subscribe(At(i,u=>{var c;null===(c=r.next)||void 0===c||c.call(r,u),i.next(u)},()=>{var u;s=!1,null===(u=r.complete)||void 0===u||u.call(r),i.complete()},u=>{var c;s=!1,null===(c=r.error)||void 0===c||c.call(r,u),i.error(u)},()=>{var u,c;s&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(c=r.finalize)||void 0===c||c.call(r)}))}):Or}function Vs(e){return at((n,t)=>{let i,r=null,o=!1;r=n.subscribe(At(t,void 0,void 0,a=>{i=yn(e(a,Vs(e)(n))),r?(r.unsubscribe(),r=null,i.subscribe(t)):o=!0})),o&&(r.unsubscribe(),r=null,i.subscribe(t))})}function a0(e){return e<=0?()=>uo:at((n,t)=>{let r=[];n.subscribe(At(t,o=>{r.push(o),e<r.length&&r.shift()},()=>{for(const o of r)t.next(o);t.complete()},void 0,()=>{r=null}))})}const Be="primary",Hd=Symbol("RouteTitle");class U6{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t[0]:t}return null}getAll(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function _c(e){return new U6(e)}function j6(e,n,t){const r=t.path.split("/");if(r.length>e.length||"full"===t.pathMatch&&(n.hasChildren()||r.length<e.length))return null;const o={};for(let i=0;i<r.length;i++){const a=r[i],s=e[i];if(a.startsWith(":"))o[a.substring(1)]=s;else if(a!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:o}}function ci(e,n){const t=e?Object.keys(e):void 0,r=n?Object.keys(n):void 0;if(!t||!r||t.length!=r.length)return!1;let o;for(let i=0;i<t.length;i++)if(o=t[i],!qM(e[o],n[o]))return!1;return!0}function qM(e,n){if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;const t=[...e].sort(),r=[...n].sort();return t.every((o,i)=>r[i]===o)}return e===n}function XM(e){return e.length>0?e[e.length-1]:null}function Va(e){return function T6(e){return!!e&&(e instanceof Ot||Fe(e.lift)&&Fe(e.subscribe))}(e)?e:gd(e)?Te(Promise.resolve(e)):_e(e)}const W6={exact:function ZM(e,n,t){if(!Us(e.segments,n.segments)||!vg(e.segments,n.segments,t)||e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children)if(!e.children[r]||!ZM(e.children[r],n.children[r],t))return!1;return!0},subset:QM},KM={exact:function z6(e,n){return ci(e,n)},subset:function $6(e,n){return Object.keys(n).length<=Object.keys(e).length&&Object.keys(n).every(t=>qM(e[t],n[t]))},ignored:()=>!0};function YM(e,n,t){return W6[t.paths](e.root,n.root,t.matrixParams)&&KM[t.queryParams](e.queryParams,n.queryParams)&&!("exact"===t.fragment&&e.fragment!==n.fragment)}function QM(e,n,t){return JM(e,n,n.segments,t)}function JM(e,n,t,r){if(e.segments.length>t.length){const o=e.segments.slice(0,t.length);return!(!Us(o,t)||n.hasChildren()||!vg(o,t,r))}if(e.segments.length===t.length){if(!Us(e.segments,t)||!vg(e.segments,t,r))return!1;for(const o in n.children)if(!e.children[o]||!QM(e.children[o],n.children[o],r))return!1;return!0}{const o=t.slice(0,e.segments.length),i=t.slice(e.segments.length);return!!(Us(e.segments,o)&&vg(e.segments,o,r)&&e.children[Be])&&JM(e.children[Be],n,i,r)}}function vg(e,n,t){return n.every((r,o)=>KM[t](e[o].parameters,r.parameters))}class Dc{constructor(n=new It([],{}),t={},r=null){this.root=n,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=_c(this.queryParams)),this._queryParamMap}toString(){return X6.serialize(this)}}class It{constructor(n,t){this.segments=n,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return yg(this)}}class Wd{constructor(n,t){this.path=n,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=_c(this.parameters)),this._parameterMap}toString(){return nT(this)}}function Us(e,n){return e.length===n.length&&e.every((t,r)=>t.path===n[r].path)}let zd=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:function(){return new s0},providedIn:"root"})}return e})();class s0{parse(n){const t=new i$(n);return new Dc(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(n){const t=`/${$d(n.root,!0)}`,r=function Z6(e){const n=Object.keys(e).map(t=>{const r=e[t];return Array.isArray(r)?r.map(o=>`${wg(t)}=${wg(o)}`).join("&"):`${wg(t)}=${wg(r)}`}).filter(t=>!!t);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${t}${r}${"string"==typeof n.fragment?`#${function K6(e){return encodeURI(e)}(n.fragment)}`:""}`}}const X6=new s0;function yg(e){return e.segments.map(n=>nT(n)).join("/")}function $d(e,n){if(!e.hasChildren())return yg(e);if(n){const t=e.children[Be]?$d(e.children[Be],!1):"",r=[];return Object.entries(e.children).forEach(([o,i])=>{o!==Be&&r.push(`${o}:${$d(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function q6(e,n){let t=[];return Object.entries(e.children).forEach(([r,o])=>{r===Be&&(t=t.concat(n(o,r)))}),Object.entries(e.children).forEach(([r,o])=>{r!==Be&&(t=t.concat(n(o,r)))}),t}(e,(r,o)=>o===Be?[$d(e.children[Be],!1)]:[`${o}:${$d(r,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[Be]?`${yg(e)}/${t[0]}`:`${yg(e)}/(${t.join("//")})`}}function eT(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function wg(e){return eT(e).replace(/%3B/gi,";")}function u0(e){return eT(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function bg(e){return decodeURIComponent(e)}function tT(e){return bg(e.replace(/\+/g,"%20"))}function nT(e){return`${u0(e.path)}${function Y6(e){return Object.keys(e).map(n=>`;${u0(n)}=${u0(e[n])}`).join("")}(e.parameters)}`}const Q6=/^[^\/()?;#]+/;function c0(e){const n=e.match(Q6);return n?n[0]:""}const J6=/^[^\/()?;=#]+/,t$=/^[^=?&#]+/,r$=/^[^&#]+/;class i${constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new It([],{}):new It([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(n.length>0||Object.keys(t).length>0)&&(r[Be]=new It(n,t)),r}parseSegment(){const n=c0(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new ee(4009,!1);return this.capture(n),new Wd(bg(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const t=function e$(e){const n=e.match(J6);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const o=c0(this.remaining);o&&(r=o,this.capture(r))}n[bg(t)]=bg(r)}parseQueryParam(n){const t=function n$(e){const n=e.match(t$);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const a=function o$(e){const n=e.match(r$);return n?n[0]:""}(this.remaining);a&&(r=a,this.capture(r))}const o=tT(t),i=tT(r);if(n.hasOwnProperty(o)){let a=n[o];Array.isArray(a)||(a=[a],n[o]=a),a.push(i)}else n[o]=i}parseParens(n){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=c0(this.remaining),o=this.remaining[r.length];if("/"!==o&&")"!==o&&";"!==o)throw new ee(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):n&&(i=Be);const a=this.parseChildren();t[i]=1===Object.keys(a).length?a[Be]:new It([],a),this.consumeOptional("//")}return t}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new ee(4011,!1)}}function rT(e){return e.segments.length>0?new It([],{[Be]:e}):e}function oT(e){const n={};for(const r of Object.keys(e.children)){const i=oT(e.children[r]);if(r===Be&&0===i.segments.length&&i.hasChildren())for(const[a,s]of Object.entries(i.children))n[a]=s;else(i.segments.length>0||i.hasChildren())&&(n[r]=i)}return function a$(e){if(1===e.numberOfChildren&&e.children[Be]){const n=e.children[Be];return new It(e.segments.concat(n.segments),n.children)}return e}(new It(e.segments,n))}function js(e){return e instanceof Dc}function iT(e){let n;const o=rT(function t(i){const a={};for(const u of i.children){const c=t(u);a[u.outlet]=c}const s=new It(i.url,a);return i===e&&(n=s),s}(e.root));return n??o}function aT(e,n,t,r){let o=e;for(;o.parent;)o=o.parent;if(0===n.length)return l0(o,o,o,t,r);const i=function u$(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new uT(!0,0,e);let n=0,t=!1;const r=e.reduce((o,i,a)=>{if("object"==typeof i&&null!=i){if(i.outlets){const s={};return Object.entries(i.outlets).forEach(([u,c])=>{s[u]="string"==typeof c?c.split("/"):c}),[...o,{outlets:s}]}if(i.segmentPath)return[...o,i.segmentPath]}return"string"!=typeof i?[...o,i]:0===a?(i.split("/").forEach((s,u)=>{0==u&&"."===s||(0==u&&""===s?t=!0:".."===s?n++:""!=s&&o.push(s))}),o):[...o,i]},[]);return new uT(t,n,r)}(n);if(i.toRoot())return l0(o,o,new It([],{}),t,r);const a=function c$(e,n,t){if(e.isAbsolute)return new Cg(n,!0,0);if(!t)return new Cg(n,!1,NaN);if(null===t.parent)return new Cg(t,!0,0);const r=xg(e.commands[0])?0:1;return function l$(e,n,t){let r=e,o=n,i=t;for(;i>o;){if(i-=o,r=r.parent,!r)throw new ee(4005,!1);o=r.segments.length}return new Cg(r,!1,o-i)}(t,t.segments.length-1+r,e.numberOfDoubleDots)}(i,o,e),s=a.processChildren?qd(a.segmentGroup,a.index,i.commands):cT(a.segmentGroup,a.index,i.commands);return l0(o,a.segmentGroup,s,t,r)}function xg(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Gd(e){return"object"==typeof e&&null!=e&&e.outlets}function l0(e,n,t,r,o){let a,i={};r&&Object.entries(r).forEach(([u,c])=>{i[u]=Array.isArray(c)?c.map(l=>`${l}`):`${c}`}),a=e===n?t:sT(e,n,t);const s=rT(oT(a));return new Dc(s,i,o)}function sT(e,n,t){const r={};return Object.entries(e.children).forEach(([o,i])=>{r[o]=i===n?t:sT(i,n,t)}),new It(e.segments,r)}class uT{constructor(n,t,r){if(this.isAbsolute=n,this.numberOfDoubleDots=t,this.commands=r,n&&r.length>0&&xg(r[0]))throw new ee(4003,!1);const o=r.find(Gd);if(o&&o!==XM(r))throw new ee(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Cg{constructor(n,t,r){this.segmentGroup=n,this.processChildren=t,this.index=r}}function cT(e,n,t){if(e||(e=new It([],{})),0===e.segments.length&&e.hasChildren())return qd(e,n,t);const r=function f$(e,n,t){let r=0,o=n;const i={match:!1,pathIndex:0,commandIndex:0};for(;o<e.segments.length;){if(r>=t.length)return i;const a=e.segments[o],s=t[r];if(Gd(s))break;const u=`${s}`,c=r<t.length-1?t[r+1]:null;if(o>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!dT(u,c,a))return i;r+=2}else{if(!dT(u,{},a))return i;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}(e,n,t),o=t.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){const i=new It(e.segments.slice(0,r.pathIndex),{});return i.children[Be]=new It(e.segments.slice(r.pathIndex),e.children),qd(i,0,o)}return r.match&&0===o.length?new It(e.segments,{}):r.match&&!e.hasChildren()?d0(e,n,t):r.match?qd(e,0,o):d0(e,n,t)}function qd(e,n,t){if(0===t.length)return new It(e.segments,{});{const r=function d$(e){return Gd(e[0])?e[0].outlets:{[Be]:e}}(t),o={};if(Object.keys(r).some(i=>i!==Be)&&e.children[Be]&&1===e.numberOfChildren&&0===e.children[Be].segments.length){const i=qd(e.children[Be],n,t);return new It(e.segments,i.children)}return Object.entries(r).forEach(([i,a])=>{"string"==typeof a&&(a=[a]),null!==a&&(o[i]=cT(e.children[i],n,a))}),Object.entries(e.children).forEach(([i,a])=>{void 0===r[i]&&(o[i]=a)}),new It(e.segments,o)}}function d0(e,n,t){const r=e.segments.slice(0,n);let o=0;for(;o<t.length;){const i=t[o];if(Gd(i)){const u=h$(i.outlets);return new It(r,u)}if(0===o&&xg(t[0])){r.push(new Wd(e.segments[n].path,lT(t[0]))),o++;continue}const a=Gd(i)?i.outlets[Be]:`${i}`,s=o<t.length-1?t[o+1]:null;a&&s&&xg(s)?(r.push(new Wd(a,lT(s))),o+=2):(r.push(new Wd(a,{})),o++)}return new It(r,{})}function h$(e){const n={};return Object.entries(e).forEach(([t,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(n[t]=d0(new It([],{}),0,r))}),n}function lT(e){const n={};return Object.entries(e).forEach(([t,r])=>n[t]=`${r}`),n}function dT(e,n,t){return e==t.path&&ci(n,t.parameters)}const Xd="imperative";class li{constructor(n,t){this.id=n,this.url=t}}class _g extends li{constructor(n,t,r="imperative",o=null){super(n,t),this.type=0,this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ua extends li{constructor(n,t,r){super(n,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Kd extends li{constructor(n,t,r,o){super(n,t),this.reason=r,this.code=o,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Ec extends li{constructor(n,t,r,o){super(n,t),this.reason=r,this.code=o,this.type=16}}class Dg extends li{constructor(n,t,r,o){super(n,t),this.error=r,this.target=o,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class fT extends li{constructor(n,t,r,o){super(n,t),this.urlAfterRedirects=r,this.state=o,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class p$ extends li{constructor(n,t,r,o){super(n,t),this.urlAfterRedirects=r,this.state=o,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class g$ extends li{constructor(n,t,r,o,i){super(n,t),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class m$ extends li{constructor(n,t,r,o){super(n,t),this.urlAfterRedirects=r,this.state=o,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class v$ extends li{constructor(n,t,r,o){super(n,t),this.urlAfterRedirects=r,this.state=o,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class y${constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class w${constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class b${constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class x${constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class C${constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _${constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hT{constructor(n,t,r){this.routerEvent=n,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class f0{}class h0{constructor(n){this.url=n}}class D${constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Yd,this.attachRef=null}}let Yd=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const o=this.getOrCreateContext(t);o.outlet=r,this.contexts.set(t,o)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new D$,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class pT{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const t=this.pathFromRoot(n);return t.length>1?t[t.length-2]:null}children(n){const t=p0(n,this._root);return t?t.children.map(r=>r.value):[]}firstChild(n){const t=p0(n,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(n){const t=g0(n,this._root);return t.length<2?[]:t[t.length-2].children.map(o=>o.value).filter(o=>o!==n)}pathFromRoot(n){return g0(n,this._root).map(t=>t.value)}}function p0(e,n){if(e===n.value)return n;for(const t of n.children){const r=p0(e,t);if(r)return r}return null}function g0(e,n){if(e===n.value)return[n];for(const t of n.children){const r=g0(e,t);if(r.length)return r.unshift(n),r}return[]}class Ki{constructor(n,t){this.value=n,this.children=t}toString(){return`TreeNode(${this.value})`}}function Ic(e){const n={};return e&&e.children.forEach(t=>n[t.value.outlet]=t),n}class gT extends pT{constructor(n,t){super(n),this.snapshot=t,m0(this,n)}toString(){return this.snapshot.toString()}}function mT(e,n){const t=function E$(e,n){const a=new Eg([],{},{},"",{},Be,n,null,{});return new yT("",new Ki(a,[]))}(0,n),r=new _r([new Wd("",{})]),o=new _r({}),i=new _r({}),a=new _r({}),s=new _r(""),u=new Sc(r,o,a,s,i,Be,n,t.root);return u.snapshot=t.root,new gT(new Ki(u,[]),t)}class Sc{constructor(n,t,r,o,i,a,s,u){this.urlSubject=n,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=o,this.dataSubject=i,this.outlet=a,this.component=s,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(ft(c=>c[Hd]))??_e(void 0),this.url=n,this.params=t,this.queryParams=r,this.fragment=o,this.data=i}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(ft(n=>_c(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(ft(n=>_c(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function vT(e,n="emptyOnly"){const t=e.pathFromRoot;let r=0;if("always"!==n)for(r=t.length-1;r>=1;){const o=t[r],i=t[r-1];if(o.routeConfig&&""===o.routeConfig.path)r--;else{if(i.component)break;r--}}return function I$(e){return e.reduce((n,t)=>({params:{...n.params,...t.params},data:{...n.data,...t.data},resolve:{...t.data,...n.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class Eg{get title(){return this.data?.[Hd]}constructor(n,t,r,o,i,a,s,u,c){this.url=n,this.params=t,this.queryParams=r,this.fragment=o,this.data=i,this.outlet=a,this.component=s,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=_c(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=_c(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class yT extends pT{constructor(n,t){super(t),this.url=n,m0(this,t)}toString(){return wT(this._root)}}function m0(e,n){n.value._routerState=e,n.children.forEach(t=>m0(e,t))}function wT(e){const n=e.children.length>0?` { ${e.children.map(wT).join(", ")} } `:"";return`${e.value}${n}`}function v0(e){if(e.snapshot){const n=e.snapshot,t=e._futureSnapshot;e.snapshot=t,ci(n.queryParams,t.queryParams)||e.queryParamsSubject.next(t.queryParams),n.fragment!==t.fragment&&e.fragmentSubject.next(t.fragment),ci(n.params,t.params)||e.paramsSubject.next(t.params),function H6(e,n){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!ci(e[t],n[t]))return!1;return!0}(n.url,t.url)||e.urlSubject.next(t.url),ci(n.data,t.data)||e.dataSubject.next(t.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function y0(e,n){const t=ci(e.params,n.params)&&function G6(e,n){return Us(e,n)&&e.every((t,r)=>ci(t.parameters,n[r].parameters))}(e.url,n.url);return t&&!(!e.parent!=!n.parent)&&(!e.parent||y0(e.parent,n.parent))}let w0=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Be,this.activateEvents=new rn,this.deactivateEvents=new rn,this.attachEvents=new rn,this.detachEvents=new rn,this.parentContexts=ie(Yd),this.location=ie(Fo),this.changeDetector=ie(kp),this.environmentInjector=ie($r),this.inputBinder=ie(Ig,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:r,previousValue:o}=t.name;if(r)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ee(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ee(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ee(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new ee(4013,!1);this._activatedRoute=t;const o=this.location,a=t.snapshot.component,s=this.parentContexts.getOrCreateContext(this.name).children,u=new S$(t,s,o.injector);this.activated=o.createComponent(a,{index:o.length,injector:u,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275dir=Ce({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[go]})}return e})();class S${constructor(n,t,r){this.route=n,this.childContexts=t,this.parent=r}get(n,t){return n===Sc?this.route:n===Yd?this.childContexts:this.parent.get(n,t)}}const Ig=new ue("");let bT=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:r}=t,o=n0([r.queryParams,r.params,r.data]).pipe(Vr(([i,a,s],u)=>(s={...i,...a,...s},0===u?_e(s):Promise.resolve(s)))).subscribe(i=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(t);const a=function AH(e){const n=nt(e);if(!n)return null;const t=new ld(n);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}(r.component);if(a)for(const{templateName:s}of a.inputs)t.activatedComponentRef.setInput(s,i[s]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,o)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();function Zd(e,n,t){if(t&&e.shouldReuseRoute(n.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=n.value;const o=function M$(e,n,t){return n.children.map(r=>{for(const o of t.children)if(e.shouldReuseRoute(r.value,o.value.snapshot))return Zd(e,r,o);return Zd(e,r)})}(e,n,t);return new Ki(r,o)}{if(e.shouldAttach(n.value)){const i=e.retrieve(n.value);if(null!==i){const a=i.route;return a.value._futureSnapshot=n.value,a.children=n.children.map(s=>Zd(e,s)),a}}const r=function T$(e){return new Sc(new _r(e.url),new _r(e.params),new _r(e.queryParams),new _r(e.fragment),new _r(e.data),e.outlet,e.component,e)}(n.value),o=n.children.map(i=>Zd(e,i));return new Ki(r,o)}}const b0="ngNavigationCancelingError";function xT(e,n){const{redirectTo:t,navigationBehaviorOptions:r}=js(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,o=CT(!1,0,n);return o.url=t,o.navigationBehaviorOptions=r,o}function CT(e,n,t){const r=new Error("NavigationCancelingError: "+(e||""));return r[b0]=!0,r.cancellationCode=n,t&&(r.url=t),r}function _T(e){return e&&e[b0]}let DT=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["ng-component"]],standalone:!0,features:[iI],decls:1,vars:0,template:function(r,o){1&r&&Ue(0,"router-outlet")},dependencies:[w0],encapsulation:2})}return e})();function x0(e){const n=e.children&&e.children.map(x0),t=n?{...e,children:n}:{...e};return!t.component&&!t.loadComponent&&(n||t.loadChildren)&&t.outlet&&t.outlet!==Be&&(t.component=DT),t}function Lo(e){return e.outlet||Be}function Qd(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let n=e.parent;n;n=n.parent){const t=n.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class B${constructor(n,t,r,o,i){this.routeReuseStrategy=n,this.futureState=t,this.currState=r,this.forwardEvent=o,this.inputBindingEnabled=i}activate(n){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,n),v0(this.futureState.root),this.activateChildRoutes(t,r,n)}deactivateChildRoutes(n,t,r){const o=Ic(t);n.children.forEach(i=>{const a=i.value.outlet;this.deactivateRoutes(i,o[a],r),delete o[a]}),Object.values(o).forEach(i=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(n,t,r){const o=n.value,i=t?t.value:null;if(o===i)if(o.component){const a=r.getContext(o.outlet);a&&this.deactivateChildRoutes(n,t,a.children)}else this.deactivateChildRoutes(n,t,r);else i&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(n,t){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,t):this.deactivateRouteAndOutlet(n,t)}detachAndStoreRouteSubtree(n,t){const r=t.getContext(n.value.outlet),o=r&&n.value.component?r.children:t,i=Ic(n);for(const a of Object.keys(i))this.deactivateRouteAndItsChildren(i[a],o);if(r&&r.outlet){const a=r.outlet.detach(),s=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:a,route:n,contexts:s})}}deactivateRouteAndOutlet(n,t){const r=t.getContext(n.value.outlet),o=r&&n.value.component?r.children:t,i=Ic(n);for(const a of Object.keys(i))this.deactivateRouteAndItsChildren(i[a],o);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(n,t,r){const o=Ic(t);n.children.forEach(i=>{this.activateRoutes(i,o[i.value.outlet],r),this.forwardEvent(new _$(i.value.snapshot))}),n.children.length&&this.forwardEvent(new x$(n.value.snapshot))}activateRoutes(n,t,r){const o=n.value,i=t?t.value:null;if(v0(o),o===i)if(o.component){const a=r.getOrCreateContext(o.outlet);this.activateChildRoutes(n,t,a.children)}else this.activateChildRoutes(n,t,r);else if(o.component){const a=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){const s=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),a.children.onOutletReAttached(s.contexts),a.attachRef=s.componentRef,a.route=s.route.value,a.outlet&&a.outlet.attach(s.componentRef,s.route.value),v0(s.route.value),this.activateChildRoutes(n,null,a.children)}else{const s=Qd(o.snapshot);a.attachRef=null,a.route=o,a.injector=s,a.outlet&&a.outlet.activateWith(o,a.injector),this.activateChildRoutes(n,null,a.children)}}else this.activateChildRoutes(n,null,r)}}class ET{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class Sg{constructor(n,t){this.component=n,this.route=t}}function V$(e,n,t){const r=e._root;return Jd(r,n?n._root:null,t,[r.value])}function Ac(e,n){const t=Symbol(),r=n.get(e,t);return r===t?"function"!=typeof e||function lv(e){return null!==gu(e)}(e)?n.get(e):e:r}function Jd(e,n,t,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const i=Ic(n);return e.children.forEach(a=>{(function j$(e,n,t,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const i=e.value,a=n?n.value:null,s=t?t.getContext(e.value.outlet):null;if(a&&i.routeConfig===a.routeConfig){const u=function H$(e,n,t){if("function"==typeof t)return t(e,n);switch(t){case"pathParamsChange":return!Us(e.url,n.url);case"pathParamsOrQueryParamsChange":return!Us(e.url,n.url)||!ci(e.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!y0(e,n)||!ci(e.queryParams,n.queryParams);default:return!y0(e,n)}}(a,i,i.routeConfig.runGuardsAndResolvers);u?o.canActivateChecks.push(new ET(r)):(i.data=a.data,i._resolvedData=a._resolvedData),Jd(e,n,i.component?s?s.children:null:t,r,o),u&&s&&s.outlet&&s.outlet.isActivated&&o.canDeactivateChecks.push(new Sg(s.outlet.component,a))}else a&&ef(n,s,o),o.canActivateChecks.push(new ET(r)),Jd(e,null,i.component?s?s.children:null:t,r,o)})(a,i[a.value.outlet],t,r.concat([a.value]),o),delete i[a.value.outlet]}),Object.entries(i).forEach(([a,s])=>ef(s,t.getContext(a),o)),o}function ef(e,n,t){const r=Ic(e),o=e.value;Object.entries(r).forEach(([i,a])=>{ef(a,o.component?n?n.children.getContext(i):null:n,t)}),t.canDeactivateChecks.push(new Sg(o.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,o))}function tf(e){return"function"==typeof e}function IT(e){return e instanceof gg||"EmptyError"===e?.name}const Ag=Symbol("INITIAL_VALUE");function Mc(){return Vr(e=>n0(e.map(n=>n.pipe(Cc(1),function k6(...e){const n=cs(e);return at((t,r)=>{(n?r0(e,t,n):r0(e,t)).subscribe(r)})}(Ag)))).pipe(ft(n=>{for(const t of n)if(!0!==t){if(t===Ag)return Ag;if(!1===t||t instanceof Dc)return t}return!0}),Xi(n=>n!==Ag),Cc(1)))}function ST(e){return function Re(...e){return pa(e)}(Yn(n=>{if(js(n))throw xT(0,n)}),ft(n=>!0===n))}class Mg{constructor(n){this.segmentGroup=n||null}}class AT{constructor(n){this.urlTree=n}}function Tc(e){return jd(new Mg(e))}function MT(e){return jd(new AT(e))}class uG{constructor(n,t){this.urlSerializer=n,this.urlTree=t}noMatchError(n){return new ee(4002,!1)}lineralizeSegments(n,t){let r=[],o=t.root;for(;;){if(r=r.concat(o.segments),0===o.numberOfChildren)return _e(r);if(o.numberOfChildren>1||!o.children[Be])return jd(new ee(4e3,!1));o=o.children[Be]}}applyRedirectCommands(n,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),n,r)}applyRedirectCreateUrlTree(n,t,r,o){const i=this.createSegmentGroup(n,t.root,r,o);return new Dc(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(n,t){const r={};return Object.entries(n).forEach(([o,i])=>{if("string"==typeof i&&i.startsWith(":")){const s=i.substring(1);r[o]=t[s]}else r[o]=i}),r}createSegmentGroup(n,t,r,o){const i=this.createSegments(n,t.segments,r,o);let a={};return Object.entries(t.children).forEach(([s,u])=>{a[s]=this.createSegmentGroup(n,u,r,o)}),new It(i,a)}createSegments(n,t,r,o){return t.map(i=>i.path.startsWith(":")?this.findPosParam(n,i,o):this.findOrReturn(i,r))}findPosParam(n,t,r){const o=r[t.path.substring(1)];if(!o)throw new ee(4001,!1);return o}findOrReturn(n,t){let r=0;for(const o of t){if(o.path===n.path)return t.splice(r),o;r++}return n}}const C0={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function cG(e,n,t,r,o){const i=_0(e,n,t);return i.matched?(r=function N$(e,n){return e.providers&&!e._injector&&(e._injector=Rw(e.providers,n,`Route: ${e.path}`)),e._injector??n}(n,r),function iG(e,n,t,r){const o=n.canMatch;return o&&0!==o.length?_e(o.map(a=>{const s=Ac(a,e);return Va(function X$(e){return e&&tf(e.canMatch)}(s)?s.canMatch(n,t):e.runInContext(()=>s(n,t)))})).pipe(Mc(),ST()):_e(!0)}(r,n,t).pipe(ft(a=>!0===a?i:{...C0}))):_e(i)}function _0(e,n,t){if(""===n.path)return"full"===n.pathMatch&&(e.hasChildren()||t.length>0)?{...C0}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const o=(n.matcher||j6)(t,e,n);if(!o)return{...C0};const i={};Object.entries(o.posParams??{}).forEach(([s,u])=>{i[s]=u.path});const a=o.consumed.length>0?{...i,...o.consumed[o.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:o.consumed,remainingSegments:t.slice(o.consumed.length),parameters:a,positionalParamSegments:o.posParams??{}}}function TT(e,n,t,r){return t.length>0&&function fG(e,n,t){return t.some(r=>Tg(e,n,r)&&Lo(r)!==Be)}(e,t,r)?{segmentGroup:new It(n,dG(r,new It(t,e.children))),slicedSegments:[]}:0===t.length&&function hG(e,n,t){return t.some(r=>Tg(e,n,r))}(e,t,r)?{segmentGroup:new It(e.segments,lG(e,0,t,r,e.children)),slicedSegments:t}:{segmentGroup:new It(e.segments,e.children),slicedSegments:t}}function lG(e,n,t,r,o){const i={};for(const a of r)if(Tg(e,t,a)&&!o[Lo(a)]){const s=new It([],{});i[Lo(a)]=s}return{...o,...i}}function dG(e,n){const t={};t[Be]=n;for(const r of e)if(""===r.path&&Lo(r)!==Be){const o=new It([],{});t[Lo(r)]=o}return t}function Tg(e,n,t){return(!(e.hasChildren()||n.length>0)||"full"!==t.pathMatch)&&""===t.path}class vG{constructor(n,t,r,o,i,a,s){this.injector=n,this.configLoader=t,this.rootComponentType=r,this.config=o,this.urlTree=i,this.paramsInheritanceStrategy=a,this.urlSerializer=s,this.allowRedirects=!0,this.applyRedirects=new uG(this.urlSerializer,this.urlTree)}noMatchError(n){return new ee(4002,!1)}recognize(){const n=TT(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,Be).pipe(Vs(t=>{if(t instanceof AT)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof Mg?this.noMatchError(t):t}),ft(t=>{const r=new Eg([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Be,this.rootComponentType,null,{}),o=new Ki(r,t),i=new yT("",o),a=function s$(e,n,t=null,r=null){return aT(iT(e),n,t,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,i.url=this.urlSerializer.serialize(a),this.inheritParamsAndData(i._root),{state:i,tree:a}}))}match(n){return this.processSegmentGroup(this.injector,this.config,n.root,Be).pipe(Vs(r=>{throw r instanceof Mg?this.noMatchError(r):r}))}inheritParamsAndData(n){const t=n.value,r=vT(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),n.children.forEach(o=>this.inheritParamsAndData(o))}processSegmentGroup(n,t,r,o){return 0===r.segments.length&&r.hasChildren()?this.processChildren(n,t,r):this.processSegment(n,t,r,r.segments,o,!0)}processChildren(n,t,r){const o=[];for(const i of Object.keys(r.children))"primary"===i?o.unshift(i):o.push(i);return Te(o).pipe(vc(i=>{const a=r.children[i],s=function O$(e,n){const t=e.filter(r=>Lo(r)===n);return t.push(...e.filter(r=>Lo(r)!==n)),t}(t,i);return this.processSegmentGroup(n,s,a,i)}),function O6(e,n){return at(function P6(e,n,t,r,o){return(i,a)=>{let s=t,u=n,c=0;i.subscribe(At(a,l=>{const d=c++;u=s?e(u,l,d):(s=!0,l),r&&a.next(u)},o&&(()=>{s&&a.next(u),a.complete()})))}}(e,n,arguments.length>=2,!0))}((i,a)=>(i.push(...a),i)),mg(null),function L6(e,n){const t=arguments.length>=2;return r=>r.pipe(e?Xi((o,i)=>e(o,i,r)):Or,a0(1),t?mg(n):GM(()=>new gg))}(),Wt(i=>{if(null===i)return Tc(r);const a=RT(i);return function yG(e){e.sort((n,t)=>n.value.outlet===Be?-1:t.value.outlet===Be?1:n.value.outlet.localeCompare(t.value.outlet))}(a),_e(a)}))}processSegment(n,t,r,o,i,a){return Te(t).pipe(vc(s=>this.processSegmentAgainstRoute(s._injector??n,t,s,r,o,i,a).pipe(Vs(u=>{if(u instanceof Mg)return _e(null);throw u}))),Bs(s=>!!s),Vs(s=>{if(IT(s))return function gG(e,n,t){return 0===n.length&&!e.children[t]}(r,o,i)?_e([]):Tc(r);throw s}))}processSegmentAgainstRoute(n,t,r,o,i,a,s){return function pG(e,n,t,r){return!!(Lo(e)===r||r!==Be&&Tg(n,t,e))&&("**"===e.path||_0(n,e,t).matched)}(r,o,i,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(n,o,r,i,a,s):s&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,o,t,r,i,a):Tc(o):Tc(o)}expandSegmentAgainstRouteUsingRedirect(n,t,r,o,i,a){return"**"===o.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,r,o,a):this.expandRegularSegmentAgainstRouteUsingRedirect(n,t,r,o,i,a)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,t,r,o){const i=this.applyRedirects.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?MT(i):this.applyRedirects.lineralizeSegments(r,i).pipe(Wt(a=>{const s=new It(a,{});return this.processSegment(n,t,s,a,o,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,t,r,o,i,a){const{matched:s,consumedSegments:u,remainingSegments:c,positionalParamSegments:l}=_0(t,o,i);if(!s)return Tc(t);const d=this.applyRedirects.applyRedirectCommands(u,o.redirectTo,l);return o.redirectTo.startsWith("/")?MT(d):this.applyRedirects.lineralizeSegments(o,d).pipe(Wt(f=>this.processSegment(n,r,t,f.concat(c),a,!1)))}matchSegmentAgainstRoute(n,t,r,o,i,a){let s;if("**"===r.path){const u=o.length>0?XM(o).parameters:{};s=_e({snapshot:new Eg(o,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,NT(r),Lo(r),r.component??r._loadedComponent??null,r,kT(r)),consumedSegments:[],remainingSegments:[]}),t.children={}}else s=cG(t,r,o,n).pipe(ft(({matched:u,consumedSegments:c,remainingSegments:l,parameters:d})=>u?{snapshot:new Eg(c,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,NT(r),Lo(r),r.component??r._loadedComponent??null,r,kT(r)),consumedSegments:c,remainingSegments:l}:null));return s.pipe(Vr(u=>null===u?Tc(t):this.getChildConfig(n=r._injector??n,r,o).pipe(Vr(({routes:c})=>{const l=r._loadedInjector??n,{snapshot:d,consumedSegments:f,remainingSegments:h}=u,{segmentGroup:p,slicedSegments:m}=TT(t,f,h,c);if(0===m.length&&p.hasChildren())return this.processChildren(l,c,p).pipe(ft(y=>null===y?null:[new Ki(d,y)]));if(0===c.length&&0===m.length)return _e([new Ki(d,[])]);const v=Lo(r)===i;return this.processSegment(l,c,p,m,v?Be:i,!0).pipe(ft(y=>[new Ki(d,y)]))}))))}getChildConfig(n,t,r){return t.children?_e({routes:t.children,injector:n}):t.loadChildren?void 0!==t._loadedRoutes?_e({routes:t._loadedRoutes,injector:t._loadedInjector}):function oG(e,n,t,r){const o=n.canLoad;return void 0===o||0===o.length?_e(!0):_e(o.map(a=>{const s=Ac(a,e);return Va(function z$(e){return e&&tf(e.canLoad)}(s)?s.canLoad(n,t):e.runInContext(()=>s(n,t)))})).pipe(Mc(),ST())}(n,t,r).pipe(Wt(o=>o?this.configLoader.loadChildren(n,t).pipe(Yn(i=>{t._loadedRoutes=i.routes,t._loadedInjector=i.injector})):function sG(e){return jd(CT(!1,3))}())):_e({routes:[],injector:n})}}function wG(e){const n=e.value.routeConfig;return n&&""===n.path}function RT(e){const n=[],t=new Set;for(const r of e){if(!wG(r)){n.push(r);continue}const o=n.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==o?(o.children.push(...r.children),t.add(o)):n.push(r)}for(const r of t){const o=RT(r.children);n.push(new Ki(r.value,o))}return n.filter(r=>!t.has(r))}function NT(e){return e.data||{}}function kT(e){return e.resolve||{}}function FT(e){return"string"==typeof e.title||null===e.title}function D0(e){return Vr(n=>{const t=e(n);return t?Te(t).pipe(ft(()=>n)):_e(n)})}const Rc=new ue("ROUTES");let E0=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ie(KI)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return _e(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=Va(t.loadComponent()).pipe(ft(PT),Yn(i=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=i}),kd(()=>{this.componentLoaders.delete(t)})),o=new $M(r,()=>new Wn).pipe(o0());return this.componentLoaders.set(t,o),o}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return _e({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=function IG(e,n,t,r){return Va(e.loadChildren()).pipe(ft(PT),Wt(o=>o instanceof rI||Array.isArray(o)?_e(o):Te(n.compileModuleAsync(o))),ft(o=>{r&&r(e);let i,a,s=!1;return Array.isArray(o)?(a=o,!0):(i=o.create(t).injector,a=i.get(Rc,[],{optional:!0,self:!0}).flat()),{routes:a.map(x0),injector:i}}))}(r,this.compiler,t,this.onLoadEndListener).pipe(kd(()=>{this.childrenLoaders.delete(r)})),a=new $M(i,()=>new Wn).pipe(o0());return this.childrenLoaders.set(r,a),a}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function PT(e){return function SG(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let Rg=(()=>{class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Wn,this.transitionAbortSubject=new Wn,this.configLoader=ie(E0),this.environmentInjector=ie($r),this.urlSerializer=ie(zd),this.rootContexts=ie(Yd),this.inputBindingEnabled=null!==ie(Ig,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>_e(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=o=>this.events.next(new w$(o)),this.configLoader.onLoadStartListener=o=>this.events.next(new y$(o))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:r})}setupNavigations(t,r,o){return this.transitions=new _r({id:0,currentUrlTree:r,currentRawUrl:r,currentBrowserUrl:r,extractedUrl:t.urlHandlingStrategy.extract(r),urlAfterRedirects:t.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Xd,restoredState:null,currentSnapshot:o.snapshot,targetSnapshot:null,currentRouterState:o,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Xi(i=>0!==i.id),ft(i=>({...i,extractedUrl:t.urlHandlingStrategy.extract(i.rawUrl)})),Vr(i=>{this.currentTransition=i;let a=!1,s=!1;return _e(i).pipe(Yn(u=>{this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Vr(u=>{const c=u.currentBrowserUrl.toString(),l=!t.navigated||u.extractedUrl.toString()!==c||c!==u.currentUrlTree.toString();if(!l&&"reload"!==(u.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const f="";return this.events.next(new Ec(u.id,this.urlSerializer.serialize(u.rawUrl),f,0)),u.resolve(null),uo}if(t.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return _e(u).pipe(Vr(f=>{const h=this.transitions?.getValue();return this.events.next(new _g(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),h!==this.transitions?.getValue()?uo:Promise.resolve(f)}),function bG(e,n,t,r,o,i){return Wt(a=>function mG(e,n,t,r,o,i,a="emptyOnly"){return new vG(e,n,t,r,o,a,i).recognize()}(e,n,t,r,a.extractedUrl,o,i).pipe(ft(({state:s,tree:u})=>({...a,targetSnapshot:s,urlAfterRedirects:u}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Yn(f=>{i.targetSnapshot=f.targetSnapshot,i.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:f.urlAfterRedirects};const h=new fT(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(h)}));if(l&&t.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){const{id:f,extractedUrl:h,source:p,restoredState:m,extras:v}=u,y=new _g(f,this.urlSerializer.serialize(h),p,m);this.events.next(y);const b=mT(0,this.rootComponentType).snapshot;return this.currentTransition=i={...u,targetSnapshot:b,urlAfterRedirects:h,extras:{...v,skipLocationChange:!1,replaceUrl:!1}},_e(i)}{const f="";return this.events.next(new Ec(u.id,this.urlSerializer.serialize(u.extractedUrl),f,1)),u.resolve(null),uo}}),Yn(u=>{const c=new p$(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(c)}),ft(u=>(this.currentTransition=i={...u,guards:V$(u.targetSnapshot,u.currentSnapshot,this.rootContexts)},i)),function Y$(e,n){return Wt(t=>{const{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:i,canDeactivateChecks:a}}=t;return 0===a.length&&0===i.length?_e({...t,guardsResult:!0}):function Z$(e,n,t,r){return Te(e).pipe(Wt(o=>function rG(e,n,t,r,o){const i=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return i&&0!==i.length?_e(i.map(s=>{const u=Qd(n)??o,c=Ac(s,u);return Va(function q$(e){return e&&tf(e.canDeactivate)}(c)?c.canDeactivate(e,n,t,r):u.runInContext(()=>c(e,n,t,r))).pipe(Bs())})).pipe(Mc()):_e(!0)}(o.component,o.route,t,n,r)),Bs(o=>!0!==o,!0))}(a,r,o,e).pipe(Wt(s=>s&&function W$(e){return"boolean"==typeof e}(s)?function Q$(e,n,t,r){return Te(n).pipe(vc(o=>r0(function eG(e,n){return null!==e&&n&&n(new b$(e)),_e(!0)}(o.route.parent,r),function J$(e,n){return null!==e&&n&&n(new C$(e)),_e(!0)}(o.route,r),function nG(e,n,t){const r=n[n.length-1],i=n.slice(0,n.length-1).reverse().map(a=>function U$(e){const n=e.routeConfig?e.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:e,guards:n}:null}(a)).filter(a=>null!==a).map(a=>zM(()=>_e(a.guards.map(u=>{const c=Qd(a.node)??t,l=Ac(u,c);return Va(function G$(e){return e&&tf(e.canActivateChild)}(l)?l.canActivateChild(r,e):c.runInContext(()=>l(r,e))).pipe(Bs())})).pipe(Mc())));return _e(i).pipe(Mc())}(e,o.path,t),function tG(e,n,t){const r=n.routeConfig?n.routeConfig.canActivate:null;if(!r||0===r.length)return _e(!0);const o=r.map(i=>zM(()=>{const a=Qd(n)??t,s=Ac(i,a);return Va(function $$(e){return e&&tf(e.canActivate)}(s)?s.canActivate(n,e):a.runInContext(()=>s(n,e))).pipe(Bs())}));return _e(o).pipe(Mc())}(e,o.route,t))),Bs(o=>!0!==o,!0))}(r,i,e,n):_e(s)),ft(s=>({...t,guardsResult:s})))})}(this.environmentInjector,u=>this.events.next(u)),Yn(u=>{if(i.guardsResult=u.guardsResult,js(u.guardsResult))throw xT(0,u.guardsResult);const c=new g$(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(c)}),Xi(u=>!!u.guardsResult||(this.cancelNavigationTransition(u,"",3),!1)),D0(u=>{if(u.guards.canActivateChecks.length)return _e(u).pipe(Yn(c=>{const l=new m$(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),Vr(c=>{let l=!1;return _e(c).pipe(function xG(e,n){return Wt(t=>{const{targetSnapshot:r,guards:{canActivateChecks:o}}=t;if(!o.length)return _e(t);let i=0;return Te(o).pipe(vc(a=>function CG(e,n,t,r){const o=e.routeConfig,i=e._resolve;return void 0!==o?.title&&!FT(o)&&(i[Hd]=o.title),function _G(e,n,t,r){const o=function DG(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}(e);if(0===o.length)return _e({});const i={};return Te(o).pipe(Wt(a=>function EG(e,n,t,r){const o=Qd(n)??r,i=Ac(e,o);return Va(i.resolve?i.resolve(n,t):o.runInContext(()=>i(n,t)))}(e[a],n,t,r).pipe(Bs(),Yn(s=>{i[a]=s}))),a0(1),function B6(e){return ft(()=>e)}(i),Vs(a=>IT(a)?uo:jd(a)))}(i,e,n,r).pipe(ft(a=>(e._resolvedData=a,e.data=vT(e,t).resolve,o&&FT(o)&&(e.data[Hd]=o.title),null)))}(a.route,r,e,n)),Yn(()=>i++),a0(1),Wt(a=>i===o.length?_e(t):uo))})}(t.paramsInheritanceStrategy,this.environmentInjector),Yn({next:()=>l=!0,complete:()=>{l||this.cancelNavigationTransition(c,"",2)}}))}),Yn(c=>{const l=new v$(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}))}),D0(u=>{const c=l=>{const d=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(l.routeConfig).pipe(Yn(f=>{l.component=f}),ft(()=>{})));for(const f of l.children)d.push(...c(f));return d};return n0(c(u.targetSnapshot.root)).pipe(mg(),Cc(1))}),D0(()=>this.afterPreactivation()),ft(u=>{const c=function A$(e,n,t){const r=Zd(e,n._root,t?t._root:void 0);return new gT(r,n)}(t.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=i={...u,targetRouterState:c},i}),Yn(()=>{this.events.next(new f0)}),((e,n,t,r)=>ft(o=>(new B$(n,o.targetRouterState,o.currentRouterState,t,r).activate(e),o)))(this.rootContexts,t.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),Cc(1),Yn({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ua(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),t.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),function V6(e){return at((n,t)=>{yn(e).subscribe(At(t,()=>t.complete(),rr)),!t.closed&&n.subscribe(t)})}(this.transitionAbortSubject.pipe(Yn(u=>{throw u}))),kd(()=>{a||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),Vs(u=>{if(s=!0,_T(u))this.events.next(new Kd(i.id,this.urlSerializer.serialize(i.extractedUrl),u.message,u.cancellationCode)),function R$(e){return _T(e)&&js(e.url)}(u)?this.events.next(new h0(u.url)):i.resolve(!1);else{this.events.next(new Dg(i.id,this.urlSerializer.serialize(i.extractedUrl),u,i.targetSnapshot??void 0));try{i.resolve(t.errorHandler(u))}catch(c){i.reject(c)}}return uo}))}))}cancelNavigationTransition(t,r,o){const i=new Kd(t.id,this.urlSerializer.serialize(t.extractedUrl),r,o);this.events.next(i),t.resolve(!1)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function OT(e){return e!==Xd}let LT=(()=>{class e{buildTitle(t){let r,o=t.root;for(;void 0!==o;)r=this.getResolvedTitleForRoute(o)??r,o=o.children.find(i=>i.outlet===Be);return r}getResolvedTitleForRoute(t){return t.data[Hd]}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:function(){return ie(AG)},providedIn:"root"})}return e})(),AG=(()=>{class e extends LT{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}static#e=this.\u0275fac=function(r){return new(r||e)(fe(mA))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),MG=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:function(){return ie(RG)},providedIn:"root"})}return e})();class TG{shouldDetach(n){return!1}store(n,t){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,t){return n.routeConfig===t.routeConfig}}let RG=(()=>{class e extends TG{static#e=this.\u0275fac=function(){let t;return function(o){return(t||(t=Pn(e)))(o||e)}}();static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Ng=new ue("",{providedIn:"root",factory:()=>({})});let NG=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:function(){return ie(kG)},providedIn:"root"})}return e})(),kG=(()=>{class e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var nf=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(nf||{});function BT(e,n){e.events.pipe(Xi(t=>t instanceof Ua||t instanceof Kd||t instanceof Dg||t instanceof Ec),ft(t=>t instanceof Ua||t instanceof Ec?nf.COMPLETE:t instanceof Kd&&(0===t.code||1===t.code)?nf.REDIRECTING:nf.FAILED),Xi(t=>t!==nf.REDIRECTING),Cc(1)).subscribe(()=>{n()})}function FG(e){throw e}function PG(e,n,t){return n.parse("/")}const OG={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},LG={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ln=(()=>{class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=ie(XI),this.isNgZoneEnabled=!1,this._events=new Wn,this.options=ie(Ng,{optional:!0})||{},this.pendingTasks=ie(Mp),this.errorHandler=this.options.errorHandler||FG,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||PG,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=ie(NG),this.routeReuseStrategy=ie(MG),this.titleStrategy=ie(LT),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=ie(Rc,{optional:!0})?.flat()??[],this.navigationTransitions=ie(Rg),this.urlSerializer=ie(zd),this.location=ie(cb),this.componentInputBindingEnabled=!!ie(Ig,{optional:!0}),this.eventsSubscription=new St,this.isNgZoneEnabled=ie(Vt)instanceof Vt&&Vt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Dc,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=mT(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(r=>{try{const{currentTransition:o}=this.navigationTransitions;if(null===o)return void(VT(r)&&this._events.next(r));if(r instanceof _g)OT(o.source)&&(this.browserUrlTree=o.extractedUrl);else if(r instanceof Ec)this.rawUrlTree=o.rawUrl;else if(r instanceof fT){if("eager"===this.urlUpdateStrategy){if(!o.extras.skipLocationChange){const i=this.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl);this.setBrowserUrl(i,o)}this.browserUrlTree=o.urlAfterRedirects}}else if(r instanceof f0)this.currentUrlTree=o.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),this.routerState=o.targetRouterState,"deferred"===this.urlUpdateStrategy&&(o.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,o),this.browserUrlTree=o.urlAfterRedirects);else if(r instanceof Kd)0!==r.code&&1!==r.code&&(this.navigated=!0),(3===r.code||2===r.code)&&this.restoreHistory(o);else if(r instanceof h0){const i=this.urlHandlingStrategy.merge(r.url,o.currentRawUrl),a={skipLocationChange:o.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||OT(o.source)};this.scheduleNavigation(i,Xd,null,a,{resolve:o.resolve,reject:o.reject,promise:o.promise})}r instanceof Dg&&this.restoreHistory(o,!0),r instanceof Ua&&(this.navigated=!0),VT(r)&&this._events.next(r)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Xd,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,r,t.state)},0)}))}navigateToSyncWithBrowser(t,r,o){const i={replaceUrl:!0},a=o?.navigationId?o:null;if(o){const u={...o};delete u.navigationId,delete u.\u0275routerPageId,0!==Object.keys(u).length&&(i.state=u)}const s=this.parseUrl(t);this.scheduleNavigation(s,r,a,i)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(x0),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){const{relativeTo:o,queryParams:i,fragment:a,queryParamsHandling:s,preserveFragment:u}=r,c=u?this.currentUrlTree.fragment:a;let d,l=null;switch(s){case"merge":l={...this.currentUrlTree.queryParams,...i};break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=i||null}null!==l&&(l=this.removeEmptyProps(l));try{d=iT(o?o.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),d=this.currentUrlTree.root}return aT(d,t,l,c??null)}navigateByUrl(t,r={skipLocationChange:!1}){const o=js(t)?t:this.parseUrl(t),i=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(i,Xd,null,r)}navigate(t,r={skipLocationChange:!1}){return function BG(e){for(let n=0;n<e.length;n++)if(null==e[n])throw new ee(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(o){r=this.malformedUriErrorHandler(o,this.urlSerializer,t)}return r}isActive(t,r){let o;if(o=!0===r?{...OG}:!1===r?{...LG}:r,js(t))return YM(this.currentUrlTree,t,o);const i=this.parseUrl(t);return YM(this.currentUrlTree,i,o)}removeEmptyProps(t){return Object.keys(t).reduce((r,o)=>{const i=t[o];return null!=i&&(r[o]=i),r},{})}scheduleNavigation(t,r,o,i,a){if(this.disposed)return Promise.resolve(!1);let s,u,c;a?(s=a.resolve,u=a.reject,c=a.promise):c=new Promise((d,f)=>{s=d,u=f});const l=this.pendingTasks.add();return BT(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(l))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:i,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}setBrowserUrl(t,r){const o=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(o)||r.extras.replaceUrl){const a={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(o,"",a)}else{const i={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(o,"",i)}}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const i=this.currentPageId-this.browserPageId;0!==i?this.location.historyGo(i):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===i&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function VT(e){return!(e instanceof f0||e instanceof h0)}let rf=(()=>{class e{constructor(t,r,o,i,a,s){this.router=t,this.route=r,this.tabIndexAttribute=o,this.renderer=i,this.el=a,this.locationStrategy=s,this.href=null,this.commands=null,this.onChanges=new Wn,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const u=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===u||"area"===u,this.isAnchorElement?this.subscription=t.events.subscribe(c=>{c instanceof Ua&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,r,o,i,a){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||r||o||i||a||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function rD(e,n,t){return function UL(e,n){return"src"===n&&("embed"===e||"frame"===e||"iframe"===e||"media"===e||"script"===e)||"href"===n&&("base"===e||"link"===e)?nD:Xh}(n,t)(e)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,r){const o=this.renderer,i=this.el.nativeElement;null!==r?o.setAttribute(i,t,r):o.removeAttribute(i,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(r){return new(r||e)(te(Ln),te(Sc),function Ah(e){return function aO(e,n){if("class"===n)return e.classes;if("style"===n)return e.styles;const t=e.attrs;if(t){const r=t.length;let o=0;for(;o<r;){const i=t[o];if(sh(i))break;if(0===i)o+=2;else if("number"==typeof i)for(o++;o<r&&"string"==typeof t[o];)o++;else{if(i===n)return t[o+1];o+=2}}}return null}(Fn(),e)}("tabindex"),te(Jo),te(Gr),te(Na))};static#t=this.\u0275dir=Ce({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,o){1&r&&On("click",function(a){return o.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),2&r&&ni("target",o.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",gc],skipLocationChange:["skipLocationChange","skipLocationChange",gc],replaceUrl:["replaceUrl","replaceUrl",gc],routerLink:"routerLink"},standalone:!0,features:[mE,go]})}return e})();class UT{}let jG=(()=>{class e{constructor(t,r,o,i,a){this.router=t,this.injector=o,this.preloadingStrategy=i,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Xi(t=>t instanceof Ua),vc(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const o=[];for(const i of r){i.providers&&!i._injector&&(i._injector=Rw(i.providers,t,`Route: ${i.path}`));const a=i._injector??t,s=i._loadedInjector??a;(i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent)&&o.push(this.preloadConfig(a,i)),(i.children||i._loadedRoutes)&&o.push(this.processRoutes(s,i.children??i._loadedRoutes))}return Te(o).pipe(ya())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let o;o=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):_e(null);const i=o.pipe(Wt(a=>null===a?_e(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,this.processRoutes(a.injector??t,a.routes))));return r.loadComponent&&!r._loadedComponent?Te([i,this.loader.loadComponent(r)]).pipe(ya()):i})}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Ln),fe(KI),fe($r),fe(UT),fe(E0))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const I0=new ue("");let jT=(()=>{class e{constructor(t,r,o,i,a={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=o,this.zone=i,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof _g?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ua?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Ec&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof hT&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new hT(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){!function WD(){throw new Error("invalid")}()};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac})}return e})();function Yi(e,n){return{\u0275kind:e,\u0275providers:n}}function WT(){const e=ie(qr);return n=>{const t=e.get(pc);if(n!==t.components[0])return;const r=e.get(Ln),o=e.get(zT);1===e.get(S0)&&r.initialNavigation(),e.get($T,null,ze.Optional)?.setUpPreloading(),e.get(I0,null,ze.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}const zT=new ue("",{factory:()=>new Wn}),S0=new ue("",{providedIn:"root",factory:()=>1}),$T=new ue("");function $G(e){return Yi(0,[{provide:$T,useExisting:jG},{provide:UT,useExisting:e}])}const GT=new ue("ROUTER_FORROOT_GUARD"),qG=[cb,{provide:zd,useClass:s0},Ln,Yd,{provide:Sc,useFactory:function HT(e){return e.routerState.root},deps:[Ln]},E0,[]];function XG(){return new nS("Router",Ln)}let A0=(()=>{class e{constructor(t){}static forRoot(t,r){return{ngModule:e,providers:[qG,[],{provide:Rc,multi:!0,useValue:t},{provide:GT,useFactory:QG,deps:[[Ln,new Rh,new Nh]]},{provide:Ng,useValue:r||{}},r?.useHash?{provide:Na,useClass:kS}:{provide:Na,useClass:NS},{provide:I0,useFactory:()=>{const e=ie(JW),n=ie(Vt),t=ie(Ng),r=ie(Rg),o=ie(zd);return t.scrollOffset&&e.setOffset(t.scrollOffset),new jT(o,r,e,n,t)}},r?.preloadingStrategy?$G(r.preloadingStrategy).\u0275providers:[],{provide:nS,multi:!0,useFactory:XG},r?.initialNavigation?JG(r):[],r?.bindToComponentInputs?Yi(8,[bT,{provide:Ig,useExisting:bT}]).\u0275providers:[],[{provide:qT,useFactory:WT},{provide:Jw,multi:!0,useExisting:qT}]]}}static forChild(t){return{ngModule:e,providers:[{provide:Rc,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(r){return new(r||e)(fe(GT,8))};static#t=this.\u0275mod=Hr({type:e});static#n=this.\u0275inj=ur({})}return e})();function QG(e){return"guarded"}function JG(e){return["disabled"===e.initialNavigation?Yi(3,[{provide:$w,multi:!0,useFactory:()=>{const n=ie(Ln);return()=>{n.setUpLocationChangeListener()}}},{provide:S0,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?Yi(2,[{provide:S0,useValue:0},{provide:$w,multi:!0,deps:[qr],useFactory:n=>{const t=n.get(RH,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const o=n.get(Ln),i=n.get(zT);BT(o,()=>{r(!0)}),n.get(Rg).afterPreactivation=()=>(r(!0),i.closed?_e(void 0):i),o.initialNavigation()}))}}]).\u0275providers:[]]}const qT=new ue("");function XT(e,n,t,r,o,i,a){try{var s=e[i](a),u=s.value}catch(c){return void t(c)}s.done?n(u):Promise.resolve(u).then(r,o)}function Nc(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var i=e.apply(n,t);function a(u){XT(i,r,o,a,s,"next",u)}function s(u){XT(i,r,o,a,s,"throw",u)}a(void 0)})}}var KT=function(e,n){return(KT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])})(e,n)};function Bo(e,n){function t(){this.constructor=e}KT(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}function he(e,n,t,r){return new(t||(t=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(l){i(l)}}function s(c){try{u(r.throw(c))}catch(l){i(l)}}function u(c){c.done?o(c.value):new t(function(l){l(c.value)}).then(a,s)}u((r=r.apply(e,n||[])).next())})}function pe(e,n){var t,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,r=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===l[0]||2===l[0])){a=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){a.label=l[1];break}if(6===l[0]&&a.label<o[1]){a.label=o[1],o=l;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(l);break}o[2]&&a.ops.pop(),a.trys.pop();continue}l=n.call(e,a)}catch(d){l=[6,d],r=0}finally{t=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([u,c])}}}var t8=function(){function e(n){this.global=n,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(n,t){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=n,this.platform=t},e.prototype.registerFlag=function(n,t,r){if(this.flagRegistry[n]={evaluationFn:t,setHook:r},null!=this.urlFlags[n]){var o=this.urlFlags[n];console.warn("Setting feature override from URL "+n+": "+o+"."),this.set(n,o)}},e.prototype.get=function(n){return n in this.flags||(this.flags[n]=this.evaluateFlag(n)),this.flags[n]},e.prototype.getNumber=function(n){return this.get(n)},e.prototype.getBool=function(n){return this.get(n)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(n,t){if(null==this.flagRegistry[n])throw new Error("Cannot set flag "+n+" as it has not been registered.");this.flags[n]=t,null!=this.flagRegistry[n].setHook&&this.flagRegistry[n].setHook(t)},e.prototype.evaluateFlag=function(n){if(null==this.flagRegistry[n])throw new Error("Cannot evaluate flag '"+n+"': no evaluation function found.");return this.flagRegistry[n].evaluationFn()},e.prototype.setFlags=function(n){this.flags=Object.assign({},n)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var n=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var r,o=(r={},this.global.location.search.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return function n8(e,n,t){e[decodeURIComponent(n)]=decodeURIComponent(t||"")}(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0];n.urlFlags[s]=function(c,l){if("true"===(l=l.toLowerCase())||"false"===l)return"true"===l;if(""+ +l===l)return+l;throw new Error("Could not parse value flag value "+l+" for flag "+c+".")}(s,a[1])})}},e}();function H(){return YT}var YT=null,kc=new Map,af=new Map;function ZT(e,n){var t=M0(e,n);return kc.get(t)}function QT(e){for(var n=kc.entries(),t=[];;){var r=n.next(),i=r.value;if(r.done)break;var s=i[1];i[0].split("_")[0]===e&&t.push(s)}return t}function JT(e){var n=e.kernelName,t=e.backendName,r=M0(n,t);if(kc.has(r))throw new Error("The kernel '"+n+"' for backend '"+t+"' is already registered");kc.set(r,e)}function o8(e){var n=e.kernelName;af.has(n)&&console.warn("Overriding the gradient for '"+n+"'"),af.set(n,e)}function M0(e,n){return n+"_"+e}function eR(e){for(var n=e.length,t=0,r=0;n>0;)r=Math.random()*n|0,t=e[--n],e[n]=e[r],e[r]=t}function kg(e,n,t){return Math.max(e,Math.min(n,t))}function T0(e){return e%2==0?e:e+1}function tR(e){for(var n=0,t=0;t<e.length;t++)n+=e[t];return n}function A(e,n){if(!e)throw new Error("string"==typeof n?n:n())}function ut(e,n,t){void 0===t&&(t=""),A(hn(e,n),function(){return t+" Shapes "+e+" and "+n+" must match"})}function Hs(e){A(null!=e,function(){return"The input to the tensor constructor must be a non-null value."})}function Zi(e,n,t){if(void 0===n&&(n=[]),void 0===t&&(t=!1),null==n&&(n=[]),Array.isArray(e)||Bn(e)&&!t)for(var r=0;r<e.length;++r)Zi(e[r],n,t);else n.push(e);return n}function ge(e){if(0===e.length)return 1;for(var n=e[0],t=1;t<e.length;t++)n*=e[t];return n}function hn(e,n){if(e===n)return!0;if(null==e||null==n||e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0}function Qt(e){return e%1==0}function nR(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var n=Math.exp(2*e);return(n-1)/(n+1)}function Fg(e){var n=Math.ceil(Math.sqrt(e));return[n,Math.ceil(e/n)]}function Ws(e,n){return n<=e.length?e:e+" ".repeat(n-e.length)}function R0(e,n,t){return void 0===n&&(n=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(e())r();else{i++;var s=n(i);null!=t&&i>=t?o():setTimeout(a,s)}};a()})}function rR(e,n){for(var t=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)t*=e[o];else if(-1===e[o]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(-1===r){if(n>0&&n!==t)throw Error("Size("+n+") must match the product of shape "+e);return e}if(0===t)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(n%t!=0)throw Error("The implicit shape can't be a fractional number. Got "+n+" / "+t);var i=e.slice();return i[r]=n/t,i}function pn(e,n){var t=n.length;return A((e=null==e?n.map(function(r,o){return o}):[].concat(e)).every(function(r){return r>=-t&&r<t}),function(){return"All values in axis param must be in range [-"+t+", "+t+") but got axis "+e}),A(e.every(function(r){return Qt(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?t+r:r})}function ja(e,n){for(var t=[],r=[],o=null!=n&&Array.isArray(n)&&0===n.length,i=null==n||o?null:pn(n,e).sort(),a=0,s=0;s<e.length;++s){if(null!=i){if(i[a]===s&&1!==e[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(null==i[a]||i[a]>s)&&1===e[s]&&(t.push(e[s]),r.push(s)),i[a]<=s&&a++}1!==e[s]&&(t.push(e[s]),r.push(s))}return{newShape:t,keptDims:r}}function Fc(e,n){var t=null;if(null==e||"float32"===e)t=new Float32Array(n);else if("int32"===e)t=new Int32Array(n);else{if("bool"!==e)throw new Error("Unknown data type "+e);t=new Uint8Array(n)}return t}function sf(e,n){var t=null;if(null==e||"float32"===e)t=new Float32Array(n);else if("int32"===e)t=new Int32Array(n);else if("bool"===e)t=new Uint8Array(n);else{if("string"!==e)throw new Error("Unknown data type "+e);t=new Array(n)}return t}function oR(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+n+" being uploaded contains "+r+".")}}function iR(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function aR(e,n){return!("complex64"===n||"float32"===n&&"complex64"!==e||"int32"===n&&"float32"!==e&&"complex64"!==e||"bool"===n&&"bool"===e)}function Bn(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function N0(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function sR(e){if(null==e)return 0;var n=0;return e.forEach(function(t){return n+=t.length}),n}function Ha(e){return"string"==typeof e||e instanceof String}function uR(e){return"boolean"==typeof e}function cR(e){return"number"==typeof e}function Pc(e){return Array.isArray(e)?Pc(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":cR(e)?"float32":Ha(e)?"string":uR(e)?"bool":"float32"}function Wa(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Pg(e,n){for(var t=n;t<e;++t)if(e%t==0)return t;return e}function Vo(e){var n=e.length;if(n<2)return[];var t=new Array(n-1);t[n-2]=e[n-1];for(var r=n-3;r>=0;--r)t[r]=t[r+1]*e[r+1];return t}function k0(e,n,t){if("string"===n)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Zi(e)),t&&oR(e,n),a=n,(i=e)instanceof Float32Array&&"float32"===a||i instanceof Int32Array&&"int32"===a||i instanceof Uint8Array&&"bool"===a)return e;var i,a;if(null==n||"float32"===n||"complex64"===n)return new Float32Array(e);if("int32"===n)return new Int32Array(e);if("bool"===n){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)0!==Math.round(e[o])&&(r[o]=1);return r}throw new Error("Unknown data type "+n)}function F0(e,n){if(0===e.length)return n[0];var t=e.reduce(function(r,o){return r*o});if(0===t)return[];if(t!==n.length)throw new Error("["+e+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(1===i.length)for(var u=i[0],c=0;c<u;c++)s[c]=a[o+c];else{u=i[0];var l=i.slice(1),d=l.reduce(function(f,h){return f*h});for(c=0;c<u;c++)s[c]=r(o+c*d,l,a)}return s}(0,e,n)}function P0(e,n){for(var t=Oc(e,n),r=0;r<t.length;r++)t[r]=1;return t}function Oc(e,n){if(null==n||"float32"===n||"complex64"===n)return new Float32Array(e);if("int32"===n)return new Int32Array(e);if("bool"===n)return new Uint8Array(e);throw new Error("Unknown data type "+n)}function Uo(){return H().platform.now()}function O0(e){e.forEach(function(n){A(Number.isInteger(n)&&n>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function lR(e,n){return void 0===n&&(n="utf-8"),n=n||"utf-8",H().platform.encode(e,n)}function uf(e,n){return void 0===n&&(n="utf-8"),n=n||"utf-8",H().platform.decode(e,n)}function L0(e,n,t){if(0===n)return 0;if(1===n)return e[0];for(var r=e[e.length-1],o=0;o<e.length-1;++o)r+=t[o]*e[o];return r}function dR(e,n,t){if(0===n)return[];if(1===n)return[e];for(var r=new Array(n),o=0;o<r.length-1;++o)r[o]=Math.floor(e/t[o]),e-=r[o]*t[o];return r[r.length-1]=e,r}Object.freeze({shuffle:eR,clamp:kg,nearestLargerEven:T0,sum:tR,randUniform:function(e,n){var t=Math.random();return n*t+(1-t)*e},distSquared:function(e,n){for(var t=0,r=0;r<e.length;r++){var o=Number(e[r])-Number(n[r]);t+=o*o}return t},assert:A,assertShapesMatch:ut,assertNonNull:Hs,flatten:Zi,sizeFromShape:ge,isScalarShape:function(e){return 0===e.length},arraysEqual:hn,isInt:Qt,tanh:nR,sizeToSquarishShape:Fg,createShuffledIndices:function(e){for(var n=new Uint32Array(e),t=0;t<e;++t)n[t]=t;return eR(n),n},rightPad:Ws,repeatedTry:R0,inferFromImplicitShape:rR,parseAxisParam:pn,squeezeShape:ja,getTypedArrayFromDType:Fc,getArrayFromDType:sf,checkConversionForErrors:oR,isValidDtype:iR,hasEncodingLoss:aR,isTypedArray:Bn,bytesPerElement:N0,bytesFromStringArray:sR,isString:Ha,isBoolean:uR,isNumber:cR,inferDtype:Pc,isFunction:Wa,nearestDivisor:Pg,computeStrides:Vo,toTypedArray:k0,toNestedArray:F0,makeOnesTypedArray:P0,makeZerosTypedArray:Oc,now:Uo,assertNonNegativeIntegerDimensions:O0,fetch:function(e,n){return H().platform.fetch(e,n)},encodeString:lR,decodeString:uf,locToIndex:L0,indexToLoc:dR});var i8=function(){function e(n,t){this.backendTimer=n,this.logger=t,null==t&&(this.logger=new a8)}return e.prototype.profileKernel=function(n,t,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(c,l,d){if("float32"!==l)return!1;for(var f=0;f<c.length;f++){var h=c[f];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+d+"'"),!0}})(u,s.dtype,n),a.then(function(c){var l="";null!=c.getExtraProfileInfo&&(l=c.getExtraProfileInfo()),i.logger.logKernelProfile(n,s,u,c.kernelMs,t,l)})})}),o},e}(),a8=function(){function e(){}return e.prototype.logKernelProfile=function(n,t,r,o,i,a){var s="number"==typeof o?Ws(o+"ms",9):o.error,u=Ws(n,25),c=t.rank,l=t.size,d=Ws(t.shape.toString(),14),f="";for(var h in i){var p=i[h].shape||t.shape,m=p.length;f+=h+": "+m+"D "+(m>0?p:"")+" "}console.log("%c"+u+"\t%c"+s+"\t%c"+c+"D "+d+"\t%c"+l+"\t%c"+f+"\t%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();function lf(e,n,t){return Ws(Array.isArray(e)?parseFloat(e[0].toFixed(7))+" + "+parseFloat(e[1].toFixed(7))+"j":Ha(e)?"'"+e+"'":"bool"===t?hR(e):parseFloat(e.toFixed(7)).toString(),n)}function hR(e){return 0===e?"false":"true"}function df(e){for(var n=[],t=0;t<e.length;t+=2)n.push([e[t],e[t+1]]);return n}var ff=function(){function e(n,t,r){var o=this;if(this.dtype=t,this.shape=n.slice(),this.size=ge(n),null!=r){var i=r.length;A(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||sf(t,this.size),this.strides=Vo(n)}return e.prototype.set=function(n){for(var t=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];0===r.length&&(r=[0]),A(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+t.rank+")"});var i=this.locToIndex(r);this.values[i]=n},e.prototype.get=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];0===n.length&&(n=[0]);for(var r=0,o=0,i=n;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r])throw new Error("Requested out of range element at "+n+".   Buffer shape="+this.shape);r++}for(var u=n[n.length-1],c=0;c<n.length-1;++c)u+=this.strides[c]*n[c];return this.values[u]},e.prototype.locToIndex=function(n){if(0===this.rank)return 0;if(1===this.rank)return n[0];for(var t=n[n.length-1],r=0;r<n.length-1;++r)t+=this.strides[r]*n[r];return t},e.prototype.indexToLoc=function(n){if(0===this.rank)return[];if(1===this.rank)return[n];for(var t=new Array(this.shape.length),r=0;r<t.length-1;++r)t[r]=Math.floor(n/this.strides[r]),n-=t[r]*this.strides[r];return t[t.length-1]=n,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return di().makeTensor(this.values,this.shape,this.dtype)},e}(),di=null,V=null,pR=null,kt=function(){function e(n,t,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=n.slice(),this.dtype=t||"float32",this.size=ge(n),this.strides=Vo(n),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),A(1===this.size,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(n,t){return this.throwIfDisposed(),this.reshape([n,t])},e.prototype.as3D=function(n,t,r){return this.throwIfDisposed(),this.reshape([n,t,r])},e.prototype.as4D=function(n,t,r,o){return this.throwIfDisposed(),this.reshape([n,t,r,o])},e.prototype.as5D=function(n,t,r,o,i){return this.throwIfDisposed(),this.reshape([n,t,r,o,i])},e.prototype.asType=function(n){return this.throwIfDisposed(),V.cast(this,n)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return he(this,void 0,void 0,function(){var n;return pe(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return n=t.sent(),[2,V.buffer(this.shape,this.dtype,n)]}})})},e.prototype.bufferSync=function(){return V.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return he(this,void 0,void 0,function(){var n;return pe(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return n=t.sent(),[2,F0(this.shape,n)]}})})},e.prototype.arraySync=function(){return F0(this.shape,this.dataSync())},e.prototype.data=function(){return he(this,void 0,void 0,function(){var n,t;return pe(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),n=di().read(this.dataId),"string"!==this.dtype?[3,2]:[4,n];case 1:t=r.sent();try{return[2,t.map(function(o){return uf(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,n]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var n=di().readSync(this.dataId);if("string"===this.dtype)try{return n.map(function(t){return uf(t)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return n},e.prototype.bytes=function(){return he(this,void 0,void 0,function(){var n;return pe(this,function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,di().read(this.dataId)];case 1:return n=t.sent(),"string"===this.dtype?[2,n]:[2,new Uint8Array(n.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(di().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(n){return void 0===n&&(n=!1),V.print(this,n)},e.prototype.reshape=function(n){return this.throwIfDisposed(),V.reshape(this,n)},e.prototype.reshapeAs=function(n){return this.throwIfDisposed(),this.reshape(n.shape)},e.prototype.expandDims=function(n){return void 0===n&&(n=0),V.expandDims(this,n)},e.prototype.cumsum=function(n,t,r){return void 0===n&&(n=0),void 0===t&&(t=!1),void 0===r&&(r=!1),V.cumsum(this,n,t,r)},e.prototype.squeeze=function(n){return this.throwIfDisposed(),V.squeeze(this,n)},e.prototype.clone=function(){return this.throwIfDisposed(),V.clone(this)},e.prototype.oneHot=function(n,t,r){return this.throwIfDisposed(),V.oneHot(this,n,t,r)},e.prototype.toString=function(n){return void 0===n&&(n=!1),function s8(e,n,t,r){var o=Vo(n),i=function(c,l,d,f){var h=ge(l),p=f[f.length-1],m=new Array(p).fill(0),v=l.length,y="complex64"===d?df(c):c;if(v>1)for(var b=0;b<h/p;b++)for(var C=b*p,x=0;x<p;x++)m[x]=Math.max(m[x],lf(y[C+x],0,d).length);return m}(e,n,t,o),a=n.length,s=function c(l,d,f,h,p,m){void 0===m&&(m=!0);var v="complex64"===f?2:1,y=d[0],b=d.length;if(0===b)return"complex64"===f?[lf(df(l)[0],0,f)]:"bool"===f?[hR(l[0])]:[l[0].toString()];if(1===b){if(y>20){var x=Array.from(l.slice(0,3*v)),E=Array.from(l.slice((y-3)*v,y*v));return"complex64"===f&&(x=df(x),E=df(E)),["["+x.map(function(G,J){return lf(G,p[J],f)}).join(", ")+", ..., "+E.map(function(G,J){return lf(G,p[y-3+J],f)}).join(", ")+"]"]}return["["+("complex64"===f?df(l):Array.from(l)).map(function(G,J){return lf(G,p[J],f)}).join(", ")+"]"]}var I=d.slice(1),N=h.slice(1),R=h[0]*v,M=[];if(y>20){for(var T=0;T<3;T++){var L=(O=T*R)+R;M.push.apply(M,c(l.slice(O,L),I,f,N,p,!1))}for(M.push("..."),T=y-3;T<y;T++)L=(O=T*R)+R,M.push.apply(M,c(l.slice(O,L),I,f,N,p,T===y-1))}else for(T=0;T<y;T++){var O;L=(O=T*R)+R,M.push.apply(M,c(l.slice(O,L),I,f,N,p,T===y-1))}var q=2===b?",":"";for(M[0]="["+M[0]+q,T=1;T<M.length-1;T++)M[T]=" "+M[T]+q;var $=",\n";for(T=2;T<b;T++)$+="\n";return M[M.length-1]=" "+M[M.length-1]+"]"+(m?"":$),M}(e,n,t,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+t),u.push("  rank: "+a),u.push("  shape: ["+n+"]"),u.push("  values:")),u.push(s.map(function(c){return"    "+c}).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,n)},e.prototype.tile=function(n){return this.throwIfDisposed(),V.tile(this,n)},e.prototype.gather=function(n,t){return void 0===t&&(t=0),this.throwIfDisposed(),V.gather(this,n,t)},e.prototype.matMul=function(n,t,r){return void 0===t&&(t=!1),void 0===r&&(r=!1),this.throwIfDisposed(),V.matMul(this,n,t,r)},e.prototype.dot=function(n){return this.throwIfDisposed(),V.dot(this,n)},e.prototype.norm=function(n,t,r){return void 0===n&&(n="euclidean"),void 0===t&&(t=null),void 0===r&&(r=!1),this.throwIfDisposed(),V.norm(this,n,t,r)},e.prototype.slice=function(n,t){return this.throwIfDisposed(),V.slice(this,n,t)},e.prototype.reverse=function(n){return this.throwIfDisposed(),V.reverse(this,n)},e.prototype.concat=function(n,t){return void 0===t&&(t=0),this.throwIfDisposed(),n instanceof e&&(n=[n]),V.concat([this].concat(n),t)},e.prototype.split=function(n,t){return void 0===t&&(t=0),this.throwIfDisposed(),V.split(this,n,t)},e.prototype.stack=function(n,t){return void 0===t&&(t=0),V.stack([this,n],t)},e.prototype.unstack=function(n){return void 0===n&&(n=0),V.unstack(this,n)},e.prototype.pad=function(n,t){return void 0===t&&(t=0),V.pad(this,n,t)},e.prototype.batchNormalization=function(n,t,r,o,i){return void 0===r&&(r=.001),pR("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(n,t,i,o,r)},e.prototype.batchNorm=function(n,t,r,o,i){return void 0===i&&(i=.001),this.throwIfDisposed(),V.batchNorm(this,n,t,r,o,i)},e.prototype.all=function(n,t){return void 0===n&&(n=null),void 0===t&&(t=!1),this.throwIfDisposed(),V.all(this,n,t)},e.prototype.any=function(n,t){return void 0===n&&(n=null),void 0===t&&(t=!1),this.throwIfDisposed(),V.any(this,n,t)},e.prototype.logSumExp=function(n,t){return void 0===n&&(n=null),void 0===t&&(t=!1),this.throwIfDisposed(),V.logSumExp(this,n,t)},e.prototype.sum=function(n,t){return void 0===n&&(n=null),void 0===t&&(t=!1),this.throwIfDisposed(),V.sum(this,n,t)},e.prototype.prod=function(n,t){return void 0===n&&(n=null),void 0===t&&(t=!1),this.throwIfDisposed(),V.prod(this,n,t)},e.prototype.mean=function(n,t){return void 0===n&&(n=null),void 0===t&&(t=!1),this.throwIfDisposed(),V.mean(this,n,t)},e.prototype.min=function(n,t){return void 0===n&&(n=null),void 0===t&&(t=!1),this.throwIfDisposed(),V.min(this,n,t)},e.prototype.max=function(n,t){return void 0===n&&(n=null),void 0===t&&(t=!1),this.throwIfDisposed(),V.max(this,n,t)},e.prototype.argMin=function(n){return void 0===n&&(n=null),this.throwIfDisposed(),V.argMin(this,n)},e.prototype.argMax=function(n){return void 0===n&&(n=null),this.throwIfDisposed(),V.argMax(this,n)},e.prototype.cast=function(n){return this.throwIfDisposed(),V.cast(this,n)},e.prototype.add=function(n){return this.throwIfDisposed(),V.add(this,n)},e.prototype.addStrict=function(n){return this.throwIfDisposed(),V.addStrict(this,n)},e.prototype.atan2=function(n){return this.throwIfDisposed(),V.atan2(this,n)},e.prototype.sub=function(n){return this.throwIfDisposed(),V.sub(this,n)},e.prototype.subStrict=function(n){return this.throwIfDisposed(),V.subStrict(this,n)},e.prototype.pow=function(n){return this.throwIfDisposed(),V.pow(this,n)},e.prototype.powStrict=function(n){return this.throwIfDisposed(),V.powStrict(this,n)},e.prototype.mul=function(n){return this.throwIfDisposed(),V.mul(this,n)},e.prototype.mulStrict=function(n){return this.throwIfDisposed(),V.mulStrict(this,n)},e.prototype.div=function(n){return this.throwIfDisposed(),V.div(this,n)},e.prototype.divNoNan=function(n){return this.throwIfDisposed(),V.divNoNan(this,n)},e.prototype.floorDiv=function(n){return this.throwIfDisposed(),V.floorDiv(this,n)},e.prototype.divStrict=function(n){return this.throwIfDisposed(),V.divStrict(this,n)},e.prototype.minimum=function(n){return this.throwIfDisposed(),V.minimum(this,n)},e.prototype.minimumStrict=function(n){return this.throwIfDisposed(),V.minimumStrict(this,n)},e.prototype.maximum=function(n){return this.throwIfDisposed(),V.maximum(this,n)},e.prototype.maximumStrict=function(n){return this.throwIfDisposed(),V.maximumStrict(this,n)},e.prototype.mod=function(n){return this.throwIfDisposed(),V.mod(this,n)},e.prototype.modStrict=function(n){return this.throwIfDisposed(),V.modStrict(this,n)},e.prototype.squaredDifferenceStrict=function(n){return this.throwIfDisposed(),V.squaredDifferenceStrict(this,n)},e.prototype.transpose=function(n){return this.throwIfDisposed(),V.transpose(this,n)},e.prototype.notEqual=function(n){return this.throwIfDisposed(),V.notEqual(this,n)},e.prototype.notEqualStrict=function(n){return this.throwIfDisposed(),V.notEqualStrict(this,n)},e.prototype.less=function(n){return this.throwIfDisposed(),V.less(this,n)},e.prototype.lessStrict=function(n){return this.throwIfDisposed(),V.lessStrict(this,n)},e.prototype.equal=function(n){return this.throwIfDisposed(),V.equal(this,n)},e.prototype.equalStrict=function(n){return this.throwIfDisposed(),V.equalStrict(this,n)},e.prototype.lessEqual=function(n){return this.throwIfDisposed(),V.lessEqual(this,n)},e.prototype.lessEqualStrict=function(n){return this.throwIfDisposed(),V.lessEqualStrict(this,n)},e.prototype.greater=function(n){return this.throwIfDisposed(),V.greater(this,n)},e.prototype.greaterStrict=function(n){return this.throwIfDisposed(),V.greaterStrict(this,n)},e.prototype.greaterEqual=function(n){return this.throwIfDisposed(),V.greaterEqual(this,n)},e.prototype.greaterEqualStrict=function(n){return this.throwIfDisposed(),V.greaterEqualStrict(this,n)},e.prototype.logicalAnd=function(n){return this.throwIfDisposed(),V.logicalAnd(this,n)},e.prototype.logicalOr=function(n){return this.throwIfDisposed(),V.logicalOr(this,n)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),V.logicalNot(this)},e.prototype.logicalXor=function(n){return this.throwIfDisposed(),V.logicalXor(this,n)},e.prototype.where=function(n,t){return this.throwIfDisposed(),V.where(n,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),V.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),V.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),V.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),V.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),V.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),V.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),V.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),V.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),V.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),V.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),V.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),V.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),V.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),V.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),V.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),V.abs(this)},e.prototype.clipByValue=function(n,t){return this.throwIfDisposed(),V.clipByValue(this,n,t)},e.prototype.relu=function(){return this.throwIfDisposed(),V.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),V.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),V.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),V.selu(this)},e.prototype.leakyRelu=function(n){return void 0===n&&(n=.2),this.throwIfDisposed(),V.leakyRelu(this,n)},e.prototype.prelu=function(n){return this.throwIfDisposed(),V.prelu(this,n)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),V.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),V.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),V.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),V.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),V.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),V.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),V.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),V.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),V.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),V.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),V.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),V.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),V.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),V.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),V.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),V.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),V.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),V.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),V.round(this)},e.prototype.step=function(n){return void 0===n&&(n=0),this.throwIfDisposed(),V.step(this,n)},e.prototype.softmax=function(n){return void 0===n&&(n=-1),this.throwIfDisposed(),V.softmax(this,n)},e.prototype.logSoftmax=function(n){return void 0===n&&(n=-1),this.throwIfDisposed(),V.logSoftmax(this,n)},e.prototype.resizeBilinear=function(n,t){return void 0===t&&(t=!1),this.throwIfDisposed(),V.image.resizeBilinear(this,n,t)},e.prototype.resizeNearestNeighbor=function(n,t){return void 0===t&&(t=!1),this.throwIfDisposed(),V.image.resizeNearestNeighbor(this,n,t)},e.prototype.conv1d=function(n,t,r,o,i,a){return void 0===o&&(o="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),V.conv1d(this,n,t,r,o,i,a)},e.prototype.conv2d=function(n,t,r,o,i,a){return void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),V.conv2d(this,n,t,r,o,i,a)},e.prototype.conv2dTranspose=function(n,t,r,o,i){return this.throwIfDisposed(),V.conv2dTranspose(this,n,t,r,o,i)},e.prototype.depthwiseConv2D=function(n,t,r,o,i,a){return void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),V.depthwiseConv2d(this,n,t,r,o,i,a)},e.prototype.separableConv2d=function(n,t,r,o,i,a){return void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC"),this.throwIfDisposed(),V.separableConv2d(this,n,t,r,o,i,a)},e.prototype.avgPool=function(n,t,r,o){return this.throwIfDisposed(),V.avgPool(this,n,t,r,o)},e.prototype.maxPool=function(n,t,r,o){return this.throwIfDisposed(),V.maxPool(this,n,t,r,o)},e.prototype.localResponseNormalization=function(n,t,r,o){return void 0===n&&(n=5),void 0===t&&(t=1),void 0===r&&(r=1),void 0===o&&(o=.5),V.localResponseNormalization(this,n,t,r,o)},e.prototype.pool=function(n,t,r,o,i){return this.throwIfDisposed(),V.pool(this,n,t,r,o,i)},e.prototype.variable=function(n,t,r){return void 0===n&&(n=!0),this.throwIfDisposed(),di().makeVariable(this,n,t,r)},e.prototype.unsortedSegmentSum=function(n,t){return this.throwIfDisposed(),V.unsortedSegmentSum(this,n,t)},e.prototype.batchToSpaceND=function(n,t){return this.throwIfDisposed(),V.batchToSpaceND(this,n,t)},e.prototype.spaceToBatchND=function(n,t){return this.throwIfDisposed(),V.spaceToBatchND(this,n,t)},e.prototype.topk=function(n,t){return void 0===n&&(n=1),void 0===t&&(t=!0),this.throwIfDisposed(),V.topk(this,n,t)},e.prototype.stridedSlice=function(n,t,r,o,i,a,s,u){return void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),this.throwIfDisposed(),V.stridedSlice(this,n,t,r,o,i,a,s,u)},e.prototype.depthToSpace=function(n,t){return this.throwIfDisposed(),V.depthToSpace(this,n,t)},e.prototype.fft=function(){return this.throwIfDisposed(),V.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),V.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),V.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),V.spectral.irfft(this)},e}();Object.defineProperty(kt,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var gR,V0,U0,j0,H0,e,Lc=function(e){function n(t,r,o,i){var a=e.call(this,t.shape,t.dtype,t.dataId,i)||this;return a.trainable=r,a.name=o,a}return Bo(n,e),n.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!hn(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");di().disposeTensor(this),this.dataId=t.dataId,di().incRef(this,null)},n.prototype.dispose=function(){di().disposeVariable(this),this.isDisposedInternal=!0},n}(kt);Object.defineProperty(Lc,Symbol.hasInstance,{value:function(e){return e instanceof kt&&null!=e.assign&&e.assign instanceof Function}}),(e=gR||(gR={})).R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6",function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(V0||(V0={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(U0||(U0={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(j0||(j0={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(H0||(H0={}));var u8={float32:j0,int32:V0,bool:U0,complex64:H0};function An(e,n){if("string"===e||"string"===n){if("string"===e&&"string"===n)return"string";throw new Error("Can not upcast "+e+" with "+n)}return u8[e][n]}function W0(e){return An(e,"int32")}function qt(e,n){if(e.dtype===n.dtype)return[e,n];var t=An(e.dtype,n.dtype);return[e.cast(t),n.cast(t)]}function mR(e,n){A(e.dtype===n.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+n.dtype+") input must match"})}function z0(e){var n=[];return function t(r,o,i){if(null!=r){if(r instanceof kt)return void o.push(r);if(a=r,Array.isArray(a)||"object"==typeof a){var a,s=r;for(var u in s){var c=s[u];i.has(c)||(i.add(c),t(c,o,i))}}}}(e,n,new Set),n}Object.freeze({makeTypesMatch:qt,assertTypesMatch:mR,isTensorInList:function(e,n){return n.some(function(t){return t.id===e.id})},getTensorsInContainer:z0});var $0,vR=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var n in this.registeredVariables)this.registeredVariables[n].dispose()},e}(),c8=function(){function e(n){this.ENV=n,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new vR}return e.prototype.ready=function(){return he(this,void 0,void 0,function(){var n,t,r;return pe(this,function(o){switch(o.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then(function(){})];if(null!=this.backendInstance)return[2];n=this.getSortedBackends(),t=0,o.label=1;case 1:return t<n.length?[4,this.initializeBackend(r=n[t]).success]:[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var n=this.initializeBackendsAndReturnBest(),t=n.name;if(n.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(n){return n in this.registry||n in this.registryFactory&&!this.initializeBackend(n).asyncInit?this.registry[n]:null},e.prototype.findBackendFactory=function(n){return n in this.registryFactory?this.registryFactory[n].factory:null},e.prototype.registerBackend=function(n,t,r){return void 0===r&&(r=1),n in this.registryFactory?(console.warn(n+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[n]={factory:t,priority:r},!0)},e.prototype.setBackend=function(n){return he(this,void 0,void 0,function(){var t,r,o;return pe(this,function(i){switch(i.label){case 0:if(null==this.registryFactory[n])throw new Error("Backend name '"+n+"' not found in registry");return this.backendName=n,null!=this.registry[n]?[3,4]:(this.backendInstance=null,t=this.initializeBackend(n),r=t.success,t.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[n],this.setupRegisteredKernels(),this.profiler=new i8(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var n=this;QT(this.backendName).forEach(function(t){null!=t.setupFunc&&t.setupFunc(n.backendInstance)})},e.prototype.disposeRegisteredKernels=function(n){var t=this;QT(n).forEach(function(r){null!=r.disposeFunc&&r.disposeFunc(t.registry[n])})},e.prototype.initializeBackend=function(n){var t=this,r=this.registryFactory[n];if(null==r)throw new Error("Cannot initialize backend "+n+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<t.pendingBackendInitId||(t.registry[n]=s,t.pendingBackendInit=null,0))}).catch(function(s){return!(i<t.pendingBackendInitId||(t.pendingBackendInit=null,console.warn("Initialization of backend "+n+" failed"),console.warn(s.stack||s.message),1))});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[n]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+n+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(n){if(!(n in this.registryFactory))throw new Error(n+" backend not found in registry");this.backendName===n&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,n in this.registry&&(this.disposeRegisteredKernels(n),this.registry[n].dispose(),delete this.registry[n]),delete this.registryFactory[n],this.backendName===n&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var n=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(t,r){return n.registryFactory[r].priority-n.registryFactory[t].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var n=this.getSortedBackends(),t=0;t<n.length;t++){var r=n[t],o=this.initializeBackend(r),a=o.asyncInit;if(a||o.success)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(n,t){var r=this.state.tensorInfo.get(t),o=r.backend,i=this.readSync(t);o.disposeData(t),r.backend=n,n.move(t,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(n,t){var r,o=this,i=null;if(null==t){if("function"!=typeof n)throw new Error("Please provide a function to tidy()");t=n}else{if("string"!=typeof n&&!(n instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=n}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(n,t,r){n();try{var o=r();return t(),o}catch(i){throw t(),i}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(n){var t=this.makeTensorFromDataId(n.dataId,n.shape,n.dtype);return this.addTapeNode(this.state.activeScope.name,{x:n},[t],function(o){return{x:function(){return o.toFloat()}}},[]),t},e.prototype.runKernel=function(n,t,r,o,i){return this.runKernelFunc(null,t,null,n,r,o,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(n,t,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+="complex64"===u.dtype?3:1});var s=o-t-i-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+n+"'")},e.prototype.runKernelFunc=function(n,t,r,o,i,a,s){var u,c=this;void 0===a&&(a=[]),void 0===s&&(s=[]);var l=[],d=this.isTapeOn();null==o&&(o=null!=this.state.activeScope?this.state.activeScope.name:"");var f,h=function(b){d&&(l=b.map(function(C){return c.keep(c.clone(C))}))},p=this.state.numBytes,m=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var v,y=ZT(o,this.backendName);return f=null!=y?function(){var b=c.backend.numDataIds();v=y.kernelFunc({inputs:t,attrs:i,backend:c.backend});var C=Array.isArray(v)?v:[v];c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(o,b,C);var x=C.map(function(I){return c.makeTensorFromDataId(I.dataId,I.shape,I.dtype)}),E=x.filter(function(I,N){return s[N]});return h((a||[]).slice().concat(E)),x}:function(){var b=c.backend.numDataIds();v=c.tidy(function(){return n(c.backend,h)});var C=Array.isArray(v)?v:[v];return c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(o,b,C),C},this.scopedRun(function(){return c.state.kernelDepth++},function(){return c.state.kernelDepth--},function(){u=c.ENV.getBool("DEBUG")?c.profiler.profileKernel(o,t,function(){return f()}):f()}),d&&this.addTapeNode(o,t,u,r,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-m,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map(function(b){return t[b].shape}),outputShapes:u.map(function(b){return b.shape})}),Array.isArray(v)?u:u[0]},e.prototype.makeTensor=function(n,t,r,o){if(null==n)throw new Error("Values passed to engine.makeTensor() are null");o=o||this.backend;var i=n;"string"===(r=r||"float32")&&Ha(n[0])&&(i=n.map(function(l){return lR(l)}));var a=o.write(i,t,r),s=new kt(t,r,a,this.nextTensorId());if(this.incRef(s,o),"string"===r){var u=this.state.tensorInfo.get(a),c=sR(i);this.state.numBytes+=c-u.bytes,u.bytes=c}return s},e.prototype.makeTensorFromDataId=function(n,t,r,o){var i=new kt(t,r=r||"float32",n,this.nextTensorId());return this.incRef(i,o),i},e.prototype.makeVariable=function(n,t,r,o){void 0===t&&(t=!0),r=r||this.nextVariableId().toString(),null!=o&&o!==n.dtype&&(n=n.asType(o));var i=new Lc(n,t,r,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(n,t){var r=this.state.tensorInfo.has(n.dataId)?this.state.tensorInfo.get(n.dataId).refCount:0;if(this.state.numTensors++,"string"===n.dtype&&this.state.numStringTensors++,0===r){this.state.numDataBuffers++;var o=0;"complex64"!==n.dtype&&"string"!==n.dtype&&(o=n.size*N0(n.dtype)),this.state.tensorInfo.set(n.dataId,{backend:t||this.backend,dtype:n.dtype,shape:n.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(n.dataId).refCount++,n instanceof Lc||this.track(n)},e.prototype.disposeTensor=function(n){if(this.state.tensorInfo.has(n.dataId)){this.state.numTensors--,"string"===n.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(n.dataId);t.refCount<=1?("complex64"!==n.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(n.dataId),this.state.tensorInfo.delete(n.dataId)):this.state.tensorInfo.get(n.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var n in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[n])},e.prototype.disposeVariable=function(n){this.disposeTensor(n),null!=this.state.registeredVariables[n.name]&&delete this.state.registeredVariables[n.name]},e.prototype.memory=function(){var n=this.backend.memory();return n.numTensors=this.state.numTensors,n.numDataBuffers=this.state.numDataBuffers,n.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(n.unreliable=!0,null==n.reasons&&(n.reasons=[]),n.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),n},e.prototype.profile=function(n){return he(this,void 0,void 0,function(){var t,r;return pe(this,function(o){return this.state.profiling=!0,t=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=n(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},e.prototype.addTapeNode=function(n,t,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:n,inputs:t,outputs:r,saved:i},u=function r8(e){return af.get(e)}(n);null!=u&&(o=u.gradFunc),null!=o&&(s.gradient=function(c){return c=c.map(function(l,d){if(null==l){var f=r[d],h=Oc(f.size,f.dtype);return a.makeTensor(h,f.shape,f.dtype)}return l}),o(c.length>1?c:c[0],i)}),this.state.activeTape.push(s)},e.prototype.keep=function(n){return n.kept=!0,n},e.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(n){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};n&&(t.name=n),this.state.scopeStack.push(t),this.state.activeScope=t},e.prototype.endScope=function(n){for(var t=this,r=z0(n),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||t.track(u)})},e.prototype.gradients=function(n,t,r,o){var i=this;if(void 0===o&&(o=!1),A(t.length>0,function(){return"gradients() received an empty list of xs."}),null!=r&&"float32"!==r.dtype)throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",n)});A(a instanceof kt,function(){return"The result y returned by f() must be a tensor."});var s=function(u,c,l){for(var d={},f={},h=0;h<c.length;h++)d[c[h].id]=!0;for(h=0;h<u.length;h++){var p=(I=u[h]).inputs;for(var m in p){for(var v=p[m],y=!1,b=0;b<c.length;b++)if(d[v.id]){I.outputs.forEach(function(T){return d[T.id]=!0}),y=!0,f[I.id]=!0;break}if(y)break}}var C={};C[l.id]=!0;var x={};for(h=u.length-1;h>=0;h--)for(p=(I=u[h]).inputs,b=0;b<I.outputs.length;b++)if(C[I.outputs[b].id]){for(var m in p)C[p[m].id]=!0,x[I.id]=!0;break}var E=[];for(h=0;h<u.length;h++){var I;if(f[(I=u[h]).id]&&x[I.id]){var N={};for(var m in I.inputs){var R=I.inputs[m];d[R.id]&&(N[m]=R)}var M=Object.assign({},I);M.inputs=N,M.outputs=I.outputs,E.push(M)}}return E}(this.state.activeTape,t,a);if(!o&&0===s.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,c,l={};l[a.id]=r??(c=P0(ge(u=a.shape),"float32"),F.makeTensor(c,u,"float32")),function(f,h,p){for(var m=function(y){var b=h[y],C=[];if(b.outputs.forEach(function(N){var R=f[N.id];C.push(null!=R?R:null)}),null==b.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+b.kernelName+".");var x=b.gradient(C),E=function(N){if(!(N in x))throw new Error("Cannot backprop through input "+N+". Available gradients found: "+Object.keys(x)+".");var R=i.tidy(function(){return x[N]()});if("float32"!==R.dtype)throw new Error("Error in gradient for op "+b.kernelName+". The gradient of input "+N+" must have 'float32' dtype, but has '"+R.dtype+"'");var M=b.inputs[N];if(!hn(R.shape,M.shape))throw new Error("Error in gradient for op "+b.kernelName+". The gradient of input '"+N+"' has shape '"+R.shape+"', which does not match the shape of the input '"+M.shape+"'");if(null==f[M.id])f[M.id]=R;else{var T=f[M.id];f[M.id]=T.add(R),T.dispose()}};for(var I in b.inputs)E(I)},v=h.length-1;v>=0;v--)m(v)}(l,s);var d=t.map(function(f){return l[f.id]});return 0===i.state.gradientDepth&&(i.state.activeTape.forEach(function(f){for(var h=0,p=f.saved;h<p.length;h++)p[h].dispose()}),i.state.activeTape=null),{value:a,grads:d}})},e.prototype.customGrad=function(n){var t=this;return A(Wa(n),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];A(o.every(function(s){return s instanceof kt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,u){a[u]=s}),t.runKernelFunc(function(s,u){return A((r=n.apply(void 0,o.concat([u]))).value instanceof kt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),A(Wa(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var c=r.gradFunc(s,u),l=Array.isArray(c)?c:[c];A(l.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),A(l.every(function(f){return f instanceof kt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return l.forEach(function(f,h){d[h]=function(){return f}}),d})}},e.prototype.readSync=function(n){return this.state.tensorInfo.get(n).backend.readSync(n)},e.prototype.read=function(n){return this.state.tensorInfo.get(n).backend.read(n)},e.prototype.time=function(n){return he(this,void 0,void 0,function(){var t,r;return pe(this,function(o){switch(o.label){case 0:return t=Uo(),[4,this.backend.time(n)];case 1:return(r=o.sent()).wallMs=Uo()-t,[2,r]}})})},e.prototype.track=function(n){return null!=this.state.activeScope&&(n.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(n)),n},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var n in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new vR,this.registry)this.disposeRegisteredKernels(n),this.registry[n].dispose(),delete this.registry[n];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),F=function(){var e=function(){if(null==$0){var t=void 0;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else{if(typeof self>"u")throw new Error("Could not find a global object");t=self}$0=t}return $0}();if(null==e._tfengine){var n=new t8(e);e._tfengine=new c8(n)}return YT=e._tfengine.ENV,di=function(){return e._tfengine},e._tfengine}();function yR(){return typeof window<"u"&&null!=window.document||typeof WorkerGlobalScope<"u"}var Qi=H();Qi.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Qi.registerFlag("IS_BROWSER",function(){return yR()}),Qi.registerFlag("IS_NODE",function(){return typeof process<"u"&&void 0!==process.versions&&void 0!==process.versions.node}),Qi.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Qi.registerFlag("PROD",function(){return!1}),Qi.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Qi.getBool("DEBUG")}),Qi.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Qi.registerFlag("IS_TEST",function(){return!1});var hf,Zr,Qr,zs={},G0={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function wR(e,n){zs[e]=n}function fi(e){e in zs||(zs[e]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&2===o)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete zs[t]},!1),1===t?r.getContext("webgl",G0)||r.getContext("experimental-webgl",G0):r.getContext("webgl2",G0)}(e));var n=zs[e];return n.isContextLost()?(delete zs[e],fi(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),zs[e])}function Og(e,n){return[n,e]}function pf(e){var n=ge(e);return Fg(Math.ceil(n/4))}function gf(e,n){return[Math.max(1,Math.ceil(n/2)),Math.max(1,Math.ceil(e/2))]}function q0(e,n){var t,r,o,i,a,s,u,c,l,d=e;return 2===H().getNumber("WEBGL_VERSION")?(t=d.R32F,r=d.R16F,o=d.RGBA16F,i=d.RGBA32F,a=d.RED,s=4,u=1,c=d.HALF_FLOAT,l=d.FLOAT):(t=e.RGBA,r=e.RGBA,o=e.RGBA,i=d.RGBA,a=e.RGBA,s=4,u=4,c=null!=n?n.HALF_FLOAT_OES:null,l=e.FLOAT),{internalFormatFloat:t,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function de(e,n,t){var r=t();return n&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+xR(o,i))}(e),r}function bR(e){return!!(H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function xR(e,n){switch(n){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+n}}function mf(e,n,t){return Ji(e,n,function(){return e.getExtension(t)},'Extension "'+t+'" not supported on this browser.')}function CR(e,n,t){var r=Ji(e,n,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(de(e,n,function(){return e.shaderSource(r,t)}),de(e,n,function(){return e.compileShader(r)}),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function _R(e,n,t){var r=Ji(e,n,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(de(e,n,function(){return e.shaderSource(r,t)}),de(e,n,function(){return e.compileShader(r)}),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw function(o,i){var a=f8.exec(i);if(null==a)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],u=o.split("\n"),c=u.length.toString().length+2,l=u.map(function(v,y){return Ws((y+1).toString(),c)+v}),d=0,f=0;f<l.length;f++)d=Math.max(l[f].length,d);var h=l.slice(0,s-1),p=l.slice(s-1,s),m=l.slice(s);console.log(h.join("\n")),console.log(i.split("\n")[0]),console.log("%c "+Ws(p[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(m.join("\n"))}(t,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(hf||(hf={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Zr||(Zr={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Qr||(Qr={}));var Lg,Bg,f8=/ERROR: [0-9]+:([0-9]+):/g;function DR(e,n){return Ji(e,n,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function ER(e,n,t){if(de(e,n,function(){return e.linkProgram(t)}),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function Vg(e,n,t){if(de(e,n,function(){return e.validateProgram(t)}),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function IR(e,n,t){var r=Ji(e,n,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return de(e,n,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),de(e,n,function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)}),r}function SR(e,n,t){var r=Ji(e,n,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return de(e,n,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),de(e,n,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)}),r}function AR(e,n){return Ji(e,n,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function MR(e,n){var t=H().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||n<=0){var r="["+e+"x"+n+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>t||n>t)throw r="["+e+"x"+n+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+t+"x"+t+"].")}function TR(e,n){return Ji(e,n,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function X0(e,n,t,r,o,i,a,s){var u=e.getAttribLocation(t,r);return-1!==u&&(de(e,n,function(){return e.bindBuffer(e.ARRAY_BUFFER,o)}),de(e,n,function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,a,s)}),de(e,n,function(){return e.enableVertexAttribArray(u)}),!0)}function RR(e,n,t,r){OR(e,r),de(e,n,function(){return e.activeTexture(e.TEXTURE0+r)}),de(e,n,function(){return e.bindTexture(e.TEXTURE_2D,t)})}function NR(e,n,t,r){return Ji(e,n,function(){return e.getUniformLocation(t,r)},'uniform "'+r+'" not present in program.')}function kR(e,n,t){return e.getUniformLocation(n,t)}function FR(e,n,t,r,o,i){de(e,n,function(){return RR(e,n,r,i)}),de(e,n,function(){return e.uniform1i(o,i)})}function Ug(e,n,t,r){de(e,n,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),de(e,n,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)})}function K0(e,n,t){de(e,n,function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)}),de(e,n,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function vf(e){var n=e.checkFramebufferStatus(e.FRAMEBUFFER);if(n!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+PR(e,n))}function PR(e,n){switch(n){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+n}}function Ji(e,n,t,r){var o=de(e,n,function(){return t()});if(null==o)throw new Error(r);return o}function OR(e,n){var t=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=n+e.TEXTURE0;if(r<e.TEXTURE0||r>t)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+t+"].")}function yf(e,n){return void 0===n&&(n=2),ge(e.slice(0,e.length-n))}function wf(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function jg(e){var n=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(n=[yf(e)].concat(wf(e))),n}function LR(e,n){var t;void 0===n&&(n=!1);var r=H().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n&&(r*=2,1===(e=e.map(function(c,l){return l>=e.length-2?T0(e[l]):e[l]})).length&&(e=[2,e[0]])),2!==e.length){var o=ja(e);e=o.newShape}var i=ge(e);if(e.length<=1&&i<=r)return[1,i];if(2===e.length&&e[0]<=r&&e[1]<=r)return e;if(3===e.length&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(n){var a=yf(e),s=2,u=2;return e.length&&(s=(t=wf(e))[0],u=t[1]),Fg(i=a*(s/2)*(u/2)).map(function(c){return 2*c})}return Fg(i)}function Hg(e){return e%2==0}function bf(e,n){if(hn(e=e.slice(-2),n=n.slice(-2))||!e.length||!n.length||0===e[0]||0===e[1]||0===n[0]||0===n[1])return!0;if(e.length!==n.length){var t=e.slice(-1)[0],r=n.slice(-1)[0];if(t===r||Hg(t)&&Hg(r)&&(1===e[0]||1===n[0]))return!0}return e[1]===n[1]&&Hg(e[0])&&Hg(n[0])}function BR(e){if(null==Lg){var n=fi(e);Lg=n.getParameter(n.MAX_TEXTURE_SIZE)}return Lg}function VR(e){if(null==Bg){var n=fi(e);Bg=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Bg)}function UR(e){if(0===e)return 0;var n=fi(e);return Jr(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Jr(n,"EXT_disjoint_timer_query")?1:0}function Jr(e,n){return null!=e.getExtension(n)}function Y0(e){try{if(null!=fi(e))return!0}catch{return!1}return!1}function jR(e){if(0===e)return!1;var n=fi(e);if(1===e){if(!Jr(n,"OES_texture_float"))return!1}else if(!Jr(n,"EXT_color_buffer_float"))return!1;return Z0(n)}function HR(e){if(0===e)return!1;var n=fi(e);if(1!==e){if(Jr(n,"EXT_color_buffer_float"))return Z0(n);if(Jr(n,"EXT_color_buffer_half_float")){var t=n.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=q0(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(n,t)}return!1}return!!Jr(n,"OES_texture_float")&&!!Jr(n,"WEBGL_color_buffer_float")&&Z0(n)}function Z0(e){var n=q0(e),t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatFloat,1,1,0,n.textureFormatFloat,n.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(t),e.deleteFramebuffer(r),o}function WR(e){return 2===e&&null!=fi(e).fenceSync}var h8=Object.freeze({callAndCheck:de,canBeRepresented:bR,getWebGLErrorMessage:xR,getExtensionOrThrow:mf,createVertexShader:CR,createFragmentShader:_R,createProgram:DR,linkProgram:ER,validateProgram:Vg,createStaticVertexBuffer:IR,createStaticIndexBuffer:SR,getNumChannels:function(){return 2===H().getNumber("WEBGL_VERSION")?1:4},createTexture:AR,validateTextureSize:MR,createFramebuffer:TR,bindVertexBufferToProgramAttribute:X0,bindTextureUnit:RR,unbindTextureUnit:function(e,n,t){OR(e,t),de(e,n,function(){return e.activeTexture(e.TEXTURE0+t)}),de(e,n,function(){return e.bindTexture(e.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:NR,getProgramUniformLocation:kR,bindTextureToProgramUniformSampler:FR,bindCanvasToFramebuffer:function(e,n){de(e,n,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),de(e,n,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),de(e,n,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},bindColorTextureToFramebuffer:Ug,unbindColorTextureFromFramebuffer:K0,validateFramebuffer:vf,getFramebufferErrorMessage:PR,getBatchDim:yf,getRowsCols:wf,getShapeAs3D:jg,getTextureShapeFromLogicalShape:LR,isReshapeFree:bf,getWebGLMaxTextureSize:BR,resetMaxTextureSize:function(){Lg=null},resetMaxTexturesInShader:function(){Bg=null},getMaxTexturesInShader:VR,getWebGLDisjointQueryTimerVersion:UR,hasExtension:Jr,isWebGLVersionEnabled:Y0,isCapableOfRenderingToFloatTexture:jR,isDownloadFloatTextureEnabled:HR,isWebGLFenceEnabled:WR}),Me=H();function zR(e){H().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function le(e,n){return F.tidy(e,n)}function Rr(e){z0(e).forEach(function(n){return n.dispose()})}function Wg(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];H().getBool("IS_TEST")||console.warn.apply(console,e)}function hi(e,n){var t=e;if(Bn(e))return"string"===n?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(t)||Bn(t)&&"string"!==n;)r.push(t.length),t=t[0];return Array.isArray(e)&&H().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],Array.isArray(i)||Bn(i)){A(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),A(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var u=a.slice(1),c=0;c<i.length;++c)o(i[c],u,s.concat(c))}else A(0===a.length,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"})}(e,r,[]),r}function $R(e,n,t,r){if(null!=e&&("numeric"!==e&&e!==n||"numeric"===e&&"string"===n))throw new Error("Argument '"+t+"' passed to '"+r+"' must be "+e+" tensor, but got "+n+" tensor")}function S(e,n,t,r){if(void 0===r&&(r="numeric"),e instanceof kt)return $R(r,e.dtype,n,t),e;var o=Pc(e);if("string"!==o&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),$R(r,o,n,t),null==e||!Bn(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("Argument '"+n+"' passed to '"+t+"' must be a Tensor or TensorLike, but got '"+(null==e?"null":e.constructor.name)+"'");var a=hi(e,o);Bn(e)||Array.isArray(e)||(e=[e]);var s="string"!==o?k0(e,o,H().getBool("DEBUG")):Zi(e,[],!0);return F.makeTensor(s,a,o)}function xf(e,n,t,r){if(void 0===r&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+n+" passed to "+t+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(o,i){return S(o,n+"["+i+"]",t)},r)}function Q0(e,n){for(var t=0;t<e.length;++t)if(e[e.length-t-1]!==n-1-t)return!1;return!0}function GR(e,n,t){for(var r=e.length+n.length,o=[],i=0,a=0,s=0;s<r;s++)-1===t.indexOf(s)?o.push(e[i++]):o.push(n[a++]);return o}function Vn(e,n){for(var t=[],r=e.length,o=0;o<r;o++)-1===n.indexOf(o)&&t.push(e[o]);return[t,n.map(function(i){return e[i]})]}function vr(e,n){return GR(e,n.map(function(t){return 1}),n)}function Nr(e,n,t){A(Q0(n,t),function(){return e+" supports only inner-most axes for now. Got axes "+n+" and rank-"+t+" input."})}function jo(e,n){if(Q0(e,n))return null;for(var t=[],r=0;r<n;++r)-1===e.indexOf(r)&&t.push(r);return e.forEach(function(o){return t.push(o)}),t}function zg(e){return e.map(function(n,t){return[t,n]}).sort(function(n,t){return n[1]-t[1]}).map(function(n){return n[0]})}function Ho(e,n){for(var t=[],r=n-e;r<n;++r)t.push(r);return t}function qR(e,n){var t=e[0].length;e.forEach(function(o,i){A(o.length===t,function(){return"Error in concat"+t+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+t+")"})}),A(n>=0&&n<t,function(){return"Error in concat"+t+"D: axis must be between 0 and "+(t-1)+"."});var r=e[0];e.forEach(function(o,i){for(var a=0;a<t;a++)A(a===n||o[a]===r[a],function(){return"Error in concat"+t+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function $s(e,n){for(var t=e[0].slice(),r=1;r<e.length;r++)t[n]+=e[r][n];return t}function P(e){var n=Object.keys(e);if(1!==n.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+n.length+" keys.");var t=n[0],r=e[t];t.endsWith("_")&&(t=t.substring(0,t.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];F.startScope(t);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),F.endScope(s),s}catch(u){throw F.endScope(null),u}};return Object.defineProperty(o,"name",{value:t,configurable:!0}),o}Me.registerFlag("HAS_WEBGL",function(){return Me.getNumber("WEBGL_VERSION")>0}),Me.registerFlag("WEBGL_VERSION",function(){return Y0(2)?2:Y0(1)?1:0}),Me.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return 2===Me.get("WEBGL_VERSION")}),Me.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Me.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Me.registerFlag("WEBGL_PACK",function(){return Me.getBool("HAS_WEBGL")}),Me.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Me.getBool("WEBGL_PACK")}),Me.registerFlag("WEBGL_PACK_CLIP",function(){return Me.getBool("WEBGL_PACK")}),Me.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Me.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Me.getBool("WEBGL_PACK")}),Me.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Me.getBool("WEBGL_PACK")}),Me.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Me.getBool("WEBGL_PACK")}),Me.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Me.getBool("WEBGL_PACK")}),Me.registerFlag("WEBGL_PACK_REDUCE",function(){return Me.getBool("WEBGL_PACK")}),Me.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Me.getBool("WEBGL_PACK")}),Me.registerFlag("WEBGL_CONV_IM2COL",function(){return Me.getBool("WEBGL_PACK")}),Me.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return BR(Me.getNumber("WEBGL_VERSION"))}),Me.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return VR(Me.getNumber("WEBGL_VERSION"))}),Me.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Me.getNumber("WEBGL_VERSION");return 0===e?0:UR(e)}),Me.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Me.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Me.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return jR(Me.getNumber("WEBGL_VERSION"))}),Me.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Me.getBool("WEBGL_FORCE_F16_TEXTURES")&&Me.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Me.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return HR(Me.getNumber("WEBGL_VERSION"))}),Me.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return WR(Me.getNumber("WEBGL_VERSION"))}),Me.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Me.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),pR=zR;var Un=P({complex_:function(e,n){var t=S(e,"real","complex"),r=S(n,"imag","complex");return ut(t.shape,r.shape,"real and imag shapes, "+t.shape+" and "+r.shape+", must match in call to tf.complex()."),F.runKernelFunc(function(o){return o.complex(t,r)},{$real:t,$imag:r})}}),Co=P({real_:function(e){var n=S(e,"input","real");return F.runKernelFunc(function(t){return t.real(n)},{$input:n})}}),pi=P({imag_:function(e){var n=S(e,"input","imag");return F.runKernelFunc(function(t){return t.imag(n)},{$input:n})}});function jn(e,n,t){return za(e,n,hi(e,t),t)}function za(e,n,t,r){if(null==r&&(r=Pc(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Bn(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=n){O0(n);var o=ge(n),i=ge(t);A(o===i,function(){return"Based on the provided shape, ["+n+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<t.length;++a){var u=a!==t.length-1||t[a]!==ge(n.slice(a));A(t[a]===n[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+t+") does not match the provided shape ("+n+"). "})}}return Bn(e)||Array.isArray(e)||(e=[e]),n=n||t,e="string"!==r?k0(e,r,H().getBool("DEBUG")):Zi(e,[],!0),F.makeTensor(e,n,r)}function ae(e,n){if((Bn(e)&&"string"!==n||Array.isArray(e))&&"complex64"!==n)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===n&&Bn(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return za(e,[],[],n)}function gn(e,n){Hs(e);var t=hi(e,n);if(1!==t.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return za(e,null,t,n)}function $a(e,n,t){if(Hs(e),null!=n&&2!==n.length)throw new Error("tensor2d() requires shape to have two numbers");var r=hi(e,t);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==n)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return za(e,n,r,t)}function J0(e,n,t){if(Hs(e),null!=n&&3!==n.length)throw new Error("tensor3d() requires shape to have three numbers");var r=hi(e,t);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==n)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return za(e,n,r,t)}function kr(e,n,t){if(Hs(e),null!=n&&4!==n.length)throw new Error("tensor4d() requires shape to have four numbers");var r=hi(e,t);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==n)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return za(e,n,r,t)}function Bc(e,n){if(void 0===n&&(n="float32"),"complex64"===n){var t=Bc(e,"float32"),r=zt(e,"float32");return Un(t,r)}var o=P0(ge(e),n);return F.makeTensor(o,e,n)}function zt(e,n){if(void 0===n&&(n="float32"),"complex64"===n){var t=zt(e,"float32"),r=zt(e,"float32");return Un(t,r)}var o=Oc(ge(e),n);return F.makeTensor(o,e,n)}function gi(e,n,t){return F.runKernelFunc(function(r){return r.fill(e,n,t)},{})}function $g(e,n,t,r){if(void 0===t&&(t=1),void 0===r&&(r="float32"),0===t)throw new Error("Cannot have a step of zero");if(e===n||e<n&&t<0||n<e&&t>1)return zt([0],r);var o=Oc(Math.abs(Math.ceil((n-e)/t)),r);n<e&&1===t&&(t=-1),o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+t;return gn(o,r)}var XR=P({onesLike_:function(e){var n=S(e,"x","onesLike");if("complex64"===n.dtype){var t=XR(Co(n)),r=ct(pi(n));return Un(t,r)}return F.runKernelFunc(function(o){return o.onesLike(n)},{$x:n},function(o,i){return{$x:function(){return ct(o)}}})}}),ct=P({zerosLike_:function(e){var n=S(e,"x","zerosLike");return F.runKernelFunc(function(t){return t.zerosLike(n)},{$x:n},function(t,r){return{$x:function(){return ct(t)}}})}}),Cn=P({concat_:function(e,n){void 0===n&&(n=0),A(e.length>=1,function(){return"Pass at least one tensor to concat"});var t=xf(e,"tensors","concat");"complex64"===t[0].dtype&&t.forEach(function(s){if("complex64"!==s.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+s.dtype+". ")}),n=pn(n,t[0].shape)[0];var r=$s(t.map(function(s){return s.shape}),n);if(0===ge(r))return jn([],r);if(1===(t=t.filter(function(s){return s.size>0})).length)return t[0];var o=t.map(function(s){return s.shape});return qR(o,n),F.runKernelFunc(function(s){return s.concat(t,n)},t,function(s){var u=o.map(function(c){return c[n]});return ex(s,u,n).map(function(c){return function(){return c}})},"Concat",{axis:n})}}),w8=P({concat1d_:function(e){return Cn(e,0)}}),b8=P({concat2d_:function(e,n){return Cn(e,n)}}),x8=P({concat3d_:function(e,n){return Cn(e,n)}}),C8=P({concat4d_:function(e,n){return Cn(e,n)}}),ex=P({split_:function(e,n,t){void 0===t&&(t=0);var r,o=S(e,"x","split");return t=pn(t,o.shape)[0],"number"==typeof n?(A(o.shape[t]%n==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(n).fill(o.shape[t]/n)):(A(o.shape[t]===n.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=n),F.runKernelFunc(function(i){return i.split(o,r,t)},{$x:o},function(i){return{$x:function(){return Cn(i,t)}}})}});function Gs(e,n){return e(n={exports:{}},n.exports),n.exports}typeof globalThis<"u"||typeof window<"u"||typeof global<"u"&&global;var _8=Gs(function(e){!function(n,t,r){function o(s){var u,c=this,l=(u=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var h=.02519603282416938*(u+=d.charCodeAt(f));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 2.3283064365386963e-10*(u>>>0)});c.next=function(){var d=2091639*c.s0+2.3283064365386963e-10*c.c;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=0|d)},c.c=1,c.s0=l(" "),c.s1=l(" "),c.s2=l(" "),c.s0-=l(s),c.s0<0&&(c.s0+=1),c.s1-=l(s),c.s1<0&&(c.s1+=1),c.s2-=l(s),c.s2<0&&(c.s2+=1),l=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var c=new o(s),l=u&&u.state,d=c.next;return d.int32=function(){return 4294967296*c.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,l&&("object"==typeof l&&i(l,c),d.state=function(){return i(c,{})}),d}t&&t.exports?t.exports=a:this.alea=a}(0,e)}),D8=Gs(function(e){!function(n,t,r){function o(s){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:c+=s;for(var l=0;l<c.length+64;l++)u.x^=0|c.charCodeAt(l),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do{var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152}while(0===f);return f},d.int32=c.next,d.quick=d,l&&("object"==typeof l&&i(l,c),d.state=function(){return i(c,{})}),d}t&&t.exports?t.exports=a:this.xor128=a}(0,e)}),E8=Gs(function(e){!function(n,t,r){function o(s){var u=this,c="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:c+=s;for(var l=0;l<c.length+64;l++)u.x^=0|c.charCodeAt(l),l==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do{var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152}while(0===f);return f},d.int32=c.next,d.quick=d,l&&("object"==typeof l&&i(l,c),d.state=function(){return i(c,{})}),d}t&&t.exports?t.exports=a:this.xorwow=a}(0,e)}),I8=Gs(function(e){!function(n,t,r){function o(s){var u=this;u.next=function(){var c,l,d=u.x,f=u.i;return c=d[f],l=(c^=c>>>7)^c<<24,l^=(c=d[f+1&7])^c>>>10,l^=(c=d[f+3&7])^c>>>3,l^=(c=d[f+4&7])^c<<7,c=d[f+7&7],l^=(c^=c<<13)^c<<9,d[f]=l,u.i=f+1&7,l},function(c,l){var d,f=[];if(l===(0|l))f[0]=l;else for(l=""+l,d=0;d<l.length;++d)f[7&d]=f[7&d]<<15^l.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&0===f[d];++d);for(8==d&&(f[7]=-1),c.x=f,c.i=0,d=256;d>0;--d)c.next()}(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){null==s&&(s=+new Date);var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do{var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152}while(0===f);return f},d.int32=c.next,d.quick=d,l&&(l.x&&i(l,c),d.state=function(){return i(c,{})}),d}t&&t.exports?t.exports=a:this.xorshift7=a}(0,e)}),S8=Gs(function(e){!function(n,t,r){function o(s){var u=this;u.next=function(){var c,l,d=u.w,f=u.X,h=u.i;return u.w=d=d+1640531527|0,l=f[h+34&127],c=f[h=h+1&127],l^=l<<13,c^=c<<17,l=f[h]=(l^=l>>>15)^(c^=c>>>12),u.i=h,l+(d^d>>>16)|0},function(c,l){var d,f,h,p,m,v=[],y=128;for(l===(0|l)?(f=l,l=null):(l+="\0",f=0,y=Math.max(y,l.length)),h=0,p=-32;p<y;++p)l&&(f^=l.charCodeAt((p+32)%l.length)),0===p&&(m=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,p>=0&&(h=0==(d=v[127&p]^=f+(m=m+1640531527|0))?h+1:0);for(h>=128&&(v[127&(l&&l.length||0)]=-1),h=127,p=512;p>0;--p)f=v[h+34&127],d=v[h=h+1&127],f^=f<<13,d^=d<<17,v[h]=(f^=f>>>15)^(d^=d>>>12);c.w=m,c.X=v,c.i=h}(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){null==s&&(s=+new Date);var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do{var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152}while(0===f);return f},d.int32=c.next,d.quick=d,l&&(l.X&&i(l,c),d.state=function(){return i(c,{})}),d}t&&t.exports?t.exports=a:this.xor4096=a}(0,e)}),A8=Gs(function(e){!function(n,t,r){function o(s){var u=this,c="";u.next=function(){var d=u.b,f=u.c,h=u.d,p=u.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^p,p=p-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-h|0,u.d=h<<16^f>>>16^p,u.a=p-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):c+=s;for(var l=0;l<c.length+20;l++)u.b^=0|c.charCodeAt(l),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var c=new o(s),l=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do{var f=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152}while(0===f);return f},d.int32=c.next,d.quick=d,l&&("object"==typeof l&&i(l,c),d.state=function(){return i(c,{})}),d}t&&t.exports?t.exports=a:this.tychei=a}(0,e)}),qs=Gs(function(e){!function(n,t){var r,o=this,i=256,s="random",u=t.pow(i,6),c=t.pow(2,52),l=2*c,d=i-1;function f(y,b,C){var x=[],E=m(function R(M,T){var L,O=[],q=typeof M;if(T&&"object"==q)for(L in M)try{O.push(R(M[L],T-1))}catch{}return O.length?O:"string"==q?M:M+"\0"}((b=1==b?{entropy:!0}:b||{}).entropy?[y,v(n)]:y??function(){try{var R;return r&&(R=r.randomBytes)?R=R(i):(R=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(R)),v(R)}catch{var M=o.navigator,T=M&&M.plugins;return[+new Date,o,T,o.screen,v(n)]}}(),3),x),I=new h(x),N=function(){for(var R=I.g(6),M=u,T=0;R<c;)R=(R+T)*i,M*=i,T=I.g(1);for(;R>=l;)R/=2,M/=2,T>>>=1;return(R+T)/M};return N.int32=function(){return 0|I.g(4)},N.quick=function(){return I.g(4)/4294967296},N.double=N,m(v(I.S),n),(b.pass||C||function(R,M,T,L){return L&&(L.S&&p(L,I),R.state=function(){return p(I,{})}),T?(t[s]=R,M):R})(N,E,"global"in b?b.global:this==t,b.state)}function h(y){var b,C=y.length,x=this,E=0,I=x.i=x.j=0,N=x.S=[];for(C||(y=[C++]);E<i;)N[E]=E++;for(E=0;E<i;E++)N[E]=N[I=d&I+y[E%C]+(b=N[E])],N[I]=b;(x.g=function(R){for(var M,T=0,L=x.i,O=x.j,q=x.S;R--;)M=q[L=d&L+1],T=T*i+q[d&(q[L]=q[O=d&O+M])+(q[O]=M)];return x.i=L,x.j=O,T})(i)}function p(y,b){return b.i=y.i,b.j=y.j,b.S=y.S.slice(),b}function m(y,b){for(var C,x=y+"",E=0;E<x.length;)b[d&E]=d&(C^=19*b[d&E])+x.charCodeAt(E++);return v(b)}function v(y){return String.fromCharCode.apply(0,y)}if(t["seed"+s]=f,m(t.random(),n),e.exports){e.exports=f;try{r=Xt(902)}catch{}}}([],Math)});qs.alea=_8,qs.xor128=D8,qs.xorwow=E8,qs.xorshift7=I8,qs.xor4096=S8,qs.tychei=A8;var Gg=qs.alea,tx=function(){function e(n,t,r,o,i){this.mean=n,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=Gg(a.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var n=this.nextVal;return this.nextVal=NaN,n}for(var t,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do{s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a}while(s>=1||0===s);var u=Math.sqrt(-2*Math.log(s)/s);t=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(t)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(t)},e.prototype.convertValue=function(n){return null==this.dtype||"float32"===this.dtype?n:Math.round(n)},e.prototype.isValidTruncated=function(n){return n<=this.upper&&n>=this.lower},e}(),M8=function(){function e(n,t,r,o){this.alpha=n,this.beta=1/t,this.dtype=r;var i=o||Math.random();this.randu=Gg(i.toString()),this.randn=new tx(0,1,r,!1,this.randu()),this.d=n<1?n+2/3:n-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var n,t,r,o,i,a;;){do{o=this.randn.nextValue(),a=1+this.c*o}while(a<=0);if(t=1-.331*(n=o*o)*n,r=.5*n+this.d*(1-(a*=a*a)+Math.log(a)),(i=this.randu())<t||Math.log(i)<r)break}return a*=1/this.beta*this.d,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},e.prototype.convertValue=function(n){return"float32"===this.dtype?n:Math.round(n)},e}(),T8=function(){function e(n,t,r,o){var i=this;if(void 0===n&&(n=0),void 0===t&&(t=1),this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=n,this.range=t-n,this.dtype=r,null==o&&(o=Math.random()),"number"==typeof o&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+n+" - "+t+" <= 1 and dtype is not float");this.random=Gg(o)}return e.prototype.convertValue=function(n){return this.canReturnFloat()?n:Math.round(n)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Oe(e,n,t){return void 0===n&&(n="float32"),n=n||"float32",O0(e),new ff(e,n,t)}var KR=P({batchToSpaceND_:function(e,n,t){var r=S(e,"x","batchToSpaceND"),o=n.reduce(function(i,a){return i*a});return A(r.rank>=1+n.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+n.length}),A(t.length===n.length,function(){return"crops.length is "+t.length+" but should be equal to blockShape.length  "+n.length}),A(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+n.join(" * ")+" === "+o}),F.runKernelFunc(function(i){return i.batchToSpaceND(r,n,t)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(n,t)}}})}}),N8=P({broadcastTo_:function(e,n){var t=S(e,"broadcastTo","x"),r=t.shape;if(n.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+n+"].");if(n.length<t.rank)throw new Error("broadcastTo(): shape.length="+n.length+" < input.rank="+t.rank+".");if(n.length>t.rank){for(var o=t.shape.slice();o.length<n.length;)o.unshift(1);t=t.reshape(o)}for(var i=Array.from(n),a=n.length-1;a>=0;a--)if(t.shape[a]===n[a])i[a]=1;else if(1!==t.shape[a])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+n+"].");var s=i.map(function(u,c){return u>1?c:-1}).filter(function(u){return u>=0});return 0===s.length?t.clone():F.runKernelFunc(function(u){return u.tile(t,i)},{input:t},function(u){return{input:function(){return u.sum(s,!0)}}})}}),k8=P({cast_:function(e,n){var t=S(e,"x","cast");if(!iR(n))throw new Error("Failed to cast to unknown dtype "+n);if("string"===n&&"string"!==t.dtype||"string"!==n&&"string"===t.dtype)throw new Error("Only strings can be casted to strings");return F.runKernelFunc(function(o){return o.cast(t,n)},{x:t},function(o){return{x:function(){return o.clone()}}},"Cast",{dtype:n})}}),F8=P({clone_:function(e){var n=S(e,"x","clone",null);return F.runKernelFunc(function(){return F.makeTensorFromDataId(n.dataId,n.shape,n.dtype)},{$x:n},function(t){return{$x:function(){return t.toFloat()}}})}}),P8=P({cumsum_:function(e,n,t,r){void 0===n&&(n=0),void 0===t&&(t=!1),void 0===r&&(r=!1);var o=S(e,"x","cumsum"),i=jo([n|=0],o.rank),a=o;null!=i&&(a=o.transpose(i));var s=Ho(1,o.rank)[0],u=F.runKernelFunc(function(c){return c.cumsum(a,s,t,r)},{permutedX:a},function(c){return{permutedX:function(){return c.cumsum(n,t,!r)}}});return null!=i&&(u=u.transpose(i)),u}}),O8=P({depthToSpace_:function(e,n,t){void 0===t&&(t="NHWC");var r=S(e,"x","depthToSpace"),o="NHWC"===t?r.shape[1]:r.shape[2],i="NHWC"===t?r.shape[2]:r.shape[3],a="NHWC"===t?r.shape[3]:r.shape[1];return A(o*n>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+n+"  for depthToSpace with input shape\n      "+r.shape}),A(i*n>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+n+" for depthToSpace with input shape\n          "+r.shape}),A(a%(n*n)==0,function(){return"Dimension size must be evenly divisible by "+n*n+" but is "+a+" for depthToSpace with input shape "+r.shape}),F.runKernelFunc(function(s){return s.depthToSpace(r,n,t)},{$x:r})}}),_o=P({expandDims_:function(e,n){void 0===n&&(n=0);var t=S(e,"x","expandDims",null);A(n<=t.rank,function(){return"Axis must be <= rank of the tensor"});var r=t.shape.slice();return n<0&&(A(-(t.rank+1)<=n,function(){return"Axis must be in the interval ["+-(t.rank+1)+", "+t.rank+"]"}),n=t.rank+n+1),r.splice(n,0,1),Wo(t,r)}}),YR=P({eye_:function(e,n,t,r){void 0===r&&(r="float32"),null==n&&(n=e);for(var o=Oe([e,n],r),i=e<=n?e:n,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(e,n);if(null==t)return s;if(1===t.length)return Vc(_o(s,0),[t[0],1,1]);if(2===t.length)return Vc(_o(_o(s,0),0),[t[0],t[1],1,1]);if(3===t.length)return Vc(_o(_o(_o(s,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+t.length+"D.")}}),L8=P({multinomial_:function(e,n,t,r){void 0===r&&(r=!1);var o=S(e,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);t=t||Math.random();var s=1===a?o.as2D(1,-1):o,u=F.runKernelFunc(function(c){return c.multinomial(s,r,n,t)},{logits2D:s});return 1===a?u.as1D():u}}),nx=P({oneHot_:function(e,n,t,r){if(void 0===t&&(t=1),void 0===r&&(r=0),n<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+n);var o=S(e,"indices","oneHot","int32"),i=o.shape.concat([n]);return o=o.flatten(),F.runKernelFunc(function(a){return a.oneHot(o,n,t,r)},{$indices:o},function(a){return{$indices:function(){return zt(o.shape,"float32")}}}).reshape(i)}}),Xs=P({pad_:function(e,n,t){void 0===t&&(t=0);var r=S(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return F.runKernelFunc(function(i){return i.pad(r,n,t)},{x:r},function(i){var a=n.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",{paddings:n,constantValue:t})}}),B8=P({pad1d_:function(e,n,t){return void 0===t&&(t=0),A(2===n.length,function(){return"Invalid number of paddings. Must be length of 2."}),Xs(e,[n],t)}}),V8=P({pad2d_:function(e,n,t){return void 0===t&&(t=0),A(2===n.length&&2===n[0].length&&2===n[1].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Xs(e,n,t)}}),U8=P({pad3d_:function(e,n,t){return void 0===t&&(t=0),A(3===n.length&&2===n[0].length&&2===n[1].length&&2===n[2].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Xs(e,n,t)}}),j8=P({pad4d_:function(e,n,t){return void 0===t&&(t=0),A(4===n.length&&2===n[0].length&&2===n[1].length&&2===n[2].length&&2===n[3].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Xs(e,n,t)}}),H8=P({rand_:function(e,n,t){var r=ge(e),o=null;if(null==t||"float32"===t)o=new Float32Array(r);else if("int32"===t)o=new Int32Array(r);else{if("bool"!==t)throw new Error("Unknown data type "+t);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=n();return F.makeTensor(o,e,t)}}),W8=P({randomNormal_:function(e,n,t,r,o){if(void 0===n&&(n=0),void 0===t&&(t=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new tx(n,t,r,!1,o),a=Oe(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),z8=P({randomGamma_:function(e,n,t,r,o){if(void 0===t&&(t=1),void 0===r&&(r="float32"),null==t&&(t=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new M8(n,t,r,o),a=Oe(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),ZR=P({randomUniform_:function(e,n,t,r,o){void 0===n&&(n=0),void 0===t&&(t=1),void 0===r&&(r="float32");for(var i=Oe(e,r),a=new T8(n,t,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),Wo=P({reshape_:function(e,n){var t=S(e,"x","reshape",null);return n=rR(n,t.size),A(t.size===ge(n),function(){return"new shape and old shape must have the same number of elements."}),F.runKernelFunc(function(o){return o.reshape(t,n)},{x:t},function(o){return{x:function(){return o.reshape(t.shape)}}},"Reshape",{shape:n})}}),QR=P({spaceToBatchND_:function(e,n,t){var r=S(e,"x","spaceToBatchND");return A(r.rank>=1+n.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+n.length}),A(t.length===n.length,function(){return"paddings.shape[0] "+t.length+" must be equal to [blockShape] "+n.length}),A(r.shape.reduce(function(o,i,a){return a>0&&a<=n.length?o&&(i+t[a-1][0]+t[a-1][1])%n[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+t.toString()+" must be divisible by blockShapes "+n.toString()}),F.runKernelFunc(function(o){return o.spaceToBatchND(r,n,t)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(n,t)}}})}}),JR=P({squeeze_:function(e,n){var t=S(e,"x","squeeze");return Wo(t,ja(t.shape,n).newShape)}}),eo=P({stack_:function(e,n){void 0===n&&(n=0);var t=xf(e,"tensors","stack");if(A(t.length>=1,function(){return"Pass at least one tensor to tf.stack"}),1===t.length)return t[0].expandDims(n);var o=t[0].shape,i=t[0].dtype;A(n<=t[0].rank,function(){return"Axis must be <= rank of the tensor"}),t.forEach(function(s){ut(o,s.shape,"All tensors passed to stack must have matching shapes")}),t.forEach(function(s){A(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=t.map(function(s){return s.expandDims(n)});return Cn(a,n)}}),Vc=P({tile_:function(e,n){var t=S(e,"x","tile",null);return A(t.rank===n.length,function(){return"Error in transpose: rank of input "+t.rank+" must match length of reps "+n+"."}),F.runKernelFunc(function(i,a){var s=i.tile(t,n);return a([t]),s},{x:t},function(i,a){var s=a[0];return{x:function(){var u=ct(s);if(1===s.rank)for(var c=0;c<n[0];++c)u=u.add(i.slice([c*s.shape[0]],[s.shape[0]]));else if(2===s.rank)for(c=0;c<n[0];++c)for(var l=0;l<n[1];++l)u=u.add(i.slice([c*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(3===s.rank)for(c=0;c<n[0];++c)for(l=0;l<n[1];++l)for(var d=0;d<n[2];++d)u=u.add(i.slice([c*s.shape[0],l*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(4!==s.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(c=0;c<n[0];++c)for(l=0;l<n[1];++l)for(d=0;d<n[2];++d)for(var f=0;f<n[3];++f)u=u.add(i.slice([c*s.shape[0],l*s.shape[1],d*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",{reps:n},[t])}}),$8=P({truncatedNormal_:function(e,n,t,r,o){if(void 0===n&&(n=0),void 0===t&&(t=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new tx(n,t,r,!0,o),a=Oe(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),_n=P({unstack_:function(e,n){void 0===n&&(n=0),n=n||0;var t=S(e,"x","unstack");return A(n>=-t.shape.length&&n<t.shape.length,function(){return"Axis = "+n+" is not in [-"+t.shape.length+", "+t.shape.length+")"}),n<0&&(n+=t.shape.length),F.runKernelFunc(function(o){return o.unstack(t,n)},{x:t},function(o){return{x:function(){return eo(o,n)}}},"Unpack",{axis:n})}});function qg(e,n,t,r){void 0===r&&(r=!0);var o=[];if(r)(o=o.concat(n.slice(0))).push(e[0]/t),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var i=n.length,a=0;a<i;++a)o=o.concat([e[a+1]/n[a],n[a]]);o=o.concat(e.slice(i+1))}return o}function Xg(e,n,t){void 0===t&&(t=!0);var r=[];if(t){r.push(n);for(var o=n+1;o<e;++o)o<=2*n?(r.push(o),r.push(o-(n+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<e;++o)o>=2*n+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function Kg(e,n,t,r){void 0===r&&(r=!0);var o=[];o.push(r?e[0]/t:e[0]*t);for(var i=1;i<e.length;++i)o.push(i<=n.length?r?n[i-1]*e[i]:e[i]/n[i-1]:e[i]);return o}function eN(e,n){for(var t=[0],r=0;r<n;++r)t.push(e[r][0]);return t}function tN(e,n,t){for(var r=e.slice(0,1),o=0;o<t;++o)r.push(e[o+1]-n[o][0]-n[o][1]);return r}function rx(e,n){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(n.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+n.rank+".");if("int32"!==n.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+n.dtype+".");if(n.shape[n.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+n.shape[n.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var t=n.shape,r=t[t.length-1],o=1,i=0;i<t.length-1;++i)o*=t[i];var a=e.shape,s=t.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=a[i],s.push(a[i]);var c=Vo(e.shape).map(function(l){return l/u}).concat([1]).slice(0,r);return[s,o,u,c]}function Yg(e){return e<=30?e:Pg(e,Math.floor(Math.sqrt(e)))}function nN(e,n,t){var r=n.rank>1?n.shape[n.rank-1]:1,o=n.rank>1?n.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+t.shape+", indices.shape: "+n.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(t.rank<o)throw new Error(i+" update.rank < "+o+". ");if(e.length<r+(t.rank-o))throw new Error(i+" Output shape length < "+(r+(t.rank-o)));if(t.rank!==o+e.length-r)throw new Error(i+" update.rank != "+(o+e.length-r));for(var a=0;a<o;++a)if(t.shape[a]!==n.shape[a])throw new Error(i+" updates.shape["+a+"] ("+t.shape[a]+") != indices.shape["+a+"] ("+n.shape[a]+").");for(a=0;a<t.rank-o;++a)if(t.shape[a+o]!==e[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+t.shape[a+o]+") != shape["+(a+o)+"] ("+e[a+o]+")")}function rN(e,n,t){if(n.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+n.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==n.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+n.dtype);if(t.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+t);if(0===t.length){if(0===n.size)throw new Error("Indices specified for empty output. indices shape: "+n.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}nN(t,n,e)}function Cf(e,n,t){for(var r=n.shape.length,o=r>1?n.shape[r-1]:1,i=t.length,a=1,s=o;s<i;++s)a*=t[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:ge(n.shape)/u,sliceSize:a,strides:Vo(t.slice(0,o)).concat([1]),outputSize:ge(t)}}function oN(e,n,t){A(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+n+" must match the rank of the array ("+e.rank+")."}),A(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of size "+t+" must match the rank of the array ("+e.rank+")."});for(var r=function(i){A(n[i]+t[i]<=e.shape[i],function(){return"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(n[i]+t[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")"})},o=0;o<e.rank;++o)r(o)}function ix(e){for(var n=[],t=0;e>0;)1&e&&n.push(t),e/=2,t++;return n}function Zg(e,n,t){for(var r=[],o=0;o<e.length;o++)r[o]=Math.ceil((n[o]-e[o])/t[o]);return r}function iN(e,n,t,r,o){var i=n[o];(e&1<<o||null==i)&&(i=(t[o]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),kg(0,i,s-1)}function aN(e,n,t,r,o){var i=n[o],a=t[o]||1;(e&1<<o||null==i)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),a>0?kg(0,i,s):kg(-1,i,s-1)}function ax(e,n,t){for(var r=t.length,o=0;o<t.length;o++)if(t[o]>1){r=o;break}for(o=r+1;o<t.length;o++)if(n[o]>0||t[o]!==e[o])return!1;return!0}function sx(e,n){for(var t=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)t+=e[r]*n[r];return t}function Qg(e){return F.customGrad(e)}Object.freeze({prepareAndValidate:rx}),Object.freeze({validateUpdateShape:nN,validateInput:rN,calculateShapes:Cf}),Object.freeze({assertParamsValid:oN,maskToAxes:ix,computeOutShape:Zg,startForAxis:iN,stopForAxis:aN,isSliceContinous:ax,computeFlatOffset:sx});var ea=P({softmax_:function(e,n){void 0===n&&(n=-1);var t=S(e,"logits","softmax","float32");if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and dim was "+n);return F.runKernelFunc(function(r,o){var i=r.softmax(t,n);return o([i]),i},{logits:t},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([n],!0).mul(i))}}},"Softmax",{dim:n},[],[!0])}}),X8=P({logSoftmax_:function(e,n){void 0===n&&(n=-1);var t=S(e,"logits","logSoftmax");if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and axis was "+n);return Qg(function(r,o){var i=r.max(n,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(n,!0).log());return o([s]),{value:s,gradFunc:function(u,c){var l=c[0].exp();return u.sub(u.sum(n,!0).mul(l))}}})(t)}}),sN=function(){function e(n,t){this.backend=n,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(n){return this.data.has(n)||this.dataMover.moveData(this.backend,n),this.data.get(n)},e.prototype.set=function(n,t){this.dataIdsCount++,this.data.set(n,t)},e.prototype.has=function(n){return this.data.has(n)},e.prototype.delete=function(n){return this.dataIdsCount--,this.data.delete(n)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),uN=function(){function e(){}return e.prototype.time=function(n){return B("time")},e.prototype.read=function(n){return B("read")},e.prototype.readSync=function(n){return B("readSync")},e.prototype.numDataIds=function(){return B("numDataIds")},e.prototype.disposeData=function(n){return B("disposeData")},e.prototype.write=function(n,t,r){return B("write")},e.prototype.move=function(n,t,r,o){return B("move")},e.prototype.memory=function(){return B("memory")},e.prototype.floatPrecision=function(){return B("floatPrecision")},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.batchMatMul=function(n,t,r,o){return B("batchMatMul")},e.prototype.fusedBatchMatMul=function(n){return B("fusedBatchMatMul")},e.prototype.slice=function(n,t,r){return B("slice")},e.prototype.stridedSlice=function(n,t,r,o){return B("stridedSlice")},e.prototype.unstack=function(n,t){return B("unstack")},e.prototype.reverse=function(n,t){return B("reverse")},e.prototype.concat=function(n,t){return B("concat")},e.prototype.neg=function(n){return B("neg")},e.prototype.add=function(n,t){return B("add")},e.prototype.addN=function(n){return B("addN")},e.prototype.subtract=function(n,t){return B("subtract")},e.prototype.multiply=function(n,t){return B("multiply")},e.prototype.realDivide=function(n,t){return B("realDivide")},e.prototype.floorDiv=function(n,t){return B("floorDiv")},e.prototype.sum=function(n,t){return B("sum")},e.prototype.prod=function(n,t){return B("prod")},e.prototype.unsortedSegmentSum=function(n,t,r){return B("unsortedSegmentSum")},e.prototype.argMin=function(n,t){return B("argMin")},e.prototype.argMax=function(n,t){return B("argMax")},e.prototype.equal=function(n,t){return B("equal")},e.prototype.notEqual=function(n,t){return B("notEqual")},e.prototype.less=function(n,t){return B("less")},e.prototype.lessEqual=function(n,t){return B("lessEqual")},e.prototype.greater=function(n,t){return B("greater")},e.prototype.greaterEqual=function(n,t){return B("greaterEqual")},e.prototype.logicalNot=function(n){return B("logicalNot")},e.prototype.logicalAnd=function(n,t){return B("logicalAnd")},e.prototype.logicalOr=function(n,t){return B("logicalOr")},e.prototype.where=function(n){return B("where")},e.prototype.select=function(n,t,r){return B("select")},e.prototype.topk=function(n,t,r){return B("topk")},e.prototype.min=function(n,t){return B("min")},e.prototype.minimum=function(n,t){return B("minimum")},e.prototype.mod=function(n,t){return B("mod")},e.prototype.max=function(n,t){return B("max")},e.prototype.maximum=function(n,t){return B("maximum")},e.prototype.all=function(n,t){return B("all")},e.prototype.any=function(n,t){return B("any")},e.prototype.squaredDifference=function(n,t){return B("squaredDifference")},e.prototype.ceil=function(n){return B("ceil")},e.prototype.floor=function(n){return B("floor")},e.prototype.round=function(n){return B("round")},e.prototype.sign=function(n){return B("sign")},e.prototype.isNaN=function(n){return B("isNaN")},e.prototype.isInf=function(n){return B("isInf")},e.prototype.isFinite=function(n){return B("isFinite")},e.prototype.pow=function(n,t){return B("pow")},e.prototype.exp=function(n){return B("exp")},e.prototype.expm1=function(n){return B("expm1")},e.prototype.softmax=function(n,t){return B("softmax")},e.prototype.log=function(n){return B("log")},e.prototype.log1p=function(n){return B("log1p")},e.prototype.sqrt=function(n){return B("sqrt")},e.prototype.rsqrt=function(n){return B("rsqrt")},e.prototype.square=function(n){return B("square")},e.prototype.reciprocal=function(n){return B("reciprocal")},e.prototype.relu=function(n){return B("relu")},e.prototype.relu6=function(n){return B("relu6")},e.prototype.prelu=function(n,t){return B("prelu")},e.prototype.elu=function(n){return B("elu")},e.prototype.eluDer=function(n,t){return B("eluDer")},e.prototype.selu=function(n){return B("selu")},e.prototype.int=function(n){return B("int")},e.prototype.clip=function(n,t,r){return B("clip")},e.prototype.abs=function(n){return B("abs")},e.prototype.complexAbs=function(n){return B("complexAbs")},e.prototype.sigmoid=function(n){return B("sigmoid")},e.prototype.softplus=function(n){return B("softplus")},e.prototype.sin=function(n){return B("sin")},e.prototype.cos=function(n){return B("cos")},e.prototype.tan=function(n){return B("tan")},e.prototype.asin=function(n){return B("asin")},e.prototype.acos=function(n){return B("acos")},e.prototype.atan=function(n){return B("atan")},e.prototype.atan2=function(n,t){return B("atan2")},e.prototype.sinh=function(n){return B("sinh")},e.prototype.cosh=function(n){return B("cosh")},e.prototype.tanh=function(n){return B("tanh")},e.prototype.asinh=function(n){return B("asinh")},e.prototype.acosh=function(n){return B("acosh")},e.prototype.atanh=function(n){return B("atanh")},e.prototype.erf=function(n){return B("erf")},e.prototype.step=function(n,t){return B("step")},e.prototype.fusedConv2d=function(n){return B("fusedConv2d")},e.prototype.conv2d=function(n,t,r){return B("conv2d")},e.prototype.conv2dDerInput=function(n,t,r){return B("conv2dDerInput")},e.prototype.conv2dDerFilter=function(n,t,r){return B("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(n){return B("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(n,t,r){return B("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(n,t,r){return B("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(n,t,r){return B("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(n,t,r){return B("conv3d")},e.prototype.conv3dDerInput=function(n,t,r){return B("conv3dDerInput")},e.prototype.conv3dDerFilter=function(n,t,r){return B("conv3dDerFilter")},e.prototype.maxPool=function(n,t){return B("maxPool")},e.prototype.maxPoolBackprop=function(n,t,r,o){return B("maxPoolBackprop")},e.prototype.avgPool=function(n,t){return B("avgPool")},e.prototype.avgPoolBackprop=function(n,t,r){return B("avgPoolBackprop")},e.prototype.avgPool3d=function(n,t){return B("avgPool3d")},e.prototype.avgPool3dBackprop=function(n,t,r){return B("avgPool3dBackprop")},e.prototype.maxPool3d=function(n,t){return B("maxPool3d")},e.prototype.maxPool3dBackprop=function(n,t,r,o){return B("maxPool3dBackprop")},e.prototype.reshape=function(n,t){return B("reshape")},e.prototype.cast=function(n,t){return B("cast")},e.prototype.tile=function(n,t){return B("tile")},e.prototype.pad=function(n,t,r){return B("pad")},e.prototype.transpose=function(n,t){return B("transpose")},e.prototype.gather=function(n,t,r){return B("gather")},e.prototype.gatherND=function(n,t){return B("gatherND")},e.prototype.scatterND=function(n,t,r){return B("scatterND")},e.prototype.batchToSpaceND=function(n,t,r){return B("batchToSpaceND")},e.prototype.spaceToBatchND=function(n,t,r){return B("spaceToBatchND")},e.prototype.resizeBilinear=function(n,t,r,o){return B("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(n,t,r){return B("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(n,t,r,o){return B("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(n,t,r){return B("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(n,t,r,o,i,a){return B("batchNormalization")},e.prototype.localResponseNormalization4D=function(n,t,r,o,i){return B("localResponseNormalization4D")},e.prototype.LRNGrad=function(n,t,r,o,i,a,s){return B("LRNGrad")},e.prototype.multinomial=function(n,t,r,o){return B("multinomial")},e.prototype.oneHot=function(n,t,r,o){return B("oneHot")},e.prototype.cumsum=function(n,t,r,o){return B("cumsum")},e.prototype.nonMaxSuppression=function(n,t,r,o,i){return B("nonMaxSuppression")},e.prototype.fft=function(n){return B("fft")},e.prototype.ifft=function(n){return B("ifft")},e.prototype.complex=function(n,t){return B("complex")},e.prototype.real=function(n){return B("real")},e.prototype.imag=function(n){return B("imag")},e.prototype.cropAndResize=function(n,t,r,o,i,a){return B("cropAndResize")},e.prototype.depthToSpace=function(n,t,r){return B("depthToSpace")},e.prototype.split=function(n,t,r){return B("split")},e.prototype.sparseToDense=function(n,t,r,o){return B("sparseToDense")},e.prototype.diag=function(n){return B("diag")},e.prototype.fill=function(n,t,r){return B("fill")},e.prototype.onesLike=function(n){return B("onesLike")},e.prototype.zerosLike=function(n){return B("zerosLike")},e.prototype.linspace=function(n,t,r){return B("linspace")},e.prototype.dispose=function(){return B("dispose")},e}();function B(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function ta(e,n){for(var t=e.length,r=[],o=0;o<t;o++){var i=t-1-o;(n[n.length-1-o]||1)>1&&1===(e[i]||1)&&r.unshift(i)}return r}function mn(e,n){for(var t=[],r=0;r<n.length;r++){var o=e[e.length-r-1],i=n.length-r-1;(null==o||1===o&&n[i]>1)&&t.unshift(i)}return t}function Ze(e,n){for(var t=[],r=Math.max(e.length,n.length),o=0;o<r;o++){var i=e[e.length-o-1];null==i&&(i=1);var a=n[n.length-o-1];if(null==a&&(a=1),1===i)t.unshift(a);else if(1===a)t.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+n+".");t.unshift(i)}}return t}function Uc(e,n,t,r,o,i,a){void 0===a&&(a="channelsLast");var s,u=em(n),c=u[0],l=u[1];if("channelsLast"===a)s=[c,l,e[3],e[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);s=[c,l,e[1],e[1]]}return Ga(e,s,t,r,o,i,!1,a)}function _f(e,n,t,r,o,i,a){void 0===a&&(a="NDHWC");var s,u,c=cx(n),l=c[0],d=c[1],f=c[2];if("NDHWC"===a)u="channelsLast",s=[l,d,f,e[4],e[4]];else{if("NCDHW"!==a)throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[l,d,f,e[1],e[1]]}return Df(e,s,t,r,o,!1,u,i)}function Ga(e,n,t,r,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],f=u[3];if("channelsLast"===s)c=e[0],l=e[1],d=e[2],f=e[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=e[0],f=e[1],l=e[2],d=e[3]}var h,p=n[0],m=n[1],v=n[3],y=em(t),b=y[0],C=y[1],x=em(r),E=x[0],I=x[1],N=jc(p,E),R=jc(m,I),M=function($,G,J,Y,X,ne,re,ce){var we,be,Xe;if("number"==typeof $){we={top:$,bottom:$,left:$,right:$,type:0===$?"VALID":"NUMBER"};var Ke=function(it,Tt,Ct,sn,en){null==sn&&(sn=ux(it,Tt,Ct));var Ci=it[1],_i=Ef((it[0]-Tt+2*sn)/Ct+1,en);A(Qt(_i),function(){return"The output # of rows ("+_i+") must be an integer. Change the stride and/or zero pad parameters"});var ro=Ef((Ci-Tt+2*sn)/Ct+1,en);return A(Qt(ro),function(){return"The output # of columns ("+ro+") must be an integer. Change the stride and/or zero pad parameters"}),[_i,ro]}([G,J],ne,Y,$,ce);be=Ke[0],Xe=Ke[1]}else if("same"===$){be=Math.ceil(G/Y),Xe=Math.ceil(J/X);var et=Math.max(0,(be-1)*Y+ne-G),lt=Math.max(0,(Xe-1)*X+re-J),ot=Math.floor(et/2),dt=et-ot,ln=Math.floor(lt/2);we={top:ot,bottom:dt,left:ln,right:lt-ln,type:"SAME"}}else{if("valid"!==$)throw Error("Unknown padding parameter: "+$);we={top:0,bottom:0,left:0,right:0,type:"VALID"},be=Math.ceil((G-ne+1)/Y),Xe=Math.ceil((J-re+1)/X)}return{padInfo:we,outHeight:be,outWidth:Xe}}(o,l,d,b,C,N,R,i),L=M.outHeight,O=M.outWidth,q=a?v*f:v;return"channelsFirst"===s?h=[c,q,L,O]:"channelsLast"===s&&(h=[c,L,O,q]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:d,inChannels:f,outHeight:L,outWidth:O,outChannels:q,padInfo:M.padInfo,strideHeight:b,strideWidth:C,filterHeight:p,filterWidth:m,effectiveFilterHeight:N,effectiveFilterWidth:R,dilationHeight:E,dilationWidth:I,inShape:e,outShape:h,filterShape:n}}function Df(e,n,t,r,o,i,a,s){void 0===i&&(i=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],f=u[3],h=u[4];if("channelsLast"===a)c=e[0],l=e[1],d=e[2],f=e[3],h=e[4];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);c=e[0],h=e[1],l=e[2],d=e[3],f=e[4]}var p,m=n[0],v=n[1],y=n[2],b=n[4],C=cx(t),x=C[0],E=C[1],I=C[2],N=cx(r),R=N[0],M=N[1],T=N[2],L=jc(m,R),O=jc(v,M),q=jc(y,T),$=function(re,ce,we,be,Xe,Ke,et,lt,ot,dt,ln){var it,Tt,Ct,sn;if("number"==typeof re){it={top:re,bottom:re,left:re,right:re,front:re,back:re,type:0===re?"VALID":"NUMBER"};var en=function(rl,fa,jC,ol,Di,HC){null==Di&&(Di=ux(rl,fa,ol));var eQ=rl[1],tQ=rl[2],WC=Ef((rl[0]-fa+2*Di)/ol+1,HC);A(Qt(WC),function(){return"The output # of depths ("+WC+") must be an integer. Change the stride and/or zero pad parameters"});var zC=Ef((eQ-fa+2*Di)/ol+1,HC);A(Qt(zC),function(){return"The output # of rows ("+zC+") must be an integer. Change the stride and/or zero pad parameters"});var $C=Ef((tQ-fa+2*Di)/ol+1,HC);return A(Qt($C),function(){return"The output # of columns ("+$C+") must be an integer. Change the stride and/or zero pad parameters"}),[WC,zC,$C,1]}([ce,we,be,1],lt,0,Xe,re,ln);Tt=en[0],Ct=en[1],sn=en[2]}else if("same"===re){var tn=((Tt=Math.ceil(ce/Xe))-1)*Xe+lt-ce,Ci=((Ct=Math.ceil(we/Ke))-1)*Ke+ot-we,_i=((sn=Math.ceil(be/et))-1)*et+dt-be,ro=Math.floor(tn/2),nl=tn-ro,la=Math.floor(Ci/2),ts=Ci-la,da=Math.floor(_i/2);it={top:la,bottom:ts,left:da,right:_i-da,front:ro,back:nl,type:"SAME"}}else{if("valid"!==re)throw Error("Unknown padding parameter: "+re);it={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Tt=Math.ceil((ce-lt+1)/Xe),Ct=Math.ceil((we-ot+1)/Ke),sn=Math.ceil((be-dt+1)/et)}return{padInfo:it,outDepth:Tt,outHeight:Ct,outWidth:sn}}(o,l,d,f,x,E,I,L,O,q,s),J=$.outDepth,Y=$.outHeight,X=$.outWidth,ne=i?b*h:b;return"channelsFirst"===a?p=[c,ne,J,Y,X]:"channelsLast"===a&&(p=[c,J,Y,X,ne]),{batchSize:c,dataFormat:a,inDepth:l,inHeight:d,inWidth:f,inChannels:h,outDepth:J,outHeight:Y,outWidth:X,outChannels:ne,padInfo:$.padInfo,strideDepth:x,strideHeight:E,strideWidth:I,filterDepth:m,filterHeight:v,filterWidth:y,effectiveFilterDepth:L,effectiveFilterHeight:O,effectiveFilterWidth:q,dilationDepth:R,dilationHeight:M,dilationWidth:T,inShape:e,outShape:p,filterShape:n}}function ux(e,n,t,r){void 0===r&&(r=1);var o=jc(n,r);return Math.floor((e[0]*(t-1)-t+o)/2)}function em(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function cx(e){return"number"==typeof e?[e,e,e]:e}function jc(e,n){return n<=1?e:e+(e-1)*(n-1)}function Ef(e,n){if(!n)return e;switch(n){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+n)}}function Ks(e){var n=em(e);return 1===n[0]&&1===n[1]&&1===n[2]}function yr(e,n){return Ks(e)||Ks(n)}function tm(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function lx(e,n,t){if("complex64"===n){if("complex64"===e.dtype)return e.clone();var r=zt(e.shape),o=e.toFloat(),i=t.complex(o,r);return r.dispose(),o.dispose(),i}if(!aR(e.dtype,n))return F.makeTensorFromDataId(e.dataId,e.shape,n);if("complex64"===e.dtype){var a=t.real(e);return i=a.cast(n),a.dispose(),i}if("int32"===n)return t.int(e);if("bool"===n){var s=ae(0,e.dtype);return i=t.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+n)}function nm(e,n){return F.makeTensorFromDataId(e.dataId,n,e.dtype)}function dx(e,n,t){var r=(n-e)/(t-1),o=Oc(t,"float32");o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return gn(o,"float32")}function fx(e,n){if(e.length!==n.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+n.length+".");for(var t=new Float32Array(2*e.length),r=0;r<t.length;r+=2)t[r]=e[r/2],t[r+1]=n[r/2];return t}function cN(e,n){return{real:e[2*n],imag:e[2*n+1]}}function K8(e,n,t,r){e[2*r]=n,e[2*r+1]=t}function Y8(e,n,t){var r=(t?2:-2)*Math.PI*(e/n);return{real:Math.cos(r),imag:Math.sin(r)}}function Z8(e,n,t){var r=function(u,c,l){for(var d=0,f=u.length,h=0,p=!1;d<f;){var m=l(c,u[h=d+(f-d>>>1)]);m>0?d=h+1:(f=h,p=!m)}return p?d:-d-1}(e,n,t||Q8);e.splice(r<0?-(r+1):r,0,n)}function Q8(e,n){return e>n?1:e<n?-1:0}function hx(e,n,t,r,o){return lN(e,n,t,r,o,0).selectedIndices}function px(e,n,t,r,o,i){var a=lN(e,n,t,r,o,i,!0);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function lN(e,n,t,r,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);for(var u=Array.from(n).map(function(x,E){return{score:x,boxIndex:E,suppressBeginIndex:0}}).filter(function(x){return x.score>o}).sort(dN),c=i>0?-.5/i:0,l=[],d=[];l.length<t&&u.length>0;){var f=u.pop(),h=f.score,p=f.boxIndex,m=f.suppressBeginIndex;if(h<o)break;for(var v=!1,y=l.length-1;y>=m;--y){var b=J8(e,p,l[y]);if(b>=r){v=!0;break}if(f.score=f.score*eq(r,c,b),f.score<=o)break}f.suppressBeginIndex=l.length,v||(f.score===h?(l.push(p),d.push(f.score)):f.score>o&&Z8(u,f,dN))}var C=l.length;return s&&(l.fill(0,C),d.fill(0,C)),{selectedIndices:gn(l,"int32"),selectedScores:gn(d,"float32"),numValidOutputs:ae(C,"int32")}}function J8(e,n,t){var r=e.subarray(4*n,4*n+4),o=e.subarray(4*t,4*t+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),h=(s-i)*(u-a),p=(d-c)*(f-l);if(h<=0||p<=0)return 0;var m=Math.max(i,c),v=Math.max(a,l),y=Math.min(s,d),b=Math.min(u,f),C=Math.max(y-m,0)*Math.max(b-v,0);return C/(h+p-C)}function eq(e,n,t){var r=Math.exp(n*t*t);return t<=e?r:0}function dN(e,n){return e.score-n.score||e.score===n.score&&n.boxIndex-e.boxIndex}function fN(e,n,t){var r=new Array(e.rank).fill(0),o=e.shape.slice();return n.map(function(i){o[t]=i;var a=e.slice(r,o);return r[t]+=i,a})}function hN(e,n){for(var t=new Array(e.rank),r=0;r<t.length;r++)t[r]=e.shape[r]*n[r];var o=Oe(t,e.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=i[s]%e.shape[s];var u=e.locToIndex(a);o.values[r]=e.values[u]}return o.toTensor()}function pN(e,n,t,r,o){for(var i=n[n.length-1],a=[e.length/i,i],s=a[0],u=a[1],c=Fc(t,s*r),l=Fc("int32",s*r),d=0;d<s;d++){for(var f=d*u,h=e.subarray(f,f+u),p=[],m=0;m<h.length;m++)p.push({value:h[m],index:m});p.sort(function(x,E){return E.value-x.value});var v=d*r,y=c.subarray(v,v+r),b=l.subarray(v,v+r);for(m=0;m<r;m++)y[m]=p[m].value,b[m]=p[m].index}var C=n.slice();return C[C.length-1]=r,[jn(c,C,t),jn(l,C,"int32")]}function gx(e,n){for(var t=[],r=0;r<n.length;r++)n[r]&&t.push(r);var o=Oe(e,"int32"),i=Oe([t.length,e.length],"int32");for(r=0;r<t.length;r++){var a=o.indexToLoc(t[r]);i.values.set(a,r*e.length)}return i.toTensor()}Object.freeze({castTensor:lx,reshapeTensor:nm,linspaceImpl:dx,upcastType:An,axesAreInnerMostDims:Q0,combineLocations:GR,computeOutAndReduceShapes:Vn,expandShapeToKeepDim:vr,assertAxesAreInnerMostDims:Nr,getAxesPermutation:jo,getUndoAxesPermutation:zg,getInnerMostAxes:Ho,getBroadcastDims:ta,getReductionAxes:mn,assertAndGetBroadcastShape:Ze,assertParamsConsistent:qR,computeOutShape:$s,computePool2DInfo:Uc,computePool3DInfo:_f,computeConv2DInfo:Ga,computeConv3DInfo:Df,computeDefaultPad:ux,tupleValuesAreOne:Ks,eitherStridesOrDilationsAreOne:yr,convertConv2DDataFormat:tm,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:Yg});var tq=function(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map(function(o,i){return"T"+i});var t=[];this.variableNames.forEach(function(o){t.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode="\n      void main() {\n        "+t.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},nq=function(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map(function(o,i){return"T"+i});var t=[];this.variableNames.forEach(function(o){t.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode="\n      void main() {\n        "+t.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},rq=function(e,n,t){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,a=Math.ceil(e.inSize/r);t||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(t?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===n?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function gN(e,n){return["x","y","z","w","u","v"].slice(0,n).map(function(t){return e+"."+t})}function Fr(e,n){return 1===n?[e]:gN(e,n)}function Zn(){var e,n,t,r,o,i,a,s,u,c;return 2===H().getNumber("WEBGL_VERSION")?(e="#version 300 es",n="in",t="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",n="attribute",t="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:n,varyingVs:t,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function Ys(e,n,t){void 0===t&&(t="index");var r=Vo(n);return r.map(function(o,i){return"int "+e[i]+" = "+t+" / "+o+"; "+(i===r.length-1?"int "+e[i+1]+" = "+t+" - "+e[i]+" * "+o:"index -= "+e[i]+" * "+o)+";"}).join("")}function mx(e){var n=Vo(e).map(function(t){return t.toString()});return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+n[0]+" + coords.y * "+n[1]+" + coords.z;\n  }\n"}var mN="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function oq(e,n,t,r){var o=[];e.forEach(function(h){var p=ge(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push("uniform float "+h.name+(p>1?"["+p+"]":"")+";"):(o.push("uniform sampler2D "+h.name+";"),o.push("uniform int offset"+h.name+";"))});var i,a,h,s=o.join("\n"),u=e.map(function(h){return function(p,m,v){void 0===v&&(v=!1);var y="";return y+=v?vN(p):Hc(p),p.shapeInfo.logicalShape.length<=m.logicalShape.length&&(y+=v?function(x,E){var I,J,N=x.name,R=N.charAt(0).toUpperCase()+N.slice(1),M="get"+R+"AtOutCoords",T=x.shapeInfo.logicalShape.length,L=E.logicalShape.length,O=ta(x.shapeInfo.logicalShape,E.logicalShape),q=Ht(L),$=L-T,G=["x","y","z","w","u","v"];I=0===T?"":L<2&&O.length>=1?"coords = 0;":O.map(function(we){return"coords."+G[we+$]+" = 0;"}).join("\n"),J=L<2&&T>0?"coords":x.shapeInfo.logicalShape.map(function(we,be){return"coords."+G[be+$]}).join(", ");var Y="return outputValue;",X=1===ge(x.shapeInfo.logicalShape),ne=1===ge(E.logicalShape);if(1!==T||X||ne){if(X&&!ne)Y=1===L?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(O.length){var re=T-2,ce=T-1;O.indexOf(re)>-1&&O.indexOf(ce)>-1?Y="return vec4(outputValue.x);":O.indexOf(re)>-1?Y="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":O.indexOf(ce)>-1&&(Y="return vec4(outputValue.xx, outputValue.zz);")}}else Y="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+M+"() {\n      "+q+" coords = getOutputCoords();\n      "+I+"\n      vec4 outputValue = get"+R+"("+J+");\n      "+Y+"\n    }\n  "}(p,m):function(x,E){var I=x.name,N=I.charAt(0).toUpperCase()+I.slice(1),R="get"+N+"AtOutCoords",L=x.shapeInfo.logicalShape.length,O=E.logicalShape.length;if(!x.shapeInfo.isUniform&&L===O&&null==x.shapeInfo.flatOffset&&hn(x.shapeInfo.texShape,E.texShape))return"\n      float "+R+"() {\n        return sampleTexture("+I+", resultUV);\n      }\n    ";var $=Ht(O),G=ta(x.shapeInfo.logicalShape,E.logicalShape),J=O-L,Y=["x","y","z","w","u","v"];return"\n    float "+R+"() {\n      "+$+" coords = getOutputCoords();\n      "+(0===L?"":O<2&&G.length>=1?"coords = 0;":G.map(function(ne){return"coords."+Y[ne+J]+" = 0;"}).join("\n"))+"\n      return get"+N+"("+(O<2&&L>0?"coords":x.shapeInfo.logicalShape.map(function(ne,re){return"coords."+Y[re+J]}).join(", "))+");\n    }\n  "}(p,m)),y}(h,n,r)}).join("\n"),c=n.texShape,l=Zn(),d="\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+l.texture2D+"(textureSampler, uv).r;\n    }\n  ",f=(h=l).version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+h.varyingFs+" vec2 resultUV;\n    "+h.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+h.defineSpecialNaN+"\n    "+h.defineSpecialInf+"\n    "+h.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+iq+"\n    "+aq+"\n    "+sq+"\n  ";return n.isPacked?(i=function(h,p){switch(h.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return E=p,1===(I=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)])[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+I[1]+".0);\n      }\n    ":1===I[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+I[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+I[0]+", "+I[1]+"));\n      return 2 * (resTexRC.x * "+I[1]+" + resTexRC.y);\n    }\n  ";case 2:return function(x,E){var I=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];if(hn(x,E))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+I[0]+", "+I[1]+"));\n      }\n    ";var N=Math.ceil(x[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+I[0]+", "+I[1]+"));\n\n      int index = resTexRC.x * "+I[1]+" + resTexRC.y;\n      int r = 2 * (index / "+N+");\n      int c = imod(index, "+N+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(h,p);case 3:return m=h,v=p,y=[Math.ceil(v[0]/2),Math.ceil(v[1]/2)],C=(b=Math.ceil(m[2]/2))*Math.ceil(m[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+y[0]+", "+y[1]+"));\n      int index = resTexRC.x * "+y[1]+" + resTexRC.y;\n\n      int b = index / "+C+";\n      index -= b * "+C+";\n\n      int r = 2 * (index / "+b+");\n      int c = imod(index, "+b+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(x,E){for(var I=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)],N=Math.ceil(x[x.length-1]/2),R=N*Math.ceil(x[x.length-2]/2),M=R,T="",L="b, r, c",O=2;O<x.length-1;O++)T="\n      int b"+O+" = index / "+(M*=x[x.length-O-1])+";\n      index -= b"+O+" * "+M+";\n    "+T,L="b"+O+", "+L;return"\n    ivec"+x.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+I[0]+", "+I[1]+"));\n      int index = resTexRC.x * "+I[1]+" + resTexRC.y;\n\n      "+T+"\n\n      int b = index / "+R+";\n      index -= b * "+R+";\n\n      int r = 2 * (index / "+N+");\n      int c = imod(index, "+N+") * 2;\n\n      return ivec"+x.length+"("+L+");\n    }\n  "}(h,p)}var E,I,m,v,y,b,C}(n.logicalShape,c),a=function(h){return"\n    void setOutput(vec4 val) {\n      "+h.output+" = val;\n    }\n  "}(l)):(i=function(h,p){switch(h.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(b=p)[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+b[1]+".0);\n      }\n    ":1===b[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+b[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+b[0]+", "+b[1]+"));\n      return resTexRC.x * "+b[1]+" + resTexRC.y;\n    }\n  ";case 2:return function(y,b){return hn(y,b)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+b[0]+", "+b[1]+"));\n      }\n    ":1===y[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+b[0]+", "+b[1]+"));\n        int index = resTexRC.x * "+b[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===y[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+b[0]+", "+b[1]+"));\n        int index = resTexRC.x * "+b[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+b[0]+", "+b[1]+"));\n      int index = resTexRC.x * "+b[1]+" + resTexRC.y;\n      int r = index / "+y[1]+";\n      int c = index - r * "+y[1]+";\n      return ivec2(r, c);\n    }\n  "}(h,p);case 3:return m=p,v=Ys(["r","c","d"],h),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+m[0]+", "+m[1]+"));\n      int index = resTexRC.x * "+m[1]+" + resTexRC.y;\n      "+v+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(y,b){var C=Ys(["r","c","d","d2"],y);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+b[0]+", "+b[1]+"));\n      int index = resTexRC.x * "+b[1]+" + resTexRC.y;\n      "+C+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(h,p);case 5:return function(y,b){var C=Ys(["r","c","d","d2","d3"],y);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+b[0]+",\n                             "+b[1]+"));\n\n      int index = resTexRC.x * "+b[1]+" + resTexRC.y;\n\n      "+C+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(h,p);case 6:return function(y,b){var C=Ys(["r","c","d","d2","d3","d4"],y);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+b[0]+", "+b[1]+"));\n      int index = resTexRC.x * "+b[1]+" + resTexRC.y;\n\n      "+C+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(h,p);default:throw new Error(h.length+"-D output sampling is not yet supported")}var b,m,v}(n.logicalShape,c),a=function(h){return"\n    void setOutput(float val) {\n      "+h.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(f+=uq),[f,d,a,s,i,u,t].join("\n")}function Hc(e){var n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(t){var r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=t.shapeInfo.texShape;if(1===i[0]&&1===i[1])return"\n      float "+o+"() {\n        return sampleTexture("+r+", halfCR);\n      }\n    ";var u=t.shapeInfo.texShape;return"\n    float "+o+"() {\n      vec2 uv = uvFromFlat("+u[0]+", "+u[1]+", "+Zs(r)+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 1:return function(t){var r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+o+"(int index) {\n        "+Wc(t)+"\n      }\n    ";var i=t.shapeInfo.texShape,a=i[0],s=i[1];if(1===s&&1===a)return"\n      float "+o+"(int index) {\n        return sampleTexture("+r+", halfCR);\n      }\n    ";var u=Zs(r);return 1===s?"\n      float "+o+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+u+") + 0.5) / "+a+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":1===a?"\n      float "+o+"(int index) {\n        vec2 uv = vec2((float(index + "+u+") + 0.5) / "+s+".0, 0.5);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+o+"(int index) {\n      vec2 uv = uvFromFlat("+a+", "+s+", index + "+u+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 2:return function(t){var r=t.shapeInfo.logicalShape,o=t.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=t.shapeInfo.texShape;if(null!=a&&hn(r,a))return"\n    float "+i+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+a[1]+".0, "+a[0]+".0);\n      return sampleTexture("+o+", uv);\n    }\n  ";var c=ja(r),l=c.newShape,d=c.keptDims;if(l.length<r.length)return"\n      "+Hc(zc(t,l))+"\n      float "+i+"(int row, int col) {\n        return "+i+"("+$c(["row","col"],d)+");\n      }\n    ";if(t.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+r[1]+", 1)));\n        "+Wc(t)+"\n      }\n    ";var p=a[0],m=a[1],v=Zs(o);return 1===m?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+v+"), vec3("+r[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+p+".0);\n      return sampleTexture("+o+", uv);\n    }\n  ":1===p?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+v+"), vec3("+r[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+m+".0, 0.5);\n      return sampleTexture("+o+", uv);\n    }\n  ":"\n  float "+i+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+r[1]+" + col + "+v+";\n    vec2 uv = uvFromFlat("+p+", "+m+", index);\n    return sampleTexture("+o+", uv);\n  }\n"}(e);case 3:return function(t){var r=t.shapeInfo.logicalShape,o=t.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],u=ja(r),c=u.newShape,l=u.keptDims;if(c.length<r.length)return"\n        "+Hc(zc(t,c))+"\n        float "+i+"(int row, int col, int depth) {\n          return "+i+"("+$c(["row","col","depth"],l)+");\n        }\n      ";if(t.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+a+", "+s+", 1)));\n        "+Wc(t)+"\n      }\n    ";var h=t.shapeInfo.texShape,p=h[0],m=h[1],v=t.shapeInfo.flatOffset;return m===a&&null==v?"\n        float "+i+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+s+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+m+".0, "+p+".0);\n          return sampleTexture("+o+", uv);\n        }\n      ":m===s&&null==v?"\n    float "+i+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+r[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+m+".0, "+p+".0);\n      return sampleTexture("+o+", uv);\n    }\n  ":"\n      float "+i+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+a+" + col * "+s+" + depth + "+Zs(o)+";\n        vec2 uv = uvFromFlat("+p+", "+m+", index);\n        return sampleTexture("+o+", uv);\n      }\n  "}(e);case 4:return function(t){var r=t.shapeInfo.logicalShape,o=t.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,c=ja(r),l=c.newShape,d=c.keptDims;if(l.length<r.length)return"\n      "+Hc(zc(t,l))+"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        return "+i+"("+$c(["row","col","depth","depth2"],d)+");\n      }\n    ";if(t.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+u+", "+s+", "+a+", 1)));\n        "+Wc(t)+"\n      }\n    ";var h=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,m=p[0],v=p[1];return v===u&&null==h?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+s+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+m+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":v===a&&null==h?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+r[1]*r[2]+", "+r[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+m+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+u+" + col * "+s+" +\n          depth * "+a+" + depth2;\n      vec2 uv = uvFromFlat("+m+", "+v+", index + "+Zs(o)+");\n      return sampleTexture("+o+", uv);\n    }\n  "}(e);case 5:return function(t){var r=t.shapeInfo.logicalShape,o=t.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,c=r[1]*u,l=ja(r),d=l.newShape,f=l.keptDims;if(d.length<r.length)return"\n      "+Hc(zc(t,d))+"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+i+"("+$c(["row","col","depth","depth2","depth3"],f)+");\n      }\n    ";if(t.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+c+", "+u+", "+s+", "+a+")) +\n          depth3;\n        "+Wc(t)+"\n      }\n    ";var p=t.shapeInfo.flatOffset,m=t.shapeInfo.texShape,v=m[0],y=m[1];return y===c&&null==p?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+u+", "+s+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+y+".0, "+v+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":y===a&&null==p?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+r[1]*r[2]*r[3]+",\n               "+r[2]*r[3]+", "+r[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+y+".0, "+v+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+c+" + col * "+u+" + depth * "+s+" +\n          depth2 * "+a+" + depth3 + "+Zs(o)+";\n      vec2 uv = uvFromFlat("+v+", "+y+", index);\n      return sampleTexture("+o+", uv);\n    }\n  "}(e);case 6:return function(t){var r=t.shapeInfo.logicalShape,o=t.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=ja(r),s=a.newShape,u=a.keptDims;if(s.length<r.length)return"\n      "+Hc(zc(t,s))+"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+i+"("+$c(["row","col","depth","depth2","depth3","depth4"],u)+");\n      }\n    ";var l=r[5],d=r[4]*l,f=r[3]*d,h=r[2]*f,p=r[1]*h;if(t.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+p+", "+h+", "+f+", "+d+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+l+", 1)));\n        "+Wc(t)+"\n      }\n    ";var m=t.shapeInfo.flatOffset,v=t.shapeInfo.texShape,y=v[0],b=v[1];return b===p&&null==m?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+h+", "+f+", "+d+", "+l+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+b+".0, "+y+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":b===l&&null==m?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+r[1]*r[2]*r[3]*r[4]+",\n               "+r[2]*r[3]*r[4]+",\n               "+r[3]*r[4]+",\n               "+r[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+b+".0, "+y+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+p+" + col * "+h+" + depth * "+f+" +\n          depth2 * "+d+" + depth3 * "+l+" + depth4 + "+Zs(o)+";\n      vec2 uv = uvFromFlat("+y+", "+b+", index);\n      return sampleTexture("+o+", uv);\n    }\n  "}(e);default:throw new Error(n.length+"-D input sampling is not yet supported")}}function vN(e){var n,o,i,a,s,u,c;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(n=e.name).charAt(0).toUpperCase()+n.slice(1)+"() {\n      return "+Zn().texture2D+"("+n+", halfCR);\n    }\n  ";case 1:return a="get"+(i=(o=e).name).charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=Zn(),"\n    vec4 "+a+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+u[0]+", "+u[1]+", index);\n      return "+c.texture2D+"("+i+", uv);\n    }\n  ";case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,c=u[0],l=u[1],d=Zn();if(null!=u&&hn(i,u))return"\n      vec4 "+s+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+l+".0, "+c+".0);\n\n        return "+d.texture2D+"("+a+", uv);\n      }\n    ";var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];return"\n    vec4 "+s+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(i[1]/2)+", "+f[0]+", "+f[1]+", row, col);\n      return "+d.texture2D+"("+a+", uv);\n    }\n  "}(e);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,c=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(1===i[0])return"\n        "+vN(zc(o,i.slice(1)))+"\n        vec4 "+s+"(int b, int row, int col) {\n          return "+s+"("+$c(["b","row","col"],[1,2])+");\n        }\n      ";var f=c[0],h=c[1],p=Math.ceil(i[2]/2);return"\n    vec4 "+s+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+f+", "+h+", "+p*Math.ceil(i[1]/2)+", "+p+", b, row, col);\n      return "+Zn().texture2D+"("+a+", uv);\n    }\n  "}(e);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),c=o.shapeInfo.texShape,l=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],d=l[0],f=l[1],h=Math.ceil(i[a-1]/2),p=h*Math.ceil(i[a-2]/2),m="int b, int row, int col",v="b * "+p+" + (row / 2) * "+h+" + (col / 2)",y=2;y<a-1;y++)m="int b"+y+", "+m,v="b"+y+" * "+(p*=i[a-y-1])+" + "+v;return"\n    vec4 "+u+"("+m+") {\n      int index = "+v+";\n      int texR = index / "+f+";\n      int texC = index - texR * "+f+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+f+", "+d+");\n      return "+Zn().texture2D+"("+s+", uv);\n    }\n  "}(e)}}var iq="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",aq="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",sq="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",uq="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Zs(e){return"offset"+e}function Wc(e){var n=e.name,t=ge(e.shapeInfo.logicalShape);return t<2?"return "+n+";":"\n    for (int i = 0; i < "+t+"; i++) {\n      if (i == index) {\n        return "+n+"[i];\n      }\n    }\n  "}function Ht(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function zc(e,n){var t=JSON.parse(JSON.stringify(e));return t.shapeInfo.logicalShape=n,t}function $c(e,n){return n.map(function(t){return e[t]}).join(", ")}var cq=function(e,n,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,A(e.length>2,function(){return"Packed arg"+(t.charAt(0).toUpperCase()+t.slice(1))+" supports only inputs with rank above 2."});var i=Math.ceil(e[e.length-1]/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,c=u.length,l=Ht(c),d=Fr("coords",c);if(1===i){var f=Ht(s=c+1);a="\n        "+f+" sourceLocR = "+f+"("+d.join()+", 0);\n        ++"+d[c-1]+";\n        "+f+" sourceLocG = "+f+"("+d.join()+", 0);\n        ++"+d[c-2]+";\n        "+f+" sourceLocA = "+f+"("+d.join()+", 0);\n        --"+d[c-1]+";\n        "+f+" sourceLocB = "+f+"("+d.join()+", 0);\n        --"+d[c-2]+";"}else s=c,a="\n        "+l+" sourceLocR = coords;\n        ++"+d[c-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+d[c-2]+";\n        "+l+" sourceLocA = coords;\n        --"+d[c-1]+";\n        "+l+" sourceLocB = coords;\n        --"+d[c-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),p="."+h[s-1],m=h.map(function(R){return"int "+R}),v=Fr("sourceLocR",s-1).concat("inIdx.r"),y=Fr("sourceLocG",s-1).concat("inIdx.g"),b=Fr("sourceLocB",s-1).concat("inIdx.b"),C=Fr("sourceLocA",s-1).concat("inIdx.a"),x="max"===t?"greaterThan":"lessThan",E=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+b.join()+"),\n                             getBestIndicesAChannel("+C.join()+")));",I="vec4(\n            getAChannel("+v.join()+"),\n            hasNextCol ? getAChannel("+y.join()+") : 0.,\n            hasNextRow ? getAChannel("+b.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+C.join()+") : 0.)",N=r?"":"\n      float getBestIndicesAChannel("+m.join()+") {\n        return getChannel(getBestIndicesA("+h.join()+"),\n                                          vec2("+h.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+m.join()+") {\n        return getChannel(getA("+h.join()+"),\n                               vec2("+h.slice(-2).join()+"));\n      }\n      "+N+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+d[c-1]+" < "+(u[c-1]-1)+";\n        bool hasNextRow = "+d[c-2]+" < "+(u[c-2]-1)+";\n        "+a+"\n        ivec4 srcIdx = ivec4(sourceLocR"+p+", sourceLocG"+p+",\n          sourceLocB"+p+", sourceLocA"+p+") * "+n+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+I+";\n\n        for (int i = 0; i < "+n+"; i++) {\n          inIdx = srcIdx;\n          "+E+"\n          vec4 candidate = "+I+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+x+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},lq=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var s=e.effectiveFilterHeight,u=e.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(s-1-e.padInfo.top)+", "+(u-1-e.padInfo.left)+");\n      const float avgMultiplier = float("+1/(e.filterHeight*e.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+e.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+e.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},dq=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var l=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(l-1-e.padInfo.front)+", "+(d-1-e.padInfo.top)+", "+(f-1-e.padInfo.left)+");\n      const float avgMultiplier = float("+1/(e.filterDepth*e.filterHeight*e.filterWidth)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+e.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+e.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+d+";\n              wR += "+e.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+f+";\n                wC += "+e.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},fq=function(e,n,t,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Ze(e,n),Ze(e,t);var a="0.0";null!=r&&(Ze(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";null!=o&&(Ze(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+a+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},hq=function(e,n,t,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ze(e,n),Ze(e,t);var a="vec4(0.0)";null!=r&&(Ze(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=o&&(Ze(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = "+a+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},yN=function(e,n,t){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ze(n,t),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},vx="return a + b;",yx="return a - b;",wN="return a * b;",bN="return (a < 0.) ? b * a : a;",an=function(e,n,t){this.variableNames=["A","B"],this.outputShape=Ze(n,t),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},xN="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",na=function(e,n,t,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ze(n,t);var o=this.outputShape.length,i="";if(r)if(0===o||1===ge(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+Ht(o)+" coords = getOutputCoords();\n        ",1===o)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var a=Fr("coords",o);i+="\n            bool nextRowOutOfBounds =\n              ("+a[o-2]+" + 1) >= "+this.outputShape[o-2]+";\n            bool nextColOutOfBounds =\n              ("+a[o-1]+" + 1) >= "+this.outputShape[o-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},mq=function(){function e(n){this.variableNames=["A"],this.outputShape=n,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(n,t){var r=this;return function(o,i){null==r.minLoc&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,n),o.gl.uniform1f(r.maxLoc,t)}},e}(),vq=function(){function e(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(n,t){var r=this;return function(o,i){null==r.minLoc&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,n),o.gl.uniform1f(r.maxLoc,t)}},e}(),yq=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},wq=function(e){this.outputShape=[],this.outputShape=$s(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var n=new Array(e.length-1);n[0]=e[0][1];for(var t=1;t<n.length;t++)n[t]=n[t-1]+e[t][1];var r=["if (yC < "+n[0]+") setOutput(getT0(yR, yC));"];for(t=1;t<n.length;t++)r.push("else if (yC < "+n[t]+") setOutput(getT"+t+"(yR, yC-"+n[t-1]+"));");r.push("else setOutput(getT"+n.length+"(yR, yC-"+n[n.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},bq=function(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=$s(e,n);var t=this.outputShape,r=t.length,o=Ht(r),i=Fr("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(v,y){return"T"+y});var s=new Array(e.length-1);s[0]=e[0][n];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][n];var c=a[n],l=a.slice(-2),d=a.join(),f="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+d+"), vec2("+l.join()+"));\n        }";for(u=1;u<s.length;u++){var h=s[u-1];f+="\n        if ("+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+rm(a,c,h)+"),\n            vec2("+rm(l,c,h)+"));\n        }"}var m=s[s.length-1];f+="\n        return getChannel(\n          getT"+s.length+"("+rm(a,c,m)+"),\n          vec2("+rm(l,c,m)+"));",this.userCode="\n      float getValue("+a.map(function(v){return"int "+v})+") {\n        "+f+"\n      }\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+t[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+t[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+t[r-2]+" &&\n            "+i[r-1]+" < "+t[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function rm(e,n,t){var r=e.indexOf(n);return e.map(function(o,i){return i===r?o+" - "+t:o}).join()}var xq=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+e.strideHeight+" - "+e.padInfo.top+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+e.strideWidth+" - "+e.padInfo.left+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              if ("+("channelsLast"===e.dataFormat)+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Cq=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var n=e.filterHeight,t=e.filterWidth,i="channelsLast"===e.dataFormat;this.userCode="\n      const ivec2 pads = ivec2("+(n-1-e.padInfo.top)+", "+(t-1-e.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+(i?3:1)+"];\n\n        ivec2 dyCorner = ivec2(coords["+(i?1:2)+"], coords["+(i?2:3)+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+n+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+n+" - 1 - wR;\n\n          for (int wC = 0; wC < "+t+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+t+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},_q=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yF = 0; yF < "+e.outDepth+"; yF++) {\n            int xF = wF + yF * "+e.strideDepth+" - "+e.padInfo.front+";\n\n            if (xF < 0 || xF >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n              int xR = wR + yR * "+e.strideHeight+" - "+e.padInfo.top+";\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n                int xC = wC + yC * "+e.strideWidth+" - "+e.padInfo.left+";\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Dq=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var n=e.filterDepth,t=e.filterHeight,r=e.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(n-1-e.padInfo.front)+", "+(t-1-e.padInfo.top)+", "+(r-1-e.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+n+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+e.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+e.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+n+" - 1 - wF;\n\n          for (int wR = 0; wR < "+t+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+t+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Eq=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+e.outChannels/e.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+e.strideHeight+" - "+e.padInfo.top+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+e.strideWidth+" - "+e.padInfo.left+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Iq=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var n=e.filterHeight,t=e.filterWidth,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(n-1-e.padInfo.top)+", "+(t-1-e.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+n+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+n+" - 1 - wR;\n\n          for (int wC = 0; wC < "+t+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+t+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},CN=function(e,n,t,r){void 0===n&&(n=!1),void 0===t&&(t=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.padInfo.top,i=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterHeight,d=e.filterWidth,f=4*Math.floor(e.inChannels/4),h=e.inChannels%4,p="channelsLast"===e.dataFormat,m=p?1:2,v=p?2:3,y=p?3:1,b="",C="";t&&(b=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+t+"\n        }":"\n          float activation(float x) {\n            "+t+"\n          }\n        ",C="result = activation(result);");var x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+b+"\n\n      const ivec2 strides = ivec2("+a+", "+s+");\n      const ivec2 pads = ivec2("+o+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+y+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+v+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+d+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+p+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===h)+") {\n\n              if ("+p+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+f+") *\n                    getW(wR, wC, "+f+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+f+", xR, xC) *\n                    getW(wR, wC, "+f+", d2);\n              }\n\n            } else if ("+(2===h)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+f+", d2),\n                getW(wR, wC, "+f+" + 1, d2)\n              );\n\n              if ("+p+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+f+"),\n                  getX(batch, xR, xC, "+f+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+f+", xR, xC),\n                  getX(batch, "+f+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===h)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+f+", d2),\n                getW(wR, wC, "+f+" + 1, d2),\n                getW(wR, wC, "+f+" + 2, d2)\n              );\n\n              if ("+p+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+f+"),\n                  getX(batch, xR, xC, "+f+" + 1),\n                  getX(batch, xR, xC, "+f+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+f+", xR, xC),\n                  getX(batch, "+f+" + 1, xR, xC),\n                  getX(batch, "+f+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+x+"\n        "+C+"\n        setOutput(result);\n      }\n    "},Sq=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var n=e.padInfo.front,t=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterDepth,d=e.filterHeight,f=e.filterWidth,h=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+o+", "+i+", "+a+");\n      const ivec3 pads = ivec3("+n+", "+t+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+f+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+h+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+h+") *\n                  getW(wF, wR, wC, "+h+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+h+"),\n                  getX(batch, xF, xR, xC, "+h+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+h+", d2),\n                  getW(wF, wR, wC, "+h+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+h+"),\n                  getX(batch, xF, xR, xC, "+h+" + 1),\n                  getX(batch, xF, xR, xC, "+h+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+h+", d2),\n                  getW(wF, wR, wC, "+h+" + 1, d2),\n                  getW(wF, wR, wC, "+h+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},_N=function(e,n,t,r){void 0===n&&(n=!1),void 0===t&&(t=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=e.outChannels/e.inChannels,m="",v="";t&&(m=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+t+"\n        }":"\n          float activation(float x) {\n            "+t+"\n          }\n        ",v="result = activation(result);");var y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+m+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+p+";\n        int q = d2 - d1 * "+p+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+f+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+o+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+d+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+y+"\n        "+v+"\n        setOutput(result);\n      }\n    "},DN=function(e,n,t,r){void 0===n&&(n=!1),void 0===t&&(t=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=h,m="int xR; int xC; int xCOffset;",v=0;v<f;v++)for(var y=0;y<h;y++)m+="\n          vec4 xTexelR"+v+"C"+2*y+" = vec4(0.);\n          vec4 wR"+v+"C"+y+" = vec4(0.);\n          vec4 xR"+v+"C"+y+" = vec4(0.);";for(v=0;v<f;v++)for(var b=0;b<p;b++){if(m+="\n          xR = xRCorner + "+v*l+";\n          xC = xCCorner + "+(y=2*b)*d+";\n        ",1===c){if(y<h&&(m+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+v+"C"+y+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    xTexelR"+v+"C"+y+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+v+"C"+y+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+v+"C"+y+" = vec4(previous.zw, xTexelR"+v+"C"+y+".xy);\n                } else {\n                  xR"+v+"C"+y+" = vec4(0, 0, xTexelR"+v+"C"+y+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+o+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+v+"C"+y+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+v+"C"+y+" = vec4(0.);\n                }\n\n                xR"+v+"C"+y+" = xTexelR"+v+"C"+y+";\n              ",y+1<h)){var C=s%2==0?T0(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(m+="\n                  xCOffset = xC + "+s%2+" + "+C+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+v+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",d>1&&(m+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+o+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+v+"C"+y+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+v+"C"+y+" = vec4(0.);\n                    }\n                  "),m+="\n                  xR"+v+"C"+(y+1)+" = vec4(\n                    xTexelR"+v+"C"+y+".zw, xTexelR"+v+"C"+(y+2)+".xy);\n                "):m+="\n                  xCOffset = xC + "+C+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+v+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+v+"C"+(y+1)+" = xTexelR"+v+"C"+(y+2)+";\n                "}}else y<h&&(m+="\n              if(xR >= 0 && xR < "+o+") {\n            ",s%2==1?(m+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+v+"C"+y+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+v+"C"+y+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+v+"C"+(y+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+v+"C"+(y+2)+" = vec4(0.);\n                }\n\n                xR"+v+"C"+y+" = vec4(\n                  xTexelR"+v+"C"+y+".zw, xTexelR"+v+"C"+(y+2)+".zw);\n              ",y+1<h&&(m+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+v+"C"+(y+1)+" = vec4(xTexelR"+v+"C"+(y+2)+".xy, final.xy);\n                ")):(m+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+v+"C"+y+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+v+"C"+y+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+v+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+v+"C"+(y+2)+" = vec4(0.);\n                }\n\n                xR"+v+"C"+y+" = vec4(\n                  xTexelR"+v+"C"+y+".xy, xTexelR"+v+"C"+(y+2)+".xy);\n              ",y+1<h&&(m+="\n                  xR"+v+"C"+(y+1)+" = vec4(\n                    xTexelR"+v+"C"+y+".zw, xTexelR"+v+"C"+(y+2)+".zw);\n                ")),m+="}");y<h&&(m+="\n            vec4 wTexelR"+v+"C"+y+" = getW("+v+", "+y+", d1, q);\n            wR"+v+"C"+y+" = vec4(wTexelR"+v+"C"+y+".xz, wTexelR"+v+"C"+y+".xz);\n          ",y+1<h&&(m+="\n              vec4 wTexelR"+v+"C"+(y+1)+" = getW("+v+", "+(y+1)+", d1, q);\n              wR"+v+"C"+(y+1)+" =\n                vec4(wTexelR"+v+"C"+(y+1)+".xz, wTexelR"+v+"C"+(y+1)+".xz);"))}for(v=0;v<f;v++)for(y=0;y<h;y++)m+="dotProd += xR"+v+"C"+y+" * wR"+v+"C"+y+";";var x="",E="";t&&(x=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+t+"\n        }":"vec4 activation(vec4 x) {\n          "+t+"\n        }",E="result = activation(result);");var I=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+x+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+m+"\n\n        vec4 result = dotProd;\n        "+I+"\n        "+E+"\n        setOutput(result);\n      }\n    "},Aq=function(e,n,t,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],a=e[1],s=e[2],l=t[0],d=t[1];this.outputShape=[n[0],l,d,e[3]];var h=[a-1+".0",s-1+".0"],p=h[0],m=h[1],v=l>1?[""+(a-1)/(l-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],x=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m];this.userCode="\n      const float height_ratio = float("+v[0]+");\n      const float width_ratio = float("+x[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+v[1]+";\n        float width_scale = "+x[1]+";\n\n        float in_y = "+v[2]+";\n        if( in_y < 0.0 || in_y > "+p+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n        float in_x = "+x[2]+";\n        if( in_x < 0.0 || in_x > "+m+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===r?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},Mq=function(e,n,t){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],i=t?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(t?"return "+o+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Ht(r)+" coords = getOutputCoords();\n        int end = "+EN(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+o+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+n+") {\n            continue;\n          }\n          "+EN(r,"coords")+" = idx;\n          val += getX("+function(a,s){if(1===a)return""+s;if(2===a)return s+".x, "+s+".y";if(3===a)return s+".x, "+s+".y, "+s+".z";if(4===a)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function EN(e,n){if(1===e)return""+n;if(2===e)return n+".y";if(3===e)return n+".z";if(4===e)return n+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var Tq=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=hf.DENSE;var n=pf(e),t=Zn();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Ys(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+n[0]+", "+n[1]+"));\n        int index = 4 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+t.output+" = result;\n      }\n    "},Rq=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=hf.DENSE;var n=pf(e),t=Zn();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Ys(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+n[0]+", "+n[1]+"));\n        int index = 4 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+t.output+" = result;\n      }\n    "},Nq=function(){function e(n,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=n,this.blockSize=t,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return e.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),kq=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},Fq=function(e){this.variableNames=["A"],this.outTexUsage=Zr.DOWNLOAD;var n=Zn();this.outputShape=e,this.userCode="\n      "+mN+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+n.output+" = encode_float(x);\n      }\n    "},Pq=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Zr.DOWNLOAD;var n=Zn();this.outputShape=e,this.userCode="\n      "+mN+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+n.output+" = encode_float(x);\n      }\n    "},Oq=function(e,n,t){void 0===t&&(t=!1),this.variableNames=["A"];var r=Zn(),o=n[0],i=n[1];this.outputShape=e;var a="result";t&&(a="floor(result * 255. + 0.5)"),this.userCode="\n      "+mx(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+a+", 0., 0., 0.);\n      }\n    "},Lq=function(e,n,t){void 0===t&&(t=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Zn(),o=n[0],i=n[1];this.outputShape=e;var a="",s="result";t&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;a+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+e[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+e[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+mx(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+a+"\n\n        "+r.output+" = "+s+";\n      }\n    "},IN=function(e,n,t){this.variableNames=["real","imag"];var r=n[1];this.outputShape=n;var o=t?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+o+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(t?r+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},Uq=function(){function e(n,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=n,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(n){var t=this;return function(r,o){null==t.valueLoc&&(t.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(t.valueLoc,n)}},e}(),jq=function(e,n,t){this.variableNames=["A","indices"];var r=e.slice();r[t]=n,this.outputShape=r,this.rank=r.length;var o=Ht(this.rank),i=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(1===u)return"int(getIndices(resRC))";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],d=0;d<a.length;d++)l.push(d===s?"int(getIndices("+c[d]+"))":""+c[d]);return l.join()}(e,t);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},Hq=function(e,n,t){this.sliceDim=e,this.strides=n,this.variableNames=["x","indices"],this.outputShape=t;var r=Ht(n.length),o=Ht(t.length);this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+o+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function SN(e,n){var t=Zn();return CR(e,n,t.version+"\n    precision highp float;\n    "+t.attribute+" vec3 clipSpacePos;\n    "+t.attribute+" vec2 uv;\n    "+t.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function AN(e,n){return IR(e,n,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function MN(e,n){return SR(e,n,new Uint16Array([0,1,2,2,1,3]))}function If(e,n,t,r,o,i,a){MR(t,r);var s=AR(e,n),u=e.TEXTURE_2D;return de(e,n,function(){return e.bindTexture(u,s)}),de(e,n,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),de(e,n,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),de(e,n,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),de(e,n,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),de(e,n,function(){return e.texImage2D(u,0,o,t,r,0,i,a,null)}),de(e,n,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function TN(e,n,t,r,o){var i=Og(t,r);return If(e,n,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,e.FLOAT)}function RN(e,n,t,r,o){var i=Og(t,r);return If(e,n,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function NN(e,n,t,r,o){var i=Og(t,r);return If(e,n,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function kN(e,n,t,r,o){var i=gf(t,r);return If(e,n,i[0],i[1],o.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function FN(e,n,t,r,o){var i=gf(t,r);return If(e,n,i[0],i[1],o.internalFormatPackedHalfFloat,e.RGBA,o.textureTypeHalfFloat)}function PN(e,n,t,r){return de(e,n,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),X0(e,n,t,"clipSpacePos",r,3,20,0)&&X0(e,n,t,"uv",r,2,20,12)}function ON(e,n,t,r,o,i,a){var s,u,c;de(e,n,function(){return e.bindTexture(e.TEXTURE_2D,t)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(r*o*4),u=e.FLOAT,c=a.internalFormatPackedFloat),s.set(i),de(e,n,function(){return e.texImage2D(e.TEXTURE_2D,0,c,r,o,0,e.RGBA,u,s)}),de(e,n,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function LN(e,n,t,r){de(e,n,function(){return e.bindTexture(e.TEXTURE_2D,t)}),r.data instanceof Uint8Array?de(e,n,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):de(e,n,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),de(e,n,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function BN(e,n,t,r,o){var i=e.createBuffer();de(e,n,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var a=16*t*r;return de(e,n,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)}),de(e,n,function(){return e.readPixels(0,0,r,t,e.RGBA,e.FLOAT,0)}),de(e,n,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function VN(e,n,t){var r=e,o=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,n),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function UN(e,n,t,r,o){var i=Og(t,r),a=i[0],s=i[1],u=new Uint8Array(t*r*4);return de(e,n,function(){return e.readPixels(0,0,a,s,o.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function jN(e,n,t,r,o,i,a,s){var f,u=e,c=new Float32Array((f=gf(i,a))[0]*f[1]*4);return u.bindBuffer(u.PIXEL_PACK_BUFFER,n),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function HN(e,n,t,r){var o=new Float32Array(t*r*4);return de(e,n,function(){return e.readPixels(0,0,r,t,e.RGBA,e.FLOAT,o)}),o}var Wq=Object.freeze({createVertexShader:SN,createVertexBuffer:AN,createIndexBuffer:MN,createFloat32MatrixTexture:TN,createFloat16MatrixTexture:RN,createUnsignedBytesMatrixTexture:NN,createPackedMatrixTexture:kN,createFloat16PackedMatrixTexture:FN,bindVertexProgramAttributeStreams:PN,uploadDenseMatrixToTexture:ON,uploadPixelDataToTexture:LN,createBufferFromOutputTexture:BN,downloadFloat32MatrixFromBuffer:VN,downloadByteEncodedFloatMatrixFromOutputTexture:UN,downloadPackedMatrixFromBuffer:jN,downloadMatrixFromPackedOutputTexture:HN}),WN=function(){function e(n){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=H().getNumber("WEBGL_VERSION");null!=n?(this.gl=n,wR(t,n)):this.gl=fi(t);var r="WEBGL_color_buffer_float";if(1===H().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=mf(this.gl,this.debug,"OES_texture_float"),Jr(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=mf(this.gl,this.debug,"OES_texture_half_float");else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Jr(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=mf(this.gl,this.debug,"EXT_color_buffer_half_float");else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(Jr(this.gl,r="EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Jr(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=AN(this.gl,this.debug),this.indexBuffer=MN(this.gl,this.debug),this.framebuffer=TR(this.gl,this.debug),this.textureConfig=q0(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return H().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var n=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;de(t,this.debug,function(){return t.finish()}),de(t,this.debug,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),de(t,this.debug,function(){return t.deleteFramebuffer(n.framebuffer)}),de(t,this.debug,function(){return t.bindBuffer(t.ARRAY_BUFFER,null)}),de(t,this.debug,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}),de(t,this.debug,function(){return t.deleteBuffer(n.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(n,t){return this.throwIfDisposed(),TN(this.gl,this.debug,n,t,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(n,t){return this.throwIfDisposed(),RN(this.gl,this.debug,n,t,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(n,t){return this.throwIfDisposed(),NN(this.gl,this.debug,n,t)},e.prototype.uploadPixelDataToTexture=function(n,t){this.throwIfDisposed(),LN(this.gl,this.debug,n,t)},e.prototype.uploadDenseMatrixToTexture=function(n,t,r,o){this.throwIfDisposed(),ON(this.gl,this.debug,n,t,r,o,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(n,t){return this.throwIfDisposed(),FN(this.gl,this.debug,n,t,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(n,t){return this.throwIfDisposed(),kN(this.gl,this.debug,n,t,this.textureConfig)},e.prototype.deleteMatrixTexture=function(n){var t=this;this.throwIfDisposed(),this.outputTexture===n&&(K0(this.gl,this.debug,this.framebuffer),this.outputTexture=null),de(this.gl,this.debug,function(){return t.gl.deleteTexture(n)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(n,t,r){var o=this;return this.downloadMatrixDriver(n,function(){return UN(o.gl,o.debug,t,r,o.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(n,t,r,o,i,a){return jN(this.gl,n,0,0,0,i,a)},e.prototype.downloadFloat32MatrixFromBuffer=function(n,t){return VN(this.gl,n,t)},e.prototype.createBufferFromTexture=function(n,t,r){this.bindTextureToFrameBuffer(n);var o=BN(this.gl,this.debug,t,r);return this.unbindTextureToFrameBuffer(),o},e.prototype.createAndWaitForFence=function(){var n=this.createFence(this.gl);return this.pollFence(n)},e.prototype.createFence=function(n){var t,r,o=this;if(H().getBool("WEBGL_FENCE_API_ENABLED")){var i=n,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);n.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},t=a}else H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(t,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:t,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(n,t,r){var o=this;return this.downloadMatrixDriver(n,function(){return HN(o.gl,o.debug,t,r)})},e.prototype.createProgram=function(n){this.throwIfDisposed();var t=this.gl,r=_R(t,this.debug,n),o=SN(t,this.debug),i=DR(t,this.debug);return de(t,this.debug,function(){return t.attachShader(i,o)}),de(t,this.debug,function(){return t.attachShader(i,r)}),ER(t,this.debug,i),this.debug&&Vg(t,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=PN(t,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(n){var t=this;this.throwIfDisposed(),n===this.program&&(this.program=null),null!=n&&de(this.gl,this.debug,function(){return t.gl.deleteProgram(n)})},e.prototype.setProgram=function(n){var t=this;this.throwIfDisposed(),this.program=n,null!=this.program&&this.debug&&Vg(this.gl,this.debug,this.program),de(this.gl,this.debug,function(){return t.gl.useProgram(n)})},e.prototype.getUniformLocation=function(n,t,r){return void 0===r&&(r=!0),this.throwIfDisposed(),r?NR(this.gl,this.debug,n,t):kR(this.gl,n,t)},e.prototype.getAttributeLocation=function(n,t){var r=this;return this.throwIfDisposed(),de(this.gl,this.debug,function(){return r.gl.getAttribLocation(n,t)})},e.prototype.getUniformLocationNoThrow=function(n,t){return this.throwIfDisposed(),this.gl.getUniformLocation(n,t)},e.prototype.setInputMatrixTexture=function(n,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),FR(this.gl,this.debug,0,n,t,r)},e.prototype.setOutputMatrixTexture=function(n,t,r){this.setOutputMatrixTextureDriver(n,r,t)},e.prototype.setOutputPackedMatrixTexture=function(n,t,r){this.throwIfDisposed();var o=gf(t,r);this.setOutputMatrixTextureDriver(n,o[0],o[1])},e.prototype.setOutputMatrixWriteRegion=function(n,t,r,o){this.setOutputMatrixWriteRegionDriver(r,n,o,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(n,t,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&Vg(this.gl,this.debug,this.program),vf(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var n=this.gl;this.debug&&this.debugValidate(),de(n,this.debug,function(){return n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var n=this;this.throwIfDisposed(),de(this.gl,this.debug,function(){return n.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=mf(this.gl,this.debug,2===H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(2===H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var n=this.gl,t=this.getQueryTimerExtensionWebGL2(),r=n.createQuery();return n.beginQuery(t.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(2!==H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var n=this.getQueryTimerExtensionWebGL1();n.endQueryEXT(n.TIME_ELAPSED_EXT)}else{var t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(n){return he(this,void 0,void 0,function(){var t=this;return pe(this,function(r){switch(r.label){case 0:return[4,R0(function(){return t.disposed||t.isQueryAvailable(n,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(n,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(n,t){if(0===t)return null;if(2===t){var r=this.gl;return r.getQueryParameter(n,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(n,o.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(n,t){if(0===t)return!0;if(2===t){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(n,r.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(n,o.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(n){var t=this;return new Promise(function(r){t.addItemToPoll(function(){return n.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var n=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),t=0;t<=n;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(n+1)},e.prototype.addItemToPoll=function(n,t){var r=this;this.itemsToPoll.push({isDoneFn:n,resolveFn:t}),this.itemsToPoll.length>1||R0(function(){return r.pollItems(),0===r.itemsToPoll.length})},e.prototype.bindTextureToFrameBuffer=function(n){this.throwIfDisposed(),Ug(this.gl,this.debug,n,this.framebuffer),this.debug&&vf(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(Ug(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&vf(this.gl)):K0(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(n,t){this.bindTextureToFrameBuffer(n);var r=t();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(n,t,r){this.throwIfDisposed();var o=this.gl;Ug(o,this.debug,n,this.framebuffer),this.debug&&vf(o),this.outputTexture=n,de(o,this.debug,function(){return o.viewport(0,0,t,r)}),de(o,this.debug,function(){return o.scissor(0,0,t,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(n,t,r,o){var i=this;this.throwIfDisposed(),de(this.gl,this.debug,function(){return i.gl.scissor(n,t,r,o)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function zN(e,n){if(e.length!==n.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+n.length+" inputs");e.forEach(function(t,r){var o=t.logicalShape,i=n[r],a=i.shape;if(!hn(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!t.isUniform||!i.isUniform){var s=t.texShape,u=i.isUniform?null:i.texData.texShape;if(!hn(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var zq=function(e,n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var o=t.inChannels,i=t.strideWidth,a=t.strideHeight,s=t.padInfo,u=t.outWidth,c=t.dilationWidth,l=t.dilationHeight,d=t.dataFormat,f=s.left,h=s.top,p=o*t.filterWidth,m=Zn(),v="channelsLast"===d,y=v?0:1,b=v?1:2,C="",x=0;x<=1;x++)for(var E=0;E<=1;E++)C+="\n          blockIndex = rc.y + "+E+";\n          pos = rc.x + "+x+";\n\n          if(blockIndex < "+e[1]+" && pos < "+e[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+a+" - "+h+";\n            d0 = offsetY + "+l+" * (pos / "+p+");\n\n            if(d0 < "+n[y]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+i+". - "+f+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+p+".) / "+o+".));\n\n              if(d1 < "+n[b]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+o+".));\n\n                if ("+v+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*x+E)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*x+E)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+C+"\n\n        "+m.output+" = result;\n      }\n    "},$q=function(e,n,t,r,o){this.variableNames=["x"],this.outputShape=[];var a=n,s=e[3]-1;this.outputShape=e;var u="float("+t+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+a+"; j <= "+a+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));")+";\n        setOutput(val);\n      }\n    "},Gq=function(e,n,t,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=t,this.alpha=r,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+n+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+n+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+t+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+o+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+o+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},qq=function(e,n,t,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a=n,s=e[3]-1;this.outputShape=e;var u="float("+t+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+a+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+a+"; j <= "+a+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));")+";\n        setOutput(result);\n      }\n    "},Xq=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var o=e.effectiveFilterHeight,i=e.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(o-1-e.padInfo.top)+", "+(i-1-e.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+o+";\n          wR += "+e.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(o*i-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Kq=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(s-1-e.padInfo.front)+", "+(u-1-e.padInfo.top)+", "+(c-1-e.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+e.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+e.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+e.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+e.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+(s*u*c-1)+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},wx=function(e,n,t,r,o,i,a){void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=null),void 0===a&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;var u=Math.ceil((t?e[1]:e[2])/2),c=t?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",d=t?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";i&&(h=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",p="result = activation(result);");var m=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+h+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+l+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+d[0]+" * "+f[0]+");\n          result += ("+d[1]+" * "+f[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+m+"\n\n        "+p+"\n\n        setOutput(result);\n      }\n    "},Yq=function(){function e(n,t,r){this.variableNames=["probs"],this.outputShape=[n,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(n){var t=this;return function(r,o){null==t.seedLoc&&(t.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(t.seedLoc,n)}},e}(),Zq=function(e,n,t,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+t+"),\n                      float(index == coords.y)));\n      }\n    "},Qq=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var s,c,l,n=e.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var t=Fr("rc",n),r=Ht(n),o=function(s,u,c){if(1===s)return"rc > "+u[0];for(var l="",d=s-2;d<s;d++)l+=c[d]+" >= "+u[d],d<s-1&&(l+="||");return l}(n,e,t),i=function(s,u,c,l){if(1===s)return"";var d=l.slice(-2);return"\n    int r = "+d[0]+";\n    int c = "+d[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+u+";\n    bool rEdge = rp1 >= "+c+";\n  "}(n,e[e.length-1],e[e.length-2],t),a=(l=function(d,f){for(var h=[],p=0;p<=1;p++)for(var m=0;m<=1;m++){for(var v=(0===p?"r":"rp1")+", "+(0===m?"c":"cp1"),y=2;y<d;y++)v=f[f.length-1-y]+","+v;h.push(v)}return h}(c=(s=e).length,t),1===c?"getA(rc),\n            rc + 1 >= "+s[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+l[0]+"),\n          cEdge ? 0. : getA("+l[1]+"),\n          rEdge ? 0. : getA("+l[2]+"),\n          rEdge || cEdge ? 0. : getA("+l[3]+")");this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+o+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+a+"));\n          }\n        }\n      "}},Jq=function(e,n,t){this.variableNames=["x"],this.outputShape=n.map(function(u,c){return u[0]+e[c]+u[1]});var r=e.length,o=Ht(r),i=n.map(function(u){return u[0]}).join(","),a=n.map(function(u,c){return u[0]+e[c]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+o+" start = "+o+"("+i+");\n      "+o+" end = "+o+"("+a+");\n\n      void main() {\n        "+o+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+t+"));\n        } else {\n          "+o+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+t+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},e7=function(e,n,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map(function(v,y){return v[0]+e[y]+v[1]});for(var r=e.length,o=Ht(r),i=n.map(function(v){return v[0]}).join(","),a=n.map(function(v,y){return v[0]+e[y]}).join(","),s=Fr("rc",r),u=Fr("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",d=[o+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],f=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",p=0,m=1===r?2:4;p<m;p++)h+="\n        "+d[p]+"\n        if ("+f+") {\n          result["+p+"] = float("+t+");\n        } else {\n          "+o+" source = rc - start;\n          result["+p+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";this.userCode="\n      const "+o+" start = "+o+"("+i+");\n      const "+o+" end = "+o+"("+a+");\n\n      void main() {\n        "+o+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(h+=1===r?"} ":"}}")+"\n        setOutput(result);\n      }\n    "},bx=function(e,n,t){if(this.variableNames=["x"],"avg"===n&&t)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=e.padInfo.top,d=e.padInfo.left;this.outputShape=e.outShape;var f="avg"===n,h="0.0";if(f||(h="-1.0 / 1e-20"),t)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+i+");\n        const ivec2 pads = ivec2("+l+", "+d+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p=n+"("+n+"("+n+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(p="avgValue / count");var m=4*Math.floor(r/4),v=r%4,y="\n      if ("+f+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+i+");\n      const ivec2 pads = ivec2("+l+", "+d+");\n      const float initializationValue = "+h+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+h+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+a+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+y+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+y+"\n          } else if ("+(2===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+y+"\n          } else if ("+(3===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+y+"\n          }\n        }\n        setOutput("+p+");\n      }\n    "}},xx=function(e,n,t){if(this.variableNames=["x"],"avg"===n&&t)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.front,p=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;var v="avg"===n,y="0.0";if(v||(y="-1.0 / 1e-20"),t)this.userCode="\n        const ivec3 strides =\n            ivec3("+o+", "+i+", "+a+");\n        const ivec3 pads = ivec3("+h+", "+p+", "+m+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+l+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+d+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+f+";\n                  wC += "+c+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+d+" * "+f+" +\n                      wR * "+f+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var b=n+"("+n+"("+n+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(b="avgValue / count");var C=4*Math.floor(r/4),x=r%4,E="\n      if ("+v+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+o+", "+i+", "+a+");\n      const ivec3 pads = ivec3("+h+", "+p+", "+m+");\n      const float initializationValue = "+y+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+y+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+C+"; wC += 4) {\n              int xC = xCCorner + wC * "+c+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+c+", ch)\n              );\n\n              "+E+"\n            }\n\n            int xC = xCCorner + "+C+";\n            if ("+(1===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+E+"\n            } else if ("+(2===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+E+"\n            } else if ("+(3===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                initializationValue\n              );\n\n              "+E+"\n            }\n          }\n          setOutput("+b+");\n        }\n      }\n    "}},t7=function(e,n){this.variableNames=["x"];var t=e.windowSize,r=e.batchSize,o=e.inSize,i=Math.ceil(o/t);this.outputShape=[r,i];var a="0.0",s="";"prod"===n?a="1.0":"min"===n?(a="1.0 / 1e-20",s="min"):"max"===n&&(a="-1.0 / 1e-20",s="max");var u=n+"("+n+"("+n+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?u="sumValue":"prod"===n?u="prodValue":"all"===n?u="allValue":"any"===n&&(u="anyValue");var c=4*Math.floor(t/4),l=t%4,d="\n      if ("+("sum"===n)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===n)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",f="vec4";"all"===n?(a="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",f="bvec4"):"any"===n&&(a="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",f="bvec4");var h="";o%t>0&&(h="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+a+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+h+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+t+";\n\n        vec4 minMaxValue = vec4("+a+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+d+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(2===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(3===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+d+"\n        }\n        setOutput("+u+");\n      }\n    "},n7=function(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var t="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),t+="\n        "+o+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+Ys(["r","c","d"],n)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+mx(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+t+"\n\n        setOutput(result);\n      }\n    "},r7=function(e,n,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var r=n.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],c=[t&&s>1?o-1:o,t&&u>1?i-1:i],l=[t&&s>1?s-1:s,t&&u>1?u-1:u],d=c[0]/l[0],f=c[1]/l[1],h=1/d,p=1/f,m=2*Math.ceil(h)+2,v=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+h+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(o-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},o7=function(e,n,t,r){this.variableNames=["A"],this.outputShape=[];var i=e[1],a=e[2];this.outputShape=[e[0],n,t,e[3]];var u=[r&&n>1?i-1:i,r&&t>1?a-1:a],c=[r&&n>1?n-1:n,r&&t>1?t-1:t];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},i7=function(e,n,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=e[1],a=e[2],s=e[3];this.outputShape=[e[0],n,t,s];var u=[r&&n>1?i-1:i,r&&t>1?a-1:a],c=[r&&n>1?n-1:n,r&&t>1?t-1:t];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+",\n          "+u[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+a+".0,\n                                     "+a+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(t-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},a7=function(e,n,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var r=n.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],c=[t&&s>1?o-1:o,t&&u>1?i-1:i],l=[t&&s>1?s-1:s,t&&u>1?u-1:u],d=c[0]/l[0],f=c[1]/l[1],h=1/d,p=1/f,m=2*Math.ceil(h)+2,v=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+h+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+o+") - 1),\n                "+t+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+t+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},s7=function(e,n,t,r){this.variableNames=["A"],this.outputShape=[];var i=e[1],a=e[2];this.outputShape=[e[0],n,t,e[3]];var u=[r&&n>1?i-1:i,r&&t>1?a-1:a],c=[r&&n>1?n-1:n,r&&t>1?t-1:t];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(r?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},u7=function(e,n){this.variableNames=["x"];var t=e.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");if(this.outputShape=e,1!==t){var r=e.map(function(i,a){return-1!==n.indexOf(s=a)&&1!==e[s]?e[s]+" - coords["+s+"] - 1":"coords["+s+"]";var s}).join(","),o=Ht(t);this.userCode="\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "},c7=function(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var t=e.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");this.outputShape=e;var u,r=Fr("rc",t),o=r[t-1]+" + 1 < "+this.outputShape[t-1],i=r[t-2]+" + 1 < "+this.outputShape[t-2],a=Ht(t);function s(u){var c=e.map(function(l,d){return h=u,-1!==n.indexOf(f=d)&&1!==e[f]?e[f]+" - "+h[f]+" - 1":""+h[f];var f,h});return"getChannel(getX("+c.join(",")+"), vec2("+c.slice(-2).join(",")+"))"}this.userCode=1===t?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+e[0]+" - rc - 1),\n            "+e[0]+" - rc - 1);\n          if("+o+"){\n              result.g = getChannel(getX("+e[0]+" - (rc  + 1) - 1),\n                "+e[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+a+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+s(r.slice())+";\n          if("+o+"){\n            result.g = "+((u=r.slice())[t-1]="("+u[t-1]+" + 1)",s(u)+";\n          }\n          if(")+i+") {\n            result.b = "+function(u){return u[t-2]="("+u[t-2]+" + 1)",s(u)}(r.slice())+";\n            if("+o+") {\n              result.a = "+function(u){return u[t-1]="("+u[t-1]+" + 1)",u[t-2]="("+u[t-2]+" + 1)",s(u)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},$N=function(e,n,t,r,o,i,a){void 0===a&&(a=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Ht(o.length),u=Ht(i.length),c="";1===t?c="i":2===t&&(c="i, j");var d="";1===r?d="i":2===r&&(d="i, coords[1]"),this.userCode="\n        "+s+" strides = "+s+"("+o+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+n+"; j++) {\n              int index = round(getIndices("+c+"));\n              flattenedIndex += index * "+(n>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+d+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},l7=function(e,n){this.variableNames=["x","segmentIds"];var t=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/t);this.outputShape=[r,a];var s=4*Math.floor(t/4),u=t%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";o%t>0&&(l="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      ");var d="";o%t>0&&(d="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+d+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+t+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},d7=function(e,n,t){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=n,t>4)throw Error("Where for rank "+t+" is not yet supported");if(1===t)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<n.length;u++)s.push(""+i[u]),u<e&&a.push(""+i[u]);r=a.join(),o=s.join()}var c=Ht(t);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+o+"));\n        } else {\n          setOutput(getB("+o+"));\n        }\n      }\n    "},f7=function(){function e(n){this.variableNames=["source"],this.outputShape=n,this.rank=n.length;var t,r=Ht(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(1===a)return"sourceLoc";if(a<=6)return Cx.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);t="\n        "+r+" sourceLoc;\n        "+r+" coords = getOutputCoords();\n        "+n.map(function(a,s){return"sourceLoc."+Cx[s]+" = start["+s+"] + coords."+Cx[s]+";"}).join("\n")+"\n      ",this.userCode="\n      "+o+"\n      void main() {\n        "+t+"\n        setOutput(getSource("+i+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(n){var t=this;if(n.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+n.length+")");return function(r,o){null==t.startLoc&&(t.startLoc=r.getUniformLocationNoThrow(o,"start"),null==t.startLoc)||r.gl.uniform1iv(t.startLoc,n)}},e}(),Cx=["x","y","z","w","u","v"],h7=function(){function e(n){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.rank=n.length;var t=Ht(this.rank),r=Fr("coords",this.rank),o=Fr("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s="\n      result.x = "+a+";\n      if (++"+r[this.rank-1]+" < "+n[this.rank-1]+") {\n        ++"+o[this.rank-1]+";\n        result.y = "+a+";\n        --"+o[this.rank-1]+";\n      }\n    ",u=1===this.rank?"":"\n      --"+r[this.rank-1]+";\n      if (++"+r[this.rank-2]+" < "+n[this.rank-2]+") {\n        ++"+o[this.rank-2]+";\n        result.z = "+a+";\n        if (++"+r[this.rank-1]+" < "+n[this.rank-1]+") {\n          ++"+o[this.rank-1]+";\n          result.w = "+a+";\n        }\n      }\n    ",c=this.rank<=4?"sourceLoc = coords +\n            "+t+"("+n.map(function(l,d){return"start["+d+"]"}).join()+");":n.map(function(l,d){return o[d]+" = "+r[d]+" + start["+d+"];"}).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+t+" coords = getOutputCoords();\n        "+t+" sourceLoc;\n        "+c+"\n        vec4 result = vec4(0.);\n        "+s+"\n        "+u+"\n        setOutput(result);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(n){var t=this;if(n.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+n.length+")");return function(r,o){null==t.startLoc&&(t.startLoc=r.getUniformLocationNoThrow(o,"start"),null==t.startLoc)||r.gl.uniform1iv(t.startLoc,n)}},e}(),p7=function(e,n,t){this.variableNames=["x"],this.outputShape=t;var r=t.length,o=Ht(t.length),i=Ht(t.length),a="";if(1===r)a="coords * strides + begin";else{var s=0;a=t.map(function(u,c){return s++,1===t.length?"coords * strides["+c+"] + begin["+c+"]":"coords["+(s-1)+"] * strides["+c+"] + begin["+c+"]"}).join(",")}this.userCode="\n      "+o+" begin = "+o+"("+e+");\n      "+o+" strides = "+o+"("+n+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "},g7=function(){function e(n){this.gpgpu=n,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(n,t,r){var o,i=GN(t,r),a=qN(n,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===Qr.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(n[0],n[1]):i===Qr.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(n[0],n[1]):i===Qr.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(n[0],n[1]):i===Qr.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(n[0],n[1]):i===Qr.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(n[0],n[1])),this.usedTextures[a].push(o),o},e.prototype.releaseTexture=function(n,t,r,o){if(null!=this.freeTextures){var i=qN(t,GN(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(n),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(n);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},e.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var n=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach(function(r){n.gpgpu.deleteMatrixTexture(r)});for(var t in this.usedTextures)this.usedTextures[t].forEach(function(o){n.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function GN(e,n){if(e===Zr.UPLOAD)return Qr.PACKED_2X2_FLOAT32;if(e===Zr.RENDER||null==e)return t=n,H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Qr.PACKED_2X2_FLOAT32:Qr.UNPACKED_FLOAT32:t?Qr.PACKED_2X2_FLOAT16:Qr.UNPACKED_FLOAT16;var t;if(e===Zr.DOWNLOAD||e===Zr.PIXELS)return Qr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function qN(e,n,t){return e[0]+"_"+e[1]+"_"+n+"_"+t}var m7=function(e,n){this.variableNames=["A"];for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=e[r]*n[r];this.outputShape=t,this.rank=t.length;var o=Ht(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(1===s)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],c=[],l=0;l<a.length;l++)c.push("imod("+u[l]+", "+a[l]+")");return c.join()}(e);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},v7=function(e,n){this.variableNames=["A"];for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=e[n[r]];this.outputShape=t,this.rank=t.length;var o=Ht(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],c=new Array(s),l=0;l<a.length;l++)c[a[l]]=u[l];return c.join()}(n);this.userCode="\n    void main() {\n      "+o+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},y7=function(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=e[n[r]];if(this.outputShape=t,this.rank=t.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=Ht(this.rank),i=gN("rc",this.rank),a=new Array(this.rank);for(r=0;r<n.length;r++)a[n[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+t[this.rank-1],c="getChannel(getA("+a.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+o+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+t[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},_x=1.7580993408473768,Dx=1.0507009873554805,je=function(e,n){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+n+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},zo="if (isnan(x)) return x;",XN="return abs(x);",KN=zo+"\n  return (x < 0.0) ? 0.0 : x;\n",YN=zo+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",ZN="return (x >= 0.0) ? x : (exp(x) - 1.0);",b7="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+_x+";\n  float scale = "+Dx+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",QN="return -x;",JN="return ceil(x);",ek="return floor(x);",tk="return exp(x);",nk="return exp(x) - 1.0;",x7=zo+"\n  return sin(x);\n",C7=zo+"\n  return cos(x);\n",_7=zo+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",D7=zo+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",E7=zo+"\n  return atan(x);\n",I7=zo+"return log(x + sqrt(x * x + 1.0));",S7=zo+"\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));",A7=zo+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;",om="return x;",rk="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",ok="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",ik="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Sf=function(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+n+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},T7=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var n=e.length,t=Fr("rc",n),r=Ht(n),o=function(s,u){if(1===s)return"rc";for(var c="",l=0;l<s;l++)c+=u[l],l<s-1&&(c+=",");return c}(n,t),i=t.slice(-2),a=n<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+o+");\n\n        setOutput(getChannel(packedInput, "+a+"));\n      }\n    "},im={};function am(e,n){if(void 0===n&&(n=!1),"linear"===e)return"return x;";if("relu"===e)return n?rk:KN;if("elu"===e)return n?ik:ZN;if("relu6"===e)return n?ok:YN;if("prelu"===e)return n?xN:bN;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var ak=function(e){function n(t){var r,o=e.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!H().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var i=fi(H().getNumber("WEBGL_VERSION"));o.binaryCache=((r=H().getNumber("WEBGL_VERSION"))in im||(im[r]={}),im[r]),o.gpgpu=new WN(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=t,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=t.gl.canvas;return o.textureManager=new g7(o.gpgpu),o.numMBBeforeWarning=null==H().global.screen?1024:H().global.screen.height*H().global.screen.width*window.devicePixelRatio*600/1024/1024,o.texData=new sN(o,F),o}return Bo(n,e),n.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},n.prototype.write=function(t,r,o){if(H().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===o&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:t,usage:Zr.UPLOAD}),i},n.prototype.move=function(t,r,o,i){if(H().getBool("DEBUG")&&this.checkNumericalProblems(r),"complex64"===i)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:o,dtype:i,values:r,usage:Zr.UPLOAD})},n.prototype.readSync=function(t){var r=this.texData.get(t),o=r.values,i=r.dtype,a=r.complexTensors,u=r.shape;if(null!=r.slice){var l;l=r.isPacked?new Sf(u,om):new je(u,om);var d=this.runWebGLProgram(l,[{dataId:t,shape:u,dtype:i}],i),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(null!=o)return this.convertAndCacheOnCPU(t);if("string"===i)return o;var h,p,m=null!=this.activeTimers;return m&&(h=Uo()),p="complex64"===i?fx(a.real.dataSync(),a.imag.dataSync()):this.getValuesFromTexture(t),m&&(this.downloadWaitMs+=Uo()-h),this.convertAndCacheOnCPU(t,p)},n.prototype.read=function(t){return he(this,void 0,void 0,function(){var r,o,i,a,u,c,l,d,f,h,p,m,v,y,b,E,I,N,R;return pe(this,function(M){switch(M.label){case 0:if(this.pendingRead.has(t))return r=this.pendingRead.get(t),[2,new Promise(function(T){return r.push(T)})];if(o=this.texData.get(t),i=o.values,a=o.shape,u=o.dtype,c=o.complexTensors,l=o.isPacked,null!=o.slice)return d=l?new Sf(a,om):new je(a,om),f=this.runWebGLProgram(d,[{dataId:t,shape:a,dtype:u}],u),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(null!=i)return[2,this.convertAndCacheOnCPU(t)];if(!H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===H().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,"complex64"!==u&&H().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(t),v=this.texData.get(m.dataId),p=(R=this.gpgpu).createBufferFromTexture.apply(R,[v.texture].concat(pf(a)))),this.pendingRead.set(t,[]),"complex64"===u?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:M.sent(),M.label=2;case 2:return"complex64"!==u?[3,4]:[4,Promise.all([c.real.data(),c.imag.data()])];case 3:return b=M.sent(),y=fx(b[0],b[1]),[3,5];case 4:null==p?y=this.getValuesFromTexture(t):(E=ge(a),y=this.gpgpu.downloadFloat32MatrixFromBuffer(p,E)),M.label=5;case 5:return null!=m&&this.disposeData(m.dataId),I=this.convertAndCacheOnCPU(t,y),N=this.pendingRead.get(t),this.pendingRead.delete(t),N.forEach(function(T){return T(I)}),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,I]}})})},n.prototype.checkNumericalProblems=function(t){if(null!=t)for(var r=0;r<t.length;r++){var o=t[r];if(!bR(o))throw H().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},n.prototype.getValuesFromTexture=function(t){var r,o=this.texData.get(t),i=o.shape,a=o.dtype,s=o.isPacked,u=ge(i);if(H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var c=this.decode(t),l=this.texData.get(c.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[l.texture].concat(pf(i))).subarray(0,u);return this.disposeData(c.dataId),d}var f=H().getBool("WEBGL_PACK")&&!0===s,h=f?jg(i):i,p=f?new Pq(h):new Fq(h),m=this.runWebGLProgram(p,[{shape:h,dtype:a,dataId:t}],"float32"),v=this.texData.get(m.dataId),y=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture,v.texShape[0],v.texShape[1]).subarray(0,u);return this.disposeData(m.dataId),y},n.prototype.time=function(t){return he(this,void 0,void 0,function(){var r,o,i,a,s,u,c;return pe(this,function(l){switch(l.label){case 0:return r=this.activeTimers,o=[],i=!1,null==this.programTimersStack?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,t(),a=Zi(this.activeTimers.map(function(d){return d.query})).filter(function(d){return null!=d}),s=Zi(this.activeTimers.map(function(d){return d.name})).filter(function(d){return null!=d}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return c=l.sent(),u.kernelMs=tR(c),u.getExtraProfileInfo=function(){return c.map(function(d,f){return{name:s[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},l.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},n.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},n.prototype.startTimer=function(){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Uo(),endMs:null}},n.prototype.endTimer=function(t){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=Uo(),t)},n.prototype.getQueryTime=function(t){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(r=t).endMs-r.startMs]})})},n.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var r=this.texData.get(t).complexTensors;null!=r&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(t)}}},n.prototype.releaseGPUData=function(t){var r=this.texData.get(t),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,c=r.slice,l=c&&c.origDataId||t,d=this.dataRefCount.get(l);d>1?this.dataRefCount.set(l,d-1):(this.dataRefCount.delete(l),null!=o&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,u)));var f=this.texData.get(t);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},n.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},n.prototype.getDataInfo=function(t){return this.texData.get(t)},n.prototype.getCPUBackend=function(){return H().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=F.findBackend("cpu")),this.cpuBackend):null},n.prototype.shouldExecuteOnCPU=function(t,r){var o=this;return void 0===r&&(r=128),null!=this.getCPUBackend()&&t.every(function(i){return null==o.texData.get(i.dataId).texture&&i.size<r})},n.prototype.getGPGPUContext=function(){return this.gpgpu},n.prototype.complex=function(t,r){var o=this.makeOutput(t.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:F.keep(t.clone()),imag:F.keep(r.clone())},o},n.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},n.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},n.prototype.slice=function(t,r,o){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,r,o);if(0===ge(o))return jn([],o,t.dtype);var i=this.texData.get(t.dataId).isPacked,a=ax(t.shape,r,o);if(i||!a){var s=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new h7(o):new f7(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[t],null,u)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,r,o)},n.prototype.shallowSlice=function(t,r,o){var i=this.texData.get(t.dataId),a=this.makeOutput(o,t.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=t.dtype;var u=sx(r,t.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||t.dataId};var c=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,c+1),a},n.prototype.stridedSlice=function(t,r,o,i){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,r,o,i);var a=Zg(r,o,i);if(a.some(function(u){return 0===u}))return jn([],a);var s=new p7(r,i,a);return this.compileAndRun(s,[t])},n.prototype.reverse=function(t,r){var o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new c7(t.shape,r):new u7(t.shape,r);return this.compileAndRun(o,[t])},n.prototype.concat=function(t,r){if("complex64"===t[0].dtype){var o=t.map(function(h){return Co(h)}),i=t.map(function(h){return pi(h)});return Un(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,r);if(1===t.length)return t[0];if(t.length>H().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(t.length/2),s=this.concat(t.slice(0,a),r),u=this.concat(t.slice(a),r);return this.concat([s,u],r)}if(H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var c=new bq(t.map(function(h){return h.shape}),r);return this.compileAndRun(c,t)}var l=$s(t.map(function(h){return h.shape}),r),d=t.map(function(h){return h.as2D(-1,ge(h.shape.slice(r)))}),f=new wq(d.map(function(h){return h.shape}));return this.compileAndRun(f,d).reshape(l)},n.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,QN,t.dtype);var r=new je(t.shape,QN);return this.compileAndRun(r,[t])},n.prototype.batchMatMul=function(t,r,o,i){var a=o?t.shape[2]:t.shape[1],s=i?r.shape[1]:r.shape[2],u=o?t.shape[1]:t.shape[2],c=t.shape[0];if((1===a||1===s)&&u>1e3){o&&(t=t.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var l=1===s?t:t.as3D(c,u,1),d=1===s?2:1,f=1===s?r.as3D(c,1,u):r;return this.multiply(l,f).sum(d,!0)}var h=An(t.dtype,r.dtype),p=new wx(t.shape,[c,a,s],o,i);return this.compileAndRun(p,[t,r],h)},n.prototype.fusedBatchMatMul=function(t){var r=t.a,o=t.b,i=t.transposeA,a=t.transposeB,s=t.bias,u=t.activation,c=t.preluActivationWeights,l=i?r.shape[2]:r.shape[1],d=a?o.shape[1]:o.shape[2],f=r.shape[0],h=An(r.dtype,o.dtype),p=null!=s,m=null!=c,v=u?am(u,!0):null,y=new wx(r.shape,[f,l,d],i,a,p,v,m),b=[r,o];return s&&b.push(s),c&&b.push(c),this.compileAndRun(y,b,h)},n.prototype.multiply=function(t,r){if("complex64"===t.dtype){var o=this.texData.get(t.dataId),i=this.texData.get(r.dataId),a=new yN("return areal * breal - aimag * bimag;",t.shape,r.shape),s=new yN("return areal * bimag + aimag * breal;",t.shape,r.shape),u=[this.makeComplexComponentTensorInfo(t,o.complexTensors.real),this.makeComplexComponentTensorInfo(t,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],c=this.compileAndRun(a,u),l=this.compileAndRun(s,u),d=this.complex(c,l);return c.dispose(),l.dispose(),d}if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.multiply(t,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,wN,t.dtype);var f=new an(wN,t.shape,r.shape);return this.compileAndRun(f,[t,r],t.dtype)},n.prototype.batchNormalization=function(t,r,o,i,a,s){var u=[t,r,o],c=null;null!=s&&(c=s.shape,u.push(s));var l=null;if(null!=a&&(l=a.shape,u.push(a)),H().getBool("WEBGL_PACK_NORMALIZATION")){var d=new hq(t.shape,r.shape,o.shape,c,l,i);return this.compileAndRun(d,u)}var f=new fq(t.shape,r.shape,o.shape,c,l,i);return this.compileAndRun(f,u)},n.prototype.localResponseNormalization4D=function(t,r,o,i,a){var s=H().getBool("WEBGL_PACK_NORMALIZATION")?new qq(t.shape,r,o,i,a):new $q(t.shape,r,o,i,a);return this.compileAndRun(s,[t])},n.prototype.LRNGrad=function(t,r,o,i,a,s,u){var c=new Gq(r.shape,i,a,s,u);return this.compileAndRun(c,[r,o,t])},n.prototype.tile=function(t,r){if("string"===t.dtype){var o=this.readSync(t.dataId).map(function(a){return uf(a)});return hN(Oe(t.shape,t.dtype,o),r)}var i=new m7(t.shape,r);return this.compileAndRun(i,[t])},n.prototype.pad=function(t,r,o){var i=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new e7(t.shape,r,o):new Jq(t.shape,r,o);return this.compileAndRun(i,[t])},n.prototype.transpose=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,r);var o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new y7(t.shape,r):new v7(t.shape,r);return this.compileAndRun(o,[t])},n.prototype.gather=function(t,r,o){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.gather(t,r,o);var i=new jq(t.shape,r.size,o);return this.compileAndRun(i,[t,r])},n.prototype.batchToSpaceND=function(t,r,o){A(t.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,f){return d*f}),a=qg(t.shape,r,i),s=Xg(a.length,r.length),u=Kg(t.shape,r,i),c=eN(o,r.length),l=tN(u,o,r.length);return t.reshape(a).transpose(s).reshape(u).slice(c,l)},n.prototype.spaceToBatchND=function(t,r,o){A(t.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<t.shape.length;++s)a.push([0,0]);var u=t.pad(a),c=qg(u.shape,r,i,!1),l=Xg(c.length,r.length,!1),d=Kg(u.shape,r,i,!1);return u.reshape(c).transpose(l).reshape(d)},n.prototype.reduce=function(t,r,o){var i=t.shape[0],a=t.shape[1],s=Yg(a),u=new t7({windowSize:s,inSize:a,batchSize:i},r),c=this.compileAndRun(u,[t],o);return 1===c.shape[1]?c:this.reduce(c,r,o)},n.prototype.argReduce=function(t,r,o){void 0===o&&(o=null);var i=t.shape[0],a=t.shape[1];null!=o&&(i=o.shape[0],a=o.shape[1]);var s=Yg(a),u=new rq({windowSize:s,inSize:a,batchSize:i},r,null==o),c=[t];null!=o&&c.push(o);var l=this.compileAndRun(u,c,"int32");return 1===l.shape[1]?l:this.argReduce(t,r,l)},n.prototype.argReducePacked=function(t,r,o){void 0===o&&(o=null);var i=null!=o?o.shape:t.shape,a=Yg(i[i.length-1]),s=new cq(i,a,r,null==o),c=this.compileAndRun(s,null==o?[t]:[t,o],"int32");return c.rank===t.rank?this.argReducePacked(t,r,c):c},n.prototype.sum=function(t,r){Nr("sum",r,t.rank);var o=Vn(t.shape,r),i=o[0],a=ge(o[1]),s=t.as2D(-1,a),u=W0(t.dtype);return this.reduce(s,"sum",u).reshape(i)},n.prototype.prod=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,r);var o=Vn(t.shape,r),i=o[0],a=ge(o[1]),s=t.as2D(-1,a),u=W0(t.dtype);return this.reduce(s,"prod",u).reshape(i)},n.prototype.unsortedSegmentSum=function(t,r,o){var i=0,a=jo([i],t.rank),s=t;null!=a&&(s=t.transpose(a),i=Ho(1,t.rank)[0]);var u=function(h,p,m){for(var v=[],y=h.length,b=0;b<y;b++)v.push(b!==p?h[b]:m);return v}(s.shape,i,o),c=ge([s.shape[i]]),l=s.as2D(-1,c),d=W0(t.dtype),f=this.segOpCompute(l,"unsortedSegmentSum",r,d,o).reshape(u);return null!=a&&(f=f.transpose(zg(a))),f},n.prototype.segOpCompute=function(t,r,o,i,a){var s=t.shape[0],u=t.shape[1],c=function(f,h){var p,m=!1;for(f<=30?(p=f,m=!0):p=Pg(f,Math.floor(Math.sqrt(f)));!m;)p>h||p===f?m=!0:p=Pg(f,p+1);return p}(u,a),l=new l7({windowSize:c,inSize:u,batchSize:s,numSegments:a},r),d=this.compileAndRun(l,[t,o],i);return d.shape[1]===a?d:(o=$g(0,a).tile([u/c]),this.segOpCompute(d,r,o,i,a))},n.prototype.argMinMaxReduce=function(t,r,o){var i=[r];if(Nr("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,t.rank),!H().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var a=Vn(t.shape,i),s=a[0],u=ge(a[1]),c=t.as2D(-1,u);return this.argReduce(c,o).reshape(s)}return this.argReducePacked(t,o)},n.prototype.argMin=function(t,r){return this.argMinMaxReduce(t,r,"min")},n.prototype.argMax=function(t,r){return this.argMinMaxReduce(t,r,"max")},n.prototype.cumsum=function(t,r,o,i){if(r!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+r);var a=new Mq(t.shape,o,i);return this.compileAndRun(a,[t])},n.prototype.equal=function(t,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,"\n  return vec4(equal(a, b));\n","bool");var o=new an("return float(a == b);",t.shape,r.shape);return this.compileAndRun(o,[t,r],"bool")},n.prototype.notEqual=function(t,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,"\n  return vec4(notEqual(a, b));\n","bool");var o=new an("return float(a != b);",t.shape,r.shape);return this.compileAndRun(o,[t,r],"bool")},n.prototype.less=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.less(t,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,"\n  return vec4(lessThan(a, b));\n","bool");var o=new an("return float(a < b);",t.shape,r.shape);return this.compileAndRun(o,[t,r],"bool")},n.prototype.lessEqual=function(t,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,"\n  return vec4(lessThanEqual(a, b));\n","bool");var o=new an("return float(a <= b);",t.shape,r.shape);return this.compileAndRun(o,[t,r],"bool")},n.prototype.greater=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.greater(t,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,"\n  return vec4(greaterThan(a, b));\n","bool");var o=new an("return float(a > b);",t.shape,r.shape);return this.compileAndRun(o,[t,r],"bool")},n.prototype.greaterEqual=function(t,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var o=new an("return float(a >= b);",t.shape,r.shape);return this.compileAndRun(o,[t,r],"bool")},n.prototype.logicalNot=function(t){var r=new je(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[t])},n.prototype.logicalAnd=function(t,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var o=new an("return float(a >= 1.0 && b >= 1.0);",t.shape,r.shape);return this.compileAndRun(o,[t,r],"bool")},n.prototype.logicalOr=function(t,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var o=new an("return float(a >= 1.0 || b >= 1.0);",t.shape,r.shape);return this.compileAndRun(o,[t,r],"bool")},n.prototype.select=function(t,r,o){var i=new d7(t.rank,r.shape,r.rank);return this.compileAndRun(i,[t,r,o],An(r.dtype,o.dtype))},n.prototype.where=function(t){Wg("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=t.dataSync();return gx(t.shape,r)},n.prototype.topk=function(t,r,o){return pN(t.dataSync(),t.shape,t.dtype,r)},n.prototype.min=function(t,r){Nr("min",r,t.rank);var o=Vn(t.shape,r),i=o[0],a=ge(o[1]),s=t.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},n.prototype.minimum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.minimum(t,r);var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,r.shape):new an("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,r.shape);return this.compileAndRun(o,[t,r])},n.prototype.mod=function(t,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,r.shape):new an("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,r.shape);return this.compileAndRun(o,[t,r])},n.prototype.max=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,r);Nr("max",r,t.rank);var o=Vn(t.shape,r),i=o[0],a=ge(o[1]),s=t.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},n.prototype.maximum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.maximum(t,r);var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,r.shape):new an("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,r.shape);return this.compileAndRun(o,[t,r])},n.prototype.all=function(t,r){Nr("all",r,t.rank);var o=Vn(t.shape,r),i=o[0],a=ge(o[1]),s=t.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},n.prototype.any=function(t,r){Nr("any",r,t.rank);var o=Vn(t.shape,r),i=o[0],a=ge(o[1]),s=t.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},n.prototype.realDivide=function(t,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var o=new an("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,r.shape);return this.compileAndRun(o,[t,r],"float32")},n.prototype.floorDiv=function(t,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var o=new an("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,r.shape);return this.compileAndRun(o,[t,r],"int32")},n.prototype.add=function(t,r){if("complex64"===t.dtype&&"complex64"===r.dtype)return this.complexSeparableBinaryOp(t,r,vx);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.add(t,r);var o=An(t.dtype,r.dtype);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,vx,o);var i=new an(vx,t.shape,r.shape);return this.compileAndRun(i,[t,r],o)},n.prototype.packedUnaryOp=function(t,r,o){var i=new Sf(t.shape,r);return this.compileAndRun(i,[t],o)},n.prototype.packedBinaryOp=function(t,r,o,i,a){void 0===a&&(a=!1);var s=new na(o,t.shape,r.shape,a);return this.compileAndRun(s,[t,r],i)},n.prototype.complexSeparableBinaryOp=function(t,r,o){var i=this,a=this.texData.get(t.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(f){var h=f[0],p=f[1],m=i.makeComplexComponentTensorInfo(t,h),v=i.makeComplexComponentTensorInfo(r,p),y=new an(o,t.shape,r.shape);return i.compileAndRun(y,[m,v],An(h.dtype,p.dtype))}),c=u[0],l=u[1],d=this.complex(c,l);return c.dispose(),l.dispose(),d},n.prototype.makeComplexComponentTensorInfo=function(t,r){return{dataId:r.dataId,dtype:r.dtype,shape:t.shape}},n.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>H().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(t.length/2),o=this.addN(t.slice(0,r)),i=this.addN(t.slice(r));return this.addN([o,i])}var a=t.map(function(c){return c.dtype}).reduce(function(c,l){return An(c,l)}),s=t.map(function(c){return c.shape}),u=H().getBool("WEBGL_PACK")?new nq(t[0].shape,s):new tq(t[0].shape,s);return this.compileAndRun(u,t,a)},n.prototype.subtract=function(t,r){if("complex64"===t.dtype&&"complex64"===r.dtype)return this.complexSeparableBinaryOp(t,r,yx);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.subtract(t,r);var o=An(t.dtype,r.dtype);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,yx,t.dtype);var i=new an(yx,t.shape,r.shape);return this.compileAndRun(i,[t,r],o)},n.prototype.pow=function(t,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,r.shape):new an("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,r.shape),i=An(t.dtype,r.dtype);return this.compileAndRun(o,[t,r],i)},n.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,JN,t.dtype);var r=new je(t.shape,JN);return this.compileAndRun(r,[t])},n.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,ek,t.dtype);var r=new je(t.shape,ek);return this.compileAndRun(r,[t])},n.prototype.sign=function(t){var r=new je(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(r,[t])},n.prototype.isNaN=function(t){var r=new je(t.shape,"return float(isnan(x));");return this.compileAndRun(r,[t],"bool")},n.prototype.isInf=function(t){var r=new je(t.shape,"return float(isinf(x));");return this.compileAndRun(r,[t],"bool")},n.prototype.isFinite=function(t){var r=new je(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[t],"bool")},n.prototype.round=function(t){var r=new je(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(r,[t])},n.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,tk,t.dtype);var r=new je(t.shape,tk);return this.compileAndRun(r,[t])},n.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,nk,t.dtype);var r=new je(t.shape,nk);return this.compileAndRun(r,[t])},n.prototype.softmax=function(t,r){var o=pn([r],t.shape),i=this.max(t,o),a=vr(i.shape,o),s=this.subtract(t,i.reshape(a)),u=this.exp(s),c=this.sum(u,o).reshape(a);return this.realDivide(u,c)},n.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);var r=new je(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(r,[t])},n.prototype.log1p=function(t){var r=new je(t.shape,"return log(1.0 + x);");return this.compileAndRun(r,[t])},n.prototype.sqrt=function(t){var r=new je(t.shape,"return sqrt(x);");return this.compileAndRun(r,[t])},n.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var r=new je(t.shape,"return inversesqrt(x);");return this.compileAndRun(r,[t])},n.prototype.reciprocal=function(t){var r=new je(t.shape,"return 1.0 / x;");return this.compileAndRun(r,[t])},n.prototype.relu=function(t){var r;return r=H().getBool("WEBGL_PACK")?new Sf(t.shape,rk):new je(t.shape,KN),this.compileAndRun(r,[t])},n.prototype.relu6=function(t){var r;return r=H().getBool("WEBGL_PACK")?new Sf(t.shape,ok):new je(t.shape,YN),this.compileAndRun(r,[t])},n.prototype.prelu=function(t,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na(xN,t.shape,r.shape):new an(bN,t.shape,r.shape);return this.compileAndRun(o,[t,r])},n.prototype.elu=function(t){if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,ik,t.dtype);var r=new je(t.shape,ZN);return this.compileAndRun(r,[t])},n.prototype.eluDer=function(t,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,r.shape):new an("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,r.shape);return this.compileAndRun(o,[t,r])},n.prototype.selu=function(t){var r=new je(t.shape,b7);return this.compileAndRun(r,[t])},n.prototype.int=function(t){var r=new je(t.shape,"return float(int(x));");return this.compileAndRun(r,[t],"int32")},n.prototype.clip=function(t,r,o){var i,a=(i=H().getBool("WEBGL_PACK_CLIP")?new vq(t.shape):new mq(t.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[t],null,a)},n.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,XN,t.dtype);var r=new je(t.shape,XN);return this.compileAndRun(r,[t])},n.prototype.complexAbs=function(t){var r=this.texData.get(t.dataId),o=new yq(t.shape),i=[this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)];return this.compileAndRun(o,i)},n.prototype.sigmoid=function(t){var r=new je(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[t])},n.prototype.softplus=function(t){var r=new je(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(r,[t])},n.prototype.sin=function(t){var r=new je(t.shape,x7);return this.compileAndRun(r,[t])},n.prototype.cos=function(t){var r=new je(t.shape,C7);return this.compileAndRun(r,[t])},n.prototype.tan=function(t){var r=new je(t.shape,"return tan(x);");return this.compileAndRun(r,[t])},n.prototype.asin=function(t){var r=new je(t.shape,_7);return this.compileAndRun(r,[t])},n.prototype.acos=function(t){var r=new je(t.shape,D7);return this.compileAndRun(r,[t])},n.prototype.atan=function(t){var r=new je(t.shape,E7);return this.compileAndRun(r,[t])},n.prototype.atan2=function(t,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,r.shape):new an("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,r.shape);return this.compileAndRun(o,[t,r])},n.prototype.sinh=function(t){var r=new je(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(r,[t])},n.prototype.cosh=function(t){var r=new je(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(r,[t])},n.prototype.tanh=function(t){var r=new je(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(r,[t])},n.prototype.asinh=function(t){var r=new je(t.shape,I7);return this.compileAndRun(r,[t])},n.prototype.acosh=function(t){var r=new je(t.shape,S7);return this.compileAndRun(r,[t])},n.prototype.atanh=function(t){var r=new je(t.shape,A7);return this.compileAndRun(r,[t])},n.prototype.erf=function(t){var r=new je(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(r,[t])},n.prototype.step=function(t,r){var i,o=new je(t.shape,(void 0===(i=r)&&(i=0),zo+"\n    return x > 0.0 ? 1.0 : float("+i+");\n  "));return this.compileAndRun(o,[t])},n.prototype.conv2dByMatMul=function(t,r,o,i,a,s){var u=t.shape,c=this.texData.get(t.dataId),h="channelsLast"===o.dataFormat,m=u[2]%2!=0&&!!c.isPacked;if((1==u[0]*u[1]*u[2]||1===o.outChannels)&&o.inChannels>1e3||!H().getBool("WEBGL_LAZILY_UNPACK")||!H().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!m){var y=this.reshape(t,[1,h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],o.inChannels]),b=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:y,b,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var x={dataId:t.dataId,shape:[1,h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),o.inChannels],dtype:t.dtype},E=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,A(bf(c.shape,x.shape),function(){return"packed reshape "+c.shape+" to "+x.shape+" isn't free"});var I=this.reshape(r,[1,o.inChannels,o.outChannels]),N=this.fusedBatchMatMul({a:x,b:I,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),R=this.texData.get(N.dataId);return A(R.isPacked,function(){return"batchMatMul result is expected to be packed"}),c.shape=E,R.shape=o.outShape,F.makeTensorFromDataId(N.dataId,o.outShape,N.dtype)},n.prototype.conv2dWithIm2Row=function(t,r,o,i,a,s){var d=o.outWidth,f=o.outHeight,h="channelsLast"===o.dataFormat,p=o.filterWidth*o.filterHeight*o.inChannels,m=f*d,v=[p,m],y=t.squeeze([0]),b=r.reshape([1,p,-1]),C=new zq(v,y.shape,o),x=this.compileAndRun(C,[y]).reshape([1,v[0],v[1]]),E=null!=i,I=null!=s,N=a?am(a,!0):null,R=new wx(x.shape,[1,m,o.outChannels],!0,!1,E,N,I),M=[x,b];return i&&M.push(i),I&&M.push(s),this.compileAndRun(R,M).reshape(h?[1,f,d,o.outChannels]:[1,o.outChannels,f,d])},n.prototype.fusedConv2d=function(t){var r=t.input,o=t.filter,i=t.convInfo,a=t.bias,s=t.activation,u=t.preluActivationWeights;if(1===i.filterHeight&&1===i.filterWidth&&1===i.dilationHeight&&1===i.dilationWidth&&1===i.strideHeight&&1===i.strideWidth&&("SAME"===i.padInfo.type||"VALID"===i.padInfo.type))return this.conv2dByMatMul(r,o,i,a,s,u);if(H().getBool("WEBGL_CONV_IM2COL")&&1===r.shape[0])return this.conv2dWithIm2Row(r,o,i,a,s,u);var c=null!=a,l=null!=u,d=s?am(s,!1):null,f=new CN(i,c,d,l),h=[r,o];return a&&h.push(a),u&&h.push(u),this.compileAndRun(f,h)},n.prototype.conv2d=function(t,r,o){if(1===o.filterHeight&&1===o.filterWidth&&1===o.dilationHeight&&1===o.dilationWidth&&1===o.strideHeight&&1===o.strideWidth&&("SAME"===o.padInfo.type||"VALID"===o.padInfo.type))return this.conv2dByMatMul(t,r,o);if(H().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,r,o);var i=new CN(o);return this.compileAndRun(i,[t,r])},n.prototype.conv2dDerInput=function(t,r,o){var i=new Cq(o);return this.compileAndRun(i,[t,r])},n.prototype.conv2dDerFilter=function(t,r,o){var i=new xq(o);return this.compileAndRun(i,[t,r])},n.prototype.fusedDepthwiseConv2D=function(t){var r,o=t.input,i=t.filter,a=t.convInfo,s=t.bias,u=t.activation,c=t.preluActivationWeights,l=H().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,d=u?am(u,l):null,f=[o,i],h=null!=s,p=null!=c;return h&&f.push(s),p&&f.push(c),l?(r=new DN(a,h,d,p),this.compileAndRun(r,f)):(r=new _N(a,h,d,p),this.compileAndRun(r,f))},n.prototype.depthwiseConv2D=function(t,r,o){var i;return H().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new DN(o),this.compileAndRun(i,[t,r])):(i=new _N(o),this.compileAndRun(i,[t,r]))},n.prototype.depthwiseConv2DDerInput=function(t,r,o){var i=new Iq(o);return this.compileAndRun(i,[t,r])},n.prototype.depthwiseConv2DDerFilter=function(t,r,o){var i=new Eq(o);return this.compileAndRun(i,[t,r])},n.prototype.conv3d=function(t,r,o){var i=new Sq(o);return this.compileAndRun(i,[t,r])},n.prototype.conv3dDerInput=function(t,r,o){var i=new Dq(o);return this.compileAndRun(i,[t,r])},n.prototype.conv3dDerFilter=function(t,r,o){var i=new _q(o);return this.compileAndRun(i,[t,r])},n.prototype.maxPool=function(t,r){var o=new bx(r,"max",!1);return this.compileAndRun(o,[t])},n.prototype.avgPool=function(t,r){var o=new bx(r,"avg",!1);return this.compileAndRun(o,[t],"float32")},n.prototype.maxPoolBackprop=function(t,r,o,i){var a=new bx(i,"max",!0),s=this.compileAndRun(a,[r]),u=new Xq(i),c=this.compileAndRun(u,[t,s],r.dtype);return s.dispose(),c},n.prototype.avgPoolBackprop=function(t,r,o){var i=new lq(o);return this.compileAndRun(i,[t],r.dtype)},n.prototype.cast=function(t,r){return lx(t,r,this)},n.prototype.unstack=function(t,r){for(var o=t.shape[r],i=new Array(t.rank-1),a=0,s=0;s<t.rank;s++)s!==r&&(i[a++]=t.shape[s]);var u=new Array(t.rank).fill(0),c=t.shape.slice();c[r]=1;var l=new Array(o);for(s=0;s<l.length;s++)u[r]=s,l[s]=this.slice(t,u,c).reshape(i);return l},n.prototype.avgPool3d=function(t,r){var o=new xx(r,"avg",!1);return this.compileAndRun(o,[t],"float32")},n.prototype.avgPool3dBackprop=function(t,r,o){var i=new dq(o);return this.compileAndRun(i,[t],r.dtype)},n.prototype.maxPool3d=function(t,r){var o=new xx(r,"max",!1);return this.compileAndRun(o,[t],"float32")},n.prototype.maxPool3dBackprop=function(t,r,o,i){var a=new xx(i,"max",!0),s=this.compileAndRun(a,[r]),u=new Kq(i),c=this.compileAndRun(u,[t,s],r.dtype);return s.dispose(),c},n.prototype.reshape=function(t,r){var o=this.texData.get(t.dataId);if(o.isPacked&&!bf(t.shape,r)&&(null===o.texture||!bf(o.shape,r))){var i=this.packedReshape(t,r);return F.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return nm(t,r)},n.prototype.resizeBilinear=function(t,r,o,i){var a=H().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new i7(t.shape,r,o,i):new o7(t.shape,r,o,i);return this.compileAndRun(a,[t],"float32")},n.prototype.resizeBilinearBackprop=function(t,r,o){var i=new r7(t,r,o);return this.compileAndRun(i,[t])},n.prototype.resizeNearestNeighbor=function(t,r,o,i){var a=new s7(t.shape,r,o,i);return this.compileAndRun(a,[t])},n.prototype.resizeNearestNeighborBackprop=function(t,r,o){var i=new a7(t,r,o);return this.compileAndRun(i,[t])},n.prototype.multinomial=function(t,r,o,i){var a=r?t:ea(t),c=new Yq(a.shape[0],a.shape[1],o),l=c.getCustomSetupFunc(i);return this.compileAndRun(c,[a],"int32",l)},n.prototype.oneHot=function(t,r,o,i){var a=new Zq(t.size,r,o,i);return this.compileAndRun(a,[t])},n.prototype.diag=function(t){var r=new kq(t.size);return this.compileAndRun(r,[t])},n.prototype.nonMaxSuppression=function(t,r,o,i,a){return Wg("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),hx(t.dataSync(),r.dataSync(),o,i,a)},n.prototype.cropAndResize=function(t,r,o,i,a,s){var u=new Aq(t.shape,r.shape,i,a,s);return this.compileAndRun(u,[t,r,o],"float32")},n.prototype.depthToSpace=function(t,r,o){A(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=t.shape[0],c=("NHWC"===o?t.shape[1]:t.shape[2])*r,l=("NHWC"===o?t.shape[2]:t.shape[3])*r,d=("NHWC"===o?t.shape[3]:t.shape[1])/(r*r),f=new Nq("NHWC"===o?[i,c,l,d]:[i,d,c,l],r,o);return this.compileAndRun(f,[t])},n.prototype.split=function(t,r,o){return fN(t,r,o)},n.prototype.scatterND=function(t,r,o){var i=Cf(0,t,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,c=i.strides,l=i.outputSize,d=[l/u,u],f=t.reshape([s,a]),h=r.reshape([s,u]);if(0===l)return nm(jn([]),o);var p=ae(0),m=new $N(s,a,f.rank,h.rank,c,d);return this.compileAndRun(m,[h,f,p]).reshape(o)},n.prototype.sparseToDense=function(t,r,o,i){var a=Cf(0,t,o),d=new $N(a.numUpdates,a.sliceRank,t.rank,r.rank,a.strides,[a.outputSize,1],!1);return this.compileAndRun(d,[r,t,i]).reshape(o)},n.prototype.fft=function(t){return this.fftImpl(t,!1)},n.prototype.ifft=function(t){return this.fftImpl(t,!0)},n.prototype.fftImpl=function(t,r){var o=this.texData.get(t.dataId),i=new IN("return real * expR - imag * expI;",t.shape,r),a=new IN("return real * expI + imag * expR;",t.shape,r),s=[this.makeComplexComponentTensorInfo(t,o.complexTensors.real),this.makeComplexComponentTensorInfo(t,o.complexTensors.imag)],u=this.compileAndRun(i,s),c=this.compileAndRun(a,s),l=this.complex(u,c).as2D(t.shape[0],t.shape[1]);return u.dispose(),c.dispose(),l},n.prototype.gatherND=function(t,r){var o=r.shape,i=o[o.length-1],a=rx(t,r),s=a[0],u=a[1],c=a[2],l=a[3],d=r.reshape([u,i]),f=t.reshape([t.size/c,c]),h=new Hq(i,l,[u,c]);return this.compileAndRun(h,[f,d]).reshape(s)},n.prototype.fill=function(t,r,o){if("string"===(o=o||Pc(r))){var i=sf(o,ge(t));return i.fill(r),F.makeTensor(i,t,o,this)}var a=new Uq(t,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},n.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},n.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},n.prototype.linspace=function(t,r,o){return dx(t,r,o)},n.prototype.makeTensorInfo=function(t,r){var o=this.write(null,t,r);return this.texData.get(o).usage=null,{dataId:o,shape:t,dtype:r}},n.prototype.makeOutput=function(t,r){var o=this.makeTensorInfo(t,r).dataId;return F.makeTensorFromDataId(o,t,r,this)},n.prototype.unpackTensor=function(t){var r=new T7(t.shape);return this.runWebGLProgram(r,[t],t.dtype)},n.prototype.packTensor=function(t){var r=new Qq(t.shape);return this.runWebGLProgram(r,[t],t.dtype,null,!0)},n.prototype.packedReshape=function(t,r){var o=[yf(t.shape)].concat(wf(t.shape)),i={dtype:t.dtype,shape:o,dataId:t.dataId},a=[yf(r)].concat(wf(r)),s=new n7(a,o),u=this.runWebGLProgram(s,[i],t.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},n.prototype.decode=function(t){var r,o=this.texData.get(t),i=o.isPacked,a=o.shape,s=o.dtype,u=jg(a);return r=i?new Rq(u):new Tq(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:t}],s,null,!0).dataId}},n.prototype.runWebGLProgram=function(t,r,o,i,a){var s=this;void 0===a&&(a=!1);var u=this.makeTensorInfo(t.outputShape,o),c=this.texData.get(u.dataId);if(t.packedOutput&&(c.isPacked=!0),t.outPackingScheme===hf.DENSE){var l=pf(t.outputShape);c.texShape=l.map(function(C){return 2*C})}if(null!=t.outTexUsage&&(c.usage=t.outTexUsage),0===ge(u.shape))return c.values=Fc(u.dtype,0),u;var d=[],f=r.map(function(C){if("complex64"===C.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var x=s.texData.get(C.dataId);if(null==x.texture){if(!t.packedInputs&&ge(C.shape)<=H().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:C.shape,texData:null,isUniform:!0,uniformValues:x.values};t.packedInputs&&(x.isPacked=!0,x.shape=C.shape)}else if(!!x.isPacked!=!!t.packedInputs)C=x.isPacked?s.unpackTensor(C):s.packTensor(C),d.push(C),x=s.texData.get(C.dataId);else if(x.isPacked&&!bf(x.shape,C.shape)){var E=C,I=C.shape;C.shape=x.shape,C=s.packedReshape(C,I),d.push(C),x=s.texData.get(C.dataId),E.shape=I}return s.uploadToGPU(C.dataId),{shape:C.shape,texData:x,isUniform:!1}});this.uploadToGPU(u.dataId);var h,C,I,p={shape:u.shape,texData:c,isUniform:!1},m=(C=t,I="",f.concat(p).forEach(function(M){I+=M.shape+"_"+(M.isUniform?"uniform":M.texData.texShape)+"_"+(null!=M.texData&&null!=M.texData.slice&&M.texData.slice.flatOffset>0)}),C.constructor.name+"_"+I+"_"+C.userCode),v=this.getAndSaveBinary(m,function(){return function(C,x,E,I){var N=x.userCode,R=E.map(function(X,ne){var re={logicalShape:X.shape,texShape:X.isUniform?null:X.texData.texShape,isUniform:X.isUniform,isPacked:!X.isUniform&&X.texData.isPacked,flatOffset:null};return null!=X.texData&&null!=X.texData.slice&&X.texData.slice.flatOffset>0&&(re.flatOffset=X.texData.slice.flatOffset),{name:x.variableNames[ne],shapeInfo:re}}),M=R.map(function(X){return X.shapeInfo}),T={logicalShape:I.shape,texShape:I.texData.texShape,isUniform:!1,isPacked:I.texData.isPacked,flatOffset:null},L=oq(R,T,N,x.packedInputs),O=C.createProgram(L),q=null,$=C.getUniformLocation(O,"NAN",!1);1===H().getNumber("WEBGL_VERSION")&&(q=C.getUniformLocation(O,"INFINITY",!1));for(var G={},J=0;J<x.variableNames.length;J++){var Y=x.variableNames[J];G[Y]=C.getUniformLocation(O,Y,!1),G["offset"+Y]=C.getUniformLocation(O,"offset"+Y,!1)}return{program:x,source:L,webGLProgram:O,uniformLocations:G,inShapeInfos:M,outShapeInfo:T,infLoc:q,nanLoc:$}}(s.gpgpu,t,f,p)}),y=null!=this.activeTimers;if(y&&(h=this.startTimer()),function(C,x,E,I,N){zN(x.inShapeInfos,E),zN([x.outShapeInfo],[I]);var R=I.texData.texture,M=I.texData.texShape;I.texData.isPacked?C.setOutputPackedMatrixTexture(R,M[0],M[1]):C.setOutputMatrixTexture(R,M[0],M[1]),C.setProgram(x.webGLProgram),1===H().getNumber("WEBGL_VERSION")&&null!==x.infLoc&&C.gl.uniform1f(x.infLoc,1/0),null!==x.nanLoc&&C.gl.uniform1f(x.nanLoc,NaN),E.forEach(function(T,L){var O=x.program.variableNames[L],q=x.uniformLocations[O],$=x.uniformLocations["offset"+O];if(null!=q)if(T.isUniform)if(ge(T.shape)<2)C.gl.uniform1f(q,T.uniformValues[0]);else{var G=T.uniformValues;G instanceof Float32Array||(G=new Float32Array(G)),C.gl.uniform1fv(q,G)}else null!=T.texData.slice&&null!=$&&C.gl.uniform1i($,T.texData.slice.flatOffset),C.setInputMatrixTexture(T.texData.texture,q,L)}),N?.(C,x.webGLProgram),C.executeProgram()}(this.gpgpu,v,f,p,i),d.forEach(function(C){return s.disposeData(C.dataId)}),y&&(h=this.endTimer(h),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(h)})),!H().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&!1===a){var b=this.unpackTensor(u);return this.disposeData(u.dataId),b}return u},n.prototype.compileAndRun=function(t,r,o,i,a){void 0===a&&(a=!1);var s=this.runWebGLProgram(t,r,o=o||r[0].dtype,i,a);return F.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},n.prototype.getAndSaveBinary=function(t,r){return t in this.binaryCache||(this.binaryCache[t]=r()),this.binaryCache[t]},n.prototype.getTextureManager=function(){return this.textureManager},n.prototype.dispose=function(){var t=this;this.disposed||(H().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){t.gpgpu.deleteProgram(t.binaryCache[r].webGLProgram),delete t.binaryCache[r]}),this.textureManager.dispose(),null!=this.canvas&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},n.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=le(function(){if(!H().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=H().getBool("DEBUG");H().set("DEBUG",!1);var o=t.abs(ae(1e-8)).dataSync()[0];if(H().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},n.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},n.prototype.uploadToGPU=function(t){var r,o=this.texData.get(t),i=o.shape,a=o.dtype,s=o.values,c=o.usage,l=o.isPacked;if(null==o.texture){var d,f=null!=this.activeTimers;f&&(d=Uo());var h=o.texShape;if(null==h&&(h=LR(i,l),o.texShape=h),null!=s){var p=jg(i),m=void 0,v=h[1],y=h[0],b=s instanceof Uint8Array;l?(v=(r=gf(h[0],h[1]))[0],m=new Lq(p,[y=r[1],v],b)):m=new Oq(p,[y,v],b);var C=this.makeTensorInfo([y,v],a);this.texData.get(C.dataId).usage=b?Zr.PIXELS:Zr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(C.dataId),v,y,s);var x=this.runWebGLProgram(m,[C],a,null,!0),E=this.texData.get(x.dataId);o.texture=E.texture,o.texShape=E.texShape,o.isPacked=E.isPacked,o.usage=E.usage,this.disposeData(C.dataId),this.texData.delete(x.dataId),o.values=null,f&&(this.uploadWaitMs+=Uo()-d)}else{var I=this.acquireTexture(h,c,a,l);o.texture=I}}},n.prototype.convertAndCacheOnCPU=function(t,r){var o=this.texData.get(t),i=o.dtype;return this.releaseGPUData(t),null!=r&&(o.values=function(a,s){if("float32"===s||"complex64"===s)return a;if("int32"===s||"bool"===s){for(var u="int32"===s?new Int32Array(a.length):new Uint8Array(a.length),c=0;c<u.length;++c)u[c]=Math.round(a[c]);return u}throw new Error("Unknown dtype "+s)}(r,i)),o.values},n.prototype.acquireTexture=function(t,r,o,i){if(this.numBytesInGPU+=this.computeBytes(t,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,r,i)},n.prototype.computeBytes=function(t,r){return t[0]*t[1]*N0(r)},n}(uN);yR()&&F.registerBackend("webgl",function(){return new ak},2);var N7=P({square_:function(e){var n=S(e,"x","square");return F.runKernelFunc(function(r,o){return o([n]),r.square(n)},{x:n},null,"Square",{},[n],[])}}),Af="SquaredDifference",sk=P({squaredDifference_:function(e,n){var t,r=S(e,"a","squaredDifference"),o=S(n,"b","squaredDifference");return t=qt(r,o),Ze((r=t[0]).shape,(o=t[1]).shape),F.runKernelFunc(function(s,u){var c=s.squaredDifference(r,o);return u([r,o]),c},{a:r,b:o},function(s,u){var c=u[0],l=u[1],d=ae(2);return{a:function(){return s.mul(c.sub(l).mul(d))},b:function(){return s.mul(l.sub(c).mul(d))}}},Af,{},[r,o],[])}}),k7=P({abs_:function(e){var n=S(e,"x","abs");return"complex64"===n.dtype?F.runKernelFunc(function(t){return t.complexAbs(n)},{$x:n}):F.runKernelFunc(function(t,r){var o=t.abs(n);return r([n]),o},{x:n},function(t,r){var o=r[0];return{x:function(){return t.mul(o.toFloat().step(-1))}}},"Abs")}}),F7=P({acos_:function(e){var n=S(e,"x","acos");return F.runKernelFunc(function(t,r){var o=t.acos(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.divStrict(ae(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),P7=P({acosh_:function(e){var n=S(e,"x","acosh");return F.runKernelFunc(function(t,r){var o=t.acosh(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),O7=P({asin_:function(e){var n=S(e,"x","asin");return F.runKernelFunc(function(t,r){var o=t.asin(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.divStrict(ae(1).sub(o.toFloat().square()).sqrt())}}})}}),L7=P({asinh_:function(e){var n=S(e,"x","asinh");return F.runKernelFunc(function(t,r){var o=t.asinh(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.divStrict(ae(1).add(o.toFloat().square()).sqrt())}}})}}),B7=P({atan_:function(e){var n=S(e,"x","atan");return F.runKernelFunc(function(t,r){var o=t.atan(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.div(o.toFloat().square().add(1))}}})}}),V7=P({atanh_:function(e){var n=S(e,"x","atanh");return F.runKernelFunc(function(t,r){var o=t.atanh(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.div(ae(1).sub(o.toFloat().square()))}}})}}),U7=P({ceil_:function(e){var n=S(e,"x","ceil");return F.runKernelFunc(function(t){return t.ceil(n)},{$x:n},function(t){return{$x:function(){return ct(t)}}})}}),Ex=P({clipByValue_:function(e,n,t){var r=S(e,"x","clipByValue");return A(n<=t,function(){return"Error in clip: min ("+n+") must be less than or equal to max ("+t+")."}),F.runKernelFunc(function(a,s){var u=a.clip(r,n,t);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(n).logicalAnd(u.lessEqual(t)),ct(a))}}},"ClipByValue",{min:n,max:t},[r])}}),j7=P({cos_:function(e){var n=S(e,"x","cos");return F.runKernelFunc(function(r,o){var i=r.cos(n);return o([n]),i},{x:n},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},[n])}}),H7=P({cosh_:function(e){var n=S(e,"x","cosh");return F.runKernelFunc(function(t,r){var o=t.cosh(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(t)}}})}}),W7=P({erf_:function(e){var n=S(e,"x","erf");return A("int32"===n.dtype||"float32"===n.dtype,function(){return"Input dtype must be `int32` or `float32`."}),"int32"===n.dtype&&(n=n.toFloat()),F.runKernelFunc(function(t,r){var o=t.erf(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Ix=P({exp_:function(e){var n=S(e,"x","exp");return F.runKernelFunc(function(t,r){var o=t.exp(n);return r([o]),o},{x:n},function(t,r){return{x:function(){return t.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),z7=P({expm1_:function(e){var n=S(e,"x","expm1");return F.runKernelFunc(function(t,r){var o=t.expm1(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.mul(o.exp())}}})}}),$7=P({floor_:function(e){var n=S(e,"x","floor");return F.runKernelFunc(function(t){return t.floor(n)},{$x:n},function(t){return{$x:function(){return ct(t)}}})}}),G7=P({log_:function(e){var n=S(e,"x","log");return F.runKernelFunc(function(r,o){var i=r.log(n);return o([n]),i},{x:n},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},[n])}}),q7=P({log1p_:function(e){var n=S(e,"x","log1p");return F.runKernelFunc(function(t,r){var o=t.log1p(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.div(o.add(1))}}})}}),X7=P({logSigmoid_:function(e){var n=S(e,"x","logSigmoid");return F.runKernelFunc(function(t,r){var o=t.softplus(n.neg()).neg();return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.mul(o.neg().sigmoid())}}})}}),sm=P({neg_:function(e){var n=S(e,"x","neg");return F.runKernelFunc(function(r){return r.neg(n)},{x:n},function(r){return{x:function(){return r.neg()}}},"Neg",{},[n])}}),K7=P({reciprocal_:function(e){var n=S(e,"x","reciprocal");return F.runKernelFunc(function(t,r){var o=t.reciprocal(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.div(o.square().neg())}}})}}),Y7=P({round_:function(e){var n=S(e,"x","round");return F.runKernelFunc(function(t){return t.round(n)},{$x:n},function(t){return{$x:function(){return ct(t)}}})}}),uk=P({rsqrt_:function(e){var n=S(e,"x","rsqrt");return F.runKernelFunc(function(r,o){var i=r.rsqrt(n);return o([n]),i},{x:n},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},[n])}}),ck=P({sigmoid_:function(e){var n=S(e,"x","sigmoid");return F.runKernelFunc(function(t,r){var o=t.sigmoid(n);return r([o]),o},{x:n},function(t,r){var o=r[0];return{x:function(){return t.mul(o.mul(ae(1).sub(o)))}}},"Sigmoid")}}),Z7=P({sign_:function(e){var n=S(e,"x","sign");return F.runKernelFunc(function(t){return t.sign(n)},{$x:n},function(t){return{$x:function(){return ct(t)}}})}}),Q7=P({isNaN_:function(e){var n=S(e,"x","isNaN");return F.runKernelFunc(function(t){return t.isNaN(n)},{$x:n},function(t){return{$x:function(){return ct(t)}}})}}),J7=P({isInf_:function(e){var n=S(e,"x","isInf");return F.runKernelFunc(function(t){return t.isInf(n)},{$x:n},function(t){return{$x:function(){return ct(t)}}})}}),e9=P({isFinite_:function(e){var n=S(e,"x","isFinite");return F.runKernelFunc(function(t){return t.isFinite(n)},{$x:n},function(t){return{$x:function(){return ct(t)}}})}}),t9=P({sin_:function(e){var n=S(e,"x","sin");return F.runKernelFunc(function(r,o){var i=r.sin(n);return o([n]),i},{x:n},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},[n])}}),n9=P({sinh_:function(e){var n=S(e,"x","sinh");return F.runKernelFunc(function(t,r){var o=t.sinh(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(t)}}})}}),r9=P({softplus_:function(e){var n=S(e,"x","softplus");return F.runKernelFunc(function(t,r){var o=t.softplus(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.mul(o.sigmoid())}}})}}),o9=P({sqrt_:function(e){var n=S(e,"x","sqrt");return F.runKernelFunc(function(t,r){var o=t.sqrt(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.div(o.toFloat().sqrt().mul(2))}}})}}),i9=P({step_:function(e,n){void 0===n&&(n=0);var t=S(e,"x","step");return F.runKernelFunc(function(r){return r.step(t,n)},{$x:t},function(r){return{$x:function(){return ct(r)}}})}}),a9=P({tan_:function(e){var n=S(e,"x","tan");return F.runKernelFunc(function(t,r){var o=t.tan(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return t.div(o.cos().square())}}})}}),s9=P({tanh_:function(e){var n=S(e,"x","tanh");return F.runKernelFunc(function(t,r){var o=t.tanh(n);return r([o]),o},{x:n},function(t,r){var o=r[0];return{x:function(){return ae(1).sub(o.square()).mulStrict(t)}}},"Tanh",{},null,[!0])}});function lk(e,n,t,r,o,i){var a,s,u=S(e,"x","batchNorm"),c=S(n,"mean","batchNorm"),l=S(t,"variance","batchNorm");return null!=o&&(a=S(o,"scale","batchNorm")),null!=r&&(s=S(r,"offset","batchNorm")),A(2===u.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),A(2===c.rank||1===c.rank,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."}),A(2===l.rank||1===l.rank,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."}),null!=a&&A(2===a.rank||1===a.rank,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),null!=s&&A(2===s.rank||1===s.rank,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Mf(u,c,l,s,a,i)}function dk(e,n,t,r,o,i){var a,s,u=S(e,"x","batchNorm"),c=S(n,"mean","batchNorm"),l=S(t,"variance","batchNorm");return null!=o&&(a=S(o,"scale","batchNorm")),null!=r&&(s=S(r,"offset","batchNorm")),A(3===u.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),A(3===c.rank||1===c.rank,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."}),A(3===l.rank||1===l.rank,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."}),null!=a&&A(3===a.rank||1===a.rank,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),null!=s&&A(3===s.rank||1===s.rank,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Mf(u,c,l,s,a,i)}function fk(e,n,t,r,o,i){var a,s,u=S(e,"x","batchNorm"),c=S(n,"mean","batchNorm"),l=S(t,"variance","batchNorm");return null!=o&&(a=S(o,"scale","batchNorm")),null!=r&&(s=S(r,"offset","batchNorm")),A(4===u.rank,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),A(4===c.rank||1===c.rank,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."}),A(4===l.rank||1===l.rank,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."}),null!=a&&A(4===a.rank||1===a.rank,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),null!=s&&A(4===s.rank||1===s.rank,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Mf(u,c,l,s,a,i)}function Mf(e,n,t,r,o,i){null==i&&(i=.001);var a,s,u,c=S(e,"x","batchNorm"),l=S(n,"mean","batchNorm"),d=S(t,"variance","batchNorm");return null!=o&&(a=S(o,"scale","batchNorm")),null!=r&&(s=S(r,"offset","batchNorm")),A(l.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),A(null==s||l.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),A(null==a||l.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c,F.runKernelFunc(function(h,p){var m=h.batchNormalization(u,um(l),um(d),i,um(a),um(s));return p([c,l,d,a]),m},{x:c,mean:l,variance:d,scale:a,offset:s},function(h,p){var v=p[0],y=p[1],b=p[2],x=p[3]??ae(1),E=mn(y.shape,u.shape),I=[];if(1===y.rank){for(var N=0;N<u.shape.length-1;++N)I.push(u.shape[N]);I.push(1)}var R=v.sub(y),M=h.mul(x),T=uk(b.add(ae(i))),L=T.mul(T).mul(T).mul(ae(-.5));return{x:function(){return 1===y.rank?h.mul(Vc(T.as4D(1,1,1,y.shape[0]),I)).mul(x).reshape(v.shape):h.mul(T).mul(x).reshape(v.shape)},mean:function(){var O=T.mul(ae(-1)).mul(M);return 1===y.rank&&(O=O.sum(E)),O.reshape(y.shape)},variance:function(){var O=L.mul(R).mul(M);return 1===y.rank&&(O=O.sum(E)),O.reshape(y.shape)},scale:function(){var O=R.mul(T),q=h.mul(O);return 1===y.rank&&(q=q.sum(E)),q.reshape(y.shape)},offset:function(){var O=h;return 1===y.rank&&(O=O.sum(E)),O.reshape(y.shape)}}},"BatchNormalization",{varianceEpsilon:i},[c,l,d,a]).reshape(c.shape)}function um(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function cm(){zR("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var u9=P({batchNormalization2d_:function(e,n,t,r,o,i){return void 0===r&&(r=.001),cm(),lk(e,n,t,i,o,r)}}),c9=P({batchNormalization3d_:function(e,n,t,r,o,i){return void 0===r&&(r=.001),cm(),dk(e,n,t,i,o,r)}}),l9=P({batchNormalization4d_:function(e,n,t,r,o,i){return void 0===r&&(r=.001),cm(),fk(e,n,t,i,o,r)}}),d9=P({batchNormalization_:function(e,n,t,r,o,i){return void 0===r&&(r=.001),cm(),Mf(e,n,t,i,o,r)}}),hk=P({batchNorm_:Mf}),f9=P({batchNorm2d_:lk}),h9=P({batchNorm3d_:dk}),p9=P({batchNorm4d_:fk}),lm=P({logicalAnd_:function(e,n){var t=S(e,"a","logicalAnd","bool"),r=S(n,"b","logicalAnd","bool");return Ze(t.shape,r.shape),F.runKernelFunc(function(o){return o.logicalAnd(t,r)},{a:t,b:r},null,"LogicalAnd")}}),g9=P({logicalNot_:function(e){var n=S(e,"x","logicalNot","bool");return F.runKernelFunc(function(t){return t.logicalNot(n)},{$x:n})}}),pk=P({logicalOr_:function(e,n){var t=S(e,"a","logicalOr","bool"),r=S(n,"b","logicalOr","bool");return Ze(t.shape,r.shape),F.runKernelFunc(function(o){return o.logicalOr(t,r)},{$a:t,$b:r})}}),m9=P({logicalXor_:function(e,n){var t=S(e,"a","logicalXor","bool"),r=S(n,"b","logicalXor","bool");return Ze(t.shape,r.shape),pk(e,n).logicalAnd(lm(e,n).logicalNot())}}),Qs=P({where_:function(e,n,t){var r=S(n,"a","where"),o=S(t,"b","where"),i=S(e,"condition","where","bool");return ut(r.shape,o.shape,"Error in where: "),1===i.rank?A(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):ut(i.shape,o.shape,"Error in where: "),F.runKernelFunc(function(a,s){var u=a.select(i,r,o);return s([i]),u},{$condition:i,$a:r,$b:o},function(a,s){var u=s[0];return{$condition:function(){return ct(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),gk=function(e){return he(this,void 0,void 0,function(){var n,t,r;return pe(this,function(o){switch(o.label){case 0:return[4,(n=S(e,"condition","whereAsync","bool")).data()];case 1:return t=o.sent(),r=gx(n.shape,t),e!==n&&n.dispose(),[2,r]}})})},Qe=P({add_:function(e,n){var t,r=S(e,"a","add"),o=S(n,"b","add");t=qt(r,o);var i=Ze((r=t[0]).shape,(o=t[1]).shape);return F.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=mn(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=mn(o.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),v9=P({addN_:function(e){A(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),A(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var n=e.map(function(o,i){return S(o,"tensors"+i,"addN")}),t=n[0];return n.forEach(function(o){if(o.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),n.forEach(function(o){if(!hn(o.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}),F.runKernelFunc(function(o){return o.addN(n)},n,function(o){var i={};return n.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),y9=P({addStrict_:function(e,n){var t=S(e,"a","addStrict"),r=S(n,"b","addStrict");return ut(t.shape,r.shape,"Error in addStrict: "),t.add(r)}}),w9=P({atan2_:function(e,n){var t,r=S(e,"a","atan2"),o=S(n,"b","atan2");t=qt(r,o);var i=Ze((r=t[0]).shape,(o=t[1]).shape);return F.runKernelFunc(function(a,s){var u=a.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],c=s[1];return{$a:function(){var l=Qe(u.square(),c.square()),d=a.mul(c.div(l)),f=mn(u.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)},$b:function(){var l=Qe(u.square(),c.square()),d=sm(a.mul(u.div(l))),f=mn(c.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(c.shape)}}})}}),$o=P({div_:function(e,n){var t,r=S(e,"a","div"),o=S(n,"b","div");if(t=qt(r,o),o=t[1],"int32"===(r=t[0]).dtype&&"int32"===o.dtype)return mk(r,o);var i=Ze(r.shape,o.shape);return F.runKernelFunc(function(a,s){var u=a.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.div(c.toFloat()),d=mn(u.shape,i);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=mn(c.shape,i);d.length>0&&(l=l.sum(d).reshape(c.shape));var f=c.square();return l.div(f.toFloat()).neg()}}},"Div")}}),b9=P({divNoNan_:function(e,n){var t,r=S(e,"a","div"),o=S(n,"b","div");r=(t=qt(r,o))[0];var i=$o(r,o=t[1]),a=ct(i),s=o.equal(a);return Qs(s,a,i)}}),x9=P({divStrict_:function(e,n){var t=S(e,"a","div"),r=S(n,"b","div");return ut(t.shape,r.shape,"Error in divideStrict: "),t.div(r)}}),mk=P({floorDiv_:function(e,n){var t,r=S(e,"a","floorDiv"),o=S(n,"b","floorDiv");t=qt(r,o);var i=Ze((r=t[0]).shape,(o=t[1]).shape);return F.runKernelFunc(function(a,s){var u=a.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.div(c.toFloat()),d=mn(u.shape,i);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=mn(c.shape,i);d.length>0&&(l=l.sum(d).reshape(c.shape));var f=c.square();return l.div(f.toFloat()).neg()}}},"FloorDiv")}}),Sx=P({maximum_:function(e,n){var t,r=S(e,"a","maximum"),o=S(n,"b","maximum");return t=qt(r,o),o=t[1],"bool"===(r=t[0]).dtype&&(r=r.toInt(),o=o.toInt()),Ze(r.shape,o.shape),F.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}},"Maximum")}}),C9=P({maximumStrict_:function(e,n){var t=S(e,"a","maximumStrict"),r=S(n,"b","maximumStrict");return ut(t.shape,r.shape,"Error in maximumStrict: "),t.maximum(r)}}),vk=P({minimum_:function(e,n){var t,r=S(e,"a","minimum"),o=S(n,"b","minimum");return t=qt(r,o),o=t[1],"bool"===(r=t[0]).dtype&&(r=r.toInt(),o=o.toInt()),Ze(r.shape,o.shape),F.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}},"Minimum")}}),_9=P({minimumStrict_:function(e,n){var t=S(e,"a","minimumStrict"),r=S(n,"b","minimumStrict");return ut(t.shape,r.shape,"Error in minimumStrict: "),t.minimum(r)}}),D9=P({mod_:function(e,n){var t,r=S(e,"a","mod"),o=S(n,"b","mod");t=qt(r,o);var i=Ze((r=t[0]).shape,(o=t[1]).shape);return F.runKernelFunc(function(a,s){var u=a.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],c=s[1];return{$a:function(){var l=mn(u.shape,i);return l.length>0?a.sum(l).reshape(u.shape):a},$b:function(){var l=a.mul(u.div(c).floor().neg()),d=mn(c.shape,i);return d.length>0?l.sum(d).reshape(c.shape):l}}})}}),E9=P({modStrict_:function(e,n){var t=S(e,"a","modStrict"),r=S(n,"b","modStrict");return ut(t.shape,r.shape,"Error in modStrict: "),t.mod(r)}}),Qn=P({mul_:function(e,n){var t,r=S(e,"a","mul"),o=S(n,"b","mul");t=qt(r,o);var i=Ze((r=t[0]).shape,(o=t[1]).shape);return F.runKernelFunc(function(a,s){var u=a.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var l=a.mul(c.toFloat()),d=mn(u.shape,i);return d.length>0?l.sum(d).reshape(u.shape):l},b:function(){var l=a.mul(u.toFloat()),d=mn(c.shape,i);return d.length>0?l.sum(d).reshape(c.shape):l}}},"Mul")}}),I9=P({mulStrict_:function(e,n){var t=S(e,"a","mul"),r=S(n,"b","mul");return ut(t.shape,r.shape,"Error in multiplyStrict: "),t.mul(r)}}),dm=P({pow_:function(e,n){var t,r=S(e,"base","pow"),o=S(n,"exp","pow");t=qt(r,o);var i=Ze((r=t[0]).shape,(o=t[1]).shape);return F.runKernelFunc(function(s,u){var c=s.pow(r,o);return u([r,o,c]),c},{a:r,b:o},function(s,u){var c=u[0],l=u[1],d=u[2];return{a:function(){var f=l.toFloat(),h=s.mul(f.mul(c.pow(f.sub(ae(1))))),p=mn(c.shape,i);return p.length>0&&(h=h.sum(p)),h.reshape(c.shape)},b:function(){var f=c.greater(0),h=c.log().where(f,ct(c)),p=s.mul(d.mul(h)),m=mn(l.shape,i);return m.length>0&&(p=p.sum(m)),p.reshape(l.shape)}}},"Pow",{},[r,o],[!0])}}),S9=P({powStrict_:function(e,n){return ut(e.shape,n.shape,"Error in powStrict: "),e.pow(n)}}),A9=P({squaredDifferenceStrict_:function(e,n){var t=S(e,"a","squaredDifferenceStrict"),r=S(n,"b","squaredDifferenceStrict");return ut(t.shape,r.shape,"Error in squaredDifferenceStrict: "),t.squaredDifference(r)}}),Dn=P({sub_:function(e,n){var t,r=S(e,"a","sub"),o=S(n,"b","sub");t=qt(r,o);var i=Ze((r=t[0]).shape,(o=t[1]).shape);return F.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=mn(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=mn(o.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),M9=P({subStrict_:function(e,n){var t=S(e,"a","subStrict"),r=S(n,"b","subStrict");return ut(t.shape,r.shape,"Error in subStrict: "),t.sub(r)}}),yk=P({equal_:function(e,n){var t,r=S(e,"a","equal"),o=S(n,"b","equal");return t=qt(r,o),Ze((r=t[0]).shape,(o=t[1]).shape),F.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),T9=P({equalStrict_:function(e,n){var t=S(e,"a","equalStrict"),r=S(n,"b","equalStrict");return ut(t.shape,r.shape,"Error in equalStrict: "),t.equal(r)}}),R9=P({greater_:function(e,n){var t,r=S(e,"a","greater"),o=S(n,"b","greater");return t=qt(r,o),Ze((r=t[0]).shape,(o=t[1]).shape),F.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),wk=P({greaterEqual_:function(e,n){var t,r=S(e,"a","greaterEqual"),o=S(n,"b","greaterEqual");return t=qt(r,o),Ze((r=t[0]).shape,(o=t[1]).shape),F.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return ct(s)},b:function(){return ct(u)}}},"GreaterEqual")}}),N9=P({greaterEqualStrict_:function(e,n){var t=S(e,"a","greaterEqualStrict"),r=S(n,"b","greaterEqualStrict");return ut(t.shape,r.shape,"Error in greaterEqualStrict: "),t.greaterEqual(r)}}),k9=P({greaterStrict_:function(e,n){var t=S(e,"a","greaterStrict"),r=S(n,"b","greaterStrict");return ut(t.shape,r.shape,"Error in greaterStrict: "),t.greater(r)}}),F9=P({less_:function(e,n){var t,r=S(e,"a","less"),o=S(n,"b","less");return t=qt(r,o),Ze((r=t[0]).shape,(o=t[1]).shape),F.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),P9=P({lessEqual_:function(e,n){var t,r=S(e,"a","lessEqual"),o=S(n,"b","lessEqual");return t=qt(r,o),Ze((r=t[0]).shape,(o=t[1]).shape),F.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),O9=P({lessEqualStrict_:function(e,n){var t=S(e,"a","lessEqualStrict"),r=S(n,"b","lessEqualStrict");return ut(t.shape,r.shape,"Error in lessEqualStrict: "),t.lessEqual(r)}}),L9=P({lessStrict_:function(e,n){var t=S(e,"a","lessStrict"),r=S(n,"b","lessStrict");return ut(t.shape,r.shape,"Error in lessStrict: "),t.less(r)}}),B9=P({notEqual_:function(e,n){var t,r=S(e,"a","notEqual"),o=S(n,"b","notEqual");return t=qt(r,o),Ze((r=t[0]).shape,(o=t[1]).shape),F.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),V9=P({notEqualStrict_:function(e,n){var t=S(e,"a","notEqualStrict"),r=S(n,"b","notEqualStrict");return ut(t.shape,r.shape,"Error in notEqualStrict: "),t.notEqual(r)}});function bk(e,n){for(var t=[],r=e;r<n;++r)t.push(r);return t}function xk(e){for(var n=[],t=0;t<e.length;++t)for(var r=0;r<e[t].length;++r)n.push(e[t][r]);return n}var Ax=P({gather_:function(e,n,t){void 0===t&&(t=0);var r=S(e,"x","gather"),o=S(n,"indices","gather","int32");t=pn(t,r.shape)[0];var i=function(a,s,u){for(var c=a.shape[u],l=[],d=1,f=1,h=0;h<u;h++)l.push(a.shape[h]),d*=a.shape[h];for(h=0;h<s.rank;h++)l.push(s.shape[h]);for(h=u+1;h<a.rank;h++)l.push(a.shape[h]),f*=a.shape[h];return{batchSize:d,sliceSize:f,dimSize:c,outputShape:l}}(r,o,t);return F.runKernelFunc(function(a,s){var u=a.gather(r,o.flatten(),t);return s([o]),u},{x:r,indices:o},function(a,s){var u=s[0];return{x:function(){var c=r.shape,l=u.size,d=c.slice(0,t),f=d.length,h=c.slice(t,c.length).slice(1),p=h.length,m=bk(0,f),v=bk(f+1,f+1+p),y=xk([d,[l],h]),b=a.reshape(y),C=u.reshape([l]),x=xk([[f],m,v]),E=b.transpose(x),I=Ck(E,C,r.shape[t]),N=zg(x);return I.transpose(N)},indices:function(){return u}}},"Gather",{axis:t}).reshape(i.outputShape)}}),Ck=P({unsortedSegmentSum_:function(e,n,t){var r=S(e,"x","unsortedSegmentSum"),o=S(n,"segmentIds","unsortedSegmentSum","int32");return A(Qt(t),function(){return"numSegments must be of dtype int"}),F.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,t);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(u,c){for(var l=Sx(c,ct(c)),d=Ax(u,l),f=wk(c,ae(0,"int32")),h=d.rank-f.rank,p=0;p<h;++p)f=_o(f,p+1);f=lm(f,Bc(d.shape,"bool"));var m=ct(d);return Qs(f,d,m)}(i,s)}}})}});function _k(e,n,t,r,o,i,a){void 0===i&&(i="NHWC"),A(e.length===n.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+n.rank+") must match"});var s=e,u=n,c=!1;3===n.rank&&(c=!0,u=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]),s=[1,e[0],e[1],e[2]]),A(4===s.length,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),A(4===u.rank,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),A(4===t.rank,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+t.rank});var l="NHWC"===i?s[3]:s[1],d="NHWC"===i?u.shape[3]:u.shape[1];A(l===t.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+t.shape[2]+"."}),A(d===t.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+t.shape[3]+"."}),null!=a&&A(Qt(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var f=tm(i),h=Ga(s,t.shape,r,1,o,a,!1,f),p=F.runKernelFunc(function(m,v){var y=m.conv2dDerInput(u,t,h);return v([t,u]),y},{dy4D:u,filter:t},function(m,v){var y=v[0],b=v[1];return{dy4D:function(){return Do(m,y,r,o,i,1,a)},filter:function(){return Tx(m,b,y.shape,r,o,i,a)}}});return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function Mx(e){var i,n="number"==typeof(i=e)?[i,i,i]:2===i.length?[i[0],i[1],1]:i;return 1===n[0]&&1===n[1]&&1===n[2]}function Dk(e,n,t,r,o){A(e.length===n.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+n.rank+") must match"});var i=e,a=n,s=!1;4===n.rank&&(s=!0,a=n.as5D(1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=a.shape[4];A(5===i.length,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),A(5===a.rank,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),A(5===t.rank,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+t.rank}),A(u===t.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+t.shape[3]+"."}),A(c===t.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+t.shape[4]+"."});var l=Df(i,t.shape,r,1,o),d=F.runKernelFunc(function(f){return f.conv3dDerInput(a,t,l)},{dy5D:a});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var j9=P({conv1d_:function(e,n,t,r,o,i,a){void 0===o&&(o="NWC"),void 0===i&&(i=1);var s=S(e,"x","conv1d"),u=S(n,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),A(3===c.rank,function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."}),A(3===u.rank,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),null!=a&&A(Qt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),A(c.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),A(yr(t,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+t+" and dilation '"+i+"'"}),A("NWC"===o,function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),h=Do(f,d,[1,t],r,"NHWC",[1,i],a);return l?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Do=P({conv2d_:function(e,n,t,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=S(e,"x","conv2d"),u=S(n,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),A(4===c.rank,function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."}),A(4===u.rank,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),null!=a&&A(Qt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d="NHWC"===o?c.shape[3]:c.shape[1];A(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),A(yr(t,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+i+"'"});var f=tm(o),h=Ga(c.shape,u.shape,t,i,r,a,!1,f),m=F.runKernelFunc(function(v,y){var b=v.conv2d(c,u,h);return y([u,c]),b},{x:c,filter:u},function(v,y){var C=y[0],x=y[1];return A(Ks(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return Ek(x.shape,v,C,t,r,o)},filter:function(){return Tx(x,v,C.shape,t,r,o)}}},"Conv2D",h,[u,c]);return l?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),H9=P({conv3d_:function(e,n,t,r,o,i){void 0===o&&(o="NDHWC"),void 0===i&&(i=[1,1,1]);var h,a=S(e,"x","conv3d"),s=S(n,"filter","conv3d"),u=a,c=!1;4===a.rank&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),A(5===u.rank,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),A(5===s.rank,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),A(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),A((h=i,Mx(t)||Mx(h)),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+i+"'"}),A("NDHWC"===o,function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var l=Df(u.shape,s.shape,t,i,r),d=F.runKernelFunc(function(f,h){var p=f.conv3d(u,s,l);return h([u,s]),p},{x:u,$filter:s},function(f,h){A(Mx(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var p=h[0],m=h[1];return{x:function(){return Dk(p.shape,f,m,t,r)},$filter:function(){return function(v,y,b,C,x){var E=v;4===v.rank&&(E=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3]));var I=y;4===I.rank&&(I=y.as5D(1,y.shape[0],y.shape[1],y.shape[2],y.shape[3])),A(5===E.rank,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+E.shape+"."}),A(5===I.rank,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+I.shape+"."}),A(5===b.length,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+b+"."}),A(E.shape[4]===b[3],function(){return"Error in conv3dDerFilter: depth of input "+E.shape[4]+") must match input depth in filter ("+b[3]+"."}),A(I.shape[4]===b[4],function(){return"Error in conv3dDerFilter: depth of dy ("+I.shape[4]+") must match output depth for filter ("+b[4]+")."});var N=Df(E.shape,b,C,1,x);return F.runKernelFunc(function(R){return R.conv3dDerFilter(E,I,N)},{x5D:E,dy5D:I})}(p,f,m.shape,t,r)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Tx=P({conv2dDerFilter_:function(e,n,t,r,o,i,a){void 0===i&&(i="NHWC");var s=e;3===e.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=n;3===u.rank&&(u=n.as4D(1,n.shape[0],n.shape[1],n.shape[2])),A(4===s.rank,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),A(4===u.rank,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),A(4===t.length,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+t+"."});var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];A(c===t[2],function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+t[2]+"."}),A(l===t[3],function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+t[3]+")."}),null!=a&&A(Qt(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=tm(i),f=Ga(s.shape,t,r,1,o,a,!1,d);return F.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,f)},{x4D:s,dy4D:u})}}),Ek=P({conv2dDerInput_:_k}),fm=P({depthwiseConv2d_:function(e,n,t,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=S(e,"x","depthwiseConv2d"),u=S(n,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),A(4===c.rank,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."}),A(4===u.rank,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),A(c.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),null==i&&(i=[1,1]),A(yr(t,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+i+"'"}),null!=a&&A(Qt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=Ga(c.shape,u.shape,t,i,r,a,!0),h=F.runKernelFunc(function(p,m){var v=p.depthwiseConv2D(c,u,d);return m([c,u]),v},{x:c,filter:u},function(p,m){A(Ks(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var v=m[0],y=m[1];return{x:function(){return Ik(v.shape,p,y,d)},filter:function(){return Sk(v,p,y.shape,d)}}},"DepthwiseConv2dNative",d,[c,u]);return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),Ik=P({depthwiseConv2dDerInput_:function(e,n,t,r){var o=n,i=!1;3===n.rank&&(i=!0,o=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var a=F.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,t,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),Sk=P({depthwiseConv2dDerFilter_:function(e,n,t,r){var o=e;3===e.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=n;return 3===i.rank&&(i=n.as4D(1,n.shape[0],n.shape[1],n.shape[2])),F.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),Rx=P({separableConv2d_:function(e,n,t,r,o,i,a){void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC");var s=S(e,"x","separableConv2d"),u=S(n,"depthwiseFilter","separableConv2d"),c=S(t,"pointwiseFilter","separableConv2d"),l=s,d=!1;if(3===s.rank&&(d=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");A(4===l.rank,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."}),A(4===u.rank,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),A(4===c.rank,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),A(1===c.shape[0],function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."}),A(1===c.shape[1],function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."});var f=u.shape[2],h=u.shape[3];A(c.shape[2]===f*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+c.shape[2]+"."});var p=fm(l,u,r,o,a,i),m=Do(p,c,1,"valid",a);return d?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),W9=P({conv2dTranspose_:function(e,n,t,r,o,i){return _k(t,S(e,"x","conv2dTranspose"),S(n,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),z9=P({conv3dTranspose_:function(e,n,t,r,o){return Dk(t,S(e,"x","conv3dTranspose"),S(n,"filter","conv3dTranspose"),r,o)}}),hm=P({matMul_:function(e,n,t,r){var o;void 0===t&&(t=!1),void 0===r&&(r=!1);var i=S(e,"a","matMul"),a=S(n,"b","matMul");o=qt(i,a),i=o[0],a=o[1];var s=t?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],c=t?i.shape[i.rank-1]:i.shape[i.rank-2],l=r?a.shape[a.rank-2]:a.shape[a.rank-1],d=i.shape.slice(0,-2),f=a.shape.slice(0,-2),h=ge(d),p=ge(f);A(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),A(hn(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),A(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+t+" and transposeB="+r+" must match."});var m=i.shape.slice(0,-2).concat([c,l]),v=t?i.as3D(h,s,c):i.as3D(h,c,s),y=r?a.as3D(p,l,u):a.as3D(p,u,l);return F.runKernelFunc(function(C,x){var E=C.batchMatMul(v,y,t,r);return x([v,y]),E},{a:v,b:y},function(C,x){var I=x[0],N=x[1];return t||r?!t&&r?{a:function(){return C.matMul(N,!1,!1)},b:function(){return C.matMul(I,!0,!1)}}:t&&!r?{a:function(){return N.matMul(C,!1,!0)},b:function(){return I.matMul(C,!1,!1)}}:{a:function(){return N.matMul(C,!0,!0)},b:function(){return C.matMul(I,!0,!0)}}:{a:function(){return C.matMul(N,!1,!0)},b:function(){return I.matMul(C,!0,!1)}}},"BatchMatMul",{transposeA:t,transposeB:r}).reshape(m)}}),$9=P({dot_:function(e,n){var t=S(e,"t1","dot"),r=S(n,"t2","dot");A(!(1!==t.rank&&2!==t.rank||1!==r.rank&&2!==r.rank),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+t.rank+" and "+r.rank+"."});var o=1===t.rank?t.size:t.shape[1],i=1===r.rank?r.size:r.shape[0];return A(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),1===t.rank&&1===r.rank?t.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===t.rank&&2===r.rank?t.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===t.rank&&1===r.rank?t.matMul(r.as2D(-1,1)).as1D():t.matMul(r.as2D(r.shape[0],r.shape[1]))}}),G9=P({outerProduct_:function(e,n){var t=S(e,"v1","outerProduct"),r=S(n,"v2","outerProduct");return A(1===t.rank&&1===r.rank,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+t.rank+" and "+r.rank+"."}),t.as2D(-1,1).matMul(r.as2D(1,-1))}}),Tf=P({reverse_:function(e,n){var t=S(e,"x","reverse");if(0===t.rank)return t.clone();var r=pn(n,t.shape);return F.runKernelFunc(function(o){return o.reverse(t,r)},{$x:t},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(t)}}),q9=P({reverse1d_:function(e){var n=S(e,"x","reverse");return A(1===n.rank,function(){return"Error in reverse1D: x must be rank 1 but got rank "+n.rank+"."}),Tf(n,0)}}),X9=P({reverse2d_:function(e,n){var t=S(e,"x","reverse");return A(2===t.rank,function(){return"Error in reverse2D: x must be rank 2 but got rank "+t.rank+"."}),Tf(t,n)}}),K9=P({reverse3d_:function(e,n){var t=S(e,"x","reverse");return A(3===t.rank,function(){return"Error in reverse3D: x must be rank 3 but got rank "+t.rank+"."}),Tf(t,n)}}),Y9=P({reverse4d_:function(e,n){var t=S(e,"x","reverse");return A(4===t.rank,function(){return"Error in reverse4D: x must be rank 4 but got rank "+t.rank+"."}),Tf(t,n)}});function Ak(e,n,t,r,o,i){var a=S(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),null==r&&(r=[1,1]),A(4===s.rank,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),A(yr(t,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"}),null!=i&&A(Qt(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var c=Uc(s.shape,n,t,r,o,i);if(1===c.filterWidth&&1===c.filterHeight&&hn(c.inShape,c.outShape))return a.clone();var d=F.runKernelFunc(function(f,h){var p=f.maxPool(s,c);return h([s,p]),p},{x:s},function(f,h){var p=h[0],m=h[1];return{x:function(){return function(v,y,b,C,x,E,I,N){var R=S(v,"dy","maxPoolBackprop"),M=S(y,"input","maxPoolBackprop"),T=S(b,"output","maxPoolBackprop");A(M.rank===R.rank,function(){return"Rank of input ("+M.rank+") does not match rank of dy ("+R.rank+")"}),null==E&&(E=[1,1]),A(yr(x,E),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+E+"'"}),A(4===R.rank,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+R.rank+"."}),A(4===M.rank,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+M.rank+"."});var L=Uc(M.shape,C,x,E,I,void 0);return F.runKernelFunc(function(O){return O.maxPoolBackprop(R,M,T,L)},{$dy:R,$input:M})}(f,p,m,n,t,r,o)}}},"MaxPool",c,[s]);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function Mk(e,n,t,r,o,i){var a=S(e,"x","avgPool","float32");null==r&&(r=[1,1]),A(yr(t,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"});var s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),A(4===s.rank,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),null!=i&&A(Qt(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var c=Uc(s.shape,n,t,r,o,i);if(1===c.filterWidth&&1===c.filterHeight&&hn(c.inShape,c.outShape))return a.clone();var l=F.runKernelFunc(function(d){return d.avgPool(s,c)},{x:s},function(d){return{x:function(){return function(f,h,p,m,v,y){var b=S(f,"dy","avgPoolBackprop"),C=S(h,"input","avgPoolBackprop");A(C.rank===b.rank,function(){return"Rank of input ("+C.rank+") does not match rank of dy ("+b.rank+")"}),null==v&&(v=[1,1]),A(yr(m,v),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+v+"'"});var x=C,E=b,I=!1;3===C.rank&&(I=!0,x=C.as4D(1,C.shape[0],C.shape[1],C.shape[2]),E=b.as4D(1,b.shape[0],b.shape[1],b.shape[2])),A(4===E.rank,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+E.rank+"."}),A(4===x.rank,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+x.rank+"."});var N=Uc(x.shape,p,m,v,y),R=F.runKernelFunc(function(M){return M.avgPoolBackprop(E,x,N)},{dy4D:E,input4D:x});return I?R.as3D(R.shape[1],R.shape[2],R.shape[3]):R}(d,s,n,t,r,o)}}},"AvgPool",c);return l=l.cast(a.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var Mn=P({maxPool_:function(e,n,t,r,o){return Ak(e,n,t,1,r,o)}}),Rf=P({avgPool_:function(e,n,t,r,o){return Mk(e,n,t,1,r,o)}}),Z9=P({pool_:function(e,n,t,r,o,i){null==o&&(o=[1,1]),null==i&&(i=1),0===r&&(r="valid");var a=S(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),A(yr(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var c,E,I,N,R,l=Uc(s.shape,n,i,o,r),d=[l.dilationHeight,l.dilationWidth];c="same"===r?(E=d,I=[l.filterHeight,l.filterWidth].map(function(M,T){return M+(M-1)*(E[T]-1)}).map(function(M){return M-1}),N=I.map(function(M){return Math.floor(M/2)}),R=I.map(function(M,T){return M-N[T]}),I.map(function(M,T){return[N[T],R[T]]})):[[0,0],[0,0]];var f=1===d[0]&&1===d[1],h=function(x,E,I){var N=I.map(function($){return $[0]}),R=I.map(function($){return $[1]}),M=x.concat(N,R),T=E.map(function($,G){return($-M[G]%$)%$}),L=R.map(function($,G){return $+T[G]});return[E.map(function($,G){return[N[G],L[G]]}),E.map(function($,G){return[0,T[G]]})]}([l.inHeight,l.inWidth],d,c),m=h[1],v=f?r:"valid",y=f?s:QR(s,d,h[0]),b=("avg"===t?function(){return Mk(y,n,i,1,v)}:function(){return Ak(y,n,i,1,v)})(),C=f?b:KR(b,d,m);return u?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),Q9=P({maxPool3d_:function(e,n,t,r,o,i,a){void 0===i&&(i="NDHWC");var s=S(e,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),A(5===u.rank,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),A("NDHWC"===i,function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),A(yr(t,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+a+"'"}),null!=o&&A(Qt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var l=_f(u.shape,n,t,a,r,o,i),d=F.runKernelFunc(function(f,h){var p=f.maxPool3d(u,l);return h([u,p]),p},{x:u},function(f,h){var p=h[0],m=h[1];return{x:function(){return function(v,y,b,C,x,E,I,N){var R=S(v,"dy","maxPool3dBackprop"),M=S(y,"input","maxPool3dBackprop"),T=S(b,"output","maxPool3dBackprop"),L=R,O=M,q=T,$=!1;4===M.rank&&($=!0,L=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3]),O=M.as5D(1,M.shape[0],M.shape[1],M.shape[2],M.shape[3]),q=T.as5D(1,T.shape[0],T.shape[1],T.shape[2],T.shape[3])),A(5===L.rank,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+L.rank+"."}),A(5===O.rank,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+O.rank+"."}),A(5===q.rank,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+q.rank+"."}),null==E&&(E=[1,1,1]),A(yr(x,E),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+E+"'"}),null!=N&&A(Qt(I),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+N+" but got pad "+I+"."});var G=_f(O.shape,C,x,E,I,N),J=F.runKernelFunc(function(Y){return Y.maxPool3dBackprop(L,O,q,G)},{dy5D:L,input5D:O});return $?J.as4D(J.shape[1],J.shape[2],J.shape[3],J.shape[4]):J}(f,p,m,n,t,a,r,o)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),J9=P({avgPool3d_:function(e,n,t,r,o,i,a){void 0===i&&(i="NDHWC");var s=S(e,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),A(5===u.rank,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),A("NDHWC"===i,function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),A(yr(t,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+a+"'"}),null!=o&&A(Qt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var l=_f(u.shape,n,t,a,r,o,i),d=F.runKernelFunc(function(f){return f.avgPool3d(u,l)},{x:u},function(f){return{x:function(){return function(h,p,m,v,y,b,C){var x=S(h,"dy","avgPool3dBackprop"),E=S(p,"input","avgPool3dBackprop"),I=x,N=E,R=!1;4===E.rank&&(R=!0,I=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]),N=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),A(5===I.rank,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+I.rank+"."}),A(5===N.rank,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+N.rank+"."}),null==y&&(y=[1,1,1]),A(yr(v,y),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+v+" and dilations '"+y+"'"}),null!=C&&A(Qt(b),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+b+"."});var M=_f(N.shape,m,v,y,b,C),T=F.runKernelFunc(function(L){return L.avgPool3dBackprop(I,N,M)},{dy5D:I,input5D:N});return R?T.as4D(T.shape[1],T.shape[2],T.shape[3],T.shape[4]):T}(f,u,n,t,a,r,o)}}});return d=d.cast(u.dtype),c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),mi=P({slice_:function(e,n,t){var r,o,i=S(e,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof n?[n].concat(new Array(i.rank-1).fill(0)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(0)):n.slice()).forEach(function(u){A(-1!==u,function(){return"slice() does not support negative begin indexing."})}),o=(o=null==t?new Array(i.rank).fill(-1):"number"==typeof t?[t].concat(new Array(i.rank-1).fill(-1)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(-1)):t).map(function(u,c){return u>=0?u:(A(-1===u,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+c+"."}),i.shape[c]-r[c])}),oN(i,r,o);var a=i.shape;return F.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var c=[],l=0;l<u.rank;l++)c.push([r[l],a[l]-r[l]-o[l]]);return{x:function(){return u.pad(c)}}},"Slice",{begin:r,size:o})}}),eX=P({slice1d_:function(e,n,t){var r=S(e,"x","slice1d");return A(1===r.rank,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),mi(r,[n],[t])}}),tX=P({slice2d_:function(e,n,t){var r=S(e,"x","slice2d");return A(2===r.rank,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),mi(r,n,t)}}),Tk=P({slice3d_:function(e,n,t){var r=S(e,"x","slice3d");return A(3===r.rank,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),mi(r,n,t)}}),nX=P({slice4d_:function(e,n,t){var r=S(e,"x","slice4d");return A(4===r.rank,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),mi(r,n,t)}});function Rk(e,n,t,r,o){return n.rank<t.rank&&(n=n.reshape(vr(n.shape,r))),e.rank<t.rank&&(e=e.reshape(vr(e.shape,r))),{x:function(){var i=e.mul(t.equal(n).cast(e.dtype));return null==o?i:i.transpose(o)}}}var rX=P({all_:function(e,n,t){void 0===n&&(n=null),void 0===t&&(t=!1);var r=S(e,"x","all","bool"),o=pn(n,r.shape),i=o,a=jo(i,r.rank);null!=a&&(r=r.transpose(a),i=Ho(i.length,r.rank));var s=F.runKernelFunc(function(c){return c.all(r,i)},{$x:r});if(t){var u=vr(s.shape,o);return s.reshape(u)}return s}}),oX=P({any_:function(e,n,t){void 0===n&&(n=null),void 0===t&&(t=!1);var r=S(e,"x","any","bool"),o=pn(n,r.shape),i=o,a=jo(i,r.rank);null!=a&&(r=r.transpose(a),i=Ho(i.length,r.rank));var s=F.runKernelFunc(function(c){return c.any(r,i)},{$x:r});if(t){var u=vr(s.shape,o);return s.reshape(u)}return s}}),iX=P({argMax_:function(e,n){void 0===n&&(n=0);var t=S(e,"x","argMax");null==n&&(n=0);var r=pn(n,t.shape),o=jo(r,t.rank);return null!=o&&(t=t.transpose(o),r=Ho(r.length,t.rank)),F.runKernelFunc(function(s,u){var c=s.argMax(t,r[0]);return u([t]),c},{x:t},function(s,u){var c=u[0];return{x:function(){return ct(c)}}},"ArgMax",{axis:r[0]},[t])}}),aX=P({argMin_:function(e,n){void 0===n&&(n=0);var t=S(e,"x","argMin");null==n&&(n=0);var r=pn(n,t.shape),o=jo(r,t.rank);return null!=o&&(t=t.transpose(o),r=Ho(r.length,t.rank)),F.runKernelFunc(function(i,a){var s=i.argMin(t,r[0]);return a([t]),s},{$x:t},function(i,a){var s=a[0];return{$x:function(){return ct(s)}}})}}),sX=P({logSumExp_:function(e,n,t){void 0===n&&(n=null),void 0===t&&(t=!1);var r=S(e,"x","logSumExp"),o=pn(n,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(t){var u=vr(s.shape,o);return s.reshape(u)}return s}}),pm=P({max_:function(e,n,t){void 0===n&&(n=null),void 0===t&&(t=!1);var r=S(e,"x","max"),o=r,i=pn(n,r.shape),a=i,s=jo(a,r.rank);null!=s&&(r=r.transpose(s),a=Ho(a.length,r.rank));var c=F.runKernelFunc(function(d,f){var h=d.max(r,a);return f([o,h]),h},{x:r},function(d,f){return Rk(d,f[1],f[0],i,s)},"Max",{axes:a},[r],[!0]);if(t){var l=vr(c.shape,i);c=c.reshape(l)}return c}}),uX=P({mean_:function(e,n,t){void 0===n&&(n=null),void 0===t&&(t=!1);var r=S(e,"x","mean"),o=pn(n,r.shape),i=ge(Vn(r.shape,o)[1]);return Qg(function(a){var s=ae(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(n,t),gradFunc:function(u){var c=a.shape.slice();return o.forEach(function(l){c[l]=1}),u.reshape(c).mul(Bc(a.shape,"float32")).div(i)}}})(r)}}),cX=P({min_:function(e,n,t){void 0===n&&(n=null),void 0===t&&(t=!1);var r=S(e,"x","min"),o=r,i=pn(n,r.shape),a=i,s=jo(a,r.rank);null!=s&&(r=r.transpose(s),a=Ho(a.length,r.rank));var c=F.runKernelFunc(function(d,f){var h=d.min(r,a);return f([o,h]),h},{x:r},function(d,f){return Rk(d,f[1],f[0],i,s)},"Min",{axes:a},[r],[!0]);if(t){var l=vr(c.shape,i);c=c.reshape(l)}return c}}),lX=P({moments_:function(e,n,t){void 0===n&&(n=null),void 0===t&&(t=!1);var r=pn(n,(e=S(e,"x","moments")).shape),o=e.mean(r,t),i=o.shape;t||(i=vr(o.shape,r));var a=e.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,t)}}}),Nk=P({sum_:function(e,n,t){void 0===n&&(n=null),void 0===t&&(t=!1);var r=S(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var o=pn(n,r.shape);return Qg(function(i){var a=jo(o,i.rank),s=o,u=i;null!=a&&(u=i.transpose(a),s=Ho(s.length,i.rank));var c=function(h){var p=i.shape.slice();return o.forEach(function(m){p[m]=1}),h.reshape(p).mul(Bc(i.shape,"float32"))},d=F.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return c(h)}}},"Sum",{axes:s});if(t){var f=vr(d.shape,o);d=d.reshape(f)}return{value:d,gradFunc:c}})(r)}}),dX=P({prod_:function(e,n,t){void 0===n&&(n=null),void 0===t&&(t=!1);var r=S(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var o=pn(n,r.shape),i=jo(o,r.rank),a=o,s=r;null!=i&&(s=r.transpose(i),a=Ho(a.length,r.rank));var u=F.runKernelFunc(function(l){return l.prod(s,a)},{permutedX:s});if(t){var c=vr(u.shape,o);u=u.reshape(c)}return u}}),kk=P({elu_:function(e){var n=S(e,"x","elu");return F.runKernelFunc(function(t,r){var o=t.elu(n);return r([o]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){return F.runKernelFunc(function(i){return i.eluDer(t,o)},{dy:t,y:o})}}})}}),fX=P({leakyRelu_:function(e,n){void 0===n&&(n=.2);var t=S(e,"x","leakyRelu");return Sx(ae(n).mul(t),t)}}),Fk=P({prelu_:function(e,n){var t=S(e,"x","prelu"),r=S(n,"alpha","prelu");return F.runKernelFunc(function(o,i){var a=o.prelu(t,r);return i([t,r]),a},{x:t,alpha:r},function(o,i){var a=i[0],s=i[1],u=a.greater(0);return{x:function(){return Qs(u,o,o.mul(s))},alpha:function(){var c=Qs(u,ct(o),o.mul(a)),l=mn(s.shape,o.shape);return l.length>0&&(c=c.sum(l)),c.reshape(s.shape)}}},"Prelu")}}),Jt=P({relu_:function(e){var n=S(e,"x","relu");return"bool"===n.dtype?n.toInt():F.runKernelFunc(function(t,r){var o=t.relu(n);return r([n]),o},{x:n},function(t,r){var o=r[0];return{x:function(){return t.mulStrict(o.step().toFloat())}}},"Relu")}}),Pk=P({relu6_:function(e){var n=S(e,"x","relu6");return"bool"===n.dtype?n.toInt():F.runKernelFunc(function(t,r){var o=t.relu6(n);return r([n]),o},{x:n},function(t,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return t.mulStrict(i.toFloat())}}},"Relu6")}}),hX=P({selu_:function(e){var n=S(e,"x","selu");return F.runKernelFunc(function(t,r){var o=t.selu(n);return r([n]),o},{$x:n},function(t,r){var o=r[0];return{$x:function(){var i=o.greater(ae(0)),a=ae(_x),s=ae(Dx),u=t.mul(s),c=t.mul(a).mul(o.toFloat().exp());return Qs(i,u,c)}}})}}),qa=P({transpose_:function(e,n){var t=S(e,"x","transpose");return null==n&&(n=t.shape.map(function(o,i){return i}).reverse()),A(t.rank===n.length,function(){return"Error in transpose: rank of input "+t.rank+" must match length of perm "+n+"."}),n.forEach(function(o){A(o>=0&&o<t.rank,function(){return"All entries in 'perm' must be between 0 and "+(t.rank-1)+" but got "+n})}),t.rank<=1?t.clone():F.runKernelFunc(function(o){return o.transpose(t,n)},{x:t},function(o){var i=zg(n);return{x:function(){return o.transpose(i)}}},"Transpose",{perm:n})}}),pX=P({localResponseNormalization_:function(e,n,t,r,o){void 0===n&&(n=5),void 0===t&&(t=1),void 0===r&&(r=1),void 0===o&&(o=.5);var i=S(e,"x","localResponseNormalization");A(4===i.rank||3===i.rank,function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."}),A(Qt(n),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+n+"."});var a=i,s=!1;3===i.rank&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=F.runKernelFunc(function(c,l){var d=c.localResponseNormalization4D(a,n,t,r,o);return l([a,d]),d},{x4D:a},function(c,l){var d=l[0],f=l[1];return{x4D:function(){return F.runKernelFunc(function(h){return h.LRNGrad(c,d,f,n,t,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Ok=P({norm_:function(e,n,t,r){void 0===n&&(n="euclidean"),void 0===t&&(t=null),void 0===r&&(r=!1);var o=function s(u,c,l){if(void 0===l&&(l=null),0===u.rank)return u.abs();if(1!==u.rank&&null===l)return s(u.reshape([-1]),c,l);if(1===u.rank||"number"==typeof l||Array.isArray(l)&&1===l.length){if(1===c)return u.abs().sum(l);if(c===1/0)return u.abs().max(l);if(c===-1/0)return u.abs().min(l);if("euclidean"===c||2===c)return u.abs().pow(ae(2,"int32")).sum(l).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}if(Array.isArray(l)&&2===l.length){if(1===c)return u.abs().sum(l[0]).max(l[1]-1);if(c===1/0)return u.abs().sum(l[1]).max(l[0]);if(c===-1/0)return u.abs().sum(l[1]).min(l[0]);if("fro"===c||"euclidean"===c)return u.square().sum(l).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}throw new Error("Error in norm: invalid axis: "+l)}(e=S(e,"x","norm"),n,t),i=o.shape;if(r){var a=pn(t,e.shape);i=vr(o.shape,a)}return o.reshape(i)}}),gX=P({basicLSTMCell_:function(e,n,t,r,o,i){var a=S(e,"forgetBias","basicLSTMCell"),s=S(n,"lstmKernel","basicLSTMCell"),u=S(t,"lstmBias","basicLSTMCell"),c=S(r,"data","basicLSTMCell"),l=S(o,"c","basicLSTMCell"),d=S(i,"h","basicLSTMCell"),f=c.concat(d,1).matMul(s).add(u),p=f.shape[1]/4,m=[f.shape[0],p],v=f.slice([0,0],m),y=f.slice([0,p],m),b=f.slice([0,2*p],m),C=f.slice([0,3*p],m),x=v.sigmoid().mulStrict(y.tanh()).addStrict(l.mulStrict(a.add(b).sigmoid())),E=x.tanh().mulStrict(C.sigmoid());return[x,E]}}),mX=P({multiRNNCell_:function(e,n,t,r){for(var o=S(n,"data","multiRNNCell"),i=xf(t,"c","multiRNNCell"),a=xf(r,"h","multiRNNCell"),s=o,u=[],c=0;c<e.length;c++){var l=e[c](s,i[c],a[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var d=[],f=[];for(c=0;c<u.length;c+=2)d.push(u[c]),f.push(u[c+1]);return[d,f]}}),vX=P({movingAverage_:function(e,n,t,r,o){void 0===o&&(o=!0);var i=S(e,"v","movingAverage"),a=S(n,"x","movingAverage"),s=S(t,"decay","movingAverage");mR(i,a),A(hn(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=ae(1),c=u.sub(s),l=a.sub(i).mul(c);if(o){A(null!=r,function(){return"When using zeroDebias: true, step is required."});var d=S(r,"step","movingAverage");l=l.div(u.sub(dm(s,d)))}return i.add(l)}}),yX=P({stridedSlice_:function(e,n,t,r,o,i,a,s,u){if(void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(n.length)),0!==a)throw new Error("ellipsis mask is not yet supported");var c=S(e,"x","stridedSlice"),l=ix(s),d=c.shape.slice();l.forEach(function(v){n[v]=0,t[v]=1,d.splice(v,0,1)}),c=c.reshape(d);for(var f=0;f<c.rank;f++)n[f]=iN(o,n,r,c.shape,f),t[f]=aN(i,t,r,c.shape,f),r[f]=r[f]||1;var h=ix(u);h.forEach(function(v){t[v]=n[v]+1,r[v]=1});var p=Zg(n,t,r),m=p.filter(function(v,y){return-1===h.indexOf(y)});return r.every(function(v){return 1===v})?mi(c,n,p).reshape(m):F.runKernelFunc(function(v){return v.stridedSlice(c,n,t,r)},{$x:c}).reshape(m)}}),wX=P({topk_:function(e,n,t){void 0===n&&(n=1),void 0===t&&(t=!0);var r=S(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(n>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+n);var i=F.runKernelFunc(function(a){return a.topk(r,n,t)},{$x:r});return{values:i[0],indices:i[1]}}}),bX=P({scatterND_:function(e,n,t){var r=S(e,"indices","scatterND","int32"),o=S(n,"updates","scatterND");return rN(o,r,t),F.runKernelFunc(function(i){return i.scatterND(r,o,t)},{indices:r,updates:o},null,"ScatterNd",{shape:t})}}),Nx=P({fft_:function(e){A("complex64"===e.dtype,function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var n=e.shape[e.shape.length-1],r=e.as2D(e.size/n,n);return F.runKernelFunc(function(o){return o.fft(r)},{input:e}).reshape(e.shape)}}),gm=P({ifft_:function(e){A("complex64"===e.dtype,function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var n=e.shape[e.shape.length-1],r=e.as2D(e.size/n,n);return F.runKernelFunc(function(o){return o.ifft(r)},{input:e}).reshape(e.shape)}}),kx=P({rfft_:function(e,n){A("float32"===e.dtype,function(){return"The dtype for rfft() must be real value but got "+e.dtype});var t,r=e.shape[e.shape.length-1],o=e.size/r;if(null!=n&&n<r){var i=e.shape.map(function(y){return 0}),a=e.shape.map(function(y){return y});a[e.shape.length-1]=n,t=e.slice(i,a),r=n}else if(null!=n&&n>r){var s=e.shape.map(function(y){return y});s[e.shape.length-1]=n-r,t=e.concat(zt(s),e.shape.length-1),r=n}else t=e;var u=t.zerosLike(),c=Un(t,u).as2D(o,r),l=Nx(c),d=Math.floor(r/2)+1,f=Co(l),h=pi(l),p=f.split([d,r-d],f.shape.length-1),m=h.split([d,r-d],h.shape.length-1),v=t.shape.slice();return v[t.shape.length-1]=d,Un(p[0],m[0]).reshape(v)}}),Lk=P({irfft_:function(e){var n=e.shape[e.shape.length-1],t=e.size/n;if(n<=2){var r=e.as2D(t,n),o=gm(r);return Co(o)}var i=[t,2*(n-1)],a=Co(e).as2D(t,n),s=pi(e).as2D(t,n),u=a.slice([0,1],[t,n-2]).reverse(1),c=s.slice([0,1],[t,n-2]).reverse(1).mul(ae(-1)),l=a.concat(u,1),d=s.concat(c,1);return r=Un(l,d).as2D(i[0],i[1]),o=gm(r),Co(o)}}),xX=Object.freeze({fft:Nx,ifft:gm,rfft:kx,irfft:Lk}),CX=P({sparseToDense_:function(e,n,t,r){void 0===r&&(r=0);var o=S(e,"sparseIndices","sparseToDense","int32"),i=S(n,"sparseValues","sparseToDense"),a=S(r,"defaultValue","sparseToDense",i.dtype);return function(s,u,c,l){if("int32"!==s.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(c.length!==f)throw new Error("outputShape has incorrect number of elements:, "+c.length+", should be: "+f+".");if(0!==u.rank&&(1!==u.rank||u.size!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==l.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,t,a),F.runKernelFunc(function(s){return s.sparseToDense(o,i,t,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),_X=P({gatherND_:function(e,n){var t=S(n,"indices","gatherND","int32"),r=S(e,"x","gatherND");return F.runKernelFunc(function(o){return o.gatherND(r,t)},{x:r,indices:t},null,"GatherNd")}}),DX=P({diag_:function(e){var n=S(e,"x","diag").flatten(),t=e.shape.concat(e.shape);return F.runKernelFunc(function(r){return r.diag(n)},{$x:n}).reshape(t)}}),EX=P({dropout_:function(e,n,t,r){var o=S(e,"x","dropout");if(A("float32"===o.dtype,function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),A(n>=0&&n<1,function(){return"rate must be a float in the range [0, 1), but got "+n+"."}),0===n)return e instanceof kt?o.clone():o;var i=function(u,c){if(null==c)return u.shape.slice();if(hn(u.shape,c))return c;if(u.shape.length===c.length){for(var l=[],d=0;d<u.shape.length;d++)l.push(null==c[d]&&null!=u.shape[d]?u.shape[d]:c[d]);return l}return c}(o,t),a=1-n,s=ZR(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function Bk(e,n,t){for(var r=1-e%2,o=new Float32Array(e),i=0;i<e;++i){var a=2*Math.PI*i/(e+r-1);o[i]=n-t*Math.cos(a)}return gn(o,"float32")}var Jn,Fx=P({hannWindow_:function(e){return Bk(e,.5,.5)}}),Vk=P({hammingWindow_:function(e){return Bk(e,.54,.46)}}),Px=P({frame_:function(e,n,t,r,o){void 0===r&&(r=!1),void 0===o&&(o=0);for(var i=0,a=[];i+n<=e.size;)a.push(mi(e,i,n)),i+=t;if(r)for(;i<e.size;){var s=i+n-e.size,u=Cn([mi(e,i,n-s),gi([s],o)]);a.push(u),i+=t}return 0===a.length?$a([],[0,n]):Cn(a).as2D(a.length,n)}}),Uk=P({stft_:function(e,n,t,r,o){void 0===o&&(o=Fx),null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2)))));for(var a=Px(e,n,t),s=Qn(a,o(n)),u=[],c=0;c<a.shape[0];c++)u.push(kx(s.slice([c,0],[1,n]),r));return Cn(u)}}),IX=Object.freeze({hannWindow:Fx,hammingWindow:Vk,frame:Px,stft:Uk});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Jn||(Jn={}));var AX=P({absoluteDifference_:function(e,n,t,r){void 0===r&&(r=Jn.SUM_BY_NONZERO_WEIGHTS);var o=S(e,"labels","absoluteDifference"),i=S(n,"predictions","absoluteDifference"),a=null;null!=t&&(a=S(t,"weights","absoluteDifference")),ut(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return ra(s,a,r)}}),ra=P({computeWeightedLoss_:function(e,n,t){void 0===t&&(t=Jn.SUM_BY_NONZERO_WEIGHTS);var r=S(e,"losses","computeWeightedLoss"),o=null;null!=n&&(o=S(n,"weights","computeWeightedLoss"));var i=null==o?r:r.mul(o);if(t===Jn.NONE)return i;if(t===Jn.SUM)return i.sum();if(t===Jn.MEAN){if(null==o)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(ae(a)):s}if(t===Jn.SUM_BY_NONZERO_WEIGHTS){if(null==o)return i.sum().div(ae(r.size));var u=o.mul(Bc(r.shape)).notEqual(ae(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+t)}}),MX=P({cosineDistance_:function(e,n,t,r,o){void 0===o&&(o=Jn.SUM_BY_NONZERO_WEIGHTS);var i=S(e,"labels","cosineDistance"),a=S(n,"predictions","cosineDistance"),s=null;null!=r&&(s=S(r,"weights","cosineDistance")),ut(i.shape,a.shape,"Error in cosineDistance: ");var u=ae(1).sub(i.mul(a).sum(t,!0));return ra(u,s,o)}}),TX=P({hingeLoss_:function(e,n,t,r){void 0===r&&(r=Jn.SUM_BY_NONZERO_WEIGHTS);var o=S(e,"labels","hingeLoss"),i=S(n,"predictions","hingeLoss"),a=null;null!=t&&(a=S(t,"weights","hingeLoss")),ut(o.shape,i.shape,"Error in hingeLoss: ");var s=ae(1);o=ae(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return ra(u,a,r)}}),RX=P({huberLoss_:function(e,n,t,r,o){void 0===r&&(r=1),void 0===o&&(o=Jn.SUM_BY_NONZERO_WEIGHTS);var i=S(e,"labels","huberLoss"),a=S(n,"predictions","huberLoss"),s=null;null!=t&&(s=S(t,"weights","huberLoss")),ut(i.shape,a.shape,"Error in huberLoss: ");var u=ae(r),c=a.sub(i).abs(),l=vk(c,u),d=c.sub(l),f=ae(.5).mul(l.square()).add(u.mul(d));return ra(f,s,o)}}),NX=P({logLoss_:function(e,n,t,r,o){void 0===r&&(r=1e-7),void 0===o&&(o=Jn.SUM_BY_NONZERO_WEIGHTS);var i=S(e,"labels","logLoss"),a=S(n,"predictions","logLoss"),s=null;null!=t&&(s=S(t,"weights","logLoss")),ut(i.shape,a.shape,"Error in logLoss: ");var u=ae(1),c=ae(r),l=i.mul(a.add(c).log()).neg().sub(u.sub(i).mul(u.sub(a).add(c).log()));return ra(l,s,o)}}),kX=P({meanSquaredError_:function(e,n,t,r){void 0===r&&(r=Jn.SUM_BY_NONZERO_WEIGHTS);var o=S(e,"labels","meanSquaredError"),i=S(n,"predictions","meanSquaredError"),a=null;null!=t&&(a=S(t,"weights","meanSquaredError")),ut(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return ra(s,a,r)}}),FX=P({sigmoidCrossEntropy_:function(e,n,t,r,o){void 0===r&&(r=0),void 0===o&&(o=Jn.SUM_BY_NONZERO_WEIGHTS);var i=S(e,"multiClassLabels","sigmoidCrossEntropy"),a=S(n,"logits","sigmoidCrossEntropy"),s=null;if(null!=t&&(s=S(t,"weights","sigmoidCrossEntropy")),ut(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=ae(r),c=ae(1),l=ae(.5);i=i.mul(c.sub(u)).add(l.mul(u))}var d=function(f,h){var p=S(f,"labels","sigmoidCrossEntropyWithLogits"),m=S(h,"logits","sigmoidCrossEntropyWithLogits");ut(p.shape,m.shape,"Error in sigmoidCrossEntropyWithLogits: ");var v=m.relu(),y=m.mul(p),b=m.abs().neg().exp().log1p();return v.sub(y).add(b)}(i,a);return ra(d,s,o)}}),PX=P({softmaxCrossEntropy_:function(e,n,t,r,o){void 0===r&&(r=0),void 0===o&&(o=Jn.SUM_BY_NONZERO_WEIGHTS);var i=S(e,"onehotLabels","softmaxCrossEntropy"),a=S(n,"logits","softmaxCrossEntropy"),s=null;if(null!=t&&(s=S(t,"weights","softmaxCrossEntropy")),ut(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=ae(r),c=ae(1),l=ae(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(l))}var d=function(f,h,p){if(void 0===p&&(p=-1),-1===p&&(p=h.rank-1),p!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+p);return Qg(function(m,v,y){var b=v.logSumExp([p],!0),C=v.toFloat().sub(b);return y([m,C]),{value:C.mul(m).neg().sum([p]),gradFunc:function(x,E){var I=E[0],N=E[1],R=vr(x.shape,[p]);return[x.reshape(R).mul(I.toFloat().sub(N.exp())),x.reshape(R).mul(N.exp().sub(I.toFloat()))]}}})(f,h)}(i,a);return ra(d,s,o)}}),OX=Object.freeze({get Reduction(){return Jn},absoluteDifference:AX,computeWeightedLoss:ra,cosineDistance:MX,hingeLoss:TX,huberLoss:RX,logLoss:NX,meanSquaredError:kX,sigmoidCrossEntropy:FX,softmaxCrossEntropy:PX});function jk(e,n){return void 0===n&&(n=!1),F.tidy(function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var t=e.shape[0],r=e.shape[1],o=YR(t),i=e.clone(),a=$a([[1]],[1,1]),s=a.clone(),u=t>=r?r:t,c=function(d){var f,h=i,p=s,m=o;f=F.tidy(function(){var v=i.slice([d,d],[t-d,1]),y=v.norm(),b=i.slice([d,d],[1,1]),C=$a([[-1]]).where(b.greater(0),$a([[1]])),x=b.sub(C.mul(y)),E=v.div(x);s=1===E.shape[0]?a.clone():a.concat(E.slice([1,0],[E.shape[0]-1,E.shape[1]]),0);var I=C.matMul(x).div(y).neg(),N=i.slice([d,0],[t-d,r]),R=I.mul(s);if(0===d)i=N.sub(R.matMul(s.transpose().matMul(N)));else{var M=N.sub(R.matMul(s.transpose().matMul(N)));i=i.slice([0,0],[d,r]).concat(M,0)}var T=o.slice([0,d],[t,o.shape[1]-d]);if(0===d)o=T.sub(T.matMul(s).matMul(R.transpose()));else{var L=T.sub(T.matMul(s).matMul(R.transpose()));o=o.slice([0,0],[t,d]).concat(L,1)}return[s,i,o]}),s=f[0],i=f[1],o=f[2],Rr([h,p,m])},l=0;l<u;++l)c(l);return!n&&t>r&&(o=o.slice([0,0],[t,r]),i=i.slice([0,0],[r,r])),[o,i]})}var LX=P({bandPart_:function(e,n,t){if(n%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+n+".");if(t%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+t+".");var r=S(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(n<=a))throw new Error("bandPart(): numLower ("+n+") must not be greater than the number of rows ("+a+").");if(!(t<=s))throw new Error("bandPart(): numUpper ("+t+") must not be greater than the number of columns ("+s+").");n<0&&(n=a),t<0&&(t=s);var u=$g(0,a,1,"int32").reshape([-1,1]),c=$g(0,s,1,"int32"),l=Dn(u,c),d=lm(l.lessEqual(ae(+n,"int32")),l.greaterEqual(ae(-t,"int32"))),f=zt([a,s],r.dtype);return eo(_n(r.reshape([-1,a,s])).map(function(h){return Qs(d,h,f)})).reshape(o)}}),BX=P({gramSchmidt_:function(e){var n;if(Array.isArray(e)){n=!1,A(null!=e&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var t=e[0].shape[0],r=function(u){A(e[u].shape[0]===t,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+t+")"})},o=1;o<e.length;++o)r(o)}else n=!0,e=ex(e,e.shape[0],0).map(function(u){return JR(u,[0])});A(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],a=e,s=function(u){i.push(F.tidy(function(){var c=a[u];if(u>0)for(var l=0;l<u;++l){var d=Nk(i[l].mulStrict(c)).mul(i[l]);c=c.sub(d)}return c.div(Ok(c,"euclidean"))}))};for(o=0;o<e.length;++o)s(o);return n?eo(i,0):i}}),VX=P({qr_:function(e,n){if(void 0===n&&(n=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return jk(e,n);var t=e.shape.slice(0,e.shape.length-2).reduce(function(a,s){return a*s}),r=_n(e.reshape([t,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=jk(a,n),c=s[1];o.push(s[0]),i.push(c)}),[eo(o,0).reshape(e.shape),eo(i,0).reshape(e.shape)]}}),UX=Object.freeze({bandPart:LX,gramSchmidt:BX,qr:VX});function mm(e,n,t,r,o,i){null==r&&(r=.5),null==o&&(o=Number.NEGATIVE_INFINITY),null==i&&(i=0);var a=e.shape[0];return t=Math.min(t,a),A(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),A(2===e.rank,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),A(4===e.shape[1],function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),A(1===n.rank,function(){return"scores must be a 1D tensor"}),A(n.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+n.shape[0]}),A(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:t,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var jX=P({resizeBilinear_:function(e,n,t){void 0===t&&(t=!1);var r=S(e,"images","resizeBilinear");A(3===r.rank||4===r.rank,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),A(2===n.length,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+n+"."});var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=n[0],s=n[1],u=F.runKernelFunc(function(c,l){return l([o]),c.resizeBilinear(o,a,s,t)},{x:o},function(c,l){return{x:function(){return F.runKernelFunc(function(d){return d.resizeBilinearBackprop(c,l[0],t)},{})}}},"ResizeBilinear",{alignCorners:t,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),HX=P({resizeNearestNeighbor_:function(e,n,t){void 0===t&&(t=!1);var r=S(e,"images","resizeNearestNeighbor");A(3===r.rank||4===r.rank,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),A(2===n.length,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+n+"."}),A("float32"===r.dtype||"int32"===r.dtype,function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=n[0],s=n[1],u=F.runKernelFunc(function(c,l){return l([o]),c.resizeNearestNeighbor(o,a,s,t)},{batchImages:o},function(c,l){return{batchImages:function(){return F.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(c,l[0],t)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),WX=P({nonMaxSuppression_:function(e,n,t,r,o){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY);var i=S(e,"boxes","nonMaxSuppression"),a=S(n,"scores","nonMaxSuppression"),s=mm(i,a,t,r,o);return F.runKernelFunc(function(c){return c.nonMaxSuppression(i,a,t,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",{maxOutputSize:t=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:o=s.scoreThreshold})}}),$X=P({nonMaxSuppressionWithScore_:function(e,n,t,r,o,i){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0);var a=S(e,"boxes","nonMaxSuppression"),s=S(n,"scores","nonMaxSuppression"),u=mm(a,s,t,r,o,i),c={maxOutputSize:t=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},l=F.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),qX=P({cropAndResize_:function(e,n,t,r,o,i){var a=S(e,"image","cropAndResize"),s=S(n,"boxes","cropAndResize","float32"),u=S(t,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var c=s.shape[0];return A(4===a.rank,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),A(2===s.rank&&4===s.shape[1],function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."}),A(1===u.rank&&u.shape[0]===c,function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."}),A(2===r.length,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),A(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),A("bilinear"===o||"nearest"===o,function(){return"method must be bilinear or nearest, but was "+o}),F.runKernelFunc(function(l,d){return l.cropAndResize(a,s,u,r,o,i)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),Ox=Object.freeze({resizeBilinear:jX,resizeNearestNeighbor:HX,nonMaxSuppression:WX,nonMaxSuppressionAsync:function(e,n,t,r,o){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),he(this,void 0,void 0,function(){var i,a,s,u,d;return pe(this,function(f){switch(f.label){case 0:return i=S(e,"boxes","nonMaxSuppressionAsync"),a=S(n,"scores","nonMaxSuppressionAsync"),s=mm(i,a,t,r,o),t=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=f.sent(),d=hx(u[0],u[1],t,r,o),i!==e&&i.dispose(),a!==n&&a.dispose(),[2,d]}})})},nonMaxSuppressionWithScore:$X,nonMaxSuppressionWithScoreAsync:function(e,n,t,r,o,i){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0),he(this,void 0,void 0,function(){var a,s,u,c,f;return pe(this,function(h){switch(h.label){case 0:return a=S(e,"boxes","nonMaxSuppressionAsync"),s=S(n,"scores","nonMaxSuppressionAsync"),u=mm(a,s,t,r,o,i),t=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return c=h.sent(),f=px(c[0],c[1],t,r,o,i),a!==e&&a.dispose(),s!==n&&s.dispose(),[2,f]}})})},cropAndResize:qX}),Lx=function(e,n){return!(e>0)||"linear"===n},Bx=function(e,n,t){if(null==t||"linear"===t)return e;if("relu"===t)return e.mul(n.step());throw new Error("Gradient for activation "+t+" has not been implemented yet.")},Vx=function(e,n){var t=n,r=mn(e.shape,n.shape);return r.length>0&&(t=t.sum(r)),t.reshape(e.shape)},Ux=function(e,n,t){if("linear"===n)return e;if("relu"===n)return Jt(e);if("elu"===n)return kk(e);if("relu6"===n)return Pk(e);if("prelu"===n)return Fk(e,t);throw new Error("Unknown fused activation "+n+".")},XX=P({fusedMatMul_:function(e){var n,t=e.a,r=e.b,o=e.transposeA,i=void 0!==o&&o,a=e.transposeB,s=void 0!==a&&a,u=e.bias,c=e.activation,l=void 0===c?"linear":c,d=e.preluActivationWeights;if(!1===Lx(F.state.gradientDepth,l)){var f=hm(t,r,i,s);return null!=u&&(f=Qe(f,u)),Ux(f,l,d)}var h=S(t,"a","fused matMul"),p=S(r,"b","fused matMul");n=qt(h,p),h=n[0],p=n[1];var m=i?h.shape[h.rank-2]:h.shape[h.rank-1],v=s?p.shape[p.rank-1]:p.shape[p.rank-2],y=i?h.shape[h.rank-1]:h.shape[h.rank-2],b=s?p.shape[p.rank-2]:p.shape[p.rank-1],C=h.shape.slice(0,-2),x=p.shape.slice(0,-2),E=ge(C),I=ge(x);A(h.rank>=2&&p.rank>=2&&h.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+p.rank+"."}),A(hn(C,x),function(){return"Error in fused matMul: outer dimensions ("+C+") and ("+x+") of Tensors with shapes "+h.shape+" and "+p.shape+" must match."}),A(m===v,function(){return"Error in fused matMul: inner shapes ("+m+") and ("+v+") of Tensors with shapes "+h.shape+" and "+p.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var N,R,M=h.shape.slice(0,-2).concat([y,b]),T=i?h.as3D(E,m,y):h.as3D(E,y,m),L=s?p.as3D(I,b,v):p.as3D(I,v,b);null!=u&&Ze(M,(N=qt(N=S(u,"bias","fused matMul"),h)[0]).shape),null!=d&&(R=S(d,"prelu weights","fused matMul"));var O={a:T,b:L};return null!=u&&(O.bias=N),null!=d&&(O.preluActivationWeights=R),F.runKernelFunc(function($,G){var J=$.fusedBatchMatMul({a:T,b:L,transposeA:i,transposeB:s,bias:N,activation:l,preluActivationWeights:R});return G([T,L,J]),J},O,function($,G){var J=G[0],Y=G[1],ne=Bx($,G[2],l),re={};return null!=u&&(re={bias:function(){return Vx(N,ne)}}),Object.assign(i||s?!i&&s?{a:function(){return ne.matMul(Y,!1,!1)},b:function(){return ne.matMul(J,!0,!1)}}:i&&!s?{a:function(){return Y.matMul(ne,!1,!0)},b:function(){return J.matMul(ne,!1,!1)}}:{a:function(){return Y.matMul(ne,!0,!0)},b:function(){return ne.matMul(J,!0,!0)}}:{a:function(){return ne.matMul(Y,!1,!0)},b:function(){return J.matMul(ne,!0,!1)}},re)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:l},[T,L],[!0]).reshape(M)}}),KX=P({fusedConv2d_:function(e){var n=e.x,t=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,d=e.activation,f=void 0===d?"linear":d,h=e.preluActivationWeights;if(!1===Lx(F.state.gradientDepth,f=f||"linear")){var p=Do(n,t,r,o,a,u,c);return null!=l&&(p=Qe(p,l)),Ux(p,f,h)}var m=S(n,"x","conv2d"),v=S(t,"filter","conv2d"),y=m,b=!1;3===m.rank&&(b=!0,y=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),A(4===y.rank,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+y.rank+"."}),A(4===v.rank,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+v.rank+"."}),null!=c&&A(Qt(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+o+"."}),A(y.shape[3]===v.shape[2],function(){return"Error in conv2d: depth of input ("+y.shape[3]+") must match input depth for filter "+v.shape[2]+"."}),A(yr(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),A("NHWC"===a,function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var C,x,E=Ga(y.shape,v.shape,r,u,o,c);null!=l&&(C=qt(C=S(l,"bias","fused conv2d"),m)[0],Ze(E.outShape,C.shape)),null!=h&&(x=S(h,"prelu weights","fused conv2d"));var I={x:y,filter:v};null!=l&&(I.bias=C),null!=h&&(I.preluActivationWeights=x);var R=F.runKernelFunc(function(M,T){var L=M.fusedConv2d({input:y,filter:v,convInfo:E,bias:C,activation:f,preluActivationWeights:x});return T([v,y,L]),L},I,function(M,T){var O=T[0],q=T[1],G=Bx(M,T[2],f);A(Ks(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var J={};return null!=l&&(J={bias:function(){return Vx(C,G)}}),Object.assign({x:function(){return Ek(q.shape,G,O,r,o)},filter:function(){return Tx(q,G,O.shape,r,o)}},J)},"FusedConv2D",{convInfo:E,activation:f},[v,y],[!0]);return b?R.as3D(R.shape[1],R.shape[2],R.shape[3]):R}}),YX=P({fusedDepthwiseConv2d_:function(e){var n=e.x,t=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,d=e.activation,f=void 0===d?"linear":d,h=e.preluActivationWeights;if(!1===Lx(F.state.gradientDepth,f)){var p=fm(n,t,r,o,a,u,c);return null!=l&&(p=Qe(p,l)),Ux(p,f,h)}var m=S(n,"x","depthwiseConv2d"),v=S(t,"filter","depthwiseConv2d"),y=m,b=!1;3===m.rank&&(b=!0,y=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),A(4===y.rank,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+y.rank+"."}),A(4===v.rank,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+v.rank+"."}),A(y.shape[3]===v.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+y.shape[3]+") must match the inChannels dimension in filter "+v.shape[2]+"."}),null==u&&(u=[1,1]),A(yr(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),null!=c&&A(Qt(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+o+"."});var C,x,E=Ga(y.shape,v.shape,r,u,o,c,!0);null!=l&&(C=qt(C=S(l,"bias","fused conv2d"),m)[0],Ze(E.outShape,C.shape)),null!=h&&(x=S(h,"prelu weights","fused depthwiseConv2d"));var I={x:y,filter:v};null!=l&&(I.bias=C),null!=h&&(I.preluActivationWeights=x);var R=F.runKernelFunc(function(M,T){var L=M.fusedDepthwiseConv2D({input:y,filter:v,convInfo:E,bias:C,activation:f,preluActivationWeights:x});return T([v,y,L]),L},I,function(M,T){A(Ks(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var L=T[0],O=T[1],$=Bx(M,T[2],f),G={};return null!=l&&(G={bias:function(){return Vx(C,$)}}),Object.assign({x:function(){return Ik(O.shape,$,L,E)},filter:function(){return Sk(O,$,L.shape,E)}},G)},"FusedDepthwiseConv2D",{convInfo:E,activation:f},[v,y],[!0]);return b?R.as3D(R.shape[1],R.shape[2],R.shape[3]):R}}),ZX=Object.freeze({matMul:XX,conv2d:KX,depthwiseConv2d:YX}),QX=Object.freeze({image:Ox,linalg:UX,losses:OX,spectral:xX,fused:ZX,signal:IX,square:N7,squaredDifference:sk,conv1d:j9,conv2d:Do,conv3d:H9,depthwiseConv2d:fm,separableConv2d:Rx,conv2dTranspose:W9,conv3dTranspose:z9,op:P,batchNormalization2d:u9,batchNormalization3d:c9,batchNormalization4d:l9,batchNormalization:d9,batchNorm:hk,batchNorm2d:f9,batchNorm3d:h9,batchNorm4d:p9,booleanMaskAsync:function(e,n,t){return he(this,void 0,void 0,function(){var r,o,i,a,s,u,c,l,d,f,h,p,m;return pe(this,function(v){switch(v.label){case 0:for(r=S(e,"tensor","boolMask"),o=S(n,"mask","boolMask","bool"),i=t??0,s=r.shape,A((a=o.rank)>0,function(){return"mask cannot be scalar"}),ut(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=i;c<i+a;c++)u*=s[c];return l=s.slice(0,i).concat([u],s.slice(i+a)),d=r.reshape(l),f=o.reshape([-1]),[4,gk(f)];case 1:return h=v.sent(),p=h.squeeze([1]),m=Ax(d,p,i),e!==r&&r.dispose(),n!==o&&o.dispose(),p.dispose(),d.dispose(),f.dispose(),h.dispose(),[2,m]}})})},complex:Un,real:Co,imag:pi,concat:Cn,concat1d:w8,concat2d:b8,concat3d:x8,concat4d:C8,split:ex,matMul:hm,dot:$9,outerProduct:G9,reverse:Tf,reverse1d:q9,reverse2d:X9,reverse3d:K9,reverse4d:Y9,maxPool:Mn,avgPool:Rf,pool:Z9,maxPool3d:Q9,avgPool3d:J9,slice:mi,slice1d:eX,slice2d:tX,slice3d:Tk,slice4d:nX,abs:k7,acos:F7,acosh:P7,asin:O7,asinh:L7,atan:B7,atanh:V7,ceil:U7,clipByValue:Ex,cos:j7,cosh:H7,erf:W7,exp:Ix,expm1:z7,floor:$7,log:G7,log1p:q7,logSigmoid:X7,neg:sm,reciprocal:K7,round:Y7,rsqrt:uk,sigmoid:ck,sign:Z7,isNaN:Q7,isInf:J7,isFinite:e9,sin:t9,sinh:n9,softplus:r9,sqrt:o9,step:i9,tan:a9,tanh:s9,all:rX,any:oX,argMax:iX,argMin:aX,logSumExp:sX,max:pm,mean:uX,min:cX,moments:lX,sum:Nk,prod:dX,equal:yk,equalStrict:T9,greater:R9,greaterEqual:wk,greaterEqualStrict:N9,greaterStrict:k9,less:F9,lessEqual:P9,lessEqualStrict:O9,lessStrict:L9,notEqual:B9,notEqualStrict:V9,add:Qe,addN:v9,addStrict:y9,atan2:w9,div:$o,divNoNan:b9,divStrict:x9,floorDiv:mk,maximum:Sx,maximumStrict:C9,minimum:vk,minimumStrict:_9,mod:D9,modStrict:E9,mul:Qn,mulStrict:I9,pow:dm,powStrict:S9,squaredDifferenceStrict:A9,sub:Dn,subStrict:M9,elu:kk,leakyRelu:fX,prelu:Fk,relu:Jt,relu6:Pk,selu:hX,logicalAnd:lm,logicalNot:g9,logicalOr:pk,logicalXor:m9,where:Qs,whereAsync:gk,buffer:Oe,print:function R8(e,n){void 0===n&&(n=!1),console.log(e.toString(n))},batchToSpaceND:KR,broadcastTo:N8,cast:k8,clone:F8,cumsum:P8,depthToSpace:O8,expandDims:_o,eye:YR,multinomial:L8,oneHot:nx,pad:Xs,pad1d:B8,pad2d:V8,pad3d:U8,pad4d:j8,rand:H8,randomNormal:W8,randomGamma:z8,randomUniform:ZR,reshape:Wo,spaceToBatchND:QR,squeeze:JR,stack:eo,tile:Vc,truncatedNormal:$8,unstack:_n,setdiff1dAsync:function(e,n){return he(this,void 0,void 0,function(){var t,r,o,i,a,s,u,c,l,d;return pe(this,function(f){switch(f.label){case 0:return t=S(e,"x","setdiff1d"),r=S(n,"y","setdiff1d"),A(t.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+t.dtype+") and y ("+r.dtype+")."}),A(1===t.rank,function(){return"x should be 1D tensor, but got x ("+t.shape+")."}),A(1===r.rank,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,t.data()];case 1:return o=f.sent(),[4,r.data()];case 2:for(i=f.sent(),a=new Set(i),s=0,l=0;l<o.length;l++)a.has(o[l])||s++;for(u=new ff([s],t.dtype),c=new ff([s],"int32"),l=0,d=0;l<o.length;l++)a.has(o[l])||(u.values[d]=o[l],c.values[d]=l,d++);return[2,[u.toTensor(),c.toTensor()]]}})})},fill:gi,linspace:function y8(e,n,t){if(t<=0)throw new Error("The number of values should be positive.");return F.runKernelFunc(function(r){return r.linspace(e,n,t)},{})},ones:Bc,range:$g,scalar:ae,tensor:jn,tensor1d:gn,tensor2d:$a,tensor3d:J0,tensor4d:kr,tensor5d:function g8(e,n,t){if(Hs(e),null!=n&&5!==n.length)throw new Error("tensor5d() requires shape to have five numbers");var r=hi(e,t);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==n)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return za(e,n,r,t)},tensor6d:function m8(e,n,t){if(Hs(e),null!=n&&6!==n.length)throw new Error("tensor6d() requires shape to have six numbers");var r=hi(e,t);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==n)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return za(e,n=n||r,r,t)},variable:function v8(e,n,t,r){return void 0===n&&(n=!0),F.makeVariable(e,n,t,r)},zeros:zt,onesLike:XR,zerosLike:ct,transpose:qa,softmax:ea,logSoftmax:X8,localResponseNormalization:pX,norm:Ok,gather:Ax,unsortedSegmentSum:Ck,basicLSTMCell:gX,multiRNNCell:mX,movingAverage:vX,stridedSlice:yX,topk:wX,scatterND:bX,fft:Nx,ifft:gm,rfft:kx,irfft:Lk,sparseToDense:CX,gatherND:_X,diag:DX,dropout:EX,hannWindow:Fx,hammingWindow:Vk,frame:Px,stft:Uk,inTopKAsync:function(e,n,t){return void 0===t&&(t=1),he(this,void 0,void 0,function(){var r,o,i,a,s,u,c,l,d,f,h,p,m,v;return pe(this,function(y){switch(y.label){case 0:return r=S(e,"predictions","inTopK"),o=S(n,"targets","inTopK"),A(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),A(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),ut(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],A(t>0&&t<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+t}),[4,r.data()];case 1:return a=y.sent(),[4,o.data()];case 2:for(s=y.sent(),l=(u=[a.length/i,i])[1],d=Fc("bool",c=u[0]),f=0;f<c;f++){for(p=a.subarray(h=f*l,h+l),m=[],v=0;v<p.length;v++)m.push({value:p[v],index:v});for(m.sort(function(b,C){return C.value-b.value}),d[f]=0,v=0;v<t;v++)if(m[v].index===s[f]){d[f]=1;break}}return e!==r&&r.dispose(),n!==o&&o.dispose(),[2,jn(d,o.shape,"bool")]}})})}});function Q(e,n){Array.isArray(e)||(e=[e]),e.forEach(function(t){null!=t&&A("complex64"!==t.dtype,function(){return n+" does not support complex64 tensors."})})}function jx(e,n,t,r){if("linear"===t)return e.linear(n);if("relu"===t)return e.relu(n);if("elu"===t)return e.elu(n);if("relu6"===t)return e.relu6(n);if("prelu"===t)return e.prelu(n,r);throw new Error("Activation "+t+" has not been implemented for the CPU backend.")}var JX=function(e){function n(){var t=e.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new sN(t,F),t}return Bo(n,e),n.prototype.write=function(t,r,o){this.firstUse&&(this.firstUse=!1,H().get("IS_NODE")&&Wg("\n============================\nHi there \u{1f44b}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var i={};return this.data.set(i,{values:t,dtype:o}),i},n.prototype.move=function(t,r,o,i){this.data.set(t,{values:r,dtype:i})},n.prototype.numDataIds=function(){return this.data.numDataIds()},n.prototype.read=function(t){return he(this,void 0,void 0,function(){return pe(this,function(r){return[2,this.readSync(t)]})})},n.prototype.readSync=function(t){var r=this.data.get(t),i=r.complexTensors;return"complex64"===r.dtype?fx(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(t).values},n.prototype.bufferSync=function(t){var r=this.readSync(t.dataId),o=r;if("string"===t.dtype)try{o=r.map(function(i){return uf(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Oe(t.shape,t.dtype,o)},n.prototype.makeOutput=function(t,r,o){var i=this.write(t,r,o);return F.makeTensorFromDataId(i,r,o,this)},n.prototype.disposeData=function(t){if(this.data.has(t)){var r=this.data.get(t).complexTensors;null!=r&&(r.real.dispose(),r.imag.dispose()),this.data.delete(t)}},n.prototype.time=function(t){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){return r=Uo(),t(),[2,{kernelMs:Uo()-r}]})})},n.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},n.prototype.complex=function(t,r){var o=this.makeOutput(null,t.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:F.keep(t.clone()),imag:F.keep(r.clone())},o},n.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},n.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},n.prototype.slice=function(t,r,o){if(Q(t,"slice"),ax(t.shape,r,o)){var i=sx(r,t.strides),a=ge(o);return jn(this.readSync(t.dataId).subarray(i,i+a),o,t.dtype)}for(var s=Oe(o,t.dtype),u=this.bufferSync(t),c=0;c<s.size;++c){var l=s.indexToLoc(c).map(function(d,f){return d+r[f]});s.values[c]=u.get.apply(u,l)}return s.toTensor()},n.prototype.stridedSlice=function(t,r,o,i){Q(t,"stridedSlice");var a=Zg(r,o,i);if(a.some(function(h){return 0===h}))return jn([],a);for(var s=Oe(a,t.dtype),u=this.bufferSync(t),c=0;c<s.size;c++){for(var l=s.indexToLoc(c),d=new Array(l.length),f=0;f<d.length;f++)d[f]=l[f]*i[f]+r[f];s.set.apply(s,[u.get.apply(u,d)].concat(l))}return s.toTensor()},n.prototype.diag=function(t){for(var r=this.readSync(t.dataId),o=Oe([t.size,t.size],t.dtype),i=o.values,a=0;a<r.length;a++)i[a*t.size+a]=r[a];return o.toTensor()},n.prototype.unstack=function(t,r){for(var o=t.shape[r],i=new Array(t.rank-1),a=0,s=0;s<t.rank;s++)s!==r&&(i[a++]=t.shape[s]);var u=new Array(t.rank).fill(0),c=t.shape.slice();c[r]=1;var l=new Array(o);for(s=0;s<l.length;s++)u[r]=s,l[s]=this.slice(t,u,c).reshape(i);return l},n.prototype.reverse=function(t,r){Q(t,"reverse");for(var o=Oe(t.shape,t.dtype),i=this.bufferSync(t),a=function(u){var c=o.indexToLoc(u),l=c.slice();r.forEach(function(d){return l[d]=t.shape[d]-1-l[d]}),o.set.apply(o,[i.get.apply(i,l)].concat(c))},s=0;s<o.size;s++)a(s);return o.toTensor()},n.prototype.concat=function(t,r){var o=this;if("complex64"===t[0].dtype){var i=t.map(function(h){return Co(h)}),a=t.map(function(h){return pi(h)});return Un(this.concat(i,r),this.concat(a,r))}var s=t.map(function(h){var p=ge(h.shape.slice(r));return h.as2D(-1,p)}),u=$s(s.map(function(h){return h.shape}),1),c=Oe(u,t[0].dtype).values;if(1===s[0].shape[0]){var l=0;s.forEach(function(h){c.set(o.readSync(h.dataId),l),l+=h.size})}else{var d=0;s.forEach(function(h){for(var p=o.readSync(h.dataId),m=0,v=0;v<h.shape[0];++v)for(var y=v*u[1]+d,b=0;b<h.shape[1];++b)c[y+b]=p[m++];d+=h.shape[1]})}var f=$s(t.map(function(h){return h.shape}),r);return jn(c,f,t[0].dtype)},n.prototype.neg=function(t){return Q(t,"neg"),this.multiply(ae(-1),t)},n.prototype.add=function(t,r){return"complex64"===t.dtype||"complex64"===r.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(t,r,An(t.dtype,r.dtype),function(o,i){return o+i})},n.prototype.addN=function(t){var r=this;Q(t,"addN");for(var o=t.map(function(l){return r.readSync(l.dataId)}),i=Oe(t[0].shape,t[0].dtype),a=i.values,s=0;s<t.length;s++)for(var u=o[s],c=0;c<a.length;c++)a[c]+=u[c];return i.toTensor()},n.prototype.softmax=function(t,r){var o=pn([r],t.shape),i=this.max(t,o),a=vr(i.shape,o),s=this.subtract(t,i.reshape(a)),u=this.exp(s),c=this.sum(u,o).reshape(a);return this.realDivide(u,c)},n.prototype.subtract=function(t,r){return"complex64"===t.dtype||"complex64"===r.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(t,r,An(t.dtype,r.dtype),function(o,i){return o-i})},n.prototype.pow=function(t,r){return Q([t,r],"pow"),this.broadcastedBinaryOp(t,r,t.dtype,function(o,i){return Math.pow(o,i)})},n.prototype.batchMatMul=function(t,r,o,i){Q([t,r],"matMul");for(var a=o?t.shape[1]:t.shape[2],s=o?t.shape[2]:t.shape[1],u=i?r.shape[1]:r.shape[2],c=t.shape[0],l=this.readSync(t.dataId),d=this.readSync(r.dataId),f=o?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],h=f[0],p=f[1],m=f[2],v=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],y=v[0],b=v[1],C=v[2],x=s*u,E=Oe([c,s,u],t.dtype),I=E.values,N=this.blockSize,R=0;R<c;R++)for(var M=0;M<s;M+=N)for(var T=0;T<u;T+=N)for(var L=0;L<a;L+=N)for(var O=Math.min(M+N,s),q=Math.min(T+N,u),$=Math.min(L+N,a),G=M;G<O;G++)for(var J=T;J<q;J++){for(var Y=0,X=L;X<$;X++)Y+=l[R*h+G*p+X*m]*d[X*y+J*b+R*C];I[R*x+(G*u+J)]+=Y}return E.toTensor()},n.prototype.fusedBatchMatMul=function(t){var s=t.bias,u=t.activation,c=t.preluActivationWeights,l=this.batchMatMul(t.a,t.b,t.transposeA,t.transposeB);return s&&(l=this.add(l,s)),u&&(l=jx(this,l,u,c)),l},n.prototype.multiply=function(t,r){return"complex64"===t.dtype||"complex64"===r.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(t,r,An(t.dtype,r.dtype),function(o,i){return o*i})},n.prototype.realDivide=function(t,r){return Q([t,r],"realDivide"),this.broadcastedBinaryOp(t,r,"float32",function(o,i){return o/i})},n.prototype.floorDiv=function(t,r){return Q([t,r],"floorDiv"),this.broadcastedBinaryOp(t,r,"int32",function(o,i){return Math.floor(o/i)})},n.prototype.sum=function(t,r){Q(t,"sum"),Nr("sum",r,t.rank);for(var o=Vn(t.shape,r),a=o[1],s=zt(o[0],An(t.dtype,"int32")),u=ge(a),c=this.readSync(s.dataId),l=this.readSync(t.dataId),d=0;d<c.length;++d){for(var f=d*u,h=0,p=0;p<u;++p)h+=l[f+p];c[d]=h}return s},n.prototype.prod=function(t,r){Q(t,"sum");for(var o=Vn(t.shape,r),a=o[1],s=zt(o[0],An(t.dtype,"int32")),u=ge(a),c=this.readSync(s.dataId),l=this.readSync(t.dataId),d=0;d<c.length;++d){for(var f=d*u,h=1,p=0;p<u;++p)h*=l[f+p];c[d]=h}return s},n.prototype.unsortedSegmentSum=function(t,r,o){Q(t,"unsortedSegmentSum");for(var i=[],a=t.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=ae(s,"int32"),c=yk(u,r).asType("float32").mul(t).sum(0);i.push(c)}return eo(i)},n.prototype.argMin=function(t,r){Q(t,"argMin");var o=[r];Nr("argMin",o,t.rank);for(var i=Vn(t.shape,o),s=i[1],u=zt(i[0],"int32"),c=ge(s),l=this.readSync(u.dataId),d=this.readSync(t.dataId),f=0;f<l.length;++f){for(var h=f*c,p=d[h],m=0,v=0;v<c;++v){var y=d[h+v];y<p&&(p=y,m=v)}l[f]=m}return u},n.prototype.argMax=function(t,r){Q(t,"argMax");var o=[r];Nr("argMax",o,t.rank);for(var i=Vn(t.shape,o),s=i[1],u=zt(i[0],"int32"),c=ge(s),l=this.readSync(u.dataId),d=this.readSync(t.dataId),f=0;f<l.length;++f){for(var h=f*c,p=d[h],m=0,v=0;v<c;++v){var y=d[h+v];y>p&&(p=y,m=v)}l[f]=m}return u},n.prototype.cumsum=function(t,r,o,i){if(Q(t,"cumsum"),r!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+r);for(var a=An(t.dtype,"int32"),s=zt(t.shape,a),u=this.readSync(s.dataId),c=this.readSync(t.dataId),l=t.shape[t.rank-1],d=i?function(v,y){return v+l-y-1}:function(v,y){return v+y},f=0;f<c.length;f+=l)for(var h=0;h<l;h++){var p=d(f,h);if(0===h)u[p]=o?0:c[p];else{var m=d(f,h-1);u[p]=o?c[m]+u[m]:c[p]+u[m]}}return s},n.prototype.equal=function(t,r){return Q([t,r],"equal"),this.broadcastedBinaryOp(t,r,"bool",function(o,i){return o===i?1:0})},n.prototype.notEqual=function(t,r){return Q([t,r],"notEqual"),this.broadcastedBinaryOp(t,r,"bool",function(o,i){return o!==i?1:0})},n.prototype.less=function(t,r){return Q([t,r],"less"),this.broadcastedBinaryOp(t,r,"bool",function(o,i){return o<i?1:0})},n.prototype.lessEqual=function(t,r){return Q([t,r],"lessEqual"),this.broadcastedBinaryOp(t,r,"bool",function(o,i){return o<=i?1:0})},n.prototype.greater=function(t,r){return Q([t,r],"greater"),this.broadcastedBinaryOp(t,r,"bool",function(o,i){return o>i?1:0})},n.prototype.greaterEqual=function(t,r){return Q([t,r],"greaterEqual"),this.broadcastedBinaryOp(t,r,"bool",function(o,i){return o>=i?1:0})},n.prototype.logicalNot=function(t){Q(t,"logicalNot");for(var r=this.readSync(t.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,t.shape,"bool")},n.prototype.logicalAnd=function(t,r){return Q([t,r],"logicalAnd"),this.broadcastedBinaryOp(t,r,"bool",function(o,i){return o&&i})},n.prototype.logicalOr=function(t,r){return Q([t,r],"logicalOr"),this.broadcastedBinaryOp(t,r,"bool",function(o,i){return o||i})},n.prototype.select=function(t,r,o){Q([t,r,o],"select");for(var i=this.readSync(t.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),u=zt(r.shape,An(r.dtype,o.dtype)),c=this.readSync(u.dataId),l=0,d=0===t.rank||t.rank>1||1===r.rank?1:ge(r.shape.slice(1)),f=0;f<i.length;f++)for(var h=0;h<d;h++)c[l++]=1===i[f]?a[f]:s[f];return u},n.prototype.where=function(t){Q([t],"where");var r=this.readSync(t.dataId);return gx(t.shape,r)},n.prototype.topk=function(t,r,o){return Q(t,"topk"),pN(this.readSync(t.dataId),t.shape,t.dtype,r)},n.prototype.min=function(t,r){Q(t,"min"),Nr("min",r,t.rank);for(var o=Vn(t.shape,r),a=o[1],s=zt(o[0],t.dtype),u=ge(a),c=this.readSync(s.dataId),l=this.readSync(t.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],p=0;p<u;++p){var m=l[f+p];m<h&&(h=m)}c[d]=h}return s},n.prototype.minimum=function(t,r){return Q([t,r],"minimum"),this.broadcastedBinaryOp(t,r,t.dtype,function(o,i){return Math.min(o,i)})},n.prototype.mod=function(t,r){return Q([t,r],"mod"),this.broadcastedBinaryOp(t,r,t.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},n.prototype.max=function(t,r){Q(t,"max"),Nr("max",r,t.rank);for(var o=Vn(t.shape,r),a=o[1],s=zt(o[0],t.dtype),u=ge(a),c=this.readSync(s.dataId),l=this.readSync(t.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],p=0;p<u;++p){var m=l[f+p];m>h&&(h=m)}c[d]=h}return s},n.prototype.maximum=function(t,r){return Q([t,r],"maximum"),this.broadcastedBinaryOp(t,r,t.dtype,function(o,i){return Math.max(o,i)})},n.prototype.all=function(t,r){Q(t,"all"),Nr("all",r,t.rank);for(var o=Vn(t.shape,r),a=o[1],s=zt(o[0],t.dtype),u=ge(a),c=this.readSync(s.dataId),l=this.readSync(t.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],p=0;p<u;++p)h=h&&l[f+p];c[d]=h}return s},n.prototype.any=function(t,r){Q(t,"any"),Nr("any",r,t.rank);for(var o=Vn(t.shape,r),a=o[1],s=zt(o[0],t.dtype),u=ge(a),c=this.readSync(s.dataId),l=this.readSync(t.dataId),d=0;d<c.length;++d){for(var f=d*u,h=l[f],p=0;p<u;++p)h=h||l[f+p];c[d]=h}return s},n.prototype.squaredDifference=function(t,r){return Q([t,r],"squaredDifference"),this.broadcastedBinaryOp(t,r,t.dtype,function(o,i){var a=o-i;return a*a})},n.prototype.ceil=function(t){Q(t,"ceil");for(var r=this.readSync(t.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,t.shape,"float32")},n.prototype.floor=function(t){Q(t,"floor");for(var r=this.readSync(t.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,t.shape,"float32")},n.prototype.sign=function(t){Q(t,"x");for(var r=this.readSync(t.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=r[i]<0?-1:r[i]>0?1:0;return this.makeOutput(o,t.shape,"float32")},n.prototype.isNaN=function(t){Q(t,"x");for(var r=this.readSync(t.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,t.shape,"bool")},n.prototype.isInf=function(t){Q(t,"x");for(var r=this.readSync(t.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,t.shape,"bool")},n.prototype.isFinite=function(t){Q(t,"x");for(var r=this.readSync(t.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,t.shape,"bool")},n.prototype.round=function(t){Q(t,"round");for(var r=this.readSync(t.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);o[i]=r[i]-a<.5?Math.floor(r[i]):r[i]-a>.5?Math.ceil(r[i]):a%2==0?a:a+1}return this.makeOutput(o,t.shape,"float32")},n.prototype.exp=function(t){Q(t,"exp");for(var r=this.readSync(t.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,t.shape,"float32")},n.prototype.expm1=function(t){Q(t,"expm1");for(var r=this.readSync(t.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,t.shape,"float32")},n.prototype.log=function(t){Q(t,"log");for(var r=this.readSync(t.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.log(r[i]);return this.makeOutput(o,t.shape,"float32")},n.prototype.log1p=function(t){Q(t,"log1p");for(var r=this.readSync(t.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.log1p(r[i]);return this.makeOutput(o,t.shape,"float32")},n.prototype.sqrt=function(t){Q(t,"sqrt");for(var r=this.readSync(t.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.sqrt(r[i]);return this.makeOutput(o,t.shape,"float32")},n.prototype.rsqrt=function(t){Q(t,"rsqrt");for(var r=this.readSync(t.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/Math.sqrt(r[i]);return this.makeOutput(o,t.shape,"float32")},n.prototype.reciprocal=function(t){Q(t,"reciprocal");for(var r=this.readSync(t.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,t.shape,"float32")},n.prototype.linear=function(t){return t},n.prototype.relu=function(t){Q(t,"relu");for(var r=zt(t.shape,t.dtype),o=this.readSync(r.dataId),i=this.readSync(t.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},n.prototype.relu6=function(t){Q(t,"relu");for(var r=zt(t.shape,t.dtype),o=this.readSync(r.dataId),i=this.readSync(t.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},n.prototype.prelu=function(t,r){return Q([t,r],"prelu"),this.broadcastedBinaryOp(t,r,t.dtype,function(o,i){return o<0?i*o:o})},n.prototype.elu=function(t){Q(t,"elu");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,t.shape,"float32")},n.prototype.eluDer=function(t,r){Q([t,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(t.dataId),s=0;s<i.length;++s){var u=i[s];o[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},n.prototype.selu=function(t){Q(t,"selu");for(var i=new Float32Array(t.size),a=this.readSync(t.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=0?1.0507009873554805*u:1.7580993408473768*(Math.exp(u)-1)}return this.makeOutput(i,t.shape,"float32")},n.prototype.clip=function(t,r,o){Q(t,"clip");for(var i=new Float32Array(t.size),a=this.readSync(t.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>o?o:u<r?r:u}return this.makeOutput(i,t.shape,"float32")},n.prototype.abs=function(t){for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.complexAbs=function(t){for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<t.size;++i)r[i]=Math.hypot(o[2*i],o[2*i+1]);return this.makeOutput(r,t.shape,"float32")},n.prototype.int=function(t){Q(t,"int");for(var r=new Int32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,t.shape,"int32")},n.prototype.sigmoid=function(t){Q(t,"sigmoid");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,t.shape,"float32")},n.prototype.softplus=function(t){Q(t,"softplus");for(var r=Math.log(1.1920928955078125e-7)+2,o=new Float32Array(t.size),i=this.readSync(t.dataId),a=0;a<i.length;++a){var l,s=i[a]>-r,u=i[a]<r,c=Math.exp(i[a]);l=u?c:s?i[a]:Math.log(1+c),o[a]=l}return this.makeOutput(o,t.shape,"float32")},n.prototype.sin=function(t){Q(t,"sin");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.cos=function(t){Q(t,"cos");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.tan=function(t){Q(t,"tan");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.asin=function(t){Q(t,"asin");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.acos=function(t){Q(t,"acos");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.atan=function(t){Q(t,"atan");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.atan2=function(t,r){return Q([t,r],"atan2"),this.broadcastedBinaryOp(t,r,t.dtype,function(o,i){return Math.atan2(o,i)})},n.prototype.sinh=function(t){Q(t,"sinh");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.cosh=function(t){Q(t,"cosh");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.tanh=function(t){Q(t,"tanh");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=nR(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.asinh=function(t){Q(t,"asinh");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.acosh=function(t){Q(t,"acosh");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.atanh=function(t){Q(t,"atanh");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,t.shape,"float32")},n.prototype.erf=function(t){Q(t,"erf");for(var r=new Float32Array(t.size),o=this.readSync(t.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),u=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,t.shape,"float32")},n.prototype.step=function(t,r){void 0===r&&(r=0),Q(t,"step");for(var o=new Float32Array(t.size),i=this.readSync(t.dataId),a=0;a<i.length;++a){var s=i[a];o[a]=isNaN(s)?NaN:s>0?1:r}return this.makeOutput(o,t.shape,"float32")},n.prototype.fusedConv2d=function(t){var a=t.bias,s=t.activation,u=t.preluActivationWeights,c=this.conv2d(t.input,t.filter,t.convInfo);return a&&(c=this.add(c,a)),s&&(c=jx(this,c,s,u)),c},n.prototype.conv2d=function(t,r,o){Q([t,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,c=o.padInfo.left,l=o.padInfo.top,d="channelsLast"===o.dataFormat,f=Oe(o.outShape,t.dtype),h=t.strides[0],p=d?t.strides[1]:t.strides[2],m=d?t.strides[2]:1,v=d?1:t.strides[1],y=f.strides[0],b=d?f.strides[1]:f.strides[2],C=d?f.strides[2]:1,x=d?1:f.strides[1],E=this.readSync(t.dataId),I=this.readSync(r.dataId),N=f.values,R=0;R<o.batchSize;++R)for(var M=R*h,T=R*y,L=0;L<o.outHeight;++L)for(var O=T+L*b,q=L*o.strideHeight-l,$=0;$<i;$++){var G=q+$*s;if(!(G<0||G>=o.inHeight))for(var J=$*r.strides[0],Y=M+G*p,X=0;X<o.outWidth;++X)for(var ne=O+X*C,re=X*o.strideWidth-c,ce=0;ce<a;ce++){var we=re+ce*u;if(!(we<0||we>=o.inWidth))for(var be=Y+we*m,Xe=J+ce*r.strides[1],Ke=0;Ke<o.inChannels;++Ke){for(var et=E[be+Ke*v],lt=0;lt<o.outChannels;++lt)N[ne+lt*x]+=et*I[Xe+lt];Xe+=o.outChannels}}}return f.toTensor()},n.prototype.conv3d=function(t,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,c=o.dilationHeight,l=o.dilationWidth,d=o.padInfo.front,f=o.padInfo.left,h=o.padInfo.top,p=Oe(o.outShape,t.dtype),m=this.readSync(t.dataId),v=this.readSync(r.dataId),y=p.values,b=0;b<o.batchSize;++b)for(var C=b*t.strides[0],x=b*p.strides[0],E=0;E<o.outDepth;++E)for(var I=x+E*p.strides[1],N=E*o.strideDepth-d,R=0;R<i;R++){var M=N+R*u;if(!(M<0||M>=o.inDepth))for(var T=R*r.strides[0],L=C+M*t.strides[1],O=0;O<o.outHeight;++O)for(var q=I+O*p.strides[2],$=O*o.strideHeight-h,G=0;G<a;G++){var J=$+G*c;if(!(J<0||J>=o.inHeight))for(var Y=T+G*r.strides[1],X=L+J*t.strides[2],ne=0;ne<o.outWidth;++ne)for(var re=q+ne*o.outChannels,ce=ne*o.strideWidth-f,we=0;we<s;we++){var be=ce+we*l;if(!(be<0||be>=o.inWidth))for(var Ke=X+be*o.inChannels,et=Y+we*r.strides[2],lt=0;lt<o.inChannels;++lt){for(var ot=m[Ke+lt],dt=0;dt<o.outChannels;++dt)y[re+dt]+=ot*v[et+dt];et+=o.outChannels}}}}return p.toTensor()},n.prototype.conv2dDerInput=function(t,r,o){Q([t,r],"conv2dDerInput");for(var i=Oe(o.inShape,"float32"),a=i.values,s=this.readSync(t.dataId),u=this.readSync(r.dataId),c=r.strides,l=c[0],d=c[1],f=c[2],h=o.batchSize,p=o.filterHeight,m=o.filterWidth,v=o.inChannels,y=o.inHeight,b=o.inWidth,C=o.outChannels,x=o.outHeight,E=o.outWidth,I=o.strideHeight,N=o.strideWidth,M=p-1-o.padInfo.top,T=m-1-o.padInfo.left,L="channelsLast"===o.dataFormat,O=i.strides[0],q=L?i.strides[1]:i.strides[2],$=L?i.strides[2]:1,G=L?1:i.strides[1],J=t.strides[0],Y=L?t.strides[1]:t.strides[2],X=L?t.strides[2]:1,ne=L?1:t.strides[1],re=0;re<h;++re)for(var ce=0;ce<v;++ce)for(var we=0;we<y;++we)for(var be=we-M,Xe=Math.max(0,Math.ceil(be/I)),Ke=Math.min(x,(p+be)/I),et=0;et<b;++et){for(var lt=et-T,ot=Math.max(0,Math.ceil(lt/N)),dt=Math.min(E,(m+lt)/N),ln=0,it=Xe;it<Ke;++it)for(var Tt=it*I-be,Ct=ot;Ct<dt;++Ct)for(var sn=J*re+Y*it+X*Ct,en=l*(p-1-Tt)+d*(m-1-(Ct*N-lt))+f*ce,tn=0;tn<C;++tn)ln+=s[sn+ne*tn]*u[en+tn];a[O*re+q*we+$*et+G*ce]=ln}return i.toTensor()},n.prototype.conv3dDerInput=function(t,r,o){for(var i=Oe(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],c=s[1],l=s[2],d=s[3],f=this.readSync(t.dataId),h=t.strides,p=h[0],m=h[1],v=h[2],y=h[3],b=this.readSync(r.dataId),C=r.strides,x=C[0],E=C[1],I=C[2],N=C[3],R=o.batchSize,M=o.filterDepth,T=o.filterHeight,L=o.filterWidth,O=o.inChannels,q=o.inDepth,$=o.inHeight,G=o.inWidth,J=o.outChannels,Y=o.outDepth,X=o.outHeight,ne=o.outWidth,re=o.strideDepth,ce=o.strideHeight,we=o.strideWidth,be=M-1-o.padInfo.front,Xe=T-1-o.padInfo.top,Ke=L-1-o.padInfo.left,et=0;et<R;++et)for(var lt=0;lt<O;++lt)for(var ot=0;ot<q;++ot)for(var dt=ot-be,ln=Math.max(0,Math.ceil(dt/re)),it=Math.min(Y,(M+dt)/re),Tt=0;Tt<$;++Tt)for(var Ct=Tt-Xe,sn=Math.max(0,Math.ceil(Ct/ce)),en=Math.min(X,(T+Ct)/ce),tn=0;tn<G;++tn){for(var Ci=tn-Ke,_i=Math.max(0,Math.ceil(Ci/we)),ro=Math.min(ne,(L+Ci)/we),nl=0,la=ln;la<it;++la)for(var ts=la*re-dt,da=sn;da<en;++da)for(var rl=da*ce-Ct,fa=_i;fa<ro;++fa)for(var jC=p*et+m*la+v*da+y*fa,ol=x*(M-1-ts)+E*(T-1-rl)+I*(L-1-(fa*we-Ci))+N*lt,Di=0;Di<J;++Di)nl+=f[jC+Di]*b[ol+Di];a[u*et+c*ot+l*Tt+d*tn+lt]=nl}return i.toTensor()},n.prototype.conv2dDerFilter=function(t,r,o){Q([t,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c="channelsLast"===o.dataFormat,l=Oe(o.filterShape,"float32"),d=o.padInfo.left,f=o.padInfo.top,h=this.bufferSync(t),p=this.bufferSync(r),m=0;m<s;++m)for(var v=Math.max(0,Math.ceil((f-m)/i)),y=Math.min(o.outHeight,(o.inHeight+f-m)/i),b=0;b<u;++b)for(var C=Math.max(0,Math.ceil((d-b)/a)),x=Math.min(o.outWidth,(o.inWidth+d-b)/a),E=0;E<o.inChannels;++E)for(var I=0;I<o.outChannels;++I){for(var N=0,R=0;R<o.batchSize;++R)for(var M=v;M<y;++M)for(var T=m+M*i-f,L=C;L<x;++L){var O=b+L*a-d;N+=c?h.get(R,T,O,E)*p.get(R,M,L,I):h.get(R,E,T,O)*p.get(R,I,M,L)}l.set(N,m,b,E,I)}return l.toTensor()},n.prototype.conv3dDerFilter=function(t,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,c=o.filterHeight,l=o.filterWidth,d=Oe(o.filterShape,"float32"),f=d.values,h=d.strides,p=h[0],m=h[1],v=h[2],y=h[3],b=this.readSync(r.dataId),C=r.strides,x=C[0],E=C[1],I=C[2],N=C[3],R=this.readSync(t.dataId),M=t.strides,T=M[0],L=M[1],O=M[2],q=M[3],$=o.padInfo.front,G=o.padInfo.left,J=o.padInfo.top,Y=0;Y<u;++Y)for(var X=Math.max(0,Math.ceil(($-Y)/i)),ne=Math.min(o.outDepth,(o.inDepth+$-Y)/i),re=Y*p,ce=0;ce<c;++ce)for(var we=Math.max(0,Math.ceil((J-ce)/a)),be=Math.min(o.outHeight,(o.inHeight+J-ce)/a),Xe=ce*m+re,Ke=0;Ke<l;++Ke)for(var et=Math.max(0,Math.ceil((G-Ke)/s)),lt=Math.min(o.outWidth,(o.inWidth+G-Ke)/s),ot=Ke*v+Xe,dt=0;dt<o.inChannels;++dt)for(var ln=dt*y+ot,it=0;it<o.outChannels;++it){for(var Tt=0,Ct=0;Ct<o.batchSize;++Ct)for(var sn=Ct*T,en=Ct*x,tn=X;tn<ne;++tn)for(var Ci=(Y+tn*i-$)*L+sn,_i=tn*E+en,ro=we;ro<be;++ro)for(var nl=(ce+ro*a-J)*O+Ci,la=ro*I+_i,ts=et;ts<lt;++ts)Tt+=R[(Ke+ts*s-G)*q+nl+dt]*b[ts*N+la+it];f[ln+it]=Tt}return d.toTensor()},n.prototype.fusedDepthwiseConv2D=function(t){var a=t.bias,s=t.activation,u=t.preluActivationWeights,c=this.depthwiseConv2D(t.input,t.filter,t.convInfo);return a&&(c=this.add(c,a)),s&&(c=jx(this,c,s,u)),c},n.prototype.depthwiseConv2D=function(t,r,o){Q([t,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,c=o.padInfo.left,l=o.padInfo.top,d=o.outChannels/o.inChannels,f=Oe(o.outShape,t.dtype),h=this.readSync(t.dataId),p=this.readSync(r.dataId),m=f.values,v=0;v<o.batchSize;++v)for(var y=v*t.strides[0],b=v*f.strides[0],C=0;C<o.outHeight;++C)for(var x=b+C*f.strides[1],E=C*o.strideHeight-c,I=0;I<i;++I){var N=E+I*s;if(!(N<0||N>=o.inHeight))for(var R=I*r.strides[0],M=y+N*t.strides[1],T=0;T<o.outWidth;++T)for(var L=x+T*f.strides[2],O=T*o.strideWidth-l,q=0;q<a;++q){var $=O+q*u;if(!($<0||$>=o.inWidth))for(var J=M+$*o.inChannels,Y=L,X=R+q*r.strides[1],ne=0;ne<o.inChannels;++ne){for(var re=h[J+ne],ce=0;ce<d;++ce)m[Y+ce]+=re*p[X+ce];Y+=d,X+=d}}}return f.toTensor()},n.prototype.depthwiseConv2DDerInput=function(t,r,o){Q([t,r],"depthwiseConv2DDerInput");for(var i=Oe(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],c=s[1],l=s[2],d=this.readSync(t.dataId),f=t.strides,h=f[0],p=f[1],m=f[2],v=this.readSync(r.dataId),y=r.strides,b=y[0],C=y[1],x=y[2],E=o.batchSize,I=o.filterHeight,N=o.filterWidth,R=o.inChannels,M=o.inHeight,T=o.inWidth,O=o.outHeight,q=o.outWidth,$=o.strideHeight,G=o.strideWidth,J=I-1-o.padInfo.top,Y=N-1-o.padInfo.left,X=o.outChannels/R,ne=0;ne<E;++ne)for(var re=0;re<R;++re)for(var ce=0;ce<M;++ce)for(var we=ce-J,be=Math.max(0,Math.ceil(we/$)),Xe=Math.min(O,(I+we)/$),Ke=0;Ke<T;++Ke){for(var et=Ke-Y,lt=Math.max(0,Math.ceil(et/G)),ot=Math.min(q,(N+et)/G),dt=0,ln=be;ln<Xe;++ln)for(var it=ln*$-we,Tt=lt;Tt<ot;++Tt)for(var Ct=h*ne+p*ln+m*Tt,sn=b*(I-1-it)+C*(N-1-(Tt*G-et))+x*re,en=0;en<X;++en)dt+=d[Ct+(re*X+en)]*v[sn+en];a[u*ne+c*ce+l*Ke+re]=dt}return i.toTensor()},n.prototype.depthwiseConv2DDerFilter=function(t,r,o){Q([t,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c=Oe(o.filterShape,"float32"),l=o.padInfo.left,d=o.padInfo.top,f=o.outChannels/o.inChannels,h=this.bufferSync(t),p=this.bufferSync(r),m=0;m<s;++m)for(var v=Math.max(0,Math.ceil((d-m)/i)),y=Math.min(o.outHeight,(o.inHeight+d-m)/i),b=0;b<u;++b)for(var C=Math.max(0,Math.ceil((l-b)/a)),x=Math.min(o.outWidth,(o.inWidth+l-b)/a),E=0;E<o.outChannels;++E){for(var I=Math.trunc(E/f),N=E%f,R=0,M=0;M<o.batchSize;++M)for(var T=v;T<y;++T)for(var L=m+T*i-d,O=C;O<x;++O)R+=h.get(M,L,b+O*a-l,I)*p.get(M,T,O,E);c.set(R,m,b,I,N)}return c.toTensor()},n.prototype.tile=function(t,r){return Q(t,"tile"),hN(this.bufferSync(t),r)},n.prototype.pad=function(t,r,o){Q(t,"pad");var i=r.map(function(f,h){return f[0]+t.shape[h]+f[1]}),a=r.map(function(f){return f[0]}),s=this.bufferSync(t),u=Oe(i,t.dtype);0!==o&&u.values.fill(o);for(var c=0;c<t.size;c++){var l=s.indexToLoc(c),d=l.map(function(f,h){return f+a[h]});u.set.apply(u,[s.get.apply(s,l)].concat(d))}return u.toTensor()},n.prototype.transpose=function(t,r){Q(t,"transpose");for(var o=new Array(t.rank),i=0;i<o.length;i++)o[i]=t.shape[r[i]];var a=this.readSync(t.dataId),s=Oe(o,t.dtype),u=this.bufferSync(t);for(i=0;i<t.size;++i){for(var c=u.indexToLoc(i),l=new Array(c.length),d=0;d<l.length;d++)l[d]=c[r[d]];var f=s.locToIndex(l);s.values[f]=a[i]}return s.toTensor()},n.prototype.gather=function(t,r,o){Q([t,r],"gather");var i=t.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=Oe(i,t.dtype),u=this.bufferSync(t),c=0;c<s.size;++c){var l=s.indexToLoc(c),d=l.slice();d[o]=a[l[o]];var f=u.locToIndex(d);s.values[c]=u.values[f]}return s.toTensor()},n.prototype.batchToSpaceND=function(t,r,o){Q([t],"batchToSpaceND");var i=r.reduce(function(d,f){return d*f}),a=qg(t.shape,r,i),s=Xg(a.length,r.length),u=Kg(t.shape,r,i),c=eN(o,r.length),l=tN(u,o,r.length);return t.reshape(a).transpose(s).reshape(u).slice(c,l)},n.prototype.spaceToBatchND=function(t,r,o){Q([t],"spaceToBatchND");var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<t.shape.length;++s)a.push([0,0]);var u=t.pad(a),c=qg(u.shape,r,i,!1),l=Xg(c.length,r.length,!1),d=Kg(u.shape,r,i,!1);return u.reshape(c).transpose(l).reshape(d)},n.prototype.pool=function(t,r,o){Q(t,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,p=this.readSync(t.dataId),m=Oe(r.outShape,t.dtype),v=m.values,y=r.outShape[1]*r.outShape[2]*r.outShape[3],b=r.outShape[2]*r.outShape[3],C=r.outShape[3],x=0;x<r.batchSize;++x)for(var E=x*y,I=x*t.strides[0],N=0;N<r.inChannels;++N)for(var R=0;R<r.outHeight;++R)for(var M=R*i-d,T=Math.max(0,M),L=Math.min(r.inHeight,c+M),O=E+R*b,q=0;q<r.outWidth;++q){for(var $=q*a-f,G=Math.max(0,$),J=Math.min(r.inWidth,l+$),Y=h,X=0,ne=0,re=T;re<L;re+=s){for(var ce=I+re*t.strides[1],we=G;we<J;we+=u){var be=p[ce+we*t.strides[2]+N];"max"===o&&be>Y?Y=be:"avg"===o&&(X+=be,ne++)}if(isNaN(Y))break}v[O+q*C+N]="avg"===o?X/ne:Y}return m.toTensor()},n.prototype.maxPool=function(t,r){return this.pool(t,r,"max")},n.prototype.maxPoolPositions=function(t,r){for(var o=Oe(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=this.bufferSync(t),p=0;p<r.batchSize;++p)for(var m=0;m<r.inChannels;++m)for(var v=0;v<r.outHeight;++v){for(var y=v*i-d,b=y;b<0;)b+=s;for(var C=Math.min(r.inHeight,c+y),x=0;x<r.outWidth;++x){for(var E=x*a-f,I=E;I<0;)I+=u;for(var N=Math.min(r.inWidth,l+E),R=Number.NEGATIVE_INFINITY,M=-1,T=b;T<C;T+=s)for(var L=T-y,O=I;O<N;O+=u){var q=O-E,$=h.get(p,T,O,m);$>R&&(R=$,M=L*l+q)}o.set(M,p,v,x,m)}}return o.toTensor()},n.prototype.maxPoolBackprop=function(t,r,o,i){Q([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,u=i.strideWidth,c=i.dilationHeight,l=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=f-1-i.padInfo.left,p=d-1-i.padInfo.top,m=Oe(r.shape,"float32"),v=this.bufferSync(a),y=this.bufferSync(t),b=0;b<i.batchSize;++b)for(var C=0;C<i.inChannels;++C)for(var x=0;x<i.inHeight;++x)for(var E=0;E<i.inWidth;++E){for(var I=x-p,N=E-h,R=0,M=0;M<d;M+=c){var T=(I+M)/s;if(!(T<0||T>=i.outHeight||Math.floor(T)!==T))for(var L=0;L<f;L+=l){var O=(N+L)/u;if(!(O<0||O>=i.outWidth||Math.floor(O)!==O)){var q=d*f-1-v.get(b,T,O,C)===M*f+L?1:0;0!==q&&(R+=y.get(b,T,O,C)*q)}}}m.set(R,b,x,E,C)}return m.toTensor()},n.prototype.avgPoolBackprop=function(t,r,o){Q([t,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c=o.dilationHeight,l=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=f-1-o.padInfo.left,p=d-1-o.padInfo.top,m=Oe(r.shape,"float32"),v=1/(s*u),y=this.bufferSync(t),b=0;b<o.batchSize;++b)for(var C=0;C<o.inChannels;++C)for(var x=0;x<o.inHeight;++x)for(var E=0;E<o.inWidth;++E){for(var I=x-p,N=E-h,R=0,M=0;M<d;M+=c){var T=(I+M)/i;if(!(T<0||T>=o.outHeight||Math.floor(T)!==T))for(var L=0;L<f;L+=l){var O=(N+L)/a;O<0||O>=o.outWidth||Math.floor(O)!==O||(R+=y.get(b,T,O,C))}}m.set(R*v,b,x,E,C)}return m.toTensor()},n.prototype.pool3d=function(t,r,o){Q(t,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,m=r.padInfo.top,v=r.padInfo.left,y="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=this.readSync(t.dataId),C=Oe(r.outShape,t.dtype),x=C.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],I=r.outShape[2]*r.outShape[3]*r.outShape[4],N=r.outShape[3]*r.outShape[4],R=r.outShape[4],M=0;M<r.batchSize;++M)for(var T=M*E,L=M*t.strides[0],O=0;O<r.inChannels;++O)for(var q=0;q<r.outDepth;++q){for(var $=q*i-p,G=$;G<0;)G+=u;for(var J=Math.min(r.inDepth,d+$),Y=T+q*I,X=0;X<r.outHeight;++X){for(var ne=X*a-m,re=ne;re<0;)re+=c;for(var ce=Math.min(r.inHeight,f+ne),we=Y+X*N,be=0;be<r.outWidth;++be){for(var Xe=be*s-v,Ke=Xe;Ke<0;)Ke+=l;for(var et=Math.min(r.inWidth,h+Xe),lt=we+be*R,ot=y,dt=0,ln=0,it=G;it<J;it+=u){for(var Tt=L+it*t.strides[1],Ct=re;Ct<ce;Ct+=c){for(var sn=Tt+Ct*t.strides[2],en=Ke;en<et;en+=l){var tn=b[sn+en*t.strides[3]+O];if("max"===o&&tn>ot?ot=tn:"avg"===o&&(dt+=tn,ln++),isNaN(ot))break}if(isNaN(ot))break}if(isNaN(ot))break}x[lt+O]="avg"===o?dt/ln:ot}}}return C.toTensor()},n.prototype.avgPool3d=function(t,r){return Q(t,"avgPool3d"),this.pool3d(t,r,"avg").toFloat()},n.prototype.avgPool3dBackprop=function(t,r,o){Q([t,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,c=o.filterHeight,l=o.filterWidth,d=o.dilationDepth,f=o.dilationHeight,h=o.dilationWidth,p=o.effectiveFilterDepth,m=o.effectiveFilterHeight,v=o.effectiveFilterWidth,y=p-1-o.padInfo.front,b=v-1-o.padInfo.left,C=m-1-o.padInfo.top,x=Oe(r.shape,"float32"),E=1/(u*c*l),I=this.bufferSync(t),N=0;N<o.batchSize;++N)for(var R=0;R<o.inChannels;++R)for(var M=0;M<o.inDepth;++M)for(var T=0;T<o.inHeight;++T)for(var L=0;L<o.inWidth;++L){for(var O=M-y,q=T-C,$=L-b,G=0,J=0;J<p;J+=d){var Y=(O+J)/i;if(!(Y<0||Y>=o.outDepth||Math.floor(Y)!==Y))for(var X=0;X<m;X+=f){var ne=(q+X)/a;if(!(ne<0||ne>=o.outHeight||Math.floor(ne)!==ne))for(var re=0;re<v;re+=h){var ce=($+re)/s;ce<0||ce>=o.outWidth||Math.floor(ce)!==ce||(G+=I.get(N,Y,ne,ce,R))}}}x.set(G*E,N,M,T,L,R)}return x.toTensor()},n.prototype.maxPool3d=function(t,r){return Q(t,"maxPool3d"),this.pool3d(t,r,"max").toFloat()},n.prototype.maxPool3dPositions=function(t,r){for(var o=Oe(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,m=r.padInfo.top,v=r.padInfo.left,y=this.bufferSync(t),b=0;b<r.batchSize;++b)for(var C=0;C<r.inChannels;++C)for(var x=0;x<r.outDepth;++x){for(var E=x*i-p,I=E;I<0;)I+=u;for(var N=Math.min(r.inDepth,d+E),R=0;R<r.outHeight;++R){for(var M=R*a-m,T=M;T<0;)T+=c;for(var L=Math.min(r.inHeight,f+M),O=0;O<r.outWidth;++O){for(var q=O*s-v,$=q;$<0;)$+=l;for(var G=Math.min(r.inWidth,h+q),J=Number.NEGATIVE_INFINITY,Y=-1,X=I;X<N;X+=u)for(var ne=X-E,re=T;re<L;re+=c)for(var ce=re-M,we=$;we<G;we+=l){var be=we-q,Xe=y.get(b,X,re,we,C);Xe>=J&&(J=Xe,Y=ne*f*h+ce*f+be)}o.set(Y,b,x,R,O,C)}}}return o.toTensor()},n.prototype.maxPool3dBackprop=function(t,r,o,i){Q([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,u=i.strideHeight,c=i.strideWidth,l=i.dilationDepth,d=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,p=i.effectiveFilterHeight,m=i.effectiveFilterWidth,v=h-1-i.padInfo.front,y=m-1-i.padInfo.left,b=p-1-i.padInfo.top,C=Oe(r.shape,"float32"),x=this.bufferSync(a),E=this.bufferSync(t),I=0;I<i.batchSize;++I)for(var N=0;N<i.inChannels;++N)for(var R=0;R<i.inDepth;++R)for(var M=0;M<i.inHeight;++M)for(var T=0;T<i.inWidth;++T){for(var L=R-v,O=M-b,q=T-y,$=0,G=0;G<h;G+=l){var J=(L+G)/s;if(!(J<0||J>=i.outDepth||Math.floor(J)!==J))for(var Y=0;Y<p;Y+=d){var X=(O+Y)/u;if(!(X<0||X>=i.outHeight||Math.floor(X)!==X))for(var ne=0;ne<m;ne+=f){var re=(q+ne)/c;if(!(re<0||re>=i.outWidth||Math.floor(re)!==re)){var ce=h*p*m-1-x.get(I,J,X,re,N)===G*p*m+Y*m+ne?1:0;0!==ce&&($+=E.get(I,J,X,re,N)*ce)}}}}C.set($,I,R,M,T,N)}return C.toTensor()},n.prototype.cast=function(t,r){return lx(t,r,this)},n.prototype.reshape=function(t,r){return nm(t,r)},n.prototype.avgPool=function(t,r){return Q(t,"avgPool"),this.pool(t,r,"avg").toFloat()},n.prototype.resizeBilinear=function(t,r,o,i){Q(t,"resizeBilinear");for(var a=t.shape,s=a[0],u=a[1],c=a[2],l=a[3],d=this.readSync(t.dataId),f=new Float32Array(ge([s,r,o,l])),h=[i&&r>1?u-1:u,i&&o>1?c-1:c],p=[i&&r>1?r-1:r,i&&o>1?o-1:o],m=0,v=h[0]/p[0],y=h[1]/p[1],b=0;b<s;b++)for(var C=0;C<r;C++)for(var x=v*C,E=Math.floor(x),I=x-E,N=Math.min(u-1,Math.ceil(x)),R=b*t.strides[0]+E*t.strides[1],M=b*t.strides[0]+N*t.strides[1],T=0;T<o;T++)for(var L=y*T,O=Math.floor(L),q=L-O,$=Math.min(c-1,Math.ceil(L)),G=R+O*t.strides[2],J=M+O*t.strides[2],Y=R+$*t.strides[2],X=M+$*t.strides[2],ne=0;ne<l;ne++){var re=d[G+ne],ce=d[J+ne],we=re+(d[Y+ne]-re)*q;f[m++]=we+(ce+(d[X+ne]-ce)*q-we)*I}return jn(f,[s,r,o,l])},n.prototype.resizeBilinearBackprop=function(t,r,o){Q([t,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],c=i[3],l=t.shape,d=l[1],f=l[2],h=new Float32Array(a*s*u*c),p=[o&&d>1?s-1:s,o&&f>1?u-1:u],m=[o&&d>1?d-1:d,o&&f>1?f-1:f],v=p[0]/m[0],y=p[1]/m[1],b=this.readSync(t.dataId),C=0,x=0;x<a;x++)for(var E=x*r.strides[0],I=0;I<d;I++)for(var N=I*v,R=Math.floor(N),M=Math.min(Math.ceil(N),s-1),T=E+R*r.strides[1],L=E+M*r.strides[1],O=N-R,q=1-O,$=0;$<f;$++)for(var G=$*y,J=Math.floor(G),Y=Math.min(Math.ceil(G),u-1),X=G-J,ne=1-X,re=T+J*r.strides[2],ce=T+Y*r.strides[2],we=L+J*r.strides[2],be=L+Y*r.strides[2],Xe=q*ne,Ke=q*X,et=O*ne,lt=O*X,ot=0;ot<c;ot++){var dt=b[C++];h[re+ot]+=dt*Xe,h[ce+ot]+=dt*Ke,h[we+ot]+=dt*et,h[be+ot]+=dt*lt}return kr(h,[a,u,s,c],r.dtype)},n.prototype.resizeNearestNeighbor=function(t,r,o,i){Q(t,"resizeNearestNeighbor");for(var a=t.shape,s=a[0],u=a[1],c=a[2],l=a[3],d=this.readSync(t.dataId),f=new Float32Array(s*r*o*l),h=[i&&r>1?u-1:u,i&&o>1?c-1:c],p=[i&&r>1?r-1:r,i&&o>1?o-1:o],m=h[0]/p[0],v=h[1]/p[1],y=0,b=0;b<s;b++)for(var C=b*t.strides[0],x=0;x<r;x++)for(var E=m*x,I=C+Math.min(u-1,i?Math.round(E):Math.floor(E))*t.strides[1],N=0;N<o;N++)for(var R=v*N,M=I+Math.min(c-1,i?Math.round(R):Math.floor(R))*t.strides[2],T=0;T<l;T++)f[y++]=d[M+T];return jn(f,[s,r,o,l],t.dtype)},n.prototype.resizeNearestNeighborBackprop=function(t,r,o){Q([t,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],c=i[3],l=t.shape,d=l[1],f=l[2],h=new Float32Array(a*s*u*c),p=this.readSync(t.dataId),m=[o&&d>1?s-1:s,o&&f>1?u-1:u],v=[o&&d>1?d-1:d,o&&f>1?f-1:f],y=m[0]/v[0],b=m[1]/v[1],C=1/y,x=1/b,E=2*Math.ceil(C)+2,I=2*Math.ceil(x)+2,N=0;N<a;N++)for(var R=N*r.strides[0],M=0;M<s;M++)for(var T=R+M*r.strides[1],L=Math.floor(M*C),O=Math.floor(L-E/2),q=0;q<u;q++)for(var $=T+q*r.strides[2],G=Math.floor(q*x),J=Math.floor(G-I/2),Y=0;Y<c;Y++){for(var X=0,ne=0;ne<E;ne++){var re=ne+O;if(!(re<0||re>=d)){var ce=R+re*t.strides[1],we=re*y;if(M===Math.min(s-1,o?Math.round(we):Math.floor(we)))for(var be=0;be<I;be++){var Xe=be+J;if(!(Xe<0||Xe>=f)){var Ke=ce+Xe*t.strides[2],et=Xe*b;q===Math.min(u-1,o?Math.round(et):Math.floor(et))&&(X+=p[Ke+Y])}}}}h[$+Y]=X}return kr(h,r.shape,r.dtype)},n.prototype.batchNormalization=function(t,r,o,i,a,s){Q([t,r,o,a,s],"batchNorm");for(var u=this.readSync(t.dataId),c=this.readSync(r.dataId),l=this.readSync(o.dataId),d=a?this.readSync(a.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),p=f.length,m=d.length,v=l.length,y=c.length,b=0,C=0,x=0,E=0,I=0;I<u.length;++I)h[I]=f[b++]+(u[I]-c[C++])*d[x++]/Math.sqrt(l[E++]+i),b>=p&&(b=0),C>=y&&(C=0),x>=m&&(x=0),E>=v&&(E=0);return kr(h,t.shape)},n.prototype.localResponseNormalization4D=function(t,r,o,i,a){Q(t,"localResponseNormalization4D");var s=t.shape[3],u=s-1,c=this.readSync(t.dataId),l=t.size,d=new Float32Array(l);function f(v){for(var y=v%s,b=v-y+Math.max(0,y-r),C=v-y+Math.min(y+r,u),x=0;b<=C;b++){var E=c[b];x+=E*E}return x}for(var h=0;h<l;h++){var p=f(h),m=c[h]*Math.pow(o+i*p,-a);d[h]=m}return kr(d,t.shape)},n.prototype.LRNGrad=function(t,r,o,i,a,s,u){Q(t,"LRNGrad");for(var c=t.shape[3],l=this.readSync(t.dataId),d=this.readSync(r.dataId),f=this.readSync(o.dataId),h=new Float32Array(t.size),p=t.size,m=0;m<p;m++){for(var v=m%c,y=m-v+Math.max(0,v-i),b=m-v+Math.min(c,v+i+1),C=0,x=y;x<b;x++)C+=Math.pow(d[x],2);for(C=s*C+a,x=y;x<b;x++){var E=-2*s*u*d[x]*f[m]/C;m===x&&(E+=Math.pow(C,-u)),h[x]+=E*=l[m]}}return kr(h,t.shape)},n.prototype.multinomial=function(t,r,o,i){Q(t,"multinomial");for(var a=r?t:ea(t),s=a.shape[0],u=a.shape[1],c=zt([s,o],"int32"),l=this.readSync(c.dataId),d=this.readSync(a.dataId),f=0;f<s;++f){var h=f*u,p=new Float32Array(u-1);p[0]=d[h];for(var m=1;m<p.length;++m)p[m]=p[m-1]+d[h+m];for(var v=Gg(i.toString()),y=f*o,b=0;b<o;++b){var C=v();l[y+b]=p.length;for(var x=0;x<p.length;x++)if(C<p[x]){l[y+b]=x;break}}}return c},n.prototype.oneHot=function(t,r,o,i){Q(t,"oneHot");var a=new Float32Array(t.size*r);a.fill(i);for(var s=this.readSync(t.dataId),u=0;u<t.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=o);return $a(a,[t.size,r],"int32")},n.prototype.nonMaxSuppression=function(t,r,o,i,a){return Q(t,"nonMaxSuppression"),hx(this.readSync(t.dataId),this.readSync(r.dataId),o,i,a)},n.prototype.fft=function(t){return this.fftBatch(t,!1)},n.prototype.ifft=function(t){return this.fftBatch(t,!0)},n.prototype.fftBatch=function(t,r){for(var o=t.shape[0],i=t.shape[1],a=Oe(t.shape,"float32"),s=Oe(t.shape,"float32"),u=Co(t).as2D(o,i),c=pi(t).as2D(o,i),l=0;l<o;l++)for(var d=u.slice([l,0],[1,i]),f=c.slice([l,0],[1,i]),h=Un(d,f),p=this.readSync(this.fftImpl(h,r).dataId),m=0;m<i;m++){var v=cN(p,m);a.values[l*i+m]=v.real,s.values[l*i+m]=v.imag}return Un(a.toTensor(),s.toTensor()).as2D(o,i)},n.prototype.fftImpl=function(t,r){var o=t.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(t.shape[0],t.shape[1]);return r&&(a=Un(Co(a).div(ae(i)),pi(a).div(ae(i)))),a}var s=this.readSync(t.dataId),u=function(c){for(var l=new Float32Array(c.length/2),d=new Float32Array(c.length/2),f=0;f<c.length;f+=2)l[f/2]=c[f],d[f/2]=c[f+1];return{real:l,imag:d}}(this.fourierTransformByMatmul(s,i,r));return Un(u.real,u.imag).as2D(t.shape[0],t.shape[1])},n.prototype.isExponentOf2=function(t){return 0==(t&t-1)},n.prototype.fftRadix2=function(t,r,o){if(1===r)return t;var i=this.readSync(t.dataId),a=r/2,s=function(y){for(var b=Math.ceil(y.length/4),C=new Float32Array(b),x=new Float32Array(b),E=0;E<y.length;E+=4)C[Math.floor(E/4)]=y[E],x[Math.floor(E/4)]=y[E+1];return{real:C,imag:x}}(i),u=Un(s.real,s.imag).as1D(),c=function(y){for(var b=Math.floor(y.length/4),C=new Float32Array(b),x=new Float32Array(b),E=2;E<y.length;E+=4)C[Math.floor(E/4)]=y[E],x[Math.floor(E/4)]=y[E+1];return{real:C,imag:x}}(i),l=Un(c.real,c.imag).as1D();u=this.fftRadix2(u,a,o),l=this.fftRadix2(l,a,o);var d=function(y,b){for(var C=new Float32Array(y/2),x=new Float32Array(y/2),E=0;E<Math.ceil(y/2);E++){var I=(b?2:-2)*Math.PI*(E/y);C[E]=Math.cos(I),x[E]=Math.sin(I)}return{real:C,imag:x}}(r,o),f=Un(d.real,d.imag).mul(l),h=u.add(f),p=u.sub(f),m=Co(h).concat(Co(p)),v=pi(h).concat(pi(p));return Un(m,v).as1D()},n.prototype.fourierTransformByMatmul=function(t,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,c=0;c<r;c++){var l=Y8(a*c,r,o),d=cN(t,c);s+=d.real*l.real-d.imag*l.imag,u+=d.real*l.imag+d.imag*l.real}o&&(s/=r,u/=r),K8(i,s,u,a)}return i},n.prototype.depthToSpace=function(t,r,o){A("NHWC"===o,function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),A(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=t.shape[0],a=t.shape[1],s=t.shape[2],u=t.shape[3],c=a*r,l=s*r,d=u/(r*r),f=this.readSync(t.dataId),h=new Float32Array(i*c*l*d),p=0,m=0;m<i;++m)for(var v=0;v<c;++v)for(var y=Math.floor(v/r),b=v%r,C=0;C<l;++C)for(var x=Math.floor(C/r),E=(b*r+C%r)*d,I=0;I<d;++I)h[p++]=f[I+E+u*(x+s*(y+a*m))];return kr(h,[i,c,l,d])},n.prototype.broadcastedBinaryOp=function(t,r,o,i){var a=Ze(t.shape,r.shape),s=Oe(a,o),u=this.readSync(t.dataId),c=this.readSync(r.dataId),l=ta(t.shape,a),d=ta(r.shape,a),f=s.values;if(l.length+d.length===0)for(var h=0;h<f.length;++h)f[h]=i(u[h%u.length],c[h%c.length]);else{var p=this.bufferSync(t),m=this.bufferSync(r),v=function(y){var b=s.indexToLoc(y),C=b.slice(-t.rank);l.forEach(function(N){return C[N]=0});var x=p.locToIndex(C),E=b.slice(-r.rank);d.forEach(function(N){return E[N]=0});var I=m.locToIndex(E);f[y]=i(u[x],c[I])};for(h=0;h<f.length;++h)v(h)}return s.toTensor()},n.prototype.broadcastedBinaryComplexOp=function(t,r,o){var i=Ze(t.shape,r.shape),a=Oe(i,"float32"),s=Oe(i,"float32"),u=this.readSync(t.dataId),c=this.readSync(r.dataId),l=ta(t.shape,i),d=ta(r.shape,i),f=a.values,h=s.values;if(l.length+d.length===0)for(var p=0;p<f.length;p++){var m=p%u.length,v=p%c.length,y=o(u[2*m],u[2*m+1],c[2*v],c[2*v+1]);f[p]=y.real,h[p]=y.imag}else{var b=this.bufferSync(this.data.get(t.dataId).complexTensors.real),C=this.bufferSync(this.data.get(r.dataId).complexTensors.real),x=function(E){var I=a.indexToLoc(E),N=I.slice(-t.rank);l.forEach(function(O){return N[O]=0});var R=b.locToIndex(N),M=I.slice(-r.rank);d.forEach(function(O){return M[O]=0});var T=C.locToIndex(M),L=o(u[2*R],u[2*R+1],c[2*T],c[2*T+1]);f[E]=L.real,h[E]=L.imag};for(p=0;p<f.length;p++)x(p)}return this.complex(a.toTensor(),s.toTensor())},n.prototype.split=function(t,r,o){return fN(t,r,o)},n.prototype.dispose=function(){},n.prototype.floatPrecision=function(){return 32},n.prototype.epsilon=function(){return 1e-7},n.prototype.cropAndResize=function(t,r,o,i,a,s){for(var u=t.shape,c=u[0],l=u[1],d=u[2],f=u[3],h=r.shape[0],p=i[0],m=i[1],v=Oe([h,p,m,f],"float32"),y=this.readSync(r.dataId),b=this.readSync(o.dataId),C=this.readSync(t.dataId),x=t.strides,E=v.strides,I=0;I<h;I++){var N=4*I,R=y[N],M=y[N+1],T=y[N+2],L=y[N+3],O=b[I];if(!(O>=c))for(var q=p>1?(T-R)*(l-1)/(p-1):0,$=m>1?(L-M)*(d-1)/(m-1):0,G=0;G<p;G++){var J=p>1?R*(l-1)+G*q:.5*(R+T)*(l-1);if(J<0||J>l-1)for(var Y=0;Y<m;Y++)for(var X=0;X<f;X++){var ne=X+Y*E[2]+G*E[1]+I*E[0];v.values[ne]=s}else if("bilinear"===a){var re=Math.floor(J),ce=Math.ceil(J),we=J-re;for(Y=0;Y<m;Y++)if((it=m>1?M*(d-1)+Y*$:.5*(M+L)*(d-1))<0||it>d-1)for(X=0;X<f;X++)v.values[ne=X+Y*E[2]+G*E[1]+I*E[0]]=s;else{var be=Math.floor(it),Xe=Math.ceil(it),Ke=it-be;for(X=0;X<f;X++){var et=C[ne=X+be*x[2]+re*x[1]+O*x[0]],lt=C[ne=X+Xe*x[2]+re*x[1]+O*x[0]],ot=C[ne=X+be*x[2]+ce*x[1]+O*x[0]],dt=et+(lt-et)*Ke,ln=ot+(C[ne=X+Xe*x[2]+ce*x[1]+O*x[0]]-ot)*Ke;v.values[ne=X+Y*E[2]+G*E[1]+I*E[0]]=dt+(ln-dt)*we}}}else for(Y=0;Y<m;++Y){var it;if((it=m>1?M*(d-1)+Y*$:.5*(M+L)*(d-1))<0||it>d-1)for(X=0;X<f;X++)v.values[ne=X+Y*E[2]+G*E[1]+I*E[0]]=s;else{var Tt=Math.round(it),Ct=Math.round(J);for(X=0;X<f;X++)v.values[X+Y*E[2]+G*E[1]+I*E[0]]=C[X+Tt*x[2]+Ct*x[1]+O*x[0]]}}}}return v.toTensor()},n.prototype.sparseToDense=function(t,r,o,i){var a=Cf(0,t,o);return this.scatter(t,r,o,a.outputSize,a.sliceSize,a.numUpdates,a.sliceRank,a.strides,i,!1)},n.prototype.gatherND=function(t,r){var o=r.shape,i=o[o.length-1],a=rx(t,r),s=a[0],u=a[1],c=a[2],l=a[3];if(0===u)return jn([],s,t.dtype);for(var d=new ff([u,c],t.dtype),f=this.readSync(r.dataId),h=this.readSync(t.dataId),p=0;p<u;p++){for(var m=[],v=0,y=0;y<i;y++){var b=f[p*i+y];v+=b*l[y],m.push(b)}if(v<0||v>=t.size/c)throw new Error("Invalid indices: "+m+" does not index into "+t.shape);for(var C=0;C<c;C++)d.values[p*c+C]=h[v*c+C]}return d.toTensor().reshape(s)},n.prototype.scatterND=function(t,r,o){var i=Cf(0,t,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,c=i.strides,l=i.outputSize,d=ae(0);return this.scatter(t,r,o,l,u,s,a,c,d,!0)},n.prototype.fill=function(t,r,o){var i=sf(o=o||Pc(r),ge(t));return i.fill(r),F.makeTensor(i,t,o,this)},n.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},n.prototype.zerosLike=function(t){var r=sf(t.dtype,ge(t.shape));return this.makeOutput(r,t.shape,t.dtype)},n.prototype.linspace=function(t,r,o){return dx(t,r,o)},n.prototype.scatter=function(t,r,o,i,a,s,u,c,l,d){var f=[i/a,a],h=this.readSync(t.dataId),p=this.readSync(r.dataId);if(0===i)return jn([],o,r.dtype);var m=new ff(f,r.dtype);m.values.fill(this.readSync(l.dataId)[0]);for(var v=0;v<s;v++){for(var y=[],b=0,C=0;C<u;C++){var x=h[v*u+C];y.push(x),b+=x*c[C]}if(b<0||b>=i/a)throw new Error("Invalid indices: "+y+" does not index into "+o);for(var E=0;E<a;E++)d?m.values[b*a+E]+=p[v*a+E]:m.values[b*a+E]=0===r.rank?p[0]:p[v*a+E]}return m.toTensor().reshape(o)},n}(uN);F.registerBackend("cpu",function(){return new JX},1);for(var Hx=0,Hk=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var n=e.inputs,r=e.attrs,i=n.boxes,a=n.scores,u=r.maxOutputSize,c=r.iouThreshold,l=r.scoreThreshold,d=r.softNmsSigma,f=e.backend;Q(i,"NonMaxSuppressionWithScore");var h=px(f.data.get(i.dataId).values,f.data.get(a.dataId).values,u,c,l,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var r=e.inputs.x,o=e.backend;Q(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Af,backendName:"cpu",kernelFunc:function(e){var n=e.inputs,o=n.a,i=n.b,a=e.backend;Q([o,i],Af);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,c=function(f,h,p,m,v,y){var b=Ze(f,h),C=b.length,x=Vo(b),E=Fc(v,ge(b)),I=f.length,N=h.length,R=Vo(f),M=Vo(h),T=ta(f,b),L=ta(h,b);if(T.length+L.length===0)for(var O=0;O<E.length;++O)E[O]=y(p[O%p.length],m[O%m.length]);else{var q=function($){var G=dR($,C,x),J=G.slice(-I);T.forEach(function(re){return J[re]=0});var Y=L0(J,I,R),X=G.slice(-N);L.forEach(function(re){return X[re]=0});var ne=L0(X,N,M);E[$]=y(p[Y],m[ne])};for(O=0;O<E.length;++O)q(O)}return[E,b]}(o.shape,i.shape,s,u,o.dtype,function(f,h){var p=f-h;return p*p}),d=c[1];return{dataId:a.write(c[0],d,o.dtype),shape:d,dtype:o.dtype}}}];Hx<Hk.length;Hx++)JT(Hk[Hx]);for(var Gc,eK=function(e){this.variableNames=["A"];var n=Zn(),t=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+t+".0);\n\n        vec4 values = "+n.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},tK=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=Zn(),t=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+t+".0);\n            vec4 values = "+n.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+n.output+" = result;\n      }\n    "},Wx=0,Wk=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.backend,o=e.inputs.pixels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],c=u[0],l=u[1],d=[l,c],f=[l,c,e.attrs.numChannels];(s||a)&&(null==Gc&&(Gc=document.createElement("canvas").getContext("2d")),Gc.canvas.width=c,Gc.canvas.height=l,Gc.drawImage(o,0,0,c,l),o=Gc.canvas);var h=t.makeTensorInfo(d,"int32");t.texData.get(h.dataId).usage=Zr.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(h.dataId),o);var p=H().getBool("WEBGL_PACK")?new tK(f):new eK(f),m=t.runWebGLProgram(p,[h],"int32");return t.disposeData(h.dataId),m}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var n=e.inputs,t=e.backend,r=e.attrs;Wg("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=n.scores,u=r.maxOutputSize,c=r.iouThreshold,l=r.scoreThreshold,d=r.softNmsSigma,f=t,h=px(f.readSync(n.boxes.dataId),f.readSync(a.dataId),u,c,l,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var r=e.inputs.x,o=e.backend,i=new je(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Af,backendName:"webgl",kernelFunc:function(e){var n=e.inputs,o=n.a,i=n.b,a=e.backend,s=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new na("return (a - b) * (a - b);",o.shape,i.shape):new an("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];Wx<Wk.length;Wx++)JT(Wk[Wx]);for(var zx=0,zk=[{kernelName:"Square",gradFunc:function(e,n){var t=n[0];return{x:function(){return e.mul(t.toFloat().mul(2))}}}},{kernelName:Af,gradFunc:function(e,n){var t=n[0],r=n[1],o=ae(2);return{a:function(){return Qn(e,Qn(o,Dn(t,r)))},b:function(){return Qn(e,Qn(o,Dn(r,t)))}}}}];zx<zk.length;zx++)o8(zk[zx]);var nK=function(){function e(){}return e.prototype.fetch=function(n,t){return fetch(n,t)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(n,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(n)},e.prototype.decode=function(n,t){return new TextDecoder(t).decode(n)},e}();H().get("IS_BROWSER")&&H().setPlatform("browser",new nK);var $x,oK=function(){function e(){this.util=Xt(753),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(n,t){return null!=H().global.fetch?H().global.fetch(n,t):(null==$x&&($x=Xt(522)),$x(n,t))},e.prototype.now=function(){var n=process.hrtime();return 1e3*n[0]+n[1]/1e6},e.prototype.encode=function(n,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(n)},e.prototype.decode=function(n,t){return 0===n.length?"":new this.util.TextDecoder(t).decode(n)},e}();H().get("IS_NODE")&&H().setPlatform("node",new oK);var Gx={float32:4,int32:4,uint16:2,uint8:1,bool:1},vm=4;function $k(e,n){for(var t={},r=0,o=function(s){var u=s.name,c=s.dtype,l=s.shape,d=ge(l),f=void 0;if("quantization"in s){var h=s.quantization;if("uint8"!==h.dtype&&"uint16"!==h.dtype)throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=Gx[h.dtype],m=e.slice(r,r+d*p),v="uint8"===h.dtype?new Uint8Array(m):new Uint16Array(m);if("float32"===c)f=Float32Array.from(v,function(I){return I*h.scale+h.min});else{if("int32"!==c)throw new Error("Unsupported dtype in weight '"+u+"': "+c);f=Int32Array.from(v,function(I){return Math.round(I*h.scale+h.min)})}r+=d*p}else if("string"===c){var y=ge(s.shape);f=[];for(var b=0;b<y;b++){var C=new Uint32Array(e.slice(r,r+vm))[0];r+=vm;var x=new Uint8Array(e.slice(r,r+C));f.push(x),r+=C}}else{var E=Gx[c];if(m=e.slice(r,r+d*E),"float32"===c)f=new Float32Array(m);else if("int32"===c)f=new Int32Array(m);else{if("bool"!==c)throw new Error("Unsupported dtype in weight '"+u+"': "+c);f=new Uint8Array(m)}r+=d*E}t[u]=jn(f,l,c)},i=0,a=n;i<a.length;i++)o(a[i]);return t}function iK(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var n=0,t=[];e.forEach(function(i){if(n+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(n),o=0;return t.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var qx=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Gk(e){return qx?Buffer.byteLength(e):new Blob([e]).size}function Xx(e){var n=0;e.forEach(function(o){n+=o.byteLength});var t=new Uint8Array(n),r=0;return e.forEach(function(o){t.set(new Uint8Array(o),r),r+=o.byteLength}),t.buffer}function qk(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var n=e.split("/");return n[n.length-1]}function Nf(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:Gk(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:Gk(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var to=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(n){e.getInstance().saveRouters.push(n)},e.registerLoadRouter=function(n){e.getInstance().loadRouters.push(n)},e.getSaveHandlers=function(n){return e.getHandlers(n,"save")},e.getLoadHandlers=function(n,t){return e.getHandlers(n,"load",t)},e.getHandlers=function(n,t,r){var o=[];return("load"===t?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(i){var a=i(n,r);null!==a&&o.push(a)}),o},e}(),qc="://",Xa=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(n,t){A(null!=n,function(){return"scheme must not be undefined or null."}),n.endsWith(qc)&&(n=n.slice(0,n.indexOf(qc))),A(n.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();A(null==r.managers[n],function(){return"A model store manager is already registered for scheme '"+n+"'."}),r.managers[n]=t},e.getManager=function(n){var t=this.getInstance().managers[n];if(null==t)throw new Error("Cannot find model manager for scheme '"+n+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function ym(e){if(-1===e.indexOf(qc))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Xa.getSchemes().join(","));return{scheme:e.split(qc)[0],path:e.split(qc)[1]}}function Xk(e,n,t){return void 0===t&&(t=!1),he(this,void 0,void 0,function(){var r,o,i,a,s,u,c,l,d;return pe(this,function(f){switch(f.label){case 0:return A(e!==n,function(){return"Old path and new path are the same: '"+e+"'"}),A((r=to.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),A(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),o=r[0],A((i=to.getSaveHandlers(n)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+n+"."}),A(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+n+"."}),a=i[0],s=ym(e).scheme,u=ym(e).path,c=s===ym(e).scheme,[4,o.load()];case 1:return l=f.sent(),t&&c?[4,Xa.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(l)];case 4:return d=f.sent(),!t||c?[3,6]:[4,Xa.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var Js="models_store",Ka="model_info_store";function Kk(){if(!H().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,n=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==n)throw new Error("The current browser does not appear to support IndexedDB.");return n}function Kx(e){var n=e.result;n.createObjectStore(Js,{keyPath:"modelPath"}),n.createObjectStore(Ka,{keyPath:"modelPath"})}var Xc=function(){function e(n){if(this.indexedDB=Kk(),null==n||!n)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=n}return e.prototype.save=function(n){return he(this,void 0,void 0,function(){return pe(this,function(t){if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,n)]})})},e.prototype.load=function(){return he(this,void 0,void 0,function(){return pe(this,function(n){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(n,t){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Kx(a)},a.onsuccess=function(){var s=a.result;if(null==t){var u=s.transaction(Js,"readonly"),c=u.objectStore(Js).get(r.modelPath);c.onsuccess=function(){if(null==c.result)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(c.result.modelArtifacts)},c.onerror=function(m){return s.close(),i(c.error)},u.oncomplete=function(){return s.close()}}else{var l,d=Nf(t),f=s.transaction(Ka,"readwrite"),h=f.objectStore(Ka),p=h.put({modelPath:r.modelPath,modelArtifactsInfo:d});p.onsuccess=function(){var m=(l=s.transaction(Js,"readwrite")).objectStore(Js).put({modelPath:r.modelPath,modelArtifacts:t,modelArtifactsInfo:d});m.onsuccess=function(){return o({modelArtifactsInfo:d})},m.onerror=function(v){var y=(h=f.objectStore(Ka)).delete(r.modelPath);y.onsuccess=function(){return s.close(),i(m.error)},y.onerror=function(b){return s.close(),i(m.error)}}},p.onerror=function(m){return s.close(),i(p.error)},f.oncomplete=function(){null==l?s.close():l.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},e.URL_SCHEME="indexeddb://",e}(),Yk=function(e){return H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Xc.URL_SCHEME)?(n=e.slice(Xc.URL_SCHEME.length),new Xc(n)):null;var n};to.registerSaveRouter(Yk),to.registerLoadRouter(Yk);var aK=function(){function e(){this.indexedDB=Kk()}return e.prototype.listModels=function(){return he(this,void 0,void 0,function(){var n=this;return pe(this,function(t){return[2,new Promise(function(r,o){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Kx(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(Ka,"readonly"),u=s.objectStore(Ka).getAll();u.onsuccess=function(){for(var c={},l=0,d=u.result;l<d.length;l++){var f=d[l];c[f.modelPath]=f.modelArtifactsInfo}r(c)},u.onerror=function(c){return a.close(),o(u.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},e.prototype.removeModel=function(n){return he(this,void 0,void 0,function(){var t=this;return pe(this,function(r){var o;return n=(o=n).startsWith(Xc.URL_SCHEME)?o.slice(Xc.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=t.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Kx(s)},s.onsuccess=function(){var u,c=s.result,l=c.transaction(Ka,"readwrite"),d=l.objectStore(Ka),f=d.get(n);f.onsuccess=function(){if(null==f.result)return c.close(),a(new Error("Cannot find model with path '"+n+"' in IndexedDB."));var h=d.delete(n),p=function(){var m=(u=c.transaction(Js,"readwrite")).objectStore(Js).delete(n);m.onsuccess=function(){return i(f.result.modelArtifactsInfo)},m.onerror=function(v){return a(f.error)}};h.onsuccess=p,h.onerror=function(m){return p(),c.close(),a(f.error)}},f.onerror=function(h){return c.close(),a(f.error)},l.oncomplete=function(){null==u?c.close():u.oncomplete=function(){return c.close()}}},s.onerror=function(u){return a(s.error)}})]})})},e}();if(H().getBool("IS_BROWSER"))try{Xa.registerManager(Xc.URL_SCHEME,new aK)}catch{}var oa="/",Kc="tensorflowjs_models",Zk="info",sK="model_topology",uK="weight_specs",cK="weight_data",lK="model_metadata";function Qk(e){return{info:[Kc,e,Zk].join(oa),topology:[Kc,e,sK].join(oa),weightSpecs:[Kc,e,uK].join(oa),weightData:[Kc,e,cK].join(oa),modelMetadata:[Kc,e,lK].join(oa)}}function dK(e){var n=e.split(oa);if(n.length<3)throw new Error("Invalid key format: "+e);return n.slice(1,n.length-1).join(oa)}var Yc=function(){function e(n){if(!H().getBool("IS_BROWSER")||typeof window>"u"||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==n||!n)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=n,this.keys=Qk(this.modelPath)}return e.prototype.save=function(n){return he(this,void 0,void 0,function(){var t,r,o;return pe(this,function(i){if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(n.modelTopology),r=JSON.stringify(n.weightSpecs),o=Nf(n);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if(qx)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",c=0,l=s.length;c<l;c++)u+=String.fromCharCode(s[c]);return btoa(u)}(n.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,userDefinedMetadata:n.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return he(this,void 0,void 0,function(){var n,t,r,o,i,a,s;return pe(this,function(u){if(null==(n=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==n.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(r=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=r,null==(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=o,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(a=JSON.parse(i),t.format=a.format,t.generatedBy=a.generatedBy,t.convertedBy=a.convertedBy,t.userDefinedMetadata=a.userDefinedMetadata),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(c){if(qx){var l=Buffer.from(c,"base64");return l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength)}for(var d=atob(c),f=new Uint8Array(d.length),h=0;h<d.length;++h)f.set([d.charCodeAt(h)],h);return f.buffer}(s),[2,t]})})},e.URL_SCHEME="localstorage://",e}(),Jk=function(e){return H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Yc.URL_SCHEME)?(n=e.slice(Yc.URL_SCHEME.length),new Yc(n)):null;var n};to.registerSaveRouter(Jk),to.registerLoadRouter(Jk);var fK=function(){function e(){A(H().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),A(typeof window>"u"||void 0!==window.localStorage,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return he(this,void 0,void 0,function(){var n,t,r,o,i,a;return pe(this,function(s){for(n={},t=Kc+oa,r=oa+Zk,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(t)&&i.endsWith(r)&&(a=dK(i),n[a]=JSON.parse(this.LS.getItem(i)));return[2,n]})})},e.prototype.removeModel=function(n){return he(this,void 0,void 0,function(){var t,r;return pe(this,function(o){var i;if(n=(i=n).startsWith(Yc.URL_SCHEME)?i.slice(Yc.URL_SCHEME.length):i,t=Qk(n),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+n+"'");return r=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,r]})})},e}();if(H().getBool("IS_BROWSER"))try{Xa.registerManager(Yc.URL_SCHEME,new fK)}catch{}function eF(e){return new Promise(function(n){return setTimeout(n)}).then(e)}var Yx=function(){function e(n){if(!H().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");n.startsWith(e.URL_SCHEME)&&(n=n.slice(e.URL_SCHEME.length)),null!=n&&0!==n.length||(n="model"),this.modelTopologyFileName=n+".json",this.weightDataFileName=n+".weights.bin"}return e.prototype.save=function(n){return he(this,void 0,void 0,function(){var t,i,a,s;return pe(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([n.weightData],{type:"application/octet-stream"})),!(n.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return i=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:n.weightSpecs}]})],{type:"application/json"})),(a=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,eF(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),null==n.weightData?[3,4]:((s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=t,[4,eF(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Nf(n)}]}})})},e.URL_SCHEME="downloads://",e}(),mK=function(){function e(n){if(null==n||n.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+n);this.files=n}return e.prototype.load=function(){return he(this,void 0,void 0,function(){var n,t,r=this;return pe(this,function(o){return n=this.files[0],t=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(u){var c=JSON.parse(u.target.result),l=c.modelTopology;if(null!=l){0===t.length&&i({modelTopology:l});var d=c.weightsManifest;if(null!=d){var f;try{f=r.checkManifestAndWeightFiles(d,t)}catch(v){return void a(v)}var h=[],p=[],m=[];d.forEach(function(v){v.paths.forEach(function(y){p.push(y),m.push(null)}),h.push.apply(h,v.weights)}),d.forEach(function(v){v.paths.forEach(function(y){var b=new FileReader;b.onload=function(C){var x=C.target.result,E=p.indexOf(y);m[E]=x,-1===m.indexOf(null)&&i({modelTopology:l,weightSpecs:h,weightData:Xx(m),format:c.format,generatedBy:c.generatedBy,convertedBy:c.convertedBy,userDefinedMetadata:c.userDefinedMetadata})},b.onerror=function(C){return a("Failed to weights data from file of path '"+y+"'.")},b.readAsArrayBuffer(f[y])})})}else a(new Error("weightManifest field is missing from file "+n.name))}else a(new Error("modelTopology field is missing from file "+n.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+n.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(n)})]})})},e.prototype.checkManifestAndWeightFiles=function(n,t){for(var r=[],o=t.map(function(u){return qk(u.name)}),i={},a=0,s=n;a<s.length;a++)s[a].paths.forEach(function(u){var c=qk(u);if(-1!==r.indexOf(c))throw new Error("Duplicate file basename found in weights manifest: '"+c+"'");if(r.push(c),-1===o.indexOf(c))throw new Error("Weight file with basename '"+c+"' is not provided.");i[u]=t[o.indexOf(c)]});if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+t.length+").");return i},e}();function tF(e,n,t,r){var i;A(null!=(i=e)&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"}),function(i,a){A(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),A(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),A(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(t=t??0,r=r??1);var o=0;return Promise.all(e.map(function(i){return i.then(function(a){var s=t+ ++o/e.length*(r-t);return n(s),a}),i}))}function nF(e,n){return he(this,void 0,void 0,function(){var t,r,o,i,a,s,u,c,l;return pe(this,function(d){switch(d.label){case 0:return null==n&&(n={}),t=null==n.fetchFunc?H().platform.fetch:n.fetchFunc,r=e.map(function(f){return t(f,n.requestInit,{isBinary:!0})}),o=0,i=.5,null!=n.onProgress?[3,2]:[4,Promise.all(r)];case 1:return a=d.sent(),[3,4];case 2:return[4,tF(r,n.onProgress,o,i)];case 3:a=d.sent(),d.label=4;case 4:return s=a.map(function(f){return f.arrayBuffer()}),u=.5,c=1,null!=n.onProgress?[3,6]:[4,Promise.all(s)];case 5:return l=d.sent(),[3,8];case 6:return[4,tF(s,n.onProgress,u,c)];case 7:l=d.sent(),d.label=8;case 8:return[2,l]}})})}function rF(e){var n=this;return function(t,r,o){return void 0===r&&(r=""),he(n,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,p;return pe(this,function(m){switch(m.label){case 0:if(i=t.map(function(){return!1}),a={},s=null!=o?o.map(function(){return!1}):[],u=[],t.forEach(function(v,y){var b=0;v.weights.forEach(function(C){var E=Gx["quantization"in C?C.quantization.dtype:C.dtype]*ge(C.shape),I=function(){i[y]=!0,null==a[y]&&(a[y]=[]),a[y].push({manifestEntry:C,groupOffset:b,sizeBytes:E})};null!=o?o.forEach(function(N,R){N===C.name&&(I(),s[R]=!0)}):I(),u.push(C.name),b+=E})}),!s.every(function(v){return v}))throw c=o.filter(function(v,y){return!s[y]}),new Error("Could not find weights in manifest with names: "+c.join(", ")+". \nManifest JSON has weights with names: "+u.join(", ")+".");return l=i.reduce(function(v,y,b){return y&&v.push(b),v},[]),d=[],l.forEach(function(v){t[v].paths.forEach(function(y){var b=r+(r.endsWith("/")?"":"/")+y;d.push(b)})}),[4,e(d)];case 1:return f=m.sent(),h={},p=0,l.forEach(function(v){for(var y=t[v].paths.length,b=0,C=0;C<y;C++)b+=f[p+C].byteLength;for(var x=new ArrayBuffer(b),E=new Uint8Array(x),I=0,N=0;N<y;N++){var R=new Uint8Array(f[p+N]);E.set(R,I),I+=R.byteLength}a[v].forEach(function(M){var T=$k(x.slice(M.groupOffset,M.groupOffset+M.sizeBytes),[M.manifestEntry]);for(var L in T)h[L]=T[L]}),p+=y}),[2,h]}})})}}to.registerSaveRouter(function(e){return H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Yx.URL_SCHEME)?(void 0===(n=e.slice(Yx.URL_SCHEME.length))&&(n="model"),new Yx(n)):null;var n});var oF=function(){function e(n,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,null!=t.fetchFunc?(A("function"==typeof t.fetchFunc,function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=t.fetchFunc):this.fetch=H().platform.fetch,A(null!=n&&n.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(n)&&A(2===n.length,function(){return"URL paths for http must have a length of 2, (actual length is "+n.length+")."}),this.path=n,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return e.prototype.save=function(n){return he(this,void 0,void 0,function(){var t,i;return pe(this,function(a){switch(a.label){case 0:if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,t.body.append("model.json",new Blob([JSON.stringify({modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,userDefinedMetadata:n.userDefinedMetadata,weightsManifest:[{paths:["./model.weights.bin"],weights:n.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=n.weightData&&t.body.append("model.weights.bin",new Blob([n.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:Nf(n),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return he(this,void 0,void 0,function(){var n,t,r,o,i,a,s,u,c,l,d,f;return pe(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(n=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+n.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,n.json()];case 3:return t=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=t.weightsManifest,a=t.generatedBy,s=t.convertedBy,u=t.format,c=t.userDefinedMetadata,null==(o=t.modelTopology)&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:f=h.sent(),l=f[0],d=f[1],h.label=7;case 7:return[2,{modelTopology:o,weightSpecs:l,weightData:d,userDefinedMetadata:c,generatedBy:a,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(n){return he(this,void 0,void 0,function(){var r,o,i,a,s,u,c,d,f;return pe(this,function(h){switch(h.label){case 0:for(void 0,void 0,m=(p=Array.isArray(this.path)?this.path[1]:this.path).lastIndexOf("/"),v=p.lastIndexOf("?"),r=[p.substring(0,m)+"/",v>m?p.substring(v):""],o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],u=0,c=n;u<c.length;u++)s.push.apply(s,c[u].weights);return d=[],n.forEach(function(p){p.paths.forEach(function(m){d.push(a+m+i)})}),[4,nF(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[s,Xx(f)]]}var p,m,v})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Zx(e){return null!=e.match(oF.URL_SCHEME_REGEX)}var iF=function(e,n){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(t){return Zx(t)}):Zx(e))?Qx(e,{onProgress:n}):null};function Qx(e,n){return new oF(e,n)}to.registerSaveRouter(iF),to.registerLoadRouter(iF);var Zc,Jx=function(){function e(n){this.modelArtifacts=n}return e.prototype.load=function(){return he(this,void 0,void 0,function(){return pe(this,function(n){return[2,this.modelArtifacts]})})},e}(),vK=function(){function e(n){this.saveHandler=n}return e.prototype.save=function(n){return he(this,void 0,void 0,function(){return pe(this,function(t){return[2,this.saveHandler(n)]})})},e}(),aF=Object.freeze({browserFiles:function(e){return new mK(e)},browserHTTPRequest:function(e,n){return Qx(e,n)},concatenateArrayBuffers:Xx,decodeWeights:$k,encodeWeights:function(e,n){return he(this,void 0,void 0,function(){var t,r,o,i,a,s=this;return pe(this,function(u){switch(u.label){case 0:for(t=[],r=[],o=Array.isArray(e)?e.map(function(c){return c.name}):Object.keys(e),i=function(c){var l=o[c],d=Array.isArray(e)?e[c].tensor:e[l];if("float32"!==d.dtype&&"int32"!==d.dtype&&"bool"!==d.dtype&&"string"!==d.dtype)throw new Error("Unsupported dtype in weight '"+l+"': "+d.dtype);var f={name:l,shape:d.shape,dtype:d.dtype};if("string"===d.dtype){var h=new Promise(function(p){return he(s,void 0,void 0,function(){var m,v,y,b,C,x,E;return pe(this,function(I){switch(I.label){case 0:return[4,d.bytes()];case 1:for(m=I.sent(),v=m.reduce(function(N,R){return N+R.length},0)+vm*m.length,y=new Uint8Array(v),b=0,C=0;C<m.length;C++)x=m[C],E=new Uint8Array(new Uint32Array([x.length]).buffer),y.set(E,b),y.set(x,b+=vm),b+=x.length;return p(y),[2]}})})});r.push(h)}else r.push(d.data());null!=n&&(f.group=n),t.push(f)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:iK(u.sent()),specs:t}]}})})},fromMemory:function(e,n,t,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new Jx(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jx({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jx({modelTopology:e,weightSpecs:n,weightData:t,trainingConfig:r}))},getLoadHandlers:function(e,n){return to.getLoadHandlers(e,n)},getModelArtifactsInfoForJSON:Nf,getSaveHandlers:function(e){return to.getSaveHandlers(e)},http:Qx,isHTTPScheme:Zx,loadWeights:function(e,n,t,r){return void 0===n&&(n=""),he(this,void 0,void 0,function(){return pe(this,function(o){return[2,rF(function(i){return nF(i,{requestInit:r})})(e,n,t)]})})},registerLoadRouter:function(e){return to.registerLoadRouter(e)},registerSaveRouter:function(e){return to.registerSaveRouter(e)},weightsLoaderFactory:rF,withSaveHandler:function(e){return new vK(e)},copyModel:function(e,n){return he(this,void 0,void 0,function(){return pe(this,function(t){return[2,Xk(e,n,!1)]})})},listModels:function(){return he(this,void 0,void 0,function(){var e,n,t,r,o,i,a;return pe(this,function(s){switch(s.label){case 0:e=Xa.getSchemes(),n={},t=0,r=e,s.label=1;case 1:return t<r.length?[4,Xa.getManager(o=r[t]).listModels()]:[3,4];case 2:for(a in i=s.sent())n[o+qc+a]=i[a];s.label=3;case 3:return t++,[3,1];case 4:return[2,n]}})})},moveModel:function(e,n){return he(this,void 0,void 0,function(){return pe(this,function(t){return[2,Xk(e,n,!0)]})})},removeModel:function(e){return he(this,void 0,void 0,function(){var n;return pe(this,function(t){return n=ym(e),[2,Xa.getManager(n.scheme).removeModel(n.path)]})})}}),yK=P({confusionMatrix_:function(e,n,t){var r=S(e,"labels","confusionMatrix"),o=S(n,"predictions","confusionMatrix");A(null==t||t>0&&Number.isInteger(t),function(){return"If provided, numClasses must be a positive integer, but got "+t}),A(1===r.rank,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),A(1===o.rank,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),A(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),A(t>0&&Number.isInteger(t),function(){return"numClasses is required to be a positive integer, but got "+t});var i=nx(r.asType("int32"),t),a=nx(o.asType("int32"),t);return i.transpose().matMul(a).asType("int32")}}),wK=(Object.freeze({confusionMatrix:yK}),P({fromPixels_:function(e,n){if(void 0===n&&(n=3),n>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var t=!1,r=!1,o=!1,i=!1,a=!1;if(e.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(o&&o&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=ZT("FromPixels",F.backendName))return F.runKernel("FromPixels",{pixels:e},{numChannels:n});var s,u,c=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],l=c[0],d=c[1];if(a?s=e.getContext("2d").getImageData(0,0,l,d).data:r||t?s=e.data:(i||o)&&(null==Zc&&(Zc=document.createElement("canvas").getContext("2d")),Zc.canvas.width=l,Zc.canvas.height=d,Zc.drawImage(e,0,0,l,d),s=Zc.getImageData(0,0,l,d).data),4===n)u=new Int32Array(s);else{var f=l*d;u=new Int32Array(f*n);for(var h=0;h<f;h++)for(var p=0;p<n;++p)u[h*n+p]=s[4*h+p]}return J0(u,[d,l,n],"int32")}})),eC=Object.freeze({toPixels:function(e,n){return he(this,void 0,void 0,function(){var t,r,o,i,a,s,u,c,l,h,p,m,v,y,b,C,x,E,I,N,R;return pe(this,function(M){switch(M.label){case 0:if(t=S(e,"img","toPixels"),e instanceof kt||(t=t.toInt()),2!==t.rank&&3!==t.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+t.rank+".");if(r=t.shape.slice(0,2),o=r[0],i=r[1],(a=2===t.rank?1:t.shape[2])>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,t.data()];case 1:return s=M.sent(),u=t.min(),c=t.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(l=M.sent(),h=l[0][0],p=l[1][0],u.dispose(),c.dispose(),"float32"===t.dtype){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if("int32"!==t.dtype)throw new Error("Unsupported type for toPixels: "+t.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(m="float32"===t.dtype?255:1,v=new Uint8ClampedArray(i*o*4),y=0;y<o*i;++y)b=void 0,C=void 0,x=void 0,E=void 0,1===a?(b=s[y]*m,C=s[y]*m,x=s[y]*m,E=255):3===a?(b=s[3*y]*m,C=s[3*y+1]*m,x=s[3*y+2]*m,E=255):4===a&&(b=s[4*y]*m,C=s[4*y+1]*m,x=s[4*y+2]*m,E=s[4*y+3]*m),v[0+(I=4*y)]=Math.round(b),v[I+1]=Math.round(C),v[I+2]=Math.round(x),v[I+3]=Math.round(E);return null!=n&&(n.width=i,n.height=o,N=n.getContext("2d"),R=new ImageData(v,i,o),N.putImageData(R,0,0)),t!==e&&t.dispose(),[2,v]}})})},fromPixels:wK}),sF=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(n,t){return new n(t)},e}(),uF=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(n){e.getMap().classNameMap[n.className]=[n,n.fromConfig]},e}();function Ya(e){A(null!=e.className,function(){return"Class being registered does not have the static className property defined."}),A("string"==typeof e.className,function(){return"className is required to be a string, but got type "+typeof e.className}),A(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),uF.register(e)}function tC(){return 32===F.backend.floatPrecision()?.001:.1}function nC(e,n,t){var r=!0;if((Bn(e)||Bn(n))&&(r=!1),Bn(e)&&Bn(n)&&(r=!0),r){var o=e.constructor.name,i=n.constructor.name;if(o!==i)throw new Error("Arrays are of different type. Actual: "+o+". Expected: "+i)}if(Array.isArray(e)&&Array.isArray(n)){var a=hi(e),s=hi(n);if(!hn(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=Bn(e)?e:Zi(e),c=Bn(n)?n:Zi(n);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var d=u[l],f=c[l];if(!t(d,f))throw new Error("Arrays differ: actual["+l+"] = "+d+", expected["+l+"] = "+f+".\nActual:   "+u+".\nExpected: "+c+".")}}function rC(e,n,t){return!isFinite(e)&&!isFinite(n)||!(isNaN(e)||isNaN(n)||Math.abs(e-n)>t)}Object.freeze({Serializable:sF,SerializationMap:uF,registerClass:Ya}),Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(e,n,t){return null==t&&(t=tC()),nC(e,n,function(r,o){return rC(r,o,t)})},testEpsilon:tC,expectPromiseToFail:function(e,n){e().then(function(){return n.fail()},function(){return n()})},expectArraysEqual:function(e,n){var t="string"==typeof n||"number"==typeof n||"boolean"==typeof n?[n]:n;return Ha(e)||Ha(e[0])||Ha(n)||Ha(n[0])?nC(e,t,function(r,o){return r==o}):nC(e,n,function(r,o){return rC(r,o,0)})},expectNumbersClose:function(e,n,t){if(null==t&&(t=tC()),!rC(e,n,t))throw new Error("Numbers differ: actual === "+e+", expected === "+n)},expectValuesInRange:function(e,n,t){for(var r=0;r<e.length;r++)if(e[r]<n||e[r]>t)throw new Error("Value out of range:"+e[r]+" low: "+n+", high: "+t)},expectArrayBuffersEqual:function(e,n){expect(new Float32Array(e)).toEqual(new Float32Array(n))}}),Object.freeze({gpgpu_util:Wq,webgl_util:h8,forceHalfFloat:function(){H().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:ak,setWebGLContext:wR,GPGPUContext:WN});var eu=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Bo(n,e),n.prototype.minimize=function(t,r,o){void 0===r&&(r=!1);var i=this.computeGradients(t,o),a=i.value,s=i.grads;if(null!=o){var u=o.map(function(c){return{name:c.name,tensor:s[c.name]}});this.applyGradients(u)}else this.applyGradients(s);return Rr(s),r?a:(a.dispose(),null)},Object.defineProperty(n.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),n.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},n.prototype.computeGradients=function(t,r){return function q8(e,n){A(Wa(e),function(){return"The f passed in variableGrads(f) must be a function"}),A(null==n||Array.isArray(n)&&n.every(function(l){return l instanceof Lc}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var t=null!=n;if(!t)for(var r in n=[],F.registeredVariables)n.push(F.registeredVariables[r]);var o=t?n.filter(function(l){return!l.trainable}):null,i=n.length;A((n=n.filter(function(l){return l.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=F.gradients(e,n,null,!0),s=a.value,u=a.grads;A(u.some(function(l){return null!=l}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),A(0===s.rank,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var c={};return n.forEach(function(l,d){null!=u[d]&&(c[l.name]=u[d])}),o?.forEach(function(l){return c[l.name]=null}),{value:s,grads:c}}(t,r)},n.prototype.dispose=function(){null!=this.iterations_&&Rr(this.iterations_)},n.prototype.saveIterations=function(){return he(this,void 0,void 0,function(){return pe(this,function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:ae(this.iterations_,"int32")}]})})},n.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return pe(this,function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},n.prototype.setWeights=function(t){return he(this,void 0,void 0,function(){return pe(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},n.prototype.extractIterations=function(t){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return r=this,[4,t[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,t.slice(1)]}})})},n}(sF);Object.defineProperty(eu,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var lF=function(e){function n(t,r,o){void 0===o&&(o=null);var i=e.call(this)||this;return i.learningRate=t,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==o&&(i.epsilon=F.backend.epsilon()),i}return Bo(n,e),n.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(o){return o.name}):Object.keys(t)).forEach(function(o,i){var a=F.registeredVariables[o];null==r.accumulatedGrads[i]&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:le(function(){return ct(a).variable(!1)})}),null==r.accumulatedUpdates[i]&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:le(function(){return ct(a).variable(!1)})});var s=Array.isArray(t)?t[i].tensor:t[o];if(null!=s){var u=r.accumulatedGrads[i].variable,c=r.accumulatedUpdates[i].variable;le(function(){var l=u.mul(r.rho).add(s.square().mul(1-r.rho)),d=c.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),f=c.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(l),c.assign(f);var h=d.mul(-r.learningRate).add(a);a.assign(h)})}}),this.incrementIterations()},n.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Rr(this.accumulatedGrads.map(function(t){return t.variable})),Rr(this.accumulatedUpdates.map(function(t){return t.variable})))},n.prototype.getWeights=function(){return he(this,void 0,void 0,function(){var t;return pe(this,function(r){switch(r.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},n.prototype.setWeights=function(t){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(t)];case 1:return t=o.sent(),this.accumulatedGrads=t.slice(0,r=t.length/2).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=t.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},n.fromConfig=function(t,r){return new t(r.learningRate,r.rho,r.epsilon)},n.className="Adadelta",n}(eu);Ya(lF);var dF=function(e){function n(t,r){void 0===r&&(r=.1);var o=e.call(this)||this;return o.learningRate=t,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return Bo(n,e),n.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(o){return o.name}):Object.keys(t)).forEach(function(o,i){var a=F.registeredVariables[o];null==r.accumulatedGrads[i]&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:le(function(){return gi(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(t)?t[i].tensor:t[o];if(null!=s){var u=r.accumulatedGrads[i].variable;le(function(){var c=u.add(s.square());u.assign(c);var l=s.div(c.add(F.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(l)})}}),this.incrementIterations()},n.prototype.dispose=function(){null!=this.accumulatedGrads&&Rr(this.accumulatedGrads.map(function(t){return t.variable}))},n.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return pe(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},n.prototype.setWeights=function(t){return he(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulatedGrads=t.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},n.fromConfig=function(t,r){return new t(r.learningRate,r.initialAccumulatorValue)},n.className="Adagrad",n}(eu);Ya(dF);var fF=function(e){function n(t,r,o,i){void 0===i&&(i=null);var a=e.call(this)||this;return a.learningRate=t,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],le(function(){a.accBeta1=ae(r).variable(),a.accBeta2=ae(o).variable()}),null==i&&(a.epsilon=F.backend.epsilon()),a}return Bo(n,e),n.prototype.applyGradients=function(t){var r=this,o=Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t);le(function(){var i=Dn(1,r.accBeta1),a=Dn(1,r.accBeta2);o.forEach(function(s,u){var c=F.registeredVariables[s];null==r.accumulatedFirstMoment[u]&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:le(function(){return ct(c).variable(!1)})}),null==r.accumulatedSecondMoment[u]&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:le(function(){return ct(c).variable(!1)})});var l=Array.isArray(t)?t[u].tensor:t[s];if(null!=l){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,h=d.mul(r.beta1).add(l.mul(1-r.beta1)),p=f.mul(r.beta2).add(l.square().mul(1-r.beta2)),m=h.div(i),v=p.div(a);d.assign(h),f.assign(p);var y=m.div(v.sqrt().add(r.epsilon)).mul(-r.learningRate).add(c);c.assign(y)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},n.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Rr(this.accumulatedFirstMoment.map(function(t){return t.variable})),null!=this.accumulatedSecondMoment&&Rr(this.accumulatedSecondMoment.map(function(t){return t.variable}))},n.prototype.getWeights=function(){return he(this,void 0,void 0,function(){var t;return pe(this,function(r){switch(r.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},n.prototype.setWeights=function(t){return he(this,void 0,void 0,function(){var r,o=this;return pe(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),le(function(){o.accBeta1.assign(dm(o.beta1,o.iterations_+1)),o.accBeta2.assign(dm(o.beta2,o.iterations_+1))}),this.accumulatedFirstMoment=t.slice(0,r=t.length/2).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=t.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},n.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon)},n.className="Adam",n}(eu);Ya(fF);var hF=function(e){function n(t,r,o,i,a){void 0===i&&(i=null),void 0===a&&(a=0);var s=e.call(this)||this;return s.learningRate=t,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],le(function(){s.iteration=ae(0).variable(),s.accBeta1=ae(r).variable()}),null==i&&(s.epsilon=F.backend.epsilon()),s}return Bo(n,e),n.prototype.applyGradients=function(t){var r=this,o=Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t);le(function(){var i=Dn(1,r.accBeta1),a=$o(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var c=F.registeredVariables[s];null==r.accumulatedFirstMoment[u]&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:ct(c).variable(!1)}),null==r.accumulatedWeightedInfNorm[u]&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:ct(c).variable(!1)});var l=Array.isArray(t)?t[u].tensor:t[s];if(null!=l){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,h=d.mul(r.beta1).add(l.mul(1-r.beta1)),p=f.mul(r.beta2),m=l.abs(),v=p.maximum(m);d.assign(h),f.assign(v);var y=a.div(i).mul(h.div(v.add(r.epsilon))).add(c);c.assign(y)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},n.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Rr(this.accumulatedFirstMoment.map(function(t){return t.variable})),null!=this.accumulatedWeightedInfNorm&&Rr(this.accumulatedWeightedInfNorm.map(function(t){return t.variable}))},n.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return pe(this,function(t){throw new Error("getWeights() is not implemented for Adamax yet.")})})},n.prototype.setWeights=function(t){return he(this,void 0,void 0,function(){return pe(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},n.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},n.className="Adamax",n}(eu);Ya(hF);var oC=function(e){function n(t){var r=e.call(this)||this;return r.learningRate=t,r.setLearningRate(t),r}return Bo(n,e),n.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(o){return o.name}):Object.keys(t)).forEach(function(o,i){var a=Array.isArray(t)?t[i].tensor:t[o];if(null!=a){var s=F.registeredVariables[o];le(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},n.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=function p8(e){return F.keep(e)}(ae(-t))},n.prototype.dispose=function(){this.c.dispose()},n.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return pe(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}})})},n.prototype.setWeights=function(t){return he(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=r.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate}},n.fromConfig=function(t,r){return new t(r.learningRate)},n.className="SGD",n}(eu);Ya(oC);var pF=function(e){function n(t,r,o){void 0===o&&(o=!1);var i=e.call(this,t)||this;return i.learningRate=t,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=ae(i.momentum),i}return Bo(n,e),n.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(o){return o.name}):Object.keys(t)).forEach(function(o,i){var a=F.registeredVariables[o];null==r.accumulations[i]&&(r.accumulations[i]={originalName:o+"/momentum",variable:le(function(){return ct(a).variable(!1)})});var s=r.accumulations[i].variable,u=Array.isArray(t)?t[i].tensor:t[o];null!=u&&le(function(){var c,l=r.m.mul(s).add(u);c=r.useNesterov?r.c.mul(u.add(l.mul(r.m))).add(a):r.c.mul(l).add(a),s.assign(l),a.assign(c)})}),this.incrementIterations()},n.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Rr(this.accumulations.map(function(t){return t.variable}))},n.prototype.setMomentum=function(t){this.momentum=t},n.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return pe(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},n.prototype.setWeights=function(t){return he(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulations=t.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},n.fromConfig=function(t,r){return new t(r.learningRate,r.momentum,r.useNesterov)},n.className="Momentum",n}(oC);Ya(pF);var gF=function(e){function n(t,r,o,i,a){void 0===r&&(r=.9),void 0===o&&(o=0),void 0===i&&(i=null),void 0===a&&(a=!1);var s=e.call(this)||this;if(s.learningRate=t,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,null==i&&(s.epsilon=F.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return Bo(n,e),n.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(o){return o.name}):Object.keys(t)).forEach(function(o,i){var a=F.registeredVariables[o];null==r.accumulatedMeanSquares[i]&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:le(function(){return ct(a).variable(!1)})}),null==r.accumulatedMoments[i]&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:le(function(){return ct(a).variable(!1)})}),null==r.accumulatedMeanGrads[i]&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:le(function(){return ct(a).variable(!1)})});var s=Array.isArray(t)?t[i].tensor:t[o];if(null!=s){var u=r.accumulatedMeanSquares[i].variable,c=r.accumulatedMoments[i].variable;le(function(){var l=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[i].variable,f=d.mul(r.decay).add(s.mul(1-r.decay)),h=c.mul(r.momentum).add(s.mul(r.learningRate).div(l.sub(f.square().add(r.epsilon)).sqrt()));u.assign(l),d.assign(f),c.assign(h);var p=a.sub(h);a.assign(p)}else{var m=u.mul(r.decay).add(s.square().mul(1-r.decay));h=c.mul(r.momentum).add(s.mul(r.learningRate).div(m.add(r.epsilon).sqrt())),u.assign(m),c.assign(h),p=a.sub(h),a.assign(p)}})}}),this.incrementIterations()},n.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Rr(this.accumulatedMeanSquares.map(function(t){return t.variable})),null!=this.accumulatedMeanGrads&&this.centered&&Rr(this.accumulatedMeanGrads.map(function(t){return t.variable})),null!=this.accumulatedMoments&&Rr(this.accumulatedMoments.map(function(t){return t.variable}))},n.prototype.getWeights=function(){return he(this,void 0,void 0,function(){var t;return pe(this,function(r){switch(r.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},n.prototype.setWeights=function(t){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(t)];case 1:return t=o.sent(),this.accumulatedMeanSquares=t.slice(0,r=this.centered?t.length/3:t.length/2).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=t.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=t.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},n.fromConfig=function(t,r){return new t(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},n.className="RMSProp",n}(eu);Ya(gF),function(){function e(){}e.sgd=function(n){return new oC(n)},e.momentum=function(n,t,r){return void 0===r&&(r=!1),new pF(n,t,r)},e.rmsprop=function(n,t,r,o,i){return void 0===t&&(t=.9),void 0===r&&(r=0),void 0===o&&(o=null),void 0===i&&(i=!1),new gF(n,t,r,o,i)},e.adam=function(n,t,r,o){return void 0===n&&(n=.001),void 0===t&&(t=.9),void 0===r&&(r=.999),void 0===o&&(o=null),new fF(n,t,r,o)},e.adadelta=function(n,t,r){return void 0===n&&(n=.001),void 0===t&&(t=.95),void 0===r&&(r=null),new lF(n,t,r)},e.adamax=function(n,t,r,o,i){return void 0===n&&(n=.002),void 0===t&&(t=.9),void 0===r&&(r=.999),void 0===o&&(o=null),void 0===i&&(i=0),new hF(n,t,r,o,i)},e.adagrad=function(n,t){return void 0===t&&(t=.1),new dF(n,t)}}(),typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"&&setImmediate,kt.prototype.squaredDifference=function(e){return sk(this,e)},V=QX;var iC=function(e,n){return(iC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])})(e,n)};function ke(e,n){function t(){this.constructor=e}iC(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}var er=function(){return er=Object.assign||function(n){for(var t,r=1,o=arguments.length;r<o;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},er.apply(this,arguments)};function me(e,n,t,r){return new(t||(t=Promise))(function(i,a){function s(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):function o(i){return i instanceof t?i:new t(function(a){a(i)})}(l.value).then(s,u)}c((r=r.apply(e,n||[])).next())})}function ve(e,n){var r,o,i,a,t={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return function u(c){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(i=2&c[0]?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,o=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(!(i=(i=t.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){t=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){t.label=c[1];break}if(6===c[0]&&t.label<i[1]){t.label=i[1],i=c;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(c);break}i[2]&&t.ops.pop(),t.trys.pop();continue}c=n.call(e,t)}catch(l){c=[6,l],o=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}function kf(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;var r=Array(e),o=0;for(n=0;n<t;n++)for(var i=arguments[n],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var Qc=function(){function e(n,t){if(!nu(n)||!nu(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:n,height:t}));this._width=n,this._height=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function Ff(e,n){return e instanceof kt&&e.shape.length===n}function bm(e){return Ff(e,3)}function Za(e){return Ff(e,4)}function vF(e){return e%2==0}function yF(e){return e&&e.width&&e.height}function aC(e){return e.reduce(function(n,t){return n.add(t)},new xt(0,0)).div(new xt(e.length,e.length))}function Pf(e,n,t){return Array(e).fill(0).map(function(r,o){return n+o*t})}function nu(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||0===e}function wF(e){return nu(e)&&0<=e&&e<=1}var xt=function(){function e(n,t){this._x=n,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(n){return new e(this.x+n.x,this.y+n.y)},e.prototype.sub=function(n){return new e(this.x-n.x,this.y-n.y)},e.prototype.mul=function(n){return new e(this.x*n.x,this.y*n.y)},e.prototype.div=function(n){return new e(this.x/n.x,this.y/n.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),ia=function(){function e(n,t){void 0===t&&(t=!0);var r=n||{},o=[r.left,r.top,r.right,r.bottom].every(nu),i=[r.x,r.y,r.width,r.height].every(nu);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],c=a[2],l=a[3];e.assertIsValidBox({x:s,y:u,width:c,height:l},"Box.constructor",t),this._x=s,this._y=u,this._width=c,this._height=l}return e.isRect=function(n){return!!n&&[n.x,n.y,n.width,n.height].every(nu)},e.assertIsValidBox=function(n,t,r){if(void 0===r&&(r=!1),!e.isRect(n))throw new Error(t+" - invalid box: "+JSON.stringify(n)+", expected object with properties x, y, width, height");if(!r&&(n.width<0||n.height<0))throw new Error(t+" - width ("+n.width+") and height ("+n.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new xt(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new xt(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new xt(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new xt(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var n=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)});return new e({x:n[0],y:n[1],width:n[2],height:n[3]})},e.prototype.floor=function(){var n=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)});return new e({x:n[0],y:n[1],width:n[2],height:n[3]})},e.prototype.toSquare=function(){var n=this,t=n.x,r=n.y,o=n.width,i=n.height,a=Math.abs(o-i);return o<i&&(t-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new e({x:t,y:r,width:o,height:i})},e.prototype.rescale=function(n){var t=yF(n)?n.width:n,r=yF(n)?n.height:n;return new e({x:this.x*t,y:this.y*r,width:this.width*t,height:this.height*r})},e.prototype.pad=function(n,t){var r=[this.x-n/2,this.y-t/2,this.width+n,this.height+t];return new e({x:r[0],y:r[1],width:r[2],height:r[3]})},e.prototype.clipAtImageBorders=function(n,t){var r=this,i=r.y,a=r.right,s=r.bottom,u=Math.max(r.x,0),c=Math.max(i,0),d=s-c;return new e({x:u,y:c,width:Math.min(a-u,n-u),height:Math.min(d,t-c)}).floor()},e.prototype.shift=function(n,t){return new e({x:this.x+n,y:this.y+t,width:this.width,height:this.height})},e.prototype.padAtBorders=function(n,t){var r=this.width+1,o=this.height+1,s=r,u=o,c=this.left,l=this.top,d=this.right,f=this.bottom;return d>t&&(s=-d+t+r,d=t),f>n&&(u=-f+n+o,f=n),c<1&&(u=2-c,c=1),l<1&&(u=2-l,l=1),{dy:1,edy:u,dx:1,edx:s,y:l,ey:f,x:c,ex:d,w:r,h:o}},e.prototype.calibrate=function(n){return new e({left:this.left+n.left*this.width,top:this.top+n.top*this.height,right:this.right+n.right*this.width,bottom:this.bottom+n.bottom*this.height}).toSquare().round()},e}(),xm=function(e){function n(t,r,o,i,a){return void 0===a&&(a=!1),e.call(this,{left:t,top:r,right:o,bottom:i},a)||this}return ke(n,e),n}(ia),bF=function(){function e(n,t,r,o,i){this._imageDims=new Qc(i.width,i.height),this._score=n,this._classScore=t,this._className=r,this._box=new ia(o).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new ia(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(n,t){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:n,height:t})},e}(),vi=function(e){function n(t,r,o){return e.call(this,t,t,"",r,o)||this}return ke(n,e),n.prototype.forSize=function(t,r){var o=e.prototype.forSize.call(this,t,r);return new n(o.score,o.relativeBox,o.imageDims)},n}(bF);function AK(e,n,t){void 0===t&&(t=!0);var i=Math.max(0,Math.min(e.right,n.right)-Math.max(e.left,n.left))*Math.max(0,Math.min(e.bottom,n.bottom)-Math.max(e.top,n.top));return t?i/(e.area+n.area-i):i/Math.min(e.area,n.area)}function Of(e,n,t,r){void 0===r&&(r=!0);for(var o=n.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var u=o,c=[],l=0;l<u.length;l++)c.push(AK(e[s],e[u[l]],r));o=o.filter(function(p,m){return c[m]<=t})};o.length>0;)a();return i}function Lf(e,n){return le(function(){var t=n[0],r=n[1],o=n[2],i=gi(kf(e.shape.slice(0,3),[1]),t),a=gi(kf(e.shape.slice(0,3),[1]),r),s=gi(kf(e.shape.slice(0,3),[1]),o),u=Cn([i,a,s],3);return Dn(e,u)})}function sC(e){return 1/(1+Math.exp(-e))}var En,uC=function(e){function n(t,r,o,i,a){return void 0===a&&(a=!1),e.call(this,{x:t,y:r,width:o,height:i},a)||this}return ke(n,e),n}(ia),Cm=function(){function e(n,t,r){void 0===r&&(r=new xt(0,0));var o=t.width,i=t.height;this._imgDims=new Qc(o,i),this._shift=r,this._positions=n.map(function(a){return a.mul(new xt(o,i)).add(r)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new xt(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var n=this;return this._positions.map(function(t){return t.sub(n._shift).div(new xt(n.imageWidth,n.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(n,t){return new this.constructor(this.relativePositions,{width:n,height:t})},e.prototype.shiftBy=function(n,t){return new this.constructor(this.relativePositions,this._imgDims,new xt(n,t))},e.prototype.shiftByPoint=function(n){return this.shiftBy(n.x,n.y)},e.prototype.align=function(n,t){if(void 0===t&&(t={}),n){var r=n instanceof vi?n.box.floor():new ia(n);return this.shiftBy(r.x,r.y).align(null,t)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),a=o.minBoxPadding;return o.useDlibAlignment?this.alignDlib():this.alignMinBbox(a)},e.prototype.alignDlib=function(){var n=this.getRefPointsForAlignment(),r=n[1],o=n[2],i=function(d){return o.sub(d).magnitude()},a=(i(n[0])+i(r))/2,s=Math.floor(a/.45),u=aC(n),c=Math.floor(Math.max(0,u.x-.5*s)),l=Math.floor(Math.max(0,u.y-.43*s));return new uC(c,l,Math.min(s,this.imageWidth+c),Math.min(s,this.imageHeight+l))},e.prototype.alignMinBbox=function(n){var t=function SK(e){var n=e.map(function(s){return s.x}),t=e.map(function(s){return s.y}),r=n.reduce(function(s,u){return u<s?u:s},1/0),o=t.reduce(function(s,u){return u<s?u:s},1/0),i=n.reduce(function(s,u){return s<u?u:s},0),a=t.reduce(function(s,u){return s<u?u:s},0);return new xm(r,o,i,a)}(this.positions);return t.pad(t.width*n,t.height*n)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),kK=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.getRefPointsForAlignment=function(){var t=this.positions;return[t[0],t[1],aC([t[3],t[4]])]},n}(Cm),xF=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.getJawOutline=function(){return this.positions.slice(0,17)},n.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},n.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},n.prototype.getNose=function(){return this.positions.slice(27,36)},n.prototype.getLeftEye=function(){return this.positions.slice(36,42)},n.prototype.getRightEye=function(){return this.positions.slice(42,48)},n.prototype.getMouth=function(){return this.positions.slice(48,68)},n.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(aC)},n}(Cm),CF=function(){function e(n,t){this._label=n,this._distance=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(n){return void 0===n&&(n=!0),this.label+(n?" ("+function EK(e,n){void 0===n&&(n=2);var t=Math.pow(10,n);return Math.floor(e*t)/t}(this.distance)+")":"")},e}(),_F=function(e){function n(t,r){var o=e.call(this,t)||this;return o._label=r,o}return ke(n,e),n.assertIsValidLabeledBox=function(t,r){if(ia.assertIsValidBox(t,r),!nu(t.label))throw new Error(r+" - expected property label ("+t.label+") to be a number")},Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),n}(ia),Bf=function(){function e(n,t){if("string"!=typeof n)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=n,this._descriptors=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(n){return Array.from(n)})}},e.fromJSON=function(n){var t=n.descriptors.map(function(r){return new Float32Array(r)});return new e(n.label,t)},e}();function cC(e,n){return Object.assign({},e,{detection:n})}function DF(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}function EF(e){var n="";if(!e)try{e=Xt(186)}catch(r){n=r.toString()}return{readFile:e?function(r){return new Promise(function(o,i){e.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+n)}}}function IF(){var e=global.Canvas||global.HTMLCanvasElement,n=global.Image||global.HTMLImageElement,o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=EF();return er({Canvas:e||function a(){},CanvasRenderingContext2D:global.CanvasRenderingContext2D||function a(){},Image:n||function a(){},ImageData:global.ImageData||function a(){},Video:global.HTMLVideoElement||function a(){},createCanvasElement:function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(n)return new n;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:o},i)}function SF(){return"object"==typeof window&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function AF(){return"object"==typeof global&&typeof process<"u"&&!!process.version}function lC(e){En=e}function dC(){SF()&&lC(DF()),AF()&&lC(IF())}!function(e){function n(t,r,o,i){var a=e.call(this,t,r)||this;return a._score=o,a._classScore=i,a}ke(n,e),n.assertIsValidPredictedBox=function(t,r){if(_F.assertIsValidLabeledBox(t,r),!wF(t.score)||!wF(t.classScore))throw new Error(r+" - expected properties score ("+t.score+") and ("+t.classScore+") to be a number between [0, 1]")},Object.defineProperty(n.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0})}(_F);var tr={getEnv:function PK(){if(!En)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return En},setEnv:lC,initialize:dC,createBrowserEnv:DF,createFileSystem:EF,createNodejsEnv:IF,monkeyPatch:function OK(e){if(En||dC(),!En)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var n=e.Canvas,t=void 0===n?En.Canvas:n,r=e.Image,o=void 0===r?En.Image:r;En.Canvas=t,En.Image=o,En.createCanvasElement=e.createCanvasElement||function(){return new t},En.createImageElement=e.createImageElement||function(){return new o},En.ImageData=e.ImageData||En.ImageData,En.Video=e.Video||En.Video,En.fetch=e.fetch||En.fetch,En.readFile=e.readFile||En.readFile},isBrowser:SF,isNodejs:AF};function fC(e){return tr.isNodejs()||"string"!=typeof e?e:document.getElementById(e)}function yi(e){var n=tr.getEnv(),t=n.Canvas;if(e instanceof n.CanvasRenderingContext2D)return e;var o=fC(e);if(!(o instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}dC();var ru=function(e){return e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e}(ru||{}),MF=function e(n){void 0===n&&(n={});var r=n.backgroundColor,o=n.fontColor,i=n.fontSize,a=n.fontStyle,s=n.padding;this.anchorPosition=n.anchorPosition||ru.TOP_LEFT,this.backgroundColor=r||"rgba(0, 0, 0, 0.5)",this.fontColor=o||"rgba(255, 255, 255, 1)",this.fontSize=i||14,this.fontStyle=a||"Georgia",this.padding=s||4};!function(){function e(n,t,r){void 0===r&&(r={}),this.text="string"==typeof n?[n]:n instanceof e?n.text:n,this.anchor=t,this.options=new MF(r)}e.prototype.measureWidth=function(n){var t=this.options.padding;return this.text.map(function(r){return n.measureText(r).width}).reduce(function(r,o){return r<o?o:r},0)+2*t},e.prototype.measureHeight=function(){var n=this.options;return this.text.length*n.fontSize+2*n.padding},e.prototype.getUpperLeft=function(n,t){var r=this.options.anchorPosition,o=r===ru.BOTTOM_RIGHT||r===ru.TOP_RIGHT,i=r===ru.BOTTOM_LEFT||r===ru.BOTTOM_RIGHT,a=this.measureWidth(n),s=this.measureHeight(),u=o?this.anchor.x-a:this.anchor.x,c=i?this.anchor.y-s:this.anchor.y;if(t){var d=t.height;return{x:Math.max(Math.min(u,t.width-a),0),y:Math.max(Math.min(c,d-s),0)}}return{x:u,y:c}},e.prototype.draw=function(n){var t=fC(n),r=yi(t),o=this.options,i=o.backgroundColor,a=o.fontColor,s=o.fontSize,c=o.padding;r.font=s+"px "+o.fontStyle;var l=this.measureWidth(r),d=this.measureHeight();r.fillStyle=i;var f=this.getUpperLeft(r,t);r.fillRect(f.x,f.y,l,d),r.fillStyle=a,this.text.forEach(function(h,p){r.fillText(h,c+f.x,c+f.y+(p+1)*s)})}}();function TF(e){var n=tr.getEnv();return e instanceof n.Image&&e.complete||e instanceof n.Video&&e.readyState>=3}function RF(e){var n=tr.getEnv(),r=n.Video;return e instanceof n.Image?new Qc(e.naturalWidth,e.naturalHeight):e instanceof r?new Qc(e.videoWidth,e.videoHeight):new Qc(e.width,e.height)}function _m(e){var n=e.width,t=e.height,o=(0,tr.getEnv().createCanvasElement)();return o.width=n,o.height=t,o}function hC(e,n){var t=tr.getEnv().ImageData;if(!(e instanceof t||TF(e)))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=n||RF(e),o=r.width,i=r.height,a=_m({width:o,height:i});return e instanceof t?yi(a).putImageData(e,0,0):yi(a).drawImage(e,0,0,o,i),a}function UK(e,n){return me(this,void 0,void 0,function(){var t,r,o,i,a,s;return ve(this,function(u){switch(u.label){case 0:return t=n||tr.getEnv().createCanvasElement(),r=e.shape.slice(Za(e)?1:0),o=r[0],i=r[1],a=r[2],s=le(function(){return e.as3D(o,i,a).toInt()}),[4,eC.toPixels(s,t)];case 1:return u.sent(),s.dispose(),[2,t]}})})}function NF(e){var n=tr.getEnv();return e instanceof n.Image||e instanceof n.Canvas||e instanceof n.Video}var Dm=function(){function e(n,t){var r=this;if(void 0===t&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(n))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+n);this._treatAsBatchInput=t,this._batchSize=n.length,n.forEach(function(o,i){if(bm(o))return r._imageTensors[i]=o,void(r._inputDimensions[i]=o.shape);if(Za(o)){var a=o.shape[0];if(1!==a)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");return r._imageTensors[i]=o,void(r._inputDimensions[i]=o.shape.slice(1))}var s=o instanceof tr.getEnv().Canvas?o:hC(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var n=this;return Pf(this.batchSize,0,1).map(function(t,r){return n.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(n){return this.canvases[n]||this.imageTensors[n]},e.prototype.getInputDimensions=function(n){return this._inputDimensions[n]},e.prototype.getInputHeight=function(n){return this._inputDimensions[n][0]},e.prototype.getInputWidth=function(n){return this._inputDimensions[n][1]},e.prototype.getReshapedInputDimensions=function(n){if("number"!=typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return function IK(e,n){var t=e.width,r=e.height,o=n/Math.max(r,t);return new Qc(Math.round(t*o),Math.round(r*o))}({width:this.getInputWidth(n),height:this.getInputHeight(n)},this.inputSize)},e.prototype.toBatchTensor=function(n,t){var r=this;return void 0===t&&(t=!0),this._inputSize=n,le(function(){var o=Pf(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof kt){var u=Za(s)?s:s.expandDims();return u=function MK(e,n){return void 0===n&&(n=!1),le(function(){var t=e.shape.slice(1),r=t[0],o=t[1];if(r===o)return e;var i=Math.abs(r-o),a=Math.round(i*(n?.5:1)),s=r>o?2:1,u=function(h){var p=e.shape.slice();return p[s]=h,gi(p,0)},c=u(a),l=i-c.shape[s],f=[n&&l?u(l):null,e,c].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return Cn(f,s)})}(u,t),(u.shape[1]!==n||u.shape[2]!==n)&&(u=Ox.resizeBilinear(u,[n,n])),u.as3D(n,n,3)}if(s instanceof tr.getEnv().Canvas)return eC.fromPixels(function jK(e,n,t){void 0===t&&(t=!1);var r=tr.getEnv(),i=r.Canvas;if(!(e instanceof r.Image||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=RF(e),s=n/Math.max(a.height,a.width),u=s*a.width,c=s*a.height,l=_m({width:n,height:n}),d=e instanceof i?e:hC(e),f=Math.abs(u-c)/2,h=t&&u<c?f:0,p=t&&c<u?f:0;return yi(l).drawImage(d,h,p,u,c),l}(s,n,t));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)});return eo(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,n,n,3)})},e}();function Tn(e){return me(this,void 0,void 0,function(){var n,t,r;return ve(this,function(o){switch(o.label){case 0:if(e instanceof Dm)return[2,e];if(!(n=Array.isArray(e)?e:[e]).length)throw new Error("toNetInput - empty array passed as input");return t=function(i){return Array.isArray(e)?" at input index "+i+":":""},(r=n.map(fC)).forEach(function(i,a){if(!NF(i)&&!bm(i)&&!Za(i))throw"string"==typeof n[a]?new Error("toNetInput -"+t(a)+" string passed, but could not resolve HTMLElement for element id "+n[a]):new Error("toNetInput -"+t(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Za(i)){var s=i.shape[0];if(1!==s)throw new Error("toNetInput -"+t(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return NF(i)&&function VK(e){return new Promise(function(n,t){if(e instanceof tr.getEnv().Canvas||TF(e))return n();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}function o(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),t(i))}e.addEventListener("load",r),e.addEventListener("error",o)})}(i)}))];case 1:return o.sent(),[2,new Dm(r,Array.isArray(e))]}})})}function pC(e,n){return me(this,void 0,void 0,function(){var t,r,o,i,a,s;return ve(this,function(c){switch(c.label){case 0:return t=tr.getEnv().Canvas,r=e,e instanceof t?[3,5]:[4,Tn(e)];case 1:if((o=c.sent()).batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return(i=o.getInput(0))instanceof t?(a=i,[3,4]):[3,2];case 2:return[4,UK(i)];case 3:a=c.sent(),c.label=4;case 4:r=a,c.label=5;case 5:return s=yi(r),[2,n.map(function(l){return l instanceof vi?l.forSize(r.width,r.height).box.floor():l}).map(function(l){return l.clipAtImageBorders(r.width,r.height)}).map(function(l){var d=l.x,f=l.y,h=l.width,p=l.height,m=_m({width:h,height:p});return yi(m).putImageData(s.getImageData(d,f,h,p),0,0),m})]}})})}function gC(e,n){return me(this,void 0,void 0,function(){return ve(this,function(t){if(!bm(e)&&!Za(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Za(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,le(function(){var r=e.shape.slice(Za(e)?1:0),o=r[0],i=r[1],a=r[2];return n.map(function(c){return c instanceof vi?c.forSize(i,o).box:c}).map(function(c){return c.clipAtImageBorders(i,o)}).map(function(c){var l=c.x,d=c.y,f=c.width,h=c.height;return Tk(e.as3D(o,i,a),[d,l,0],[h,f,a])})})]})})}function HK(e,n){return me(this,void 0,void 0,function(){var r;return ve(this,function(o){switch(o.label){case 0:return[4,(0,tr.getEnv().fetch)(e,n)];case 1:if(!((r=o.sent()).status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function WK(e){return me(this,void 0,void 0,function(){return ve(this,function(n){switch(n.label){case 0:return[4,HK(e)];case 1:return[2,n.sent().json()]}})})}function kF(e,n){var t=n+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:t};if("/"===e)return{modelBaseUri:"/",manifestUri:"/"+t};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"",o=(e=e.replace(r,"")).split("/").filter(function(s){return s}),i=e.endsWith(".json")?o[o.length-1]:t,a=r+(e.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return{modelBaseUri:a=e.startsWith("/")?"/"+a:a,manifestUri:"/"===a?"/"+i:a+"/"+i}}function zK(e,n){return me(this,void 0,void 0,function(){var t,o,i;return ve(this,function(a){switch(a.label){case 0:return t=kF(e,n),o=t.modelBaseUri,[4,WK(t.manifestUri)];case 1:return i=a.sent(),[2,aF.loadWeights(i,o)]}})})}var aa=function(){function e(n){this._name=n,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(n){var t=this.traversePropertyPath(n);return t.obj[t.objProp]},e.prototype.reassignParamFromPath=function(n,t){var r=this.traversePropertyPath(n),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=t},e.prototype.getParamList=function(){var n=this;return this._paramMappings.map(function(t){var r=t.paramPath;return{path:r,tensor:n.getParamFromPath(r)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(n){return n.tensor instanceof Lc})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(n){return!(n.tensor instanceof Lc)})},e.prototype.variable=function(){var n=this;this.getFrozenParams().forEach(function(t){n.reassignParamFromPath(t.path,t.tensor.variable())})},e.prototype.freeze=function(){var n=this;this.getTrainableParams().forEach(function(t){var r=t.path,o=t.tensor,i=jn(o.dataSync());o.dispose(),n.reassignParamFromPath(r,i)})},e.prototype.dispose=function(n){void 0===n&&(n=!0),this.getParamList().forEach(function(t){if(n&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(n){return Array.from(n.tensor.dataSync())}).reduce(function(n,t){return n.concat(t)}))},e.prototype.load=function(n){return me(this,void 0,void 0,function(){return ve(this,function(t){switch(t.label){case 0:return n instanceof Float32Array?(this.extractWeights(n),[2]):[4,this.loadFromUri(n)];case 1:return t.sent(),[2]}})})},e.prototype.loadFromUri=function(n){return me(this,void 0,void 0,function(){var t;return ve(this,function(r){switch(r.label){case 0:if(n&&"string"!=typeof n)throw new Error(this._name+".loadFromUri - expected model uri");return[4,zK(n,this.getDefaultModelName())];case 1:return t=r.sent(),this.loadFromWeightMap(t),[2]}})})},e.prototype.loadFromDisk=function(n){return me(this,void 0,void 0,function(){var t,r,o,i,s,u,c,l,d;return ve(this,function(f){switch(f.label){case 0:if(n&&"string"!=typeof n)throw new Error(this._name+".loadFromDisk - expected model file path");return t=tr.getEnv().readFile,r=kF(n,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,s=aF.weightsLoaderFactory(function(h){return Promise.all(h.map(function(p){return t(p).then(function(m){return m.buffer})}))}),l=(c=JSON).parse,[4,t(o)];case 1:return u=l.apply(c,[f.sent().toString()]),[4,s(u,i)];case 2:return d=f.sent(),this.loadFromWeightMap(d),[2]}})})},e.prototype.loadFromWeightMap=function(n){var t=this.extractParamsFromWeigthMap(n),o=t.params;this._paramMappings=t.paramMappings,this._params=o},e.prototype.extractWeights=function(n){var t=this.extractParams(n),o=t.params;this._paramMappings=t.paramMappings,this._params=o},e.prototype.traversePropertyPath=function(n){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=n.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+n);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=t.obj,o=t.objProp;if(!(r&&o&&r[o]instanceof kt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+n);return{obj:r,objProp:o}},e}();function no(e,n,t){return le(function(){var r=Rx(e,n.depthwise_filter,n.pointwise_filter,t,"same");return Qe(r,n.bias)})}function mC(e,n,t){return void 0===t&&(t=!1),le(function(){var r=Jt(t?Qe(Do(e,n.conv0.filters,[2,2],"same"),n.conv0.bias):no(e,n.conv0,[2,2])),o=no(r,n.conv1,[1,1]),a=no(Jt(Qe(r,o)),n.conv2,[1,1]);return Jt(Qe(r,Qe(o,a)))})}function Em(e,n,t,r){return void 0===t&&(t=!1),void 0===r&&(r=!0),le(function(){var o=Jt(t?Qe(Do(e,n.conv0.filters,r?[2,2]:[1,1],"same"),n.conv0.bias):no(e,n.conv0,r?[2,2]:[1,1])),i=no(o,n.conv1,[1,1]),s=no(Jt(Qe(o,i)),n.conv2,[1,1]),c=no(Jt(Qe(o,Qe(i,s))),n.conv3,[1,1]);return Jt(Qe(o,Qe(i,Qe(s,c))))})}function Go(e,n,t,r){return void 0===t&&(t="same"),void 0===r&&(r=!1),le(function(){var o=Qe(Do(e,n.filters,[1,1],t),n.bias);return r?Jt(o):o})}function sa(e,n){Object.keys(e).forEach(function(t){n.some(function(r){return r.originalPath===t})||e[t].dispose()})}function Im(e,n){return function(t,r,o,i){var a=kr(e(t*r*o*o),[o,o,t,r]),s=gn(e(r));return n.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function vC(e,n){return function(t,r,o){var i=$a(e(t*r),[t,r]),a=gn(e(r));return n.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var FF=function e(n,t,r){this.depthwise_filter=n,this.pointwise_filter=t,this.bias=r};function yC(e,n){return function(t,r,o){var i=kr(e(9*t),[3,3,t,1]),a=kr(e(t*r),[1,1,t,r]),s=gn(e(r));return n.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new FF(i,a,s)}}function wC(e){return function(n){var t=e(n+"/depthwise_filter",4),r=e(n+"/pointwise_filter",4),o=e(n+"/bias",1);return new FF(t,r,o)}}function Qa(e,n){return function(t,r,o){var i=e[t];if(!Ff(i,r))throw new Error("expected weightMap["+t+"] to be a Tensor"+r+"D, instead have "+i);return n.push({originalPath:t,paramPath:o||t}),i}}function ua(e){var n=e;return{extractWeights:function t(o){var i=n.slice(0,o);return n=n.slice(o),i},getRemainingWeights:function r(){return n}}}function PF(e,n){var t=Im(e,n),r=yC(e,n);function o(a,s,u,c){return void 0===c&&(c=!1),{conv0:c?t(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),conv1:r(s,s,u+"/conv1"),conv2:r(s,s,u+"/conv2")}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:function i(a,s,u,c){void 0===c&&(c=!1);var l=o(a,s,u,c);return{conv0:l.conv0,conv1:l.conv1,conv2:l.conv2,conv3:r(s,s,u+"/conv3")}}}}function OF(e){return function(n){return{filters:e(n+"/filters",4),bias:e(n+"/bias",1)}}}function LF(e,n){var t=Qa(e,n),r=OF(t),o=wC(t);return{extractDenseBlock3Params:function i(s,u){return void 0===u&&(u=!1),{conv0:u?r(s+"/conv0"):o(s+"/conv0"),conv1:o(s+"/conv1"),conv2:o(s+"/conv2")}},extractDenseBlock4Params:function a(s,u){return void 0===u&&(u=!1),{conv0:u?r(s+"/conv0"):o(s+"/conv0"),conv1:o(s+"/conv1"),conv2:o(s+"/conv2"),conv3:o(s+"/conv3")}}}}var BF=function(e){function n(){return e.call(this,"FaceFeatureExtractor")||this}return ke(n,e),n.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return le(function(){var s=Em(Lf(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(ae(255)),r.dense0,!0);return s=Em(s,r.dense1),s=Em(s,r.dense2),s=Em(s,r.dense3),Rf(s,[7,7],[2,2],"valid")})},n.prototype.forward=function(t){return me(this,void 0,void 0,function(){var r;return ve(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Tn(t)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},n.prototype.extractParamsFromWeigthMap=function(t){return function GK(e){var n=[],t=LF(e,n).extractDenseBlock4Params,r={dense0:t("dense0",!0),dense1:t("dense1"),dense2:t("dense2"),dense3:t("dense3")};return sa(e,n),{params:r,paramMappings:n}}(t)},n.prototype.extractParams=function(t){return function $K(e){var n=[],t=ua(e),o=t.getRemainingWeights,i=PF(t.extractWeights,n).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),c=i(128,256,"dense3");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{dense0:a,dense1:s,dense2:u,dense3:c}}}(t)},n}(aa);function wi(e,n){return le(function(){return Qe(hm(e,n.weights),n.bias)})}function VF(e){var n={},t={};return Object.keys(e).forEach(function(r){(r.startsWith("fc")?t:n)[r]=e[r]}),{featureExtractorMap:n,classifierMap:t}}var UF=function(e){function n(t,r){var o=e.call(this,t)||this;return o._faceFeatureExtractor=r,o}return ke(n,e),Object.defineProperty(n.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),n.prototype.runNet=function(t){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return le(function(){var i=t instanceof Dm?r.faceFeatureExtractor.forwardInput(t):t;return wi(i.as2D(i.shape[0],-1),o.fc)})},n.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},n.prototype.loadClassifierParams=function(t){var r=this.extractClassifierParams(t),i=r.paramMappings;this._params=r.params,this._paramMappings=i},n.prototype.extractClassifierParams=function(t){return function qK(e,n,t){var r=[],o=ua(e),a=o.getRemainingWeights,u=vC(o.extractWeights,r)(n,t,"fc");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}(t,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},n.prototype.extractParamsFromWeigthMap=function(t){var r=VF(t),i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(r.featureExtractorMap),function XK(e){var n=[],t=Qa(e,n),o={fc:function r(i){return{weights:t(i+"/weights",2),bias:t(i+"/bias",1)}}("fc")};return sa(e,n),{params:o,paramMappings:n}}(i)},n.prototype.extractParams=function(t){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=t.slice(0,t.length-i),s=t.slice(t.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},n}(aa),jF=["neutral","happy","sad","angry","fearful","disgusted","surprised"],KK=function(){function e(n){var t=this;if(7!==n.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+n.length);jF.forEach(function(r,o){t[r]=n[o]})}return e.prototype.asSortedArray=function(){var n=this;return jF.map(function(t){return{expression:t,probability:n[t]}}).sort(function(t,r){return r.probability-t.probability})},e}(),YK=function(e){function n(t){return void 0===t&&(t=new BF),e.call(this,"FaceExpressionNet",t)||this}return ke(n,e),n.prototype.forwardInput=function(t){var r=this;return le(function(){return ea(r.runNet(t))})},n.prototype.forward=function(t){return me(this,void 0,void 0,function(){var r;return ve(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Tn(t)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.predictExpressions=function(t){return me(this,void 0,void 0,function(){var r,o,i,a,s=this;return ve(this,function(u){switch(u.label){case 0:return[4,Tn(t)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(_n(o).map(function(c){return me(s,void 0,void 0,function(){var l;return ve(this,function(d){switch(d.label){case 0:return[4,c.data()];case 1:return l=d.sent(),c.dispose(),[2,l]}})})}))];case 3:return i=u.sent(),o.dispose(),a=i.map(function(c){return new KK(c)}),[2,r.isBatchInput?a:a[0]]}})})},n.prototype.getDefaultModelName=function(){return"face_expression_model"},n.prototype.getClassifierChannelsIn=function(){return 256},n.prototype.getClassifierChannelsOut=function(){return 7},n}(UF);function HF(e,n){return Object.assign({},e,{expressions:n})}function bC(e,n){var t=e.detection.box,r=n.shiftBy(t.x,t.y),o=r.align(),i=e.detection.imageDims,a=new vi(e.detection.score,o.rescale(i.reverse()),i);return Object.assign({},e,{landmarks:r,unshiftedLandmarks:n,alignedRect:a})}function WF(e,n,t){return Qe(Do(e,n.filters,t,"same"),n.bias)}function xC(e,n,t){void 0===t&&(t=!0);var r=t?Jt(e):e;return r=no(r,n.separable_conv0,[1,1]),r=no(Jt(r),n.separable_conv1,[1,1]),r=Mn(r,[3,3],[2,2],"same"),Qe(r,WF(e,n.expansion_conv,[2,2]))}var iY=function(e){function n(t){var r=e.call(this,"TinyXception")||this;return r._numMainBlocks=t,r}return ke(n,e),n.prototype.forwardInput=function(t){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return le(function(){var s=Lf(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(ae(256)),u=Jt(WF(s,o.entry_flow.conv_in,[2,2]));return u=xC(u,o.entry_flow.reduction_block_0,!1),u=xC(u,o.entry_flow.reduction_block_1),Pf(r._numMainBlocks,0,1).forEach(function(c){u=function oY(e,n){var t=no(Jt(e),n.separable_conv0,[1,1]);return t=no(Jt(t),n.separable_conv1,[1,1]),t=no(Jt(t),n.separable_conv2,[1,1]),Qe(t,e)}(u,o.middle_flow["main_block_"+c])}),u=xC(u,o.exit_flow.reduction_block),u=Jt(no(u,o.exit_flow.separable_conv,[1,1]))})},n.prototype.forward=function(t){return me(this,void 0,void 0,function(){var r;return ve(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Tn(t)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.getDefaultModelName=function(){return"tiny_xception_model"},n.prototype.extractParamsFromWeigthMap=function(t){return function rY(e,n){var t=[],r=function nY(e,n){var t=Qa(e,n),r=OF(t),o=wC(t);return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:function i(s){return{separable_conv0:o(s+"/separable_conv0"),separable_conv1:o(s+"/separable_conv1"),expansion_conv:r(s+"/expansion_conv")}},extractMainBlockParams:function a(s){return{separable_conv0:o(s+"/separable_conv0"),separable_conv1:o(s+"/separable_conv1"),separable_conv2:o(s+"/separable_conv2")}}}}(e,t),i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,d={conv_in:(0,r.extractConvParams)("entry_flow/conv_in"),reduction_block_0:a("entry_flow/reduction_block_0"),reduction_block_1:a("entry_flow/reduction_block_1")},f={};Pf(n,0,1).forEach(function(v){f["main_block_"+v]=s("middle_flow/main_block_"+v)});var m={reduction_block:a("exit_flow/reduction_block"),separable_conv:i("exit_flow/separable_conv")};return sa(e,t),{params:{entry_flow:d,middle_flow:f,exit_flow:m},paramMappings:t}}(t,this._numMainBlocks)},n.prototype.extractParams=function(t){return function tY(e,n){var t=[],r=ua(e),i=r.getRemainingWeights,a=function eY(e,n){var t=Im(e,n),r=yC(e,n);return{extractConvParams:t,extractSeparableConvParams:r,extractReductionBlockParams:function o(a,s,u){return{separable_conv0:r(a,s,u+"/separable_conv0"),separable_conv1:r(s,s,u+"/separable_conv1"),expansion_conv:t(a,s,1,u+"/expansion_conv")}},extractMainBlockParams:function i(a,s){return{separable_conv0:r(a,a,s+"/separable_conv0"),separable_conv1:r(a,a,s+"/separable_conv1"),separable_conv2:r(a,a,s+"/separable_conv2")}}}}(r.extractWeights,t),u=a.extractSeparableConvParams,c=a.extractReductionBlockParams,l=a.extractMainBlockParams,p={conv_in:(0,a.extractConvParams)(3,32,3,"entry_flow/conv_in"),reduction_block_0:c(32,64,"entry_flow/reduction_block_0"),reduction_block_1:c(64,128,"entry_flow/reduction_block_1")},m={};Pf(n,0,1).forEach(function(C){m["main_block_"+C]=l(128,"middle_flow/main_block_"+C)});var b={reduction_block:c(128,256,"exit_flow/reduction_block"),separable_conv:u(256,512,"exit_flow/separable_conv")};if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:t,params:{entry_flow:p,middle_flow:m,exit_flow:b}}}(t,this._numMainBlocks)},n}(aa),CC=function(e){return e.FEMALE="female",e.MALE="male",e}(CC||{}),uY=function(e){function n(t){void 0===t&&(t=new iY(2));var r=e.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=t,r}return ke(n,e),Object.defineProperty(n.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),n.prototype.runNet=function(t){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return le(function(){var i=t instanceof Dm?r.faceFeatureExtractor.forwardInput(t):t,a=Rf(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1);return{age:wi(a,o.fc.age).as1D(),gender:wi(a,o.fc.gender)}})},n.prototype.forwardInput=function(t){var r=this;return le(function(){var o=r.runNet(t);return{age:o.age,gender:ea(o.gender)}})},n.prototype.forward=function(t){return me(this,void 0,void 0,function(){var r;return ve(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Tn(t)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.predictAgeAndGender=function(t){return me(this,void 0,void 0,function(){var r,o,i,a,s,u,c=this;return ve(this,function(l){switch(l.label){case 0:return[4,Tn(t)];case 1:return r=l.sent(),[4,this.forwardInput(r)];case 2:return o=l.sent(),i=_n(o.age),a=_n(o.gender),s=i.map(function(d,f){return{ageTensor:d,genderTensor:a[f]}}),[4,Promise.all(s.map(function(d){var f=d.ageTensor,h=d.genderTensor;return me(c,void 0,void 0,function(){var p,m,v,y,b;return ve(this,function(C){switch(C.label){case 0:return[4,f.data()];case 1:return p=C.sent()[0],[4,h.data()];case 2:return m=C.sent()[0],y=(v=m>.5)?CC.MALE:CC.FEMALE,b=v?m:1-m,f.dispose(),h.dispose(),[2,{age:p,gender:y,genderProbability:b}]}})})}))];case 3:return u=l.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},n.prototype.getDefaultModelName=function(){return"age_gender_model"},n.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},n.prototype.loadClassifierParams=function(t){var r=this.extractClassifierParams(t),i=r.paramMappings;this._params=r.params,this._paramMappings=i},n.prototype.extractClassifierParams=function(t){return function aY(e){var n=[],t=ua(e),o=t.getRemainingWeights,i=vC(t.extractWeights,n),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{fc:{age:a,gender:s}}}}(t)},n.prototype.extractParamsFromWeigthMap=function(t){var r=VF(t),i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(r.featureExtractorMap),function sY(e){var n=[],t=Qa(e,n);function r(i){return{weights:t(i+"/weights",2),bias:t(i+"/bias",1)}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return sa(e,n),{params:o,paramMappings:n}}(i)},n.prototype.extractParams=function(t){var o=t.slice(0,t.length-1539),i=t.slice(t.length-1539);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},n}(aa),zF=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.postProcess=function(t,r,o){var i=o.map(function(s){var u=s.width,c=s.height,l=r/Math.max(c,u);return{width:u*l,height:c*l}}),a=i.length;return le(function(){var s=function(f,h){return eo([gi([68],f),gi([68],h)],1).as2D(1,136).as1D()},u=function(f,h){var p=i[f],m=p.width,v=p.height;return h(m,v)?Math.abs(m-v)/2:0};return t.mul(gi([a,136],r)).sub(eo(Array.from(Array(a),function(f,h){return s(function(f){return u(f,function(h,p){return h<p})}(h),function(f){return u(f,function(h,p){return p<h})}(h))}))).div(eo(Array.from(Array(a),function(f,h){return s(i[h].width,i[h].height)})))})},n.prototype.forwardInput=function(t){var r=this;return le(function(){var o=r.runNet(t);return r.postProcess(o,t.inputSize,t.inputDimensions.map(function(i){return{height:i[0],width:i[1]}}))})},n.prototype.forward=function(t){return me(this,void 0,void 0,function(){var r;return ve(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Tn(t)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.detectLandmarks=function(t){return me(this,void 0,void 0,function(){var r,o,i,a=this;return ve(this,function(s){switch(s.label){case 0:return[4,Tn(t)];case 1:return r=s.sent(),o=le(function(){return _n(a.forwardInput(r))}),[4,Promise.all(o.map(function(u,c){return me(a,void 0,void 0,function(){var l,d,f,h,p;return ve(this,function(m){switch(m.label){case 0:return f=(d=Array).from,[4,u.data()];case 1:return l=f.apply(d,[m.sent()]),h=l.filter(function(v,y){return vF(y)}),p=l.filter(function(v,y){return!vF(y)}),[2,new xF(Array(68).fill(0).map(function(v,y){return new xt(h[y],p[y])}),{height:r.getInputHeight(c),width:r.getInputWidth(c)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},n.prototype.getClassifierChannelsOut=function(){return 136},n}(UF),$F=function(e){function n(t){return void 0===t&&(t=new BF),e.call(this,"FaceLandmark68Net",t)||this}return ke(n,e),n.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},n.prototype.getClassifierChannelsIn=function(){return 256},n}(zF),dY=function(e){function n(){return e.call(this,"TinyFaceFeatureExtractor")||this}return ke(n,e),n.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return le(function(){var s=mC(Lf(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(ae(255)),r.dense0,!0);return s=mC(s,r.dense1),s=mC(s,r.dense2),Rf(s,[14,14],[2,2],"valid")})},n.prototype.forward=function(t){return me(this,void 0,void 0,function(){var r;return ve(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Tn(t)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},n.prototype.extractParamsFromWeigthMap=function(t){return function cY(e){var n=[],t=LF(e,n).extractDenseBlock3Params,r={dense0:t("dense0",!0),dense1:t("dense1"),dense2:t("dense2")};return sa(e,n),{params:r,paramMappings:n}}(t)},n.prototype.extractParams=function(t){return function lY(e){var n=[],t=ua(e),o=t.getRemainingWeights,i=PF(t.extractWeights,n).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{dense0:a,dense1:s,dense2:u}}}(t)},n}(aa),fY=function(e){function n(t){return void 0===t&&(t=new dY),e.call(this,"FaceLandmark68TinyNet",t)||this}return ke(n,e),n.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},n.prototype.getClassifierChannelsIn=function(){return 128},n}(zF);function _C(e,n,t,r,o){void 0===o&&(o="same");var i=n.conv,s=i.bias,u=Do(e,i.filters,t,o);return u=function hY(e,n){return Qe(Qn(e,n.weights),n.biases)}(u=Qe(u,s),n.scale),r?Jt(u):u}function GF(e,n){return _C(e,n,[1,1],!1)}function qF(e,n){return _C(e,n,[2,2],!0,"valid")}function gY(e,n){function i(s,u,c,l){var d=function r(s,u,c,l){var d=function t(s,u,c){var l=e(s),d=l.length/(u*c*c);if(function DK(e){return e%1!=0}(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+l.length+", numFilters: "+u+", filterSize: "+c);return le(function(){return qa(kr(l,[u,d,c,c]),[2,3,1,0])})}(s,u,c),f=gn(e(u));return n.push({paramPath:l+"/filters"},{paramPath:l+"/bias"}),{filters:d,bias:f}}(s,u,c,l+"/conv"),f=function o(s,u){var c=gn(e(s)),l=gn(e(s));return n.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:c,biases:l}}(u,l+"/scale");return{conv:d,scale:f}}return{extractConvLayerParams:i,extractResidualLayerParams:function a(s,u,c,l,d){return void 0===d&&(d=!1),{conv1:i((d?.5:1)*s,u,c,l+"/conv1"),conv2:i(s,u,c,l+"/conv2")}}}}function yY(e){var n=[],t=function vY(e,n){var t=Qa(e,n);function o(a){var s=t(a+"/conv/filters",4),u=t(a+"/conv/bias",1),c=function r(a){return{weights:t(a+"/scale/weights",1),biases:t(a+"/scale/biases",1)}}(a);return{conv:{filters:s,bias:u},scale:c}}return{extractConvLayerParams:o,extractResidualLayerParams:function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}}}(e,n),o=t.extractResidualLayerParams,i=(0,t.extractConvLayerParams)("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),c=o("conv64_down"),l=o("conv64_1"),d=o("conv64_2"),f=o("conv64_3"),h=o("conv128_down"),p=o("conv128_1"),m=o("conv128_2"),v=o("conv256_down"),y=o("conv256_1"),b=o("conv256_2"),C=o("conv256_down_out"),x=e.fc;if(n.push({originalPath:"fc",paramPath:"fc"}),!function _K(e){return Ff(e,2)}(x))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+x);var E={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:c,conv64_1:l,conv64_2:d,conv64_3:f,conv128_down:h,conv128_1:p,conv128_2:m,conv256_down:v,conv256_1:y,conv256_2:b,conv256_down_out:C,fc:x};return sa(e,n),{params:E,paramMappings:n}}function bi(e,n){var t=function pY(e,n){return _C(e,n,[1,1],!0)}(e,n.conv1);return t=GF(t,n.conv2),t=Qe(t,e),Jt(t)}function Sm(e,n){var t=qF(e,n.conv1);t=GF(t,n.conv2);var r=Rf(e,2,2,"valid"),o=zt(r.shape),i=r.shape[3]!==t.shape[3];if(r.shape[1]!==t.shape[1]||r.shape[2]!==t.shape[2]){var s=kf(t.shape);s[1]=1;var u=zt(s),c=kf((t=Cn([t,u],1)).shape);c[2]=1;var l=zt(c);t=Cn([t,l],2)}return r=i?Cn([r,o],3):r,t=Qe(r,t),Jt(t)}!function(e){ke(function n(){return null!==e&&e.apply(this,arguments)||this},e)}($F);var wY=function(e){function n(){return e.call(this,"FaceRecognitionNet")||this}return ke(n,e),n.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return le(function(){var s=qF(Lf(t.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(ae(256)),r.conv32_down);s=bi(s=Mn(s,3,2,"valid"),r.conv32_1),s=bi(s,r.conv32_2),s=bi(s,r.conv32_3),s=bi(s=Sm(s,r.conv64_down),r.conv64_1),s=bi(s,r.conv64_2),s=bi(s,r.conv64_3),s=bi(s=Sm(s,r.conv128_down),r.conv128_1),s=bi(s,r.conv128_2),s=bi(s=Sm(s,r.conv256_down),r.conv256_1);var u=(s=Sm(s=bi(s,r.conv256_2),r.conv256_down_out)).mean([1,2]);return hm(u,r.fc)})},n.prototype.forward=function(t){return me(this,void 0,void 0,function(){var r;return ve(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Tn(t)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.computeFaceDescriptor=function(t){return me(this,void 0,void 0,function(){var r,o,i,a=this;return ve(this,function(s){switch(s.label){case 0:return[4,Tn(t)];case 1:return r=s.sent(),o=le(function(){return _n(a.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},n.prototype.getDefaultModelName=function(){return"face_recognition_model"},n.prototype.extractParamsFromWeigthMap=function(t){return yY(t)},n.prototype.extractParams=function(t){return function mY(e){var n=ua(e),t=n.extractWeights,r=n.getRemainingWeights,o=[],i=gY(t,o),s=i.extractResidualLayerParams,u=(0,i.extractConvLayerParams)(4704,32,7,"conv32_down"),c=s(9216,32,3,"conv32_1"),l=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),m=s(36864,64,3,"conv64_3"),v=s(147456,128,3,"conv128_down",!0),y=s(147456,128,3,"conv128_1"),b=s(147456,128,3,"conv128_2"),C=s(589824,256,3,"conv256_down",!0),x=s(589824,256,3,"conv256_1"),E=s(589824,256,3,"conv256_2"),I=s(589824,256,3,"conv256_down_out"),N=le(function(){return qa($a(t(32768),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{conv32_down:u,conv32_1:c,conv32_2:l,conv32_3:d,conv64_down:f,conv64_1:h,conv64_2:p,conv64_3:m,conv128_down:v,conv128_1:y,conv128_2:b,conv256_down:C,conv256_1:x,conv256_2:E,conv256_down_out:I,fc:N},paramMappings:o}}(t)},n}(aa);function XF(e,n,t){return Object.assign({},e,{gender:n,genderProbability:t})}var KF=function(){function e(n){var t=void 0===n?{}:n,r=t.minFaceSize,o=t.scaleFactor,i=t.maxNumScales,a=t.scoreThresholds,s=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,"number"!=typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!=typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!=typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some(function(u){return"number"!=typeof u}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return"number"!=typeof u})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function xi(e,n,t){return le(function(){var r=Do(e,n.filters,t,"same");return r=Qe(r,n.batch_norm_offset),Ex(r,0,6)})}function MY(e,n,t){var r=e.arraySync(),o=Math.min(r[n][0],r[n][2]),i=Math.min(r[n][1],r[n][3]),a=Math.max(r[n][0],r[n][2]),s=Math.max(r[n][1],r[n][3]),u=Math.min(r[t][0],r[t][2]),c=Math.min(r[t][1],r[t][3]),l=Math.max(r[t][0],r[t][2]),d=Math.max(r[t][1],r[t][3]),f=(a-o)*(s-i),h=(l-u)*(d-c);if(f<=0||h<=0)return 0;var p=Math.max(o,u),m=Math.max(i,c),v=Math.min(a,l),y=Math.min(s,d),b=Math.max(v-p,0)*Math.max(y-m,0);return b/(f+h-b)}function Jc(e,n){return le(function(){var t=e.shape[0];return{boxPredictionEncoding:Wo(Go(e,n.box_encoding_predictor),[t,-1,1,4]),classPrediction:Wo(Go(e,n.class_predictor),[t,-1,3])}})}var Am=function(){function e(n){var t=void 0===n?{}:n,r=t.minConfidence,o=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,"number"!=typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!=typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),YF=function(e){function n(){return e.call(this,"SsdMobilenetv1")||this}return ke(n,e),n.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return le(function(){var o=t.toBatchTensor(512,!1).toFloat(),a=function SY(e,n){return le(function(){var t=null,r=xi(e,n.conv_0,[2,2]);if([n.conv_1,n.conv_2,n.conv_3,n.conv_4,n.conv_5,n.conv_6,n.conv_7,n.conv_8,n.conv_9,n.conv_10,n.conv_11,n.conv_12,n.conv_13].forEach(function(i,a){var s=a+1,u=function IY(e){return[2,4,6,12].some(function(n){return n===e})?[2,2]:[1,1]}(s);r=function EY(e,n,t){return le(function(){var r=fm(e,n.filters,t,"same");return r=hk(r,n.batch_norm_mean,n.batch_norm_variance,n.batch_norm_offset,n.batch_norm_scale,.0010000000474974513),Ex(r,0,6)})}(r,i.depthwise_conv,u),r=xi(r,i.pointwise_conv,[1,1]),11===s&&(t=r)}),null===t)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:t}})}(Dn(Qn(o,ae(.007843137718737125)),ae(1)),r.mobilenetv1),s=function kY(e,n,t){return le(function(){var r=xi(e,t.conv_0,[1,1]),o=xi(r,t.conv_1,[2,2]),i=xi(o,t.conv_2,[1,1]),a=xi(i,t.conv_3,[2,2]),s=xi(a,t.conv_4,[1,1]),u=xi(s,t.conv_5,[2,2]),c=xi(u,t.conv_6,[1,1]),l=xi(c,t.conv_7,[2,2]),d=Jc(n,t.box_predictor_0),f=Jc(e,t.box_predictor_1),h=Jc(o,t.box_predictor_2),p=Jc(a,t.box_predictor_3),m=Jc(u,t.box_predictor_4),v=Jc(l,t.box_predictor_5);return{boxPredictions:Cn([d.boxPredictionEncoding,f.boxPredictionEncoding,h.boxPredictionEncoding,p.boxPredictionEncoding,m.boxPredictionEncoding,v.boxPredictionEncoding],1),classPredictions:Cn([d.classPrediction,f.classPrediction,h.classPrediction,p.classPrediction,m.classPrediction,v.classPrediction],1)}})}(a.out,a.conv11,r.prediction_layer);return function NY(e,n,t){return le(function(){var r=e.shape[0],o=function RY(e,n){var t=function TY(e){var n=_n(qa(e,[1,0])),t=[Dn(n[2],n[0]),Dn(n[3],n[1])];return{sizes:t,centers:[Qe(n[0],$o(t[0],ae(2))),Qe(n[1],$o(t[1],ae(2)))]}}(e),r=t.sizes,o=t.centers,i=_n(qa(n,[1,0])),a=$o(Qn(Ix($o(i[2],ae(5))),r[0]),ae(2)),s=Qe(Qn($o(i[0],ae(10)),r[0]),o[0]),u=$o(Qn(Ix($o(i[3],ae(5))),r[1]),ae(2)),c=Qe(Qn($o(i[1],ae(10)),r[1]),o[1]);return qa(eo([Dn(s,a),Dn(c,u),Qe(s,a),Qe(c,u)]),[1,0])}(Wo(Vc(t.extra_dim,[r,1,1]),[-1,4]),Wo(e,[-1,4]));o=Wo(o,[r,o.shape[0]/r,4]);var i=ck(mi(n,[0,0,1],[-1,-1,-1])),a=mi(i,[0,0,0],[-1,-1,1]);return a=Wo(a,[r,a.shape[1]]),{boxes:_n(o),scores:_n(a)}})}(s.boxPredictions,s.classPredictions,r.output_layer)})},n.prototype.forward=function(t){return me(this,void 0,void 0,function(){var r;return ve(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Tn(t)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.locateFaces=function(t,r){return void 0===r&&(r={}),me(this,void 0,void 0,function(){var o,i,a,s,u,c,l,d,f,h,p,m,v,b,C,x,E,I,N,R;return ve(this,function(M){switch(M.label){case 0:return o=new Am(r),i=o.maxResults,a=o.minConfidence,[4,Tn(t)];case 1:for(s=M.sent(),u=this.forwardInput(s),d=(c=u.boxes)[0],f=(l=u.scores)[0],h=1;h<c.length;h++)c[h].dispose(),l[h].dispose();return v=(m=Array).from,[4,f.data()];case 2:return p=v.apply(m,[M.sent()]),b=function AY(e,n,t,r,o){var a=Math.min(t,e.shape[0]),s=n.map(function(l,d){return{score:l,boxIndex:d}}).filter(function(l){return l.score>o}).sort(function(l,d){return d.score-l.score}),u=function(l){return l<=r?1:0},c=[];return s.forEach(function(l){if(!(c.length>=a)){for(var d=l.score,f=c.length-1;f>=0;--f){var h=MY(e,l.boxIndex,c[f]);if(0!==h&&(l.score*=u(h),l.score<=o))break}d===l.score&&c.push(l.boxIndex)}}),c}(d,p,i,.5,a),C=s.getReshapedInputDimensions(0),E=(x=s.inputSize)/C.width,I=x/C.height,N=d.arraySync(),R=b.map(function(T){var L=[Math.max(0,N[T][0]),Math.min(1,N[T][2])].map(function(Y){return Y*I}),O=L[0],q=L[1],$=[Math.max(0,N[T][1]),Math.min(1,N[T][3])].map(function(Y){return Y*E}),G=$[0];return new vi(p[T],new uC(G,O,$[1]-G,q-O),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),f.dispose(),[2,R]}})})},n.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},n.prototype.extractParamsFromWeigthMap=function(t){return function _Y(e){var n=[],t=function CY(e,n){var t=Qa(e,n);function r(c,l,d){return{filters:t(c+"/Conv2d_"+l+"_pointwise/weights",4,d+"/filters"),batch_norm_offset:t(c+"/Conv2d_"+l+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset")}}function o(c){var l="mobilenetv1/conv_"+c,d="MobilenetV1/Conv2d_"+c+"_depthwise",f=l+"/depthwise_conv",h=l+"/pointwise_conv";return{depthwise_conv:{filters:t(d+"/depthwise_weights",4,f+"/filters"),batch_norm_scale:t(d+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),batch_norm_offset:t(d+"/BatchNorm/beta",1,f+"/batch_norm_offset"),batch_norm_mean:t(d+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),batch_norm_variance:t(d+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",c,h)}}function a(c,l){return{filters:t(c+"/weights",4,l+"/filters"),bias:t(c+"/biases",1,l+"/bias")}}function s(c){return{box_encoding_predictor:a("Prediction/BoxPredictor_"+c+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+c+"/box_encoding_predictor"),class_predictor:a("Prediction/BoxPredictor_"+c+"/ClassPredictor","prediction_layer/box_predictor_"+c+"/class_predictor")}}return{extractMobilenetV1Params:function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}},extractPredictionLayerParams:function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}}}(e,n),r=t.extractMobilenetV1Params,o=t.extractPredictionLayerParams,i=e["Output/extra_dim"];if(n.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!bm(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return sa(e,n),{params:a,paramMappings:n}}(t)},n.prototype.extractParams=function(t){return function xY(e){var n=[],t=ua(e),r=t.extractWeights,o=t.getRemainingWeights,i=function bY(e,n){function r(u,c,l,d,f){var h=kr(e(u*c*l*l),[l,l,u,c]),p=gn(e(c));return n.push({paramPath:d+"/filters"},{paramPath:d+"/"+(f?"batch_norm_offset":"bias")}),{filters:h,bias:p}}function o(u,c,l,d){var f=r(u,c,l,d,!0);return{filters:f.filters,batch_norm_offset:f.bias}}function i(u,c,l){var d=function t(u,c){var l=kr(e(9*u),[3,3,u,1]),d=gn(e(u)),f=gn(e(u)),h=gn(e(u)),p=gn(e(u));return n.push({paramPath:c+"/filters"},{paramPath:c+"/batch_norm_scale"},{paramPath:c+"/batch_norm_offset"},{paramPath:c+"/batch_norm_mean"},{paramPath:c+"/batch_norm_variance"}),{filters:l,batch_norm_scale:d,batch_norm_offset:f,batch_norm_mean:h,batch_norm_variance:p}}(u,l+"/depthwise_conv");return{depthwise_conv:d,pointwise_conv:o(u,c,1,l+"/pointwise_conv")}}return{extractMobilenetV1Params:function a(){return{conv_0:o(3,32,3,"mobilenetv1/conv_0"),conv_1:i(32,64,"mobilenetv1/conv_1"),conv_2:i(64,128,"mobilenetv1/conv_2"),conv_3:i(128,128,"mobilenetv1/conv_3"),conv_4:i(128,256,"mobilenetv1/conv_4"),conv_5:i(256,256,"mobilenetv1/conv_5"),conv_6:i(256,512,"mobilenetv1/conv_6"),conv_7:i(512,512,"mobilenetv1/conv_7"),conv_8:i(512,512,"mobilenetv1/conv_8"),conv_9:i(512,512,"mobilenetv1/conv_9"),conv_10:i(512,512,"mobilenetv1/conv_10"),conv_11:i(512,512,"mobilenetv1/conv_11"),conv_12:i(512,1024,"mobilenetv1/conv_12"),conv_13:i(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function s(){return{conv_0:o(1024,256,1,"prediction_layer/conv_0"),conv_1:o(256,512,3,"prediction_layer/conv_1"),conv_2:o(512,128,1,"prediction_layer/conv_2"),conv_3:o(128,256,3,"prediction_layer/conv_3"),conv_4:o(256,128,1,"prediction_layer/conv_4"),conv_5:o(128,256,3,"prediction_layer/conv_5"),conv_6:o(256,64,1,"prediction_layer/conv_6"),conv_7:o(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:r(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:r(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:r(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:r(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:r(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}(r,n),s=i.extractPredictionLayerParams,u=(0,i.extractMobilenetV1Params)(),c=s(),d={extra_dim:J0(r(20472),[1,5118,4])};if(n.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:c,output_layer:d},paramMappings:n}}(t)},n}(aa);!function(e){ke(function n(){return null!==e&&e.apply(this,arguments)||this},e)}(YF);var OY=[new xt(.738768,.874946),new xt(2.42204,2.65704),new xt(4.30971,7.04493),new xt(10.246,4.59428),new xt(12.6868,11.8741)],LY=[new xt(1.603231,2.094468),new xt(6.041143,7.080126),new xt(2.882459,3.518061),new xt(4.266906,5.178857),new xt(9.041765,10.66308)],BY=[117.001,114.697,97.404],Mm=function(e){return"number"==typeof e};function DC(e){return le(function(){var n=Qn(e,ae(.10000000149011612));return Qe(Jt(Dn(e,n)),n)})}function Ja(e,n){return le(function(){var t=Xs(e,[[0,0],[1,1],[1,1],[0,0]]);return t=Do(t,n.conv.filters,[1,1],"valid"),t=Dn(t,n.bn.sub),t=Qn(t,n.bn.truediv),DC(t=Qe(t,n.conv.bias))})}function es(e,n){return le(function(){var t=Xs(e,[[0,0],[1,1],[1,1],[0,0]]);return t=Rx(t,n.depthwise_filter,n.pointwise_filter,[1,1],"valid"),DC(t=Qe(t,n.bias))})}var EC=function(){function e(n){var t=void 0===n?{}:n,r=t.inputSize,o=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,"number"!=typeof this._inputSize||this._inputSize%32!=0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!=typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),ZF=function(e){function n(t){var r=e.call(this,"TinyYolov2")||this;return function jY(e){if(!e)throw new Error("invalid config: "+e);if("boolean"!=typeof e.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!Mm(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(n){return"string"==typeof n}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(n){return n||{}}).every(function(n){return Mm(n.x)&&Mm(n.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||3!==e.meanRgb.length||!e.meanRgb.every(Mm)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}(t),r._config=t,r}return ke(n,e),Object.defineProperty(n.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),n.prototype.runTinyYolov2=function(t,r){var o=Ja(t,r.conv0);return o=Ja(o=Mn(o,[2,2],[2,2],"same"),r.conv1),o=Ja(o=Mn(o,[2,2],[2,2],"same"),r.conv2),o=Ja(o=Mn(o,[2,2],[2,2],"same"),r.conv3),o=Ja(o=Mn(o,[2,2],[2,2],"same"),r.conv4),o=Ja(o=Mn(o,[2,2],[2,2],"same"),r.conv5),o=Ja(o=Mn(o,[2,2],[1,1],"same"),r.conv6),Go(o=Ja(o,r.conv7),r.conv8,"valid",!1)},n.prototype.runMobilenet=function(t,r){var o=this.config.isFirstLayerConv2d?DC(Go(t,r.conv0,"valid",!1)):es(t,r.conv0);return o=es(o=Mn(o,[2,2],[2,2],"same"),r.conv1),o=es(o=Mn(o,[2,2],[2,2],"same"),r.conv2),o=es(o=Mn(o,[2,2],[2,2],"same"),r.conv3),o=es(o=Mn(o,[2,2],[2,2],"same"),r.conv4),o=es(o=Mn(o,[2,2],[2,2],"same"),r.conv5),o=Mn(o,[2,2],[1,1],"same"),o=r.conv6?es(o,r.conv6):o,Go(o=r.conv7?es(o,r.conv7):o,r.conv8,"valid",!1)},n.prototype.forwardInput=function(t,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return le(function(){var a=t.toBatchTensor(r,!1).toFloat();return a=(a=o.config.meanRgb?Lf(a,o.config.meanRgb):a).div(ae(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},n.prototype.forward=function(t,r){return me(this,void 0,void 0,function(){var o;return ve(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Tn(t)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},n.prototype.detect=function(t,r){return void 0===r&&(r={}),me(this,void 0,void 0,function(){var o,i,a,s,u,c,l,d,f,h,p,m,b=this;return ve(this,function(C){switch(C.label){case 0:return o=new EC(r),i=o.inputSize,a=o.scoreThreshold,[4,Tn(t)];case 1:return s=C.sent(),[4,this.forwardInput(s,i)];case 2:return u=C.sent(),c=le(function(){return _n(u)[0].expandDims()}),l={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(c,s.getReshapedInputDimensions(0),a)];case 3:return d=C.sent(),u.dispose(),c.dispose(),f=d.map(function(x){return x.box}),h=d.map(function(x){return x.score}),p=d.map(function(x){return x.classScore}),m=d.map(function(x){return b.config.classes[x.label]}),[2,Of(f.map(function(x){return x.rescale(i)}),h,this.config.iouThreshold,!0).map(function(x){return new bF(h[x],p[x],m[x],f[x],l)})]}})})},n.prototype.getDefaultModelName=function(){return""},n.prototype.extractParamsFromWeigthMap=function(t){return function $Y(e,n){var s,t=[],r=function zY(e,n){var t=Qa(e,n);function o(s){return{filters:t(s+"/filters",4),bias:t(s+"/bias",1)}}return{extractConvParams:o,extractConvWithBatchNormParams:function i(s){var u=o(s+"/conv"),c=function r(s){return{sub:t(s+"/sub",1),truediv:t(s+"/truediv",1)}}(s+"/bn");return{conv:u,bn:c}},extractSeparableConvParams:wC(t)}}(e,t),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams;if(n.withSeparableConvs){var u=n.filterSizes&&n.filterSizes.length||9;s={conv0:n.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return sa(e,t),{params:s,paramMappings:t}}(t,this.config)},n.prototype.extractParams=function(t){var r=this.config.filterSizes||n.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(7!==o&&8!==o&&9!==o)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return function WY(e,n,t,r){var f,o=ua(e),a=o.getRemainingWeights,s=[],u=function HY(e,n){var t=Im(e,n),i=yC(e,n);return{extractConvParams:t,extractConvWithBatchNormParams:function o(a,s,u){var c=t(a,s,3,u+"/conv"),l=function r(a,s){var u=gn(e(a)),c=gn(e(a));return n.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:c}}(s,u+"/bn");return{conv:c,bn:l}},extractSeparableConvParams:i}}(o.extractWeights,s),c=u.extractConvParams,l=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams;if(n.withSeparableConvs){var h=r[0],p=r[1],m=r[2],v=r[3],y=r[4],b=r[5],C=r[6],x=r[7],E=r[8];f={conv0:n.isFirstLayerConv2d?c(h,p,3,"conv0"):d(h,p,"conv0"),conv1:d(p,m,"conv1"),conv2:d(m,v,"conv2"),conv3:d(v,y,"conv3"),conv4:d(y,b,"conv4"),conv5:d(b,C,"conv5"),conv6:x?d(C,x,"conv6"):void 0,conv7:E?d(x,E,"conv7"):void 0,conv8:c(E||x||C,5*t,1,"conv8")}}else m=r[2],v=r[3],y=r[4],b=r[5],C=r[6],x=r[7],E=r[8],f={conv0:l(h=r[0],p=r[1],"conv0"),conv1:l(p,m,"conv1"),conv2:l(m,v,"conv2"),conv3:l(v,y,"conv3"),conv4:l(y,b,"conv4"),conv5:l(b,C,"conv5"),conv6:l(C,x,"conv6"),conv7:l(x,E,"conv7"),conv8:c(E,5*t,1,"conv8")};if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{params:f,paramMappings:s}}(t,this.config,this.boxEncodingSize,r)},n.prototype.extractBoxes=function(t,r,o){return me(this,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,p,m,v,y,b,C,x,E,I,N,R,M,T,L,O,q,$,G,J,Y,X=this;return ve(this,function(ne){switch(ne.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),u=s/i,c=s/a,l=t.shape[1],d=this.config.anchors.length,f=le(function(){var re=t.reshape([l,l,d,X.boxEncodingSize]);return[re.slice([0,0,0,0],[l,l,d,4]),re.slice([0,0,0,4],[l,l,d,1]),X.withClassScores?ea(re.slice([0,0,0,5],[l,l,d,X.config.classes.length]),3):ae(0)]}),h=f[0],m=f[2],v=[],[4,(p=f[1]).array()];case 1:return y=ne.sent(),[4,h.array()];case 2:b=ne.sent(),C=0,ne.label=3;case 3:if(!(C<l))return[3,12];x=0,ne.label=4;case 4:if(!(x<l))return[3,11];E=0,ne.label=5;case 5:return E<d?(I=sC(y[C][x][E][0]),!o||I>o?(N=(x+sC(b[C][x][E][0]))/l*u,R=(C+sC(b[C][x][E][1]))/l*c,M=Math.exp(b[C][x][E][2])*this.config.anchors[E].x/l*u,T=Math.exp(b[C][x][E][3])*this.config.anchors[E].y/l*c,L=N-M/2,O=R-T/2,q={row:C,col:x,anchor:E},this.withClassScores?[4,this.extractPredictedClass(m,q)]:[3,7]):[3,9]):[3,10];case 6:return Y=ne.sent(),[3,8];case 7:Y={classScore:1,label:0},ne.label=8;case 8:G=($=Y).classScore,J=$.label,v.push(er({box:new xm(L,O,L+M,O+T),score:I,classScore:I*G,label:J},q)),ne.label=9;case 9:return E++,[3,5];case 10:return x++,[3,4];case 11:return C++,[3,3];case 12:return h.dispose(),p.dispose(),m.dispose(),[2,v]}})})},n.prototype.extractPredictedClass=function(t,r){return me(this,void 0,void 0,function(){var o,i,a,s;return ve(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,t.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(c,l){return s[o][i][a][l]}).map(function(c,l){return{classScore:c,label:l}}).reduce(function(c,l){return c.classScore>l.classScore?c:l})]}})})},n.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],n}(aa),qY=function(e){function n(t){void 0===t&&(t=!0);var o=Object.assign({},{withSeparableConvs:t,iouThreshold:.4,classes:["face"]},t?{anchors:LY,meanRgb:BY}:{anchors:OY,withClassScores:!0});return e.call(this,o)||this}return ke(n,e),Object.defineProperty(n.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),n.prototype.locateFaces=function(t,r){return me(this,void 0,void 0,function(){return ve(this,function(i){switch(i.label){case 0:return[4,this.detect(t,r)];case 1:return[2,i.sent().map(function(a){return new vi(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},n.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},n.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},n}(ZF),Tm=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="TinyFaceDetectorOptions",t}return ke(n,e),n}(EC),Vf=function(){function e(){}return e.prototype.then=function(n){return me(this,void 0,void 0,function(){var t;return ve(this,function(r){switch(r.label){case 0:return t=n,[4,this.run()];case 1:return[2,t.apply(void 0,[r.sent()])]}})})},e.prototype.run=function(){return me(this,void 0,void 0,function(){return ve(this,function(n){throw new Error("ComposableTask - run is not implemented")})})},e}();function QF(e,n){return Object.assign({},e,{descriptor:n})}function Rm(e,n,t,r,o){return void 0===o&&(o=function(i){return i.alignedRect}),me(this,void 0,void 0,function(){var i,a,s,u,c;return ve(this,function(l){switch(l.label){case 0:return i=e.map(function(d){return function ZK(e){return function FK(e){return e.detection instanceof vi}(e)&&e.landmarks instanceof Cm&&e.unshiftedLandmarks instanceof Cm&&e.alignedRect instanceof vi}(d)?o(d):d.detection}),(s=r)?[3,5]:n instanceof kt?[4,gC(n,i)]:[3,2];case 1:return u=l.sent(),[3,4];case 2:return[4,pC(n,i)];case 3:u=l.sent(),l.label=4;case 4:s=u,l.label=5;case 5:return[4,t(a=s)];case 6:return c=l.sent(),a.forEach(function(d){return d instanceof kt&&d.dispose()}),[2,c]}})})}function IC(e,n,t,r,o){return me(this,void 0,void 0,function(){var i=this;return ve(this,function(a){return[2,Rm([e],n,function(s){return me(i,void 0,void 0,function(){return ve(this,function(u){return[2,t(s[0])]})})},r,o)]})})}function SC(e,n){var r=n[1];return{height:Math.floor(n[0]*e),width:Math.floor(r*e)}}var AC=function(e){function n(t,r,o,i){return e.call(this,{left:t,top:r,right:o,bottom:i},!0)||this}return ke(n,e),n}(ia);function JF(e){return le(function(){return Qn(Dn(e,ae(127.5)),ae(.0078125))})}function el(e,n){return le(function(){return Qe(Jt(e),Qn(n,sm(Jt(sm(e)))))})}function MC(e,n,t){return void 0===t&&(t=!1),le(function(){var r=Go(e,n.conv1,"valid");return r=el(r,n.prelu1_alpha),r=el(r=Go(r=Mn(r,t?[2,2]:[3,3],[2,2],"same"),n.conv2,"valid"),n.prelu2_alpha),el(r=Go(r=t?r:Mn(r,[3,3],[2,2],"valid"),n.conv3,"valid"),n.prelu3_alpha)})}function rZ(e,n,t,r,o){o.stage1=[];var i=n.map(function(f){return le(function(){var h={scale:f},p=function tZ(e,n){return le(function(){var t=SC(n,e.shape.slice(1)),a=JF(Ox.resizeBilinear(e,[t.height,t.width]));return qa(a,[0,2,1,3])})}(e,f),m=Date.now(),v=function eZ(e,n){return le(function(){var t=MC(e,n,!0),r=Go(t,n.conv4_1,"valid"),o=_o(pm(r,3),3);return{prob:ea(Dn(r,o),3),regions:Go(t,n.conv4_2,"valid")}})}(p,r),y=v.prob,b=v.regions;return h.pnet=Date.now()-m,{scoresTensor:_n(_n(y,3)[1])[0],regionsTensor:_n(b)[0],scale:f,statsForScale:h}})}),a=i.map(function(f){var h=f.scoresTensor,p=f.regionsTensor,v=f.statsForScale,y=function nZ(e,n,t,r){for(var o=[],i=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)i[a][s]>=r&&o.push(new xt(s,a));return o.map(function(c){var l=new xm(Math.round((2*c.y+1)/t),Math.round((2*c.x+1)/t),Math.round((2*c.y+12)/t),Math.round((2*c.x+12)/t)),d=i[c.y][c.x],f=n.arraySync();return{cell:l,score:d,region:new AC(f[c.y][c.x][0],f[c.y][c.x][1],f[c.y][c.x][2],f[c.y][c.x][3])}})}(h,p,f.scale,t);if(h.dispose(),p.dispose(),!y.length)return o.stage1.push(v),[];var b=Date.now(),C=Of(y.map(function(x){return x.cell}),y.map(function(x){return x.score}),.5);return v.nms=Date.now()-b,v.numBoxes=C.length,o.stage1.push(v),C.map(function(x){return y[x]})}),s=a.reduce(function(f,h){return f.concat(h)},[]),u=[],c=[];if(s.length>0){var l=Date.now(),d=Of(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);o.stage1_nms=Date.now()-l,c=d.map(function(f){return s[f].score}),u=d.map(function(f){return s[f]}).map(function(f){var h=f.cell,p=f.region;return new xm(h.left+p.left*h.width,h.top+p.top*h.height,h.right+p.right*h.width,h.bottom+p.bottom*h.height).toSquare().round()})}return{boxes:u,scores:c}}function eP(e,n,t){var r=t.width,o=t.height;return me(this,void 0,void 0,function(){var i,a,s,u=this;return ve(this,function(c){switch(c.label){case 0:return i=yi(e),[4,Promise.all(n.map(function(l){return me(u,void 0,void 0,function(){var d,v,y,b;return ve(this,function(C){return d=l.padAtBorders(e.height,e.width),b=i.getImageData(v=d.x-1,y=d.y-1,d.ex-v,d.ey-y),[2,tr.isNodejs()?hC(b):createImageBitmap(b)]})})}))];case 1:return a=c.sent(),s=[],a.forEach(function(l){var f=yi(_m({width:r,height:o}));f.drawImage(l,0,0,r,o);for(var h=f.getImageData(0,0,r,o).data,p=[],m=0;m<h.length;m+=4)p.push(h[m+2]),p.push(h[m+1]),p.push(h[m]);s.push(p)}),[2,s.map(function(l){return le(function(){return JF(qa(kr(l,[1,r,o,3]),[0,2,1,3]).toFloat())})})]}})})}function iZ(e,n,t,r,o){return me(this,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,p,m,v,y,b;return ve(this,function(C){switch(C.label){case 0:return i=Date.now(),[4,eP(e,n,{width:24,height:24})];case 1:return a=C.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(x){var E=function oZ(e,n){return le(function(){var t=MC(e,n),i=el(wi(Wo(t,[t.shape[0],n.fc1.weights.shape[0]]),n.fc1),n.prelu4_alpha),a=wi(i,n.fc2_1),s=_o(pm(a,1),1),u=ea(Dn(a,s),1),c=wi(i,n.fc2_2);return{scores:_n(u,1)[1],regions:c}})}(x,r);return x.dispose(),E}),o.stage2_rnet=Date.now()-i,u=s.length>1?Cn(s.map(function(x){return x.scores})):s[0].scores,d=(l=Array).from,[4,u.data()];case 2:return c=d.apply(l,[C.sent()]),u.dispose(),f=c.map(function(x,E){return{score:x,idx:E}}).filter(function(x){return x.score>t}).map(function(x){return x.idx}),h=f.map(function(x){return n[x]}),p=f.map(function(x){return c[x]}),m=[],v=[],h.length>0&&(i=Date.now(),y=Of(h,p,.7),o.stage2_nms=Date.now()-i,b=y.map(function(x){var E=s[f[x]].regions.arraySync();return new AC(E[0][0],E[0][1],E[0][2],E[0][3])}),v=y.map(function(x){return p[x]}),m=y.map(function(x,E){return h[x].calibrate(b[E])})),s.forEach(function(x){x.regions.dispose(),x.scores.dispose()}),[2,{boxes:m,scores:v}]}})})}function sZ(e,n,t,r,o){return me(this,void 0,void 0,function(){var i,a,s,u,c,l,d,f,h,p,m,v,y,b,C;return ve(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,eP(e,n,{width:48,height:48})];case 1:return a=x.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(E){var I=function aZ(e,n){return le(function(){var t=MC(e,n);t=el(t=Go(t=Mn(t,[2,2],[2,2],"same"),n.conv4,"valid"),n.prelu4_alpha);var i=el(wi(Wo(t,[t.shape[0],n.fc1.weights.shape[0]]),n.fc1),n.prelu5_alpha),a=wi(i,n.fc2_1),s=_o(pm(a,1),1),u=ea(Dn(a,s),1),c=wi(i,n.fc2_2),l=wi(i,n.fc2_3);return{scores:_n(u,1)[1],regions:c,points:l}})}(E,r);return E.dispose(),I}),o.stage3_onet=Date.now()-i,u=s.length>1?Cn(s.map(function(E){return E.scores})):s[0].scores,d=(l=Array).from,[4,u.data()];case 2:return c=d.apply(l,[x.sent()]),u.dispose(),f=c.map(function(E,I){return{score:E,idx:I}}).filter(function(E){return E.score>t}).map(function(E){return E.idx}),h=f.map(function(E){var I=s[E].regions.arraySync();return new AC(I[0][0],I[0][1],I[0][2],I[0][3])}),p=f.map(function(E,I){return n[E].calibrate(h[I])}),m=f.map(function(E){return c[E]}),v=[],y=[],b=[],p.length>0&&(i=Date.now(),C=Of(p,m,.7,!1),o.stage3_nms=Date.now()-i,v=C.map(function(E){return p[E]}),y=C.map(function(E){return m[E]}),b=C.map(function(E,I){return Array(5).fill(0).map(function(N,R){var M=s[E].points.arraySync();return new xt(M[0][R]*(v[I].width+1)+v[I].left,M[0][R+5]*(v[I].height+1)+v[I].top)})})),s.forEach(function(E){E.regions.dispose(),E.scores.dispose(),E.points.dispose()}),[2,{boxes:v,scores:y,points:b}]}})})}var uZ=function(e){function n(){return e.call(this,"Mtcnn")||this}return ke(n,e),n.prototype.load=function(t){return me(this,void 0,void 0,function(){return ve(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,t)]})})},n.prototype.loadFromDisk=function(t){return me(this,void 0,void 0,function(){return ve(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,t)]})})},n.prototype.forwardInput=function(t,r){return void 0===r&&(r={}),me(this,void 0,void 0,function(){var o,i,a,s,u,c,l,d,f,h,p,m,v,y,C,x,E,I,N,R;return ve(this,function(M){switch(M.label){case 0:if(!(o=this.params))throw new Error("Mtcnn - load model before inference");if(!(i=t.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=le(function(){return function XY(e){return le(function(){return eo(_n(e,3).reverse(),3)})}(_o(eC.fromPixels(i)).toFloat())}),c=function(T){return u.dispose(),a.total=Date.now()-s,T},l=u.shape.slice(1),d=l[0],f=l[1],h=new KF(r),p=h.minFaceSize,m=h.scaleFactor,v=h.maxNumScales,y=h.scoreThresholds,C=(h.scaleSteps||function JY(e,n,t){for(var i=12/e,a=[],s=Math.min(t[0],t[1])*i,u=0;s>=12;)a.push(i*Math.pow(n,u)),s*=n,u+=1;return a}(p,m,[d,f])).filter(function(T){var L=SC(T,[d,f]);return Math.min(L.width,L.height)>12}).slice(0,v),a.scales=C,a.pyramid=C.map(function(T){return SC(T,[d,f])}),x=Date.now(),[4,rZ(u,C,y[0],o.pnet,a)];case 1:return E=M.sent(),a.total_stage1=Date.now()-x,E.boxes.length?(a.stage2_numInputBoxes=E.boxes.length,x=Date.now(),[4,iZ(i,E.boxes,y[1],o.rnet,a)]):[2,c({results:[],stats:a})];case 2:return I=M.sent(),a.total_stage2=Date.now()-x,I.boxes.length?(a.stage3_numInputBoxes=I.boxes.length,x=Date.now(),[4,sZ(i,I.boxes,y[2],o.onet,a)]):[2,c({results:[],stats:a})];case 3:return N=M.sent(),a.total_stage3=Date.now()-x,R=N.boxes.map(function(T,L){return bC(cC({},new vi(N.scores[L],new uC(T.left/f,T.top/d,T.width/f,T.height/d),{height:d,width:f})),new kK(N.points[L].map(function(O){return O.sub(new xt(T.left,T.top)).div(new xt(T.width,T.height))}),{width:T.width,height:T.height}))}),[2,c({results:R,stats:a})]}})})},n.prototype.forward=function(t,r){return void 0===r&&(r={}),me(this,void 0,void 0,function(){var o;return ve(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Tn(t)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},n.prototype.forwardWithStats=function(t,r){return void 0===r&&(r={}),me(this,void 0,void 0,function(){var o;return ve(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Tn(t)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},n.prototype.getDefaultModelName=function(){return"mtcnn_model"},n.prototype.extractParamsFromWeigthMap=function(t){return function QY(e){var n=[],t=function ZY(e,n){var t=Qa(e,n);function r(l){return{filters:t(l+"/weights",4,l+"/filters"),bias:t(l+"/bias",1)}}function o(l){return{weights:t(l+"/weights",2),bias:t(l+"/bias",1)}}function i(l){return t(l,1)}function a(l){return{conv1:r(l+"/conv1"),prelu1_alpha:i(l+"/prelu1_alpha"),conv2:r(l+"/conv2"),prelu2_alpha:i(l+"/prelu2_alpha"),conv3:r(l+"/conv3"),prelu3_alpha:i(l+"/prelu3_alpha")}}return{extractPNetParams:function s(){var l=a("pnet"),d=r("pnet/conv4_1"),f=r("pnet/conv4_2");return er(er({},l),{conv4_1:d,conv4_2:f})},extractRNetParams:function u(){var l=a("rnet"),d=o("rnet/fc1"),f=i("rnet/prelu4_alpha"),h=o("rnet/fc2_1"),p=o("rnet/fc2_2");return er(er({},l),{fc1:d,prelu4_alpha:f,fc2_1:h,fc2_2:p})},extractONetParams:function c(){var l=a("onet"),d=r("onet/conv4"),f=i("onet/prelu4_alpha"),h=o("onet/fc1"),p=i("onet/prelu5_alpha"),m=o("onet/fc2_1"),v=o("onet/fc2_2"),y=o("onet/fc2_3");return er(er({},l),{conv4:d,prelu4_alpha:f,fc1:h,prelu5_alpha:p,fc2_1:m,fc2_2:v,fc2_3:y})}}}(e,n),o=t.extractRNetParams,i=t.extractONetParams,a=(0,t.extractPNetParams)(),s=o(),u=i();return sa(e,n),{params:{pnet:a,rnet:s,onet:u},paramMappings:n}}(t)},n.prototype.extractParams=function(t){return function YY(e){var n=ua(e),r=n.getRemainingWeights,o=[],i=function KY(e,n){var t=Im(e,n),r=vC(e,n);function o(c,l){var d=gn(e(c));return n.push({paramPath:l}),d}function i(c,l,d){return void 0===d&&(d=!1),{conv1:t(c[0],c[1],3,l+"/conv1"),prelu1_alpha:o(c[1],l+"/prelu1_alpha"),conv2:t(c[1],c[2],3,l+"/conv2"),prelu2_alpha:o(c[2],l+"/prelu2_alpha"),conv3:t(c[2],c[3],d?2:3,l+"/conv3"),prelu3_alpha:o(c[3],l+"/prelu3_alpha")}}return{extractPNetParams:function a(){var c=i([3,10,16,32],"pnet"),l=t(32,2,1,"pnet/conv4_1"),d=t(32,4,1,"pnet/conv4_2");return er(er({},c),{conv4_1:l,conv4_2:d})},extractRNetParams:function s(){var c=i([3,28,48,64],"rnet",!0),l=r(576,128,"rnet/fc1"),d=o(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return er(er({},c),{fc1:l,prelu4_alpha:d,fc2_1:f,fc2_2:h})},extractONetParams:function u(){var c=i([3,32,64,64],"onet"),l=t(64,128,2,"onet/conv4"),d=o(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),h=o(256,"onet/prelu5_alpha"),p=r(256,2,"onet/fc2_1"),m=r(256,4,"onet/fc2_2"),v=r(256,10,"onet/fc2_3");return er(er({},c),{conv4:l,prelu4_alpha:d,fc1:f,prelu5_alpha:h,fc2_1:p,fc2_2:m,fc2_3:v})}}}(n.extractWeights,o),s=i.extractRNetParams,u=i.extractONetParams,c=(0,i.extractPNetParams)(),l=s(),d=u();if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:c,rnet:l,onet:d},paramMappings:o}}(t)},n}(aa),lZ=[new xt(1.603231,2.094468),new xt(6.041143,7.080126),new xt(2.882459,3.518061),new xt(4.266906,5.178857),new xt(9.041765,10.66308)],dZ=[117.001,114.697,97.404],fZ=function(e){function n(){return e.call(this,{withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:lZ,meanRgb:dZ,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]})||this}return ke(n,e),Object.defineProperty(n.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),n.prototype.locateFaces=function(t,r){return me(this,void 0,void 0,function(){return ve(this,function(i){switch(i.label){case 0:return[4,this.detect(t,r)];case 1:return[2,i.sent().map(function(a){return new vi(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},n.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},n.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},n}(ZF),qe={ssdMobilenetv1:new YF,tinyFaceDetector:new fZ,tinyYolov2:new qY,mtcnn:new uZ,faceLandmark68Net:new $F,faceLandmark68TinyNet:new fY,faceRecognitionNet:new wY,faceExpressionNet:new YK,ageGenderNet:new uY};function tP(e,n){return Object.assign({},e,{age:n})}var nP=function(e){function n(t,r,o){var i=e.call(this)||this;return i.parentTask=t,i.input=r,i.extractedFaces=o,i}return ke(n,e),n}(Vf),TC=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.run=function(){return me(this,void 0,void 0,function(){var t,r,o=this;return ve(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return[4,Rm(t=i.sent(),this.input,function(a){return me(o,void 0,void 0,function(){return ve(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return qe.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,t.map(function(a,s){return HF(a,r[s])})]}})})},n.prototype.withAgeAndGender=function(){return new FC(this,this.input)},n}(nP),RC=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.run=function(){return me(this,void 0,void 0,function(){var t,r;return ve(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return(t=o.sent())?[4,IC(t,this.input,function(i){return qe.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,HF(t,r)]}})})},n.prototype.withAgeAndGender=function(){return new PC(this,this.input)},n}(nP),NC=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.withAgeAndGender=function(){return new OC(this,this.input)},n.prototype.withFaceDescriptors=function(){return new BC(this,this.input)},n}(TC),kC=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.withAgeAndGender=function(){return new LC(this,this.input)},n.prototype.withFaceDescriptor=function(){return new VC(this,this.input)},n}(RC),rP=function(e){function n(t,r,o){var i=e.call(this)||this;return i.parentTask=t,i.input=r,i.extractedFaces=o,i}return ke(n,e),n}(Vf),FC=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.run=function(){return me(this,void 0,void 0,function(){var t,r,o=this;return ve(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return[4,Rm(t=i.sent(),this.input,function(a){return me(o,void 0,void 0,function(){return ve(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return qe.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,t.map(function(a,s){var u=r[s],c=u.age;return tP(XF(a,u.gender,u.genderProbability),c)})]}})})},n.prototype.withFaceExpressions=function(){return new TC(this,this.input)},n}(rP),PC=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.run=function(){return me(this,void 0,void 0,function(){var t,r,o;return ve(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return(t=s.sent())?[4,IC(t,this.input,function(u){return qe.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,[2,tP(XF(t,r.gender,r.genderProbability),o)]}})})},n.prototype.withFaceExpressions=function(){return new RC(this,this.input)},n}(rP),OC=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.withFaceExpressions=function(){return new NC(this,this.input)},n.prototype.withFaceDescriptors=function(){return new BC(this,this.input)},n}(FC),LC=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.withFaceExpressions=function(){return new kC(this,this.input)},n.prototype.withFaceDescriptor=function(){return new VC(this,this.input)},n}(PC),oP=function(e){function n(t,r){var o=e.call(this)||this;return o.parentTask=t,o.input=r,o}return ke(n,e),n}(Vf),BC=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.run=function(){return me(this,void 0,void 0,function(){var t;return ve(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return[4,Rm(t=o.sent(),this.input,function(i){return Promise.all(i.map(function(a){return qe.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return[2,o.sent().map(function(i,a){return QF(t[a],i)})]}})})},n.prototype.withFaceExpressions=function(){return new NC(this,this.input)},n.prototype.withAgeAndGender=function(){return new OC(this,this.input)},n}(oP),VC=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.run=function(){return me(this,void 0,void 0,function(){var t,r;return ve(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return(t=o.sent())?[4,IC(t,this.input,function(i){return qe.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,QF(t,r)]}})})},n.prototype.withFaceExpressions=function(){return new kC(this,this.input)},n.prototype.withAgeAndGender=function(){return new LC(this,this.input)},n}(oP),iP=function(e){function n(t,r,o){var i=e.call(this)||this;return i.parentTask=t,i.input=r,i.useTinyLandmarkNet=o,i}return ke(n,e),Object.defineProperty(n.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?qe.faceLandmark68TinyNet:qe.faceLandmark68Net},enumerable:!0,configurable:!0}),n}(Vf),hZ=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.run=function(){return me(this,void 0,void 0,function(){var t,r,o,i,a,s=this;return ve(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return t=u.sent(),r=t.map(function(c){return c.detection}),this.input instanceof kt?[4,gC(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,pC(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(c){return s.landmarkNet.detectLandmarks(c)}))];case 6:return a=u.sent(),o.forEach(function(c){return c instanceof kt&&c.dispose()}),[2,t.map(function(c,l){return bC(c,a[l])})]}})})},n.prototype.withFaceExpressions=function(){return new NC(this,this.input)},n.prototype.withAgeAndGender=function(){return new OC(this,this.input)},n.prototype.withFaceDescriptors=function(){return new BC(this,this.input)},n}(iP),pZ=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.run=function(){return me(this,void 0,void 0,function(){var t,r,o,i,a;return ve(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return(t=s.sent())?(r=t.detection,this.input instanceof kt?[4,gC(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,pC(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return[4,this.landmarkNet.detectLandmarks((o=i)[0])];case 6:return a=s.sent(),o.forEach(function(u){return u instanceof kt&&u.dispose()}),[2,bC(t,a)]}})})},n.prototype.withFaceExpressions=function(){return new kC(this,this.input)},n.prototype.withAgeAndGender=function(){return new LC(this,this.input)},n.prototype.withFaceDescriptor=function(){return new VC(this,this.input)},n}(iP),aP=function(e){function n(t,r){void 0===r&&(r=new Am);var o=e.call(this)||this;return o.input=t,o.options=r,o}return ke(n,e),n}(Vf),gZ=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.run=function(){return me(this,void 0,void 0,function(){var t,r,o,i;return ve(this,function(a){switch(a.label){case 0:return r=(t=this).input,(o=t.options)instanceof KF?[4,qe.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(!(i=o instanceof Tm?function(s){return qe.tinyFaceDetector.locateFaces(s,o)}:o instanceof Am?function(s){return qe.ssdMobilenetv1.locateFaces(s,o)}:o instanceof EC?function(s){return qe.tinyYolov2.locateFaces(s,o)}:null))throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},n.prototype.runAndExtendWithFaceDetections=function(){var t=this;return new Promise(function(r){return me(t,void 0,void 0,function(){var o;return ve(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return cC({},a)}))]}})})})},n.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new hZ(this.runAndExtendWithFaceDetections(),this.input,t)},n.prototype.withFaceExpressions=function(){return new TC(this.runAndExtendWithFaceDetections(),this.input)},n.prototype.withAgeAndGender=function(){return new FC(this.runAndExtendWithFaceDetections(),this.input)},n}(aP),mZ=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return ke(n,e),n.prototype.run=function(){return me(this,void 0,void 0,function(){var t,r;return ve(this,function(o){switch(o.label){case 0:return[4,new gZ(this.input,this.options)];case 1:return t=o.sent(),r=t[0],t.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},n.prototype.runAndExtendWithFaceDetection=function(){var t=this;return new Promise(function(r){return me(t,void 0,void 0,function(){var o;return ve(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?cC({},o):void 0)]}})})})},n.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new pZ(this.runAndExtendWithFaceDetection(),this.input,t)},n.prototype.withFaceExpressions=function(){return new RC(this.runAndExtendWithFaceDetection(),this.input)},n.prototype.withAgeAndGender=function(){return new PC(this.runAndExtendWithFaceDetection(),this.input)},n}(aP);function UC(e,n){return void 0===n&&(n=new Am),new mZ(e,n)}var yZ=function(){function e(n,t){void 0===t&&(t=.6),this._distanceThreshold=t;var r=Array.isArray(n)?n:[n];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof Bf)return a;if(a instanceof Float32Array)return new Bf(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new Bf(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(n,t){return t.map(function(r){return function vZ(e,n){if(e.length!==n.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var t=Array.from(e),r=Array.from(n);return Math.sqrt(t.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}(r,n)}).reduce(function(r,o){return r+o},0)/(t.length||1)},e.prototype.matchDescriptor=function(n){var t=this;return this.labeledDescriptors.map(function(r){return new CF(r.label,t.computeMeanDistance(n,r.descriptors))}).reduce(function(r,o){return r.distance<o.distance?r:o})},e.prototype.findBestMatch=function(n){var t=this.matchDescriptor(n);return t.distance<this.distanceThreshold?t:new CF("unknown",t.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(n){return n.toJSON()})}},e.fromJSON=function(n){return new e(n.labeledDescriptors.map(function(r){return Bf.fromJSON(r)}),n.distanceThreshold)},e}();const Fm_urlServer="http://10.124.0.3:3000";let bZ=(()=>{class e{constructor(){this.auth="autorizado"}accesoPassword(t){"unknown"!=t&&(localStorage.setItem("id",t),localStorage.setItem("usuario",this.auth),location.href="/#/acceso-password")}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),xZ=(()=>{class e{constructor(t,r,o){this.http=t,this.router=r,this.acessSvc=o,this.imageDescriptors=[]}processFace(t,r){var o=this;return Nc(function*(){yield qe.tinyFaceDetector.loadFromUri("/assets/models"),yield qe.faceLandmark68Net.loadFromUri("/assets/models"),yield qe.faceRecognitionNet.loadFromUri("/assets/models");const i=yield UC(t,new Tm).withFaceLandmarks().withFaceDescriptor();typeof i>"u"||(o.imageDescriptors.push({id:r,detection:i}),o.faceMatcher=new yZ(o.imageDescriptors.map(a=>new Bf(a.id.toString(),[a.detection.descriptor]))))})()}descriptor(t){const r=this.faceMatcher.findBestMatch(t.descriptor);this.idImage=r.label,this.passwordImg(this.idImage)}passwordImg(t){this.acessSvc.accesoPassword(t)}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Pd),fe(Ln),fe(bZ))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ca=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["app-footer"]],decls:7,vars:0,consts:[[1,"d-grid","gap-1","text-center","mt-5"],["href","https://shaades.com/","target","_blank","rel","noopener noreferrer",1,"text-highlight"]],template:function(r,o){1&r&&(W(0,"div",0)(1,"p"),K(2,"Copyright \xa9 2024 Shaades Inc"),z(),W(3,"p"),K(4,"Desarrollado por "),W(5,"a",1),K(6,"Shaades Inc"),z()()())}})}return e})();const CZ=["videoContainer"],_Z=["myCanvas"],sP=Fm_urlServer;let DZ=(()=>{class e{constructor(t,r){var o=this;this.http=t,this.processFacesSvc=r,this.imagenes=[],this.main=Nc(function*(){o.context=o.myCanvas.nativeElement.getContext("2d");let i=yield navigator.mediaDevices.getUserMedia({video:!0});yield qe.tinyFaceDetector.loadFromUri("/assets/models"),yield qe.faceLandmark68Net.loadFromUri("/assets/models"),yield qe.faceRecognitionNet.loadFromUri("/assets/models"),o.imagesLista(),o.videoContainer.nativeElement.srcObject=i;const a=function(){var u=Nc(function*(){o.context.drawImage(o.videoContainer.nativeElement,0,0,640,480),requestAnimationFrame(a)});return function(){return u.apply(this,arguments)}}();setInterval(function(){var u=Nc(function*(){const c=yield UC(o.myCanvas.nativeElement,new Tm).withFaceLandmarks().withFaceDescriptor();typeof c>"u"||o.processFacesSvc.descriptor(c)});return function(){return u.apply(this,arguments)}}(),2e3),requestAnimationFrame(a)})}ngOnInit(){}detectar(){this.main()}removeVideo(){location.reload()}imagesLista(){this.http.get(`${sP}/upload`).subscribe(t=>{this.imagenes=t,this.imagenes.forEach(r=>{const o=document.createElement("img");o.src=`${sP}/${r.imagen}`,o.crossOrigin="anonymous",this.processFacesSvc.processFace(o,r.id)})})}static#e=this.\u0275fac=function(r){return new(r||e)(te(Pd),te(xZ))};static#t=this.\u0275cmp=In({type:e,selectors:[["app-login"]],viewQuery:function(r,o){if(1&r&&(Sp(CZ,7),Sp(_Z,7)),2&r){let i;Dd(i=Ed())&&(o.videoContainer=i.first),Dd(i=Ed())&&(o.myCanvas=i.first)}},decls:15,vars:0,consts:[[1,"container"],[1,"row"],[1,"col"],[1,"col-lg-4",2,"margin-top","150px"],[1,"card","text-white","bg-dark","mb-1"],[1,"card-header","bg-dark"],["autoplay","","mute","",2,"position","absolute","top","0","visibility","hidden","left","0","opacity","0","width","640","height","480"],["videoContainer",""],["width","640","height","480"],["myCanvas",""],["type","button",1,"btn","btn-danger","col-12",3,"click"]],template:function(r,o){1&r&&(W(0,"div",0)(1,"div",1),Ue(2,"div",2),W(3,"div",3)(4,"div",4)(5,"div",5),K(6,"Camara de Identificacion"),z(),Ue(7,"video",6,7)(9,"canvas",8,9),z(),W(11,"button",10),On("click",function(){return o.detectar()}),K(12,"Detectar rostro"),z()(),Ue(13,"div",2),z()(),Ue(14,"app-footer"))},dependencies:[ca]})}return e})();var EZ=Xt(519),tl=Xt.n(EZ);const uP=Fm_urlServer;let IZ=(()=>{class e{constructor(t){this.http=t}usuarioData(t){return this.http.get(`${uP}/imagen/${t}`)}login(t,r){return this.http.post(`${uP}/auth/${t}`,r)}static#e=this.\u0275fac=function(r){return new(r||e)(fe(Pd))};static#t=this.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const SZ=Fm_urlServer;let AZ=(()=>{class e{constructor(t,r){this.usuarioSvc=t,this.router=r,this.usuario={password:"12345678"}}ngOnInit(){this.obtenerImg()}obtenerImg(){this.idUser=localStorage.getItem("id"),this.usuarioSvc.usuarioData(this.idUser).subscribe(t=>{this.image=t,this.imageUser=`${SZ}/${this.image.imagen}`,this.imageUsername=this.image.username})}accesoPassword(t){this.idUser=localStorage.getItem("id"),this.usuarioSvc.login(this.idUser,t.value).subscribe(r=>{localStorage.removeItem("usuario"),localStorage.setItem("user","reautorizado"),this.router.navigateByUrl("/upload-files")},r=>{tl().fire("ERROR",r.error.message,"error")})}btnVolver(){localStorage.removeItem("id"),localStorage.removeItem("usuario"),this.router.navigateByUrl("/")}static#e=this.\u0275fac=function(r){return new(r||e)(te(IZ),te(Ln))};static#t=this.\u0275cmp=In({type:e,selectors:[["app-acceso-password"]],decls:21,vars:5,consts:[[1,"container"],[1,"row"],[1,"col-4"],[1,"col-4",2,"margin-top","90px"],[1,"card"],[1,"card-header","bg-dark","text-white"],["alt","",1,"img-card-top",3,"src"],[1,"card-body"],[1,"text-center",3,"ngSubmit"],["forma","ngForm"],["type","password","placeholder","Password","name","password","required","",1,"form-control",3,"ngModel"],["password","ngModel"],["type","button",1,"btn","btn-warning","mx-1",3,"click"],["type","submit",1,"btn","btn-secondary","mx-1"]],template:function(r,o){if(1&r){const i=function PE(){return Z()}();W(0,"div",0)(1,"div",1),Ue(2,"div",2),W(3,"div",3)(4,"div",4)(5,"div",5),K(6," Bienvenido: "),Ue(7,"br"),K(8),z(),Ue(9,"img",6),W(10,"div",7)(11,"form",8,9),On("ngSubmit",function(){!function P1(e){return Ie.lFrame.contextLView=e,e[Yt]}(i);const s=function RE(e){return function Mu(e,n){return e[n]}(function jP(){return Ie.lFrame.contextLView}(),He+e)}(12);return function O1(e){return Ie.lFrame.contextLView=null,e}(o.accesoPassword(s))}),Ue(13,"input",10,11)(15,"br"),W(16,"button",12),On("click",function(){return o.btnVolver()}),K(17,"Volver"),z(),W(18,"button",13),K(19,"Acceder"),z()()()()(),Ue(20,"div",2),z()()}2&r&&(We(8),bp(" ",o.imageUsername," "),We(1),Je("height","300","px"),vw("src",o.imageUser,Xh),We(4),Xn("ngModel",o.usuario.password))},dependencies:[ui,tg,lM,si,pg,Yb,xo]})}return e})();const MZ=["imagesList"],Pm=Fm_urlServer;let TZ=(()=>{class e{constructor(t,r,o){this.http=t,this.router=r,this.renderer=o,this.images="",this.imgURL="/assets/noimage.png",this.imagenes=[],this.btnActive=!0,this.imgProcess=[],this.processFace=function(){var i=Nc(function*(a,s,u){yield qe.tinyFaceDetector.loadFromUri("/assets/models"),yield qe.faceLandmark68Net.loadFromUri("/assets/models"),yield qe.faceRecognitionNet.loadFromUri("/assets/models"),typeof(yield UC(a,new Tm).withFaceLandmarks().withFaceDescriptor())>"u"?s.querySelector(".status").innerText="No se puede procesar":s.querySelector(".status").innerText="Procesado"});return function(a,s,u){return i.apply(this,arguments)}}()}ngOnInit(){this.mostrarImg()}selectImage(t){if(t.target.files.length>0){const r=t.target.files[0],o=new FileReader;o.readAsDataURL(r),o.onload=i=>{this.imgURL=i.target.result},this.images=r,this.btnActive=!1}}mostrarImg(){var t=this;this.http.get(`${Pm}/upload`).subscribe(r=>{this.imagenes=r,this.imagenes.forEach(function(){var o=Nc(function*(i){var a=document.createElement("div"),s=document.createElement("a"),u=document.createElement("img"),c=document.createElement("div"),l=document.createElement("i");l.classList.add("fas"),l.classList.add("fa-3x"),l.classList.add("fa-spinner"),l.classList.add("fa-pulse"),a.classList.add("imageContainer"),s.classList.add("cerrar"),u.classList.add("card-img-top"),u.classList.add("imageElement"),u.src=`${Pm}/${i.imagen}`,u.crossOrigin="anonymous",s.innerText="X",c.classList.add("status"),t.imgProcess=u,c.appendChild(l),a.appendChild(s),a.appendChild(c),a.appendChild(u),s.addEventListener("click",d=>{d.preventDefault(),t.deleteImg(i.id)}),t.renderer.appendChild(t.imagesList.nativeElement,a),t.processFace(t.imgProcess,a,i.id)});return function(i){return o.apply(this,arguments)}}())})}onSubmit(){tl().fire({title:"Introducir Nombre y Apellido",input:"text",inputAttributes:{autocapitalize:"off"},showCancelButton:!0,confirmButtonText:"Guardar"}).then(t=>{if(t.isConfirmed&&t.value){let r=new FormData;r.append("file",this.images),r.append("username",t.value),r.append("password","12345678"),this.http.post(`${Pm}/file`,r).subscribe(o=>{tl().fire({icon:"success",title:"Imagen Cargada",text:"La imagen se subio correctamente"}).then(()=>{t&&location.reload()})})}else tl().fire("Error","Debe llenar el password","error")})}deleteImg(t){tl().fire({icon:"info",title:"Desea Eliminar esta imagen?",confirmButtonText:"Eliminar"}).then(r=>{r.isConfirmed&&this.http.delete(`${Pm}/delete/${t}`).subscribe(o=>{tl(),location.reload()})})}logout(){localStorage.removeItem("id"),localStorage.removeItem("user"),this.router.navigateByUrl("/")}static#e=this.\u0275fac=function(r){return new(r||e)(te(Pd),te(Ln),te(Jo))};static#t=this.\u0275cmp=In({type:e,selectors:[["app-upload-files"]],viewQuery:function(r,o){if(1&r&&Sp(MZ,7),2&r){let i;Dd(i=Ed())&&(o.imagesList=i.first)}},decls:24,vars:2,consts:[[2,"text-align","center"],[1,"container"],[1,"row"],[1,"col-md-5"],[1,"card","text-white","bg-dark"],[1,"card-header","bg-secondary"],[1,"card-body"],[1,"card-img-top",3,"src"],[2,"border-color","azure"],[3,"ngSubmit"],[1,"form-group"],["type","file","accept","image/*","name","image",1,"form-control-file",3,"change"],["type","submit",1,"btn","btn-outline-secondary",3,"disabled"],[1,"col-md-7"],[1,"card"],[1,"images-list"],["imagesList",""]],template:function(r,o){1&r&&(W(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),K(6,"Subir Imagen"),z(),W(7,"div",6),Ue(8,"img",7)(9,"hr",8),W(10,"form",9),On("ngSubmit",function(){return o.onSubmit()}),W(11,"div",10)(12,"input",11),On("change",function(a){return o.selectImage(a)}),z(),Ue(13,"br"),W(14,"button",12),K(15,"Upload"),z()()()()()(),W(16,"div",13)(17,"div",14)(18,"div",4)(19,"div",5),K(20,"Rostro Procesados"),z(),W(21,"div",6),Ue(22,"div",15,16),z()()()()()()()),2&r&&(We(8),Xn("src",o.imgURL,Xh),We(6),Xn("disabled",o.btnActive))},dependencies:[ui,si,xo]})}return e})(),kZ=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["app-login"]],decls:16,vars:10,consts:[[1,"d-flex","align-items-center","align-self-center","justify-content-center"],[1,"d-flex","flex-column"],[1,"mb-2"],[1,"mb-3"],["for","email",1,"form-label"],["type","email","id","email","placeholder","Email",1,"form-control"],["for","password",1,"form-label"],["type","password","id","password","placeholder","Contrase\xf1a",1,"form-control"],["type","submit",1,"btn","btn-primary","mt-2"],["type","submit",1,"btn","btn-transparent"]],template:function(r,o){1&r&&(W(0,"div",0)(1,"div",1)(2,"form",2)(3,"div",3)(4,"label",4),K(5,"Email"),z(),Ue(6,"input",5),z(),W(7,"div",3)(8,"label",6),K(9,"Contrase\xf1a"),z(),Ue(10,"input",7),z(),W(11,"button",8),K(12,"INICIAR"),z()(),W(13,"button",9),K(14,"OLVID\xc9 MI CONTRASE\xd1A"),z(),Ue(15,"app-footer"),z()()),2&r&&(Je("height","90","vh"),We(3),Je("width","374","px"),We(4),Je("width","374","px"),We(4),Je("width","374","px"),We(2),Je("width","374","px"))},dependencies:[ui,si,xo,ca]})}return e})(),FZ=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["app-register"]],decls:18,vars:10,consts:[[1,"d-flex","align-items-center","align-self-center","justify-content-center"],[1,"d-flex","flex-column"],[1,"mb-3"],["for","company",1,"form-label"],["type","company","id","company","placeholder","Nombre empresa",1,"form-control"],["for","email",1,"form-label"],["type","email","id","email","placeholder","Email",1,"form-control"],["for","password",1,"form-label"],["type","password","id","password","placeholder","Contrase\xf1a",1,"form-control"],["type","submit",1,"btn","btn-primary"]],template:function(r,o){1&r&&(W(0,"div",0)(1,"div",1)(2,"form")(3,"div",2)(4,"label",3),K(5,"Nombre empresa"),z(),Ue(6,"input",4),z(),W(7,"div",2)(8,"label",5),K(9,"Email"),z(),Ue(10,"input",6),z(),W(11,"div",2)(12,"label",7),K(13,"Contrase\xf1a"),z(),Ue(14,"input",8),z(),W(15,"button",9),K(16,"INICIAR"),z()(),Ue(17,"app-footer"),z()()),2&r&&(Je("height","90","vh"),We(3),Je("width","374","px"),We(4),Je("width","374","px"),We(4),Je("width","374","px"),We(4),Je("width","374","px"))},dependencies:[ui,si,xo,ca]})}return e})(),PZ=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["app-user"]],decls:29,vars:8,consts:[[1,"d-flex","align-items-center","align-self-center","justify-content-center"],[1,"d-flex","flex-column"],[1,"text-center","mb-4"],["src","https://asistencia.shaades.com/wp-content/plugins/elementor/assets/images/placeholder.png",1,"rounded-circle","mb-3"],[1,"mb-1"],[1,"mb-4"],["id","sucursal",1,"form-select"],[1,"d-grid","gap-1","text-center"],[1,"text-primary","font-weight-bold"]],template:function(r,o){1&r&&(W(0,"div",0)(1,"div",1)(2,"div",2),Ue(3,"img",3),W(4,"p",4),K(5,"Nombre empresa"),z(),W(6,"p",4),K(7,"Email"),z()(),W(8,"form",5)(9,"div")(10,"select",6)(11,"option"),K(12,"SUCURSALES ACTIVAS"),z(),W(13,"option"),K(14,"SUCURSALES INACTIVAS"),z()()()(),W(15,"div",7)(16,"p",8),K(17,"AGREGAR SUCURSAL"),z(),W(18,"p"),K(19,"Nombre de la sucursal XX"),z(),W(20,"p"),K(21,"Nombre de la sucursal XX"),z(),W(22,"p"),K(23,"Nombre de la sucursal XX"),z(),W(24,"p"),K(25,"Nombre de la sucursal XX"),z(),W(26,"p"),K(27,"Nombre de la sucursal XX"),z()(),Ue(28,"app-footer"),z()()),2&r&&(Je("height","90","vh"),We(3),Je("height","100","px")("width","100","px"),We(6),Je("width","374","px"))},dependencies:[ui,fg,hg,si,xo,ca]})}return e})(),OZ=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["app-sucursal"]],decls:29,vars:8,consts:[[1,"d-flex","align-items-center","align-self-center","justify-content-center"],[1,"d-flex","flex-column"],[1,"text-center","mb-4"],["src","https://asistencia.shaades.com/wp-content/plugins/elementor/assets/images/placeholder.png",1,"rounded-circle","mb-3"],[1,"mb-3"],[1,"mb-1","text-primary"],[1,"mb-4"],["id","sucursal",1,"form-select"],[1,"d-grid","gap-1","text-center"],[1,"text-primary","font-weight-bold"]],template:function(r,o){1&r&&(W(0,"div",0)(1,"div",1)(2,"div",2),Ue(3,"img",3),W(4,"p",4),K(5,"Nombre de la sucursal XX"),z(),W(6,"p",5),K(7,"VER QR"),z()(),W(8,"form",6)(9,"div")(10,"select",7)(11,"option"),K(12,"COLABORADORES ACTIVAS"),z(),W(13,"option"),K(14,"COLABORADORES INACTIVAS"),z()()()(),W(15,"div",8)(16,"p",9),K(17,"AGREGAR COLABORADOR"),z(),W(18,"p"),K(19,"Nombre Colaborador XX"),z(),W(20,"p"),K(21,"Nombre Colaborador XX"),z(),W(22,"p"),K(23,"Nombre Colaborador XX"),z(),W(24,"p"),K(25,"Nombre Colaborador XX"),z(),W(26,"p"),K(27,"Nombre Colaborador XX"),z()(),Ue(28,"app-footer"),z()()),2&r&&(Je("height","90","vh"),We(3),Je("height","100","px")("width","100","px"),We(6),Je("width","374","px"))},dependencies:[ui,fg,hg,si,xo,ca]})}return e})();const LZ=function(){return["/login"]},BZ=function(){return["/register"]},VZ=[{path:"",component:(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["app-home"]],decls:8,vars:10,consts:[[1,"d-flex","align-items-center","align-self-center","justify-content-center"],[1,"d-flex","flex-column"],[1,"d-grid","gap-4"],["type","button",1,"btn","btn-primary",3,"routerLink"],["type","button",1,"btn","btn-secondary",3,"routerLink"]],template:function(r,o){1&r&&(W(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),K(4,"INICIAR"),z(),W(5,"button",4),K(6,"CREAR CUENTA"),z()(),Ue(7,"app-footer"),z()()),2&r&&(Je("height","90","vh"),We(3),Je("width","374","px"),Xn("routerLink",yo(8,LZ)),We(2),Je("width","374","px"),Xn("routerLink",yo(9,BZ)))},dependencies:[rf,ca]})}return e})()},{path:"loginapi",component:DZ},{path:"login",component:kZ},{path:"register",component:FZ},{path:"user",component:PZ},{path:"sucursal",component:OZ},{path:"sucursal-add",component:(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["app-sucursal-add"]],decls:18,vars:12,consts:[[1,"d-flex","align-items-center","align-self-center","justify-content-center"],[1,"d-flex","flex-column"],[1,"text-center","mb-4"],["src","https://asistencia.shaades.com/wp-content/plugins/elementor/assets/images/placeholder.png",1,"rounded-circle","mb-3"],[1,"mb-1","text-primary"],[1,"mb-4"],[1,"mb-3"],["for","colaborador",1,"form-label"],["type","text","id","colaborador","placeholder","NOMBRE SUCURSAL",1,"form-control"],["for","identficacion",1,"form-label"],["type","company","id","identficacion","placeholder","UBICACION",1,"form-control"],["type","submit",1,"btn","btn-primary"]],template:function(r,o){1&r&&(W(0,"div",0)(1,"div",1)(2,"div",2),Ue(3,"img",3),W(4,"p",4),K(5,"AGREGAR IMAGEN"),z()(),W(6,"form",5)(7,"div",6)(8,"label",7),K(9,"Agregar nombre de sucursal"),z(),Ue(10,"input",8),z(),W(11,"div",6)(12,"label",9),K(13,"Agregar ubicaci\xf3n"),z(),Ue(14,"input",10),z(),W(15,"button",11),K(16,"CREAR"),z()(),Ue(17,"app-footer"),z()()),2&r&&(Je("height","90","vh"),We(3),Je("height","100","px")("width","100","px"),We(4),Je("width","374","px"),We(4),Je("width","374","px"),We(4),Je("width","374","px"))},dependencies:[ui,si,xo,ca]})}return e})()},{path:"colaborador",component:(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["app-colaborador"]],decls:22,vars:14,consts:[[1,"d-flex","align-items-center","align-self-center","justify-content-center"],[1,"d-flex","flex-column"],[1,"text-center","mb-4"],["src","https://asistencia.shaades.com/wp-content/plugins/elementor/assets/images/placeholder.png",1,"rounded-circle","mb-3"],[1,"mb-1","text-primary"],[1,"mb-4"],[1,"mb-3"],["for","colaborador",1,"form-label"],["type","text","id","colaborador","placeholder","COLABORADOR",1,"form-control"],["for","nacimiento",1,"form-label"],["type","date","id","nacimiento","placeholder","Fecha de Nacimiento",1,"form-control"],["for","identficacion",1,"form-label"],["type","company","id","identficacion","placeholder","UBICACION",1,"form-control"],["type","submit",1,"btn","btn-primary"]],template:function(r,o){1&r&&(W(0,"div",0)(1,"div",1)(2,"div",2),Ue(3,"img",3),W(4,"p",4),K(5,"AGREGAR IMAGEN"),z()(),W(6,"form",5)(7,"div",6)(8,"label",7),K(9,"Nombre Colaborador"),z(),Ue(10,"input",8),z(),W(11,"div",6)(12,"label",9),K(13,"Fecha de Nacimiento"),z(),Ue(14,"input",10),z(),W(15,"div",6)(16,"label",11),K(17,"N\xb0 de Identificaci\xf3n"),z(),Ue(18,"input",12),z(),W(19,"button",13),K(20,"CREAR"),z()(),Ue(21,"app-footer"),z()()),2&r&&(Je("height","90","vh"),We(3),Je("height","100","px")("width","100","px"),We(4),Je("width","374","px"),We(4),Je("width","374","px"),We(4),Je("width","374","px"),We(4),Je("width","374","px"))},dependencies:[ui,si,xo,ca]})}return e})()},{path:"asistencia",component:(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["app-asistencia"]],decls:118,vars:8,consts:[[1,"d-flex","align-items-center","align-self-center","justify-content-center"],[1,"d-flex","flex-column"],[1,"text-center","mb-4"],["src","https://asistencia.shaades.com/wp-content/plugins/elementor/assets/images/placeholder.png",1,"rounded-circle","mb-3"],[1,"mb-1"],[1,"mb-3"],[1,"mb-4"],["id","sucursal",1,"form-select"],[1,"text-center","fs-6","border-bottom","py-2"],[1,"fw-bold"]],template:function(r,o){1&r&&(W(0,"div",0)(1,"div",1)(2,"div",2),Ue(3,"img",3),W(4,"p",4),K(5,"Nombre Colaborador"),z(),W(6,"p",4),K(7,"Edad"),z(),W(8,"p",5),K(9,"N\xb0 de Identificaci\xf3n"),z()(),W(10,"form",6)(11,"div")(12,"select",7)(13,"option"),K(14,"FILTRAR FECHA"),z(),W(15,"option"),K(16,"DD/MM/AA"),z(),W(17,"option"),K(18,"DD/MM/AA"),z(),W(19,"option"),K(20,"DD/MM/AA"),z(),W(21,"option"),K(22,"DD/MM/AA"),z(),W(23,"option"),K(24,"DD/MM/AA"),z()()()(),W(25,"div",8)(26,"div",9),K(27,"DD/MM/AA"),z(),W(28,"div"),K(29,"ENTRADA "),W(30,"span",9),K(31,"HH:MM"),z()(),W(32,"div"),K(33,"INICIA DESCANSO "),W(34,"span",9),K(35,"HH:MM"),z()(),W(36,"div"),K(37,"TERMINA DESCANSO "),W(38,"span",9),K(39,"HH:MM"),z()(),W(40,"div"),K(41,"SALIDA "),W(42,"span",9),K(43,"HH:MM"),z()(),W(44,"div"),K(45,"VALIDACION CORRECTA"),z(),W(46,"div"),K(47,"VER IMAGEN"),z()(),W(48,"div",8)(49,"div",9),K(50,"DD/MM/AA"),z(),W(51,"div"),K(52,"ENTRADA "),W(53,"span",9),K(54,"HH:MM"),z()(),W(55,"div"),K(56,"INICIA DESCANSO "),W(57,"span",9),K(58,"HH:MM"),z()(),W(59,"div"),K(60,"TERMINA DESCANSO "),W(61,"span",9),K(62,"HH:MM"),z()(),W(63,"div"),K(64,"SALIDA "),W(65,"span",9),K(66,"HH:MM"),z()(),W(67,"div"),K(68,"VALIDACION CORRECTA"),z(),W(69,"div"),K(70,"VER IMAGEN"),z()(),W(71,"div",8)(72,"div",9),K(73,"DD/MM/AA"),z(),W(74,"div"),K(75,"ENTRADA "),W(76,"span",9),K(77,"HH:MM"),z()(),W(78,"div"),K(79,"INICIA DESCANSO "),W(80,"span",9),K(81,"HH:MM"),z()(),W(82,"div"),K(83,"TERMINA DESCANSO "),W(84,"span",9),K(85,"HH:MM"),z()(),W(86,"div"),K(87,"SALIDA "),W(88,"span",9),K(89,"HH:MM"),z()(),W(90,"div"),K(91,"VALIDACION CORRECTA"),z(),W(92,"div"),K(93,"VER IMAGEN"),z()(),W(94,"div",8)(95,"div",9),K(96,"DD/MM/AA"),z(),W(97,"div"),K(98,"ENTRADA "),W(99,"span",9),K(100,"HH:MM"),z()(),W(101,"div"),K(102,"INICIA DESCANSO "),W(103,"span",9),K(104,"HH:MM"),z()(),W(105,"div"),K(106,"TERMINA DESCANSO "),W(107,"span",9),K(108,"HH:MM"),z()(),W(109,"div"),K(110,"SALIDA "),W(111,"span",9),K(112,"HH:MM"),z()(),W(113,"div"),K(114,"VALIDACION CORRECTA"),z(),W(115,"div"),K(116,"VER IMAGEN"),z()(),Ue(117,"app-footer"),z()()),2&r&&(Je("height","90","vh"),We(3),Je("height","100","px")("width","100","px"),We(8),Je("width","374","px"))},dependencies:[ui,fg,hg,si,xo,ca]})}return e})()},{path:"acceso-password",component:AZ,canActivate:[(e,n)=>{const t=ie(Ln);return!!localStorage.getItem("usuario")||(t.navigateByUrl("/"),!1)}]},{path:"upload-files",component:TZ,canActivate:[(e,n)=>{const t=ie(Ln);return!!localStorage.getItem("user")||(t.navigateByUrl("/"),!1)}]},{path:"**",pathMatch:"full",redirectTo:"login"}];let UZ=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Hr({type:e});static#n=this.\u0275inj=ur({imports:[A0.forRoot(VZ),A0]})}return e})();const jZ=function(){return["/colaborador"]},HZ=function(){return["/sucursal-add"]},WZ=function(){return["/"]},zZ=function(){return["/login"]},$Z=function(){return["/sucursal"]},GZ=function(){return["/user"]},qZ=function(){return["/register"]},XZ=function(){return["/asistencia"]},KZ=function(){return["/loginapi"]};let YZ=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["app-header"]],decls:40,vars:20,consts:[[1,"navbar","bg-body-tertiary"],[1,"container-fluid"],[1,"navbar-brand","font-weight-bold"],["type","button","data-bs-toggle","offcanvas","data-bs-target","#offcanvasNavbar","aria-controls","offcanvasNavbar","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["tabindex","-1","id","offcanvasNavbar","aria-labelledby","offcanvasNavbarLabel",1,"offcanvas","offcanvas-end"],[1,"offcanvas-header"],["id","offcanvasNavbarLabel",1,"offcanvas-title"],["type","button","data-bs-dismiss","offcanvas","aria-label","Close",1,"btn-close"],[1,"offcanvas-body"],[1,"navbar-nav","justify-content-end","flex-grow-1","pe-3"],[1,"nav-item"],["aria-current","page",1,"nav-link","active",3,"routerLink"],[1,"nav-link",3,"routerLink"]],template:function(r,o){1&r&&(W(0,"nav",0)(1,"div",1)(2,"a",2),K(3,"Control de Asistencia"),z(),W(4,"button",3),Ue(5,"span",4),z(),W(6,"div",5)(7,"div",6)(8,"h5",7),K(9,"Control de Asistencia"),z(),Ue(10,"button",8),z(),W(11,"div",9)(12,"ul",10)(13,"li",11)(14,"a",12),K(15,"Agregar Colaborador"),z()(),W(16,"li",11)(17,"a",13),K(18,"Agregar Sucursal"),z()(),W(19,"li",11)(20,"a",13),K(21,"Home"),z()(),W(22,"li",11)(23,"a",13),K(24,"Iniciar sesi\xf3n"),z()(),W(25,"li",11)(26,"a",13),K(27,"Perfil Sucursal"),z()(),W(28,"li",11)(29,"a",13),K(30,"Perfil Usuarios"),z()(),W(31,"li",11)(32,"a",13),K(33,"Registro Usuarios"),z()(),W(34,"li",11)(35,"a",13),K(36,"Asistencias"),z()(),W(37,"li",11)(38,"a",13),K(39,"Login Face API"),z()()()()()()()),2&r&&(Je("height","10","vh"),We(14),Xn("routerLink",yo(11,jZ)),We(3),Xn("routerLink",yo(12,HZ)),We(3),Xn("routerLink",yo(13,WZ)),We(3),Xn("routerLink",yo(14,zZ)),We(3),Xn("routerLink",yo(15,$Z)),We(3),Xn("routerLink",yo(16,GZ)),We(3),Xn("routerLink",yo(17,qZ)),We(3),Xn("routerLink",yo(18,XZ)),We(3),Xn("routerLink",yo(19,KZ)))},dependencies:[rf]})}return e})(),ZZ=(()=>{class e{constructor(){this.title="face-login"}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=In({type:e,selectors:[["app-root"]],decls:2,vars:0,template:function(r,o){1&r&&Ue(0,"app-header")(1,"router-outlet")},dependencies:[w0,YZ]})}return e})(),QZ=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=Hr({type:e,bootstrap:[ZZ]});static#n=this.\u0275inj=ur({providers:[{provide:Na,useClass:kS}],imports:[G5,UZ,Cz,M6,A0]})}return e})();z5().bootstrapModule(QZ).catch(e=>console.error(e))},496:(Ei,Ft,Xt)=>{"use strict";function Fe(Le){return Le&&Le.__esModule?Le:{default:Le}}Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.readFile=function ha(Le){return Io(Le).then(function(rt){return rt instanceof ArrayBuffer||(rt=function Pt(Le){for(var rt=new ArrayBuffer(2*Le.length),yt=new Uint16Array(rt),ht=0,dn=Le.length;ht<dn;ht++)yt[ht]=Le.charCodeAt(ht);return rt}(rt.toString())),rt})},Ft.readString=function il(Le){return Io(Le).then(function(rt){return rt instanceof ArrayBuffer&&(rt=function Eo(Le){return String.fromCharCode.apply(null,new Uint16Array(Le))}(rt)),rt})},Ft.writeFile=function ns(Le,rt){return new Promise(function(yt,ht){rr("readwrite",function(dn){var Hn=dn.put({path:Le,dir:nr.default.dirname(Le),type:"file",data:rt});Hn.onerror=ht,Hn.onsuccess=function(Ii){yt()}})})},Ft.removeFile=Pr,Ft.readdir=iu,Ft.mkdir=function rs(Le){return new Promise(function(rt,yt){rr("readwrite",function(ht){var dn=ao(nr.default),Hn=ht.put({path:Le,dir:nr.default.dirname(dn),type:"directory"});Hn.onerror=yt,Hn.onsuccess=function(Ii){rt()}})})},Ft.rmdir=function au(Le){return iu(Le).then(function rt(yt){if(!yt||!yt.length)return Pr(Le);var ht=yt.shift();return("directory"===ht.type?au:Pr)(ht.name).then(function(){return rt(yt)})})};var nr=Fe(Xt(931)),St=Fe(Xt(986)),Dt=window.location.host+"_filesystem",nn="files",br="dir";function rr(Le,rt){!function io(Le){var rt=window.indexedDB.open(Dt,1);rt.onupgradeneeded=function(yt){yt.target.result.createObjectStore(nn,{keyPath:"path"}).createIndex(br,"dir",{unique:!1})},rt.onsuccess=function(yt){Le(yt.target.result)}}(function(yt){var dn=yt.transaction([nn],Le).objectStore(nn);rt(dn)})}var Io=function(rt){return new Promise(function(yt,ht){rr("readonly",function(dn){var Hn=dn.get(rt);Hn.onerror=ht,Hn.onsuccess=function(Ii){var so=Ii.target.result;so&&so.data?yt(so.data):ht("File not found")}})})};function Pr(Le){return new Promise(function(rt){rr("readwrite",function(yt){var ht=yt.delete(Le);ht.onerror=ht.onsuccess=function(dn){rt()}})})}function ao(Le){return"/"===Le[Le.length-1]?Le:Le+"/"}function iu(Le){return new Promise(function(rt,yt){rr("readonly",function(ht){var dn=nr.default.dirname(ao(Le)),Hn=ht.index(br),Ii=IDBKeyRange.only(dn),so=Hn.openCursor(Ii);so.onerror=function(Re){yt(Re)};var Or=[];so.onsuccess=function(Re){var pa=Re.target.result;if(pa){var Ot=pa.value,os=new St.default(Ot.path,Ot.type);Or.push(os),pa.continue()}else rt(Or)}})})}},986:(Ei,Ft,Xt)=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});var nr=function Fe(St){return St&&St.__esModule?St:{default:St}}(Xt(931));Ft.default=function wr(St,Eo){this.path=St,this.name=nr.default.basename(St),this.dir=nr.default.dirname(St),this.type=Eo},Ei.exports=Ft.default},186:(Ei,Ft,Xt)=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});var wr=Xt(496),Eo=function nr(Pt){return Pt&&Pt.__esModule?Pt:{default:Pt}}(Xt(986));Eo.default.prototype.readFile=function(Pt){if("file"!==this.type)throw new TypeError("Not a file.");return(0,wr.readFile)(this.path,Pt)},function oo(Pt,Dt){for(var nn=Object.getOwnPropertyNames(Dt),br=0;br<nn.length;br++){var io=nn[br],rr=Object.getOwnPropertyDescriptor(Dt,io);rr&&rr.configurable&&void 0===Pt[io]&&Object.defineProperty(Pt,io,rr)}}(Ft,function Fe(Pt){if(Pt&&Pt.__esModule)return Pt;var Dt={};if(null!=Pt)for(var nn in Pt)Object.prototype.hasOwnProperty.call(Pt,nn)&&(Dt[nn]=Pt[nn]);return Dt.default=Pt,Dt}(wr)),Ft.DirectoryEntry=Eo.default},519:function(Ei){Ei.exports=function(){"use strict";function Ft(D,g,w){if("function"==typeof D?D===g:D.has(g))return arguments.length<3?g:w;throw new TypeError("Private element is not present on this object")}function Xt(D,g,w){return g=Io(g),function ns(D,g){if(g&&("object"==typeof g||"function"==typeof g))return g;if(void 0!==g)throw new TypeError("Derived constructors may only return object or undefined");return function il(D){if(void 0===D)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}(D)}(D,wr()?Reflect.construct(g,w||[],Io(D).constructor):g.apply(D,w))}function Fe(D,g){return D.get(Ft(D,g))}function wr(){try{var D=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wr=function(){return!!D})()}function Pt(D){var g=function Eo(D,g){if("object"!=typeof D||!D)return D;var w=D[Symbol.toPrimitive];if(void 0!==w){var _=w.call(D,g||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===g?String:Number)(D)}(D,"string");return"symbol"==typeof g?g:g+""}function Dt(D){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(D)}function nn(D,g){if(!(D instanceof g))throw new TypeError("Cannot call a class as a function")}function br(D,g){for(var w=0;w<g.length;w++){var _=g[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(D,Pt(_.key),_)}}function io(D,g,w){return g&&br(D.prototype,g),w&&br(D,w),Object.defineProperty(D,"prototype",{writable:!1}),D}function Io(D){return(Io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(w){return w.__proto__||Object.getPrototypeOf(w)})(D)}function ha(D,g){return(ha=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,k){return _.__proto__=k,_})(D,g)}function ao(){return ao=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(g,w,_){var k=function Pr(D,g){for(;!Object.prototype.hasOwnProperty.call(D,g)&&null!==(D=Io(D)););return D}(g,w);if(k){var j=Object.getOwnPropertyDescriptor(k,w);return j.get?j.get.call(arguments.length<3?g:_):j.value}},ao.apply(this,arguments)}function iu(D,g){return function Le(D){if(Array.isArray(D))return D}(D)||function St(D,g){var w=null==D?null:typeof Symbol<"u"&&D[Symbol.iterator]||D["@@iterator"];if(null!=w){var _,k,j,oe,Ge=[],xe=!0,Ye=!1;try{if(j=(w=w.call(D)).next,0===g){if(Object(w)!==w)return;xe=!1}else for(;!(xe=(_=j.call(w)).done)&&(Ge.push(_.value),Ge.length!==g);xe=!0);}catch(Oi){Ye=!0,k=Oi}finally{try{if(!xe&&null!=w.return&&(oe=w.return(),Object(oe)!==oe))return}finally{if(Ye)throw k}}return Ge}}(D,g)||yt(D,g)||function Hn(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rs(D){return function au(D){if(Array.isArray(D))return ht(D)}(D)||function rt(D){if(typeof Symbol<"u"&&null!=D[Symbol.iterator]||null!=D["@@iterator"])return Array.from(D)}(D)||yt(D)||function dn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(D,g){if(D){if("string"==typeof D)return ht(D,g);var w=Object.prototype.toString.call(D).slice(8,-1);if("Object"===w&&D.constructor&&(w=D.constructor.name),"Map"===w||"Set"===w)return Array.from(D);if("Arguments"===w||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return ht(D,g)}}function ht(D,g){(null==g||g>D.length)&&(g=D.length);for(var w=0,_=new Array(g);w<g;w++)_[w]=D[w];return _}function so(D,g,w){(function Ii(D,g){if(g.has(D))throw new TypeError("Cannot initialize the same private elements twice on an object")})(D,g),g.set(D,w)}var Re={},Ot=function(g){return new Promise(function(w){if(!g)return w();var _=window.scrollX,k=window.scrollY;Re.restoreFocusTimeout=setTimeout(function(){Re.previousActiveElement instanceof HTMLElement?(Re.previousActiveElement.focus(),Re.previousActiveElement=null):document.body&&document.body.focus(),w()},100),window.scrollTo(_,k)})},U=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"].reduce(function(D,g){return D[g]="swal2-"+g,D},{}),Wn=["success","warning","info","question","error"].reduce(function(D,g){return D[g]="swal2-"+g,D},{}),al="SweetAlert2:",su=function(g){return g.charAt(0).toUpperCase()+g.slice(1)},at=function(g){console.warn("".concat(al," ").concat("object"===Dt(g)?g.join(" "):g))},At=function(g){console.error("".concat(al," ").concat(g))},Uf=[],sl=function(g,w){!function(g){Uf.includes(g)||(Uf.push(g),at(g))}('"'.concat(g,'" is deprecated and will be removed in the next major release. Please use "').concat(w,'" instead.'))},uu=function(g){return"function"==typeof g?g():g},is=function(g){return g&&"function"==typeof g.toPromise},as=function(g){return is(g)?g.toPromise():Promise.resolve(g)},ul=function(g){return g&&Promise.resolve(g)===g},zn=function(){return document.body.querySelector(".".concat(U.container))},cu=function(g){var w=zn();return w?w.querySelector(g):null},xr=function(g){return cu(".".concat(g))},_t=function(){return xr(U.popup)},lu=function(){return xr(U.icon)},cl=function(){return xr(U.title)},ll=function(){return xr(U["html-container"])},du=function(){return xr(U.image)},dl=function(){return xr(U["progress-steps"])},ga=function(){return xr(U["validation-message"])},Lr=function(){return cu(".".concat(U.actions," .").concat(U.confirm))},ma=function(){return cu(".".concat(U.actions," .").concat(U.cancel))},Si=function(){return cu(".".concat(U.actions," .").concat(U.deny))},or=function(){return cu(".".concat(U.loader))},va=function(){return xr(U.actions)},jf=function(){return xr(U.footer)},ss=function(){return xr(U["timer-progress-bar"])},fl=function(){return xr(U.close)},hl=function(){var g=_t();if(!g)return[];var w=g.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),_=Array.from(w).sort(function(oe,Ge){var xe=parseInt(oe.getAttribute("tabindex")||"0"),Ye=parseInt(Ge.getAttribute("tabindex")||"0");return xe>Ye?1:xe<Ye?-1:0}),k=g.querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n'),j=Array.from(k).filter(function(oe){return"-1"!==oe.getAttribute("tabindex")});return rs(new Set(_.concat(j))).filter(function(oe){return ar(oe)})},pl=function(){return So(document.body,U.shown)&&!So(document.body,U["toast-shown"])&&!So(document.body,U["no-backdrop"])},fu=function(){var g=_t();return!!g&&So(g,U.toast)},ir=function(g,w){if(g.textContent="",w){var k=(new DOMParser).parseFromString(w,"text/html"),j=k.querySelector("head");j&&Array.from(j.childNodes).forEach(function(Ge){g.appendChild(Ge)});var oe=k.querySelector("body");oe&&Array.from(oe.childNodes).forEach(function(Ge){Ge instanceof HTMLVideoElement||Ge instanceof HTMLAudioElement?g.appendChild(Ge.cloneNode(!0)):g.appendChild(Ge)})}},So=function(g,w){if(!w)return!1;for(var _=w.split(/\s+/),k=0;k<_.length;k++)if(!g.classList.contains(_[k]))return!1;return!0},Cr=function(g,w,_){if(function(g,w){Array.from(g.classList).forEach(function(_){!Object.values(U).includes(_)&&!Object.values(Wn).includes(_)&&!Object.values(w.showClass||{}).includes(_)&&g.classList.remove(_)})}(g,w),w.customClass&&w.customClass[_]){if("string"!=typeof w.customClass[_]&&!w.customClass[_].forEach)return void at("Invalid type of customClass.".concat(_,'! Expected string or iterable object, got "').concat(Dt(w.customClass[_]),'"'));tt(g,w.customClass[_])}},gl=function(g,w){if(!w)return null;switch(w){case"select":case"textarea":case"file":return g.querySelector(".".concat(U.popup," > .").concat(U[w]));case"checkbox":return g.querySelector(".".concat(U.popup," > .").concat(U.checkbox," input"));case"radio":return g.querySelector(".".concat(U.popup," > .").concat(U.radio," input:checked"))||g.querySelector(".".concat(U.popup," > .").concat(U.radio," input:first-child"));case"range":return g.querySelector(".".concat(U.popup," > .").concat(U.range," input"));default:return g.querySelector(".".concat(U.popup," > .").concat(U.input))}},ml=function(g){if(g.focus(),"file"!==g.type){var w=g.value;g.value="",g.value=w}},vl=function(g,w,_){!g||!w||("string"==typeof w&&(w=w.split(/\s+/).filter(Boolean)),w.forEach(function(k){Array.isArray(g)?g.forEach(function(j){_?j.classList.add(k):j.classList.remove(k)}):_?g.classList.add(k):g.classList.remove(k)}))},tt=function(g,w){vl(g,w,!0)},Br=function(g,w){vl(g,w,!1)},Ao=function(g,w){for(var _=Array.from(g.children),k=0;k<_.length;k++){var j=_[k];if(j instanceof HTMLElement&&So(j,w))return j}},Ai=function(g,w,_){_==="".concat(parseInt(_))&&(_=parseInt(_)),_||0===parseInt(_)?g.style.setProperty(w,"number"==typeof _?"".concat(_,"px"):_):g.style.removeProperty(w)},un=function(g){g&&(g.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex")},vn=function(g){g&&(g.style.display="none")},hu=function(g){var w=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";g&&new MutationObserver(function(){yn(g,g.innerHTML,w)}).observe(g,{childList:!0,subtree:!0})},yl=function(g,w,_,k){var j=g.querySelector(w);j&&j.style.setProperty(_,k)},yn=function(g,w){w?un(g,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):vn(g)},ar=function(g){return!(!g||!(g.offsetWidth||g.offsetHeight||g.getClientRects().length))},Hf=function(g){return g.scrollHeight>g.clientHeight},Wf=function(g){var w=window.getComputedStyle(g),_=parseFloat(w.getPropertyValue("animation-duration")||"0"),k=parseFloat(w.getPropertyValue("transition-duration")||"0");return _>0||k>0},pu=function(g){var w=arguments.length>1&&void 0!==arguments[1]&&arguments[1],_=ss();_&&ar(_)&&(w&&(_.style.transition="none",_.style.width="100%"),setTimeout(function(){_.style.transition="width ".concat(g/1e3,"s linear"),_.style.width="0%"},10))},zf=function(){return typeof window>"u"||typeof document>"u"},Mo='\n <div aria-labelledby="'.concat(U.title,'" aria-describedby="').concat(U["html-container"],'" class="').concat(U.popup,'" tabindex="-1">\n   <button type="button" class="').concat(U.close,'"></button>\n   <ul class="').concat(U["progress-steps"],'"></ul>\n   <div class="').concat(U.icon,'"></div>\n   <img class="').concat(U.image,'" />\n   <h2 class="').concat(U.title,'" id="').concat(U.title,'"></h2>\n   <div class="').concat(U["html-container"],'" id="').concat(U["html-container"],'"></div>\n   <input class="').concat(U.input,'" id="').concat(U.input,'" />\n   <input type="file" class="').concat(U.file,'" />\n   <div class="').concat(U.range,'">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="').concat(U.select,'" id="').concat(U.select,'"></select>\n   <div class="').concat(U.radio,'"></div>\n   <label class="').concat(U.checkbox,'">\n     <input type="checkbox" id="').concat(U.checkbox,'" />\n     <span class="').concat(U.label,'"></span>\n   </label>\n   <textarea class="').concat(U.textarea,'" id="').concat(U.textarea,'"></textarea>\n   <div class="').concat(U["validation-message"],'" id="').concat(U["validation-message"],'"></div>\n   <div class="').concat(U.actions,'">\n     <div class="').concat(U.loader,'"></div>\n     <button type="button" class="').concat(U.confirm,'"></button>\n     <button type="button" class="').concat(U.deny,'"></button>\n     <button type="button" class="').concat(U.cancel,'"></button>\n   </div>\n   <div class="').concat(U.footer,'"></div>\n   <div class="').concat(U["timer-progress-bar-container"],'">\n     <div class="').concat(U["timer-progress-bar"],'"></div>\n   </div>\n </div>\n').replace(/(^|\n)\s*/g,""),Wt=function(){Re.currentInstance.resetValidationMessage()},qm=function(g){var w=function(){var g=zn();return!!g&&(g.remove(),Br([document.documentElement,document.body],[U["no-backdrop"],U["toast-shown"],U["has-column"]]),!0)}();if(zf())At("SweetAlert2 requires document to initialize");else{var _=document.createElement("div");_.className=U.container,w&&tt(_,U["no-transition"]),ir(_,Mo);var k=function(g){return"string"==typeof g?document.querySelector(g):g}(g.target);k.appendChild(_),function(g){var w=_t();w.setAttribute("role",g.toast?"alert":"dialog"),w.setAttribute("aria-live",g.toast?"polite":"assertive"),g.toast||w.setAttribute("aria-modal","true")}(g),function(g){"rtl"===window.getComputedStyle(g).direction&&tt(zn(),U.rtl)}(k),function(){var g=_t(),w=Ao(g,U.input),_=Ao(g,U.file),k=g.querySelector(".".concat(U.range," input")),j=g.querySelector(".".concat(U.range," output")),oe=Ao(g,U.select),Ge=g.querySelector(".".concat(U.checkbox," input")),xe=Ao(g,U.textarea);w.oninput=Wt,_.onchange=Wt,oe.onchange=Wt,Ge.onchange=Wt,xe.oninput=Wt,k.oninput=function(){Wt(),j.value=k.value},k.onchange=function(){Wt(),j.value=k.value}}()}},us=function(g,w){g instanceof HTMLElement?w.appendChild(g):"object"===Dt(g)?$f(g,w):g&&ir(w,g)},$f=function(g,w){g.jquery?cs(w,g):ir(w,g.toString())},cs=function(g,w){if(g.textContent="",0 in w)for(var _=0;_ in w;_++)g.appendChild(w[_].cloneNode(!0));else g.appendChild(w.cloneNode(!0))},Mi=function(){if(zf())return!1;var D=document.createElement("div");return typeof D.style.webkitAnimation<"u"?"webkitAnimationEnd":typeof D.style.animation<"u"&&"animationend"}(),Gf=function(g,w){var _=va(),k=or();!_||!k||(w.showConfirmButton||w.showDenyButton||w.showCancelButton?un(_):vn(_),Cr(_,w,"actions"),function qf(D,g,w){var _=Lr(),k=Si(),j=ma();!_||!k||!j||(wl(_,"confirm",w),wl(k,"deny",w),wl(j,"cancel",w),function Xm(D,g,w,_){_.buttonsStyling?(tt([D,g,w],U.styled),_.confirmButtonColor&&(D.style.backgroundColor=_.confirmButtonColor,tt(D,U["default-outline"])),_.denyButtonColor&&(g.style.backgroundColor=_.denyButtonColor,tt(g,U["default-outline"])),_.cancelButtonColor&&(w.style.backgroundColor=_.cancelButtonColor,tt(w,U["default-outline"]))):Br([D,g,w],U.styled)}(_,k,j,w),w.reverseButtons&&(w.toast?(D.insertBefore(j,_),D.insertBefore(k,_)):(D.insertBefore(j,g),D.insertBefore(k,g),D.insertBefore(_,g))))}(_,k,w),ir(k,w.loaderHtml||""),Cr(k,w,"loader"))};function wl(D,g,w){var _=su(g);yn(D,w["show".concat(_,"Button")],"inline-block"),ir(D,w["".concat(g,"ButtonText")]||""),D.setAttribute("aria-label",w["".concat(g,"ButtonAriaLabel")]||""),D.className=U[g],Cr(D,w,"".concat(g,"Button"))}var Ym=function(g,w){var _=zn();_&&(function Xf(D,g){"string"==typeof g?D.style.background=g:g||tt([document.documentElement,document.body],U["no-backdrop"])}(_,w.backdrop),function Zm(D,g){g&&(g in U?tt(D,U[g]):(at('The "position" parameter is not valid, defaulting to "center"'),tt(D,U.center)))}(_,w.position),function Qm(D,g){g&&tt(D,U["grow-".concat(g)])}(_,w.grow),Cr(_,w,"container"))};var Te={innerParams:new WeakMap,domCache:new WeakMap},Jm=["input","file","range","select","radio","checkbox","textarea"],_e=function(g){if(g.input){if(!Ve[g.input])return void At("Unexpected type of input! Expected ".concat(Object.keys(Ve).join(" | "),', got "').concat(g.input,'"'));var w=pt(g.input),_=Ve[g.input](w,g);un(w),g.inputAutoFocus&&setTimeout(function(){ml(_)})}},bl=function(g,w){var _=gl(_t(),g);if(_)for(var k in function(g){for(var w=0;w<g.attributes.length;w++){var _=g.attributes[w].name;["id","type","value","style"].includes(_)||g.removeAttribute(_)}}(_),w)_.setAttribute(k,w[k])},Vr=function(g){var w=pt(g.input);"object"===Dt(g.customClass)&&tt(w,g.customClass.input)},xl=function(g,w){(!g.placeholder||w.inputPlaceholder)&&(g.placeholder=w.inputPlaceholder)},ls=function(g,w,_){if(_.inputLabel){var k=document.createElement("label"),j=U["input-label"];k.setAttribute("for",g.id),k.className=j,"object"===Dt(_.customClass)&&tt(k,_.customClass.inputLabel),k.innerText=_.inputLabel,w.insertAdjacentElement("beforebegin",k)}},pt=function(g){return Ao(_t(),U[g]||U.input)},Ti=function(g,w){["string","number"].includes(Dt(w))?g.value="".concat(w):ul(w)||at('Unexpected type of inputValue! Expected "string", "number" or "Promise", got "'.concat(Dt(w),'"'))},Ve={};Ve.text=Ve.email=Ve.password=Ve.number=Ve.tel=Ve.url=Ve.search=Ve.date=Ve["datetime-local"]=Ve.time=Ve.week=Ve.month=function(D,g){return Ti(D,g.inputValue),ls(D,D,g),xl(D,g),D.type=g.input,D},Ve.file=function(D,g){return ls(D,D,g),xl(D,g),D},Ve.range=function(D,g){var w=D.querySelector("input"),_=D.querySelector("output");return Ti(w,g.inputValue),w.type=g.input,Ti(_,g.inputValue),ls(w,D,g),D},Ve.select=function(D,g){if(D.textContent="",g.inputPlaceholder){var w=document.createElement("option");ir(w,g.inputPlaceholder),w.value="",w.disabled=!0,w.selected=!0,D.appendChild(w)}return ls(D,D,g),D},Ve.radio=function(D){return D.textContent="",D},Ve.checkbox=function(D,g){var w=gl(_t(),"checkbox");w.value="1",w.checked=!!g.inputValue;var _=D.querySelector("span");return ir(_,g.inputPlaceholder),w},Ve.textarea=function(D,g){Ti(D,g.inputValue),xl(D,g),ls(D,D,g);return setTimeout(function(){if("MutationObserver"in window){var _=parseInt(window.getComputedStyle(_t()).width);new MutationObserver(function(){if(document.body.contains(D)){var oe=D.offsetWidth+(k=D,parseInt(window.getComputedStyle(k).marginLeft)+parseInt(window.getComputedStyle(k).marginRight));oe>_?_t().style.width="".concat(oe,"px"):Ai(_t(),"width",g.width)}var k}).observe(D,{attributes:!0,attributeFilter:["style"]})}}),D};var Cl=function(g,w){var _=ll();_&&(hu(_),Cr(_,w,"htmlContainer"),w.html?(us(w.html,_),un(_,"block")):w.text?(_.textContent=w.text,un(_,"block")):vn(_),function(g,w){var _=_t();if(_){var k=Te.innerParams.get(g),j=!k||w.input!==k.input;Jm.forEach(function(oe){var Ge=Ao(_,U[oe]);Ge&&(bl(oe,w.inputAttributes),Ge.className=U[oe],j&&vn(Ge))}),w.input&&(j&&_e(w),Vr(w))}}(g,w))},De=function(g,w){for(var _=0,k=Object.entries(Wn);_<k.length;_++){var j=iu(k[_],2);w.icon!==j[0]&&Br(g,j[1])}tt(g,w.icon&&Wn[w.icon]),ee(g,w),_l(),Cr(g,w,"icon")},_l=function(){var g=_t();if(g)for(var w=window.getComputedStyle(g).getPropertyValue("background-color"),_=g.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix"),k=0;k<_.length;k++)_[k].style.backgroundColor=w},El=function(g,w){if(w.icon||w.iconHtml){var _=g.innerHTML,k="";w.iconHtml?k=ds(w.iconHtml):"success"===w.icon?(k='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',_=_.replace(/ style=".*?"/g,"")):"error"===w.icon?k='\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':w.icon&&(k=ds({question:"?",warning:"!",info:"i"}[w.icon])),_.trim()!==k.trim()&&ir(g,k)}},ee=function(g,w){if(w.iconColor){g.style.color=w.iconColor,g.style.borderColor=w.iconColor;for(var _=0,k=[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"];_<k.length;_++)yl(g,k[_],"background-color",w.iconColor);yl(g,".swal2-success-ring","border-color",w.iconColor)}},ds=function(g){return'<div class="'.concat(U["icon-content"],'">').concat(g,"</div>")},tv=function(g,w){var _=w.showClass||{};g.className="".concat(U.popup," ").concat(ar(g)?_.popup:""),w.toast?(tt([document.documentElement,document.body],U["toast-shown"]),tt(g,U.toast)):tt(g,U.modal),Cr(g,w,"popup"),"string"==typeof w.customClass&&tt(g,w.customClass),w.icon&&tt(g,U["icon-".concat(w.icon)])},nv=function(g){var w=document.createElement("li");return tt(w,U["progress-step"]),ir(w,g),w},Il=function(g){var w=document.createElement("li");return tt(w,U["progress-step-line"]),g.progressStepsDistance&&Ai(w,"width",g.progressStepsDistance),w},rv=function(g,w){(function(g,w){var _=zn(),k=_t();if(_&&k){if(w.toast){Ai(_,"width",w.width),k.style.width="100%";var j=or();j&&k.insertBefore(j,lu())}else Ai(k,"width",w.width);Ai(k,"padding",w.padding),w.color&&(k.style.color=w.color),w.background&&(k.style.background=w.background),vn(ga()),tv(k,w)}})(0,w),Ym(0,w),function(g,w){var _=dl();if(_){var k=w.progressSteps,j=w.currentProgressStep;if(!k||0===k.length||void 0===j)return void vn(_);un(_),_.textContent="",j>=k.length&&at("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),k.forEach(function(oe,Ge){var xe=nv(oe);if(_.appendChild(xe),Ge===j&&tt(xe,U["active-progress-step"]),Ge!==k.length-1){var Ye=Il(w);_.appendChild(Ye)}})}}(0,w),function(g,w){var _=Te.innerParams.get(g),k=lu();if(k){if(_&&w.icon===_.icon)return El(k,w),void De(k,w);if(!w.icon&&!w.iconHtml)return void vn(k);if(w.icon&&-1===Object.keys(Wn).indexOf(w.icon))return At('Unknown icon! Expected "success", "error", "warning", "info" or "question", got "'.concat(w.icon,'"')),void vn(k);un(k),El(k,w),De(k,w),tt(k,w.showClass&&w.showClass.icon)}}(g,w),function(g,w){var _=du();if(_){if(!w.imageUrl)return void vn(_);un(_,""),_.setAttribute("src",w.imageUrl),_.setAttribute("alt",w.imageAlt||""),Ai(_,"width",w.imageWidth),Ai(_,"height",w.imageHeight),_.className=U.image,Cr(_,w,"image")}}(0,w),function(g,w){var _=cl();_&&(hu(_),yn(_,w.title||w.titleText,"block"),w.title&&us(w.title,_),w.titleText&&(_.innerText=w.titleText),Cr(_,w,"title"))}(0,w),function(g,w){var _=fl();_&&(ir(_,w.closeButtonHtml||""),Cr(_,w,"closeButton"),yn(_,w.showCloseButton),_.setAttribute("aria-label",w.closeButtonAriaLabel||""))}(0,w),Cl(g,w),Gf(0,w),function(g,w){var _=jf();_&&(hu(_),yn(_,w.footer,"block"),w.footer&&us(w.footer,_),Cr(_,w,"footer"))}(0,w);var _=_t();"function"==typeof w.didRender&&_&&w.didRender(_)},iv=function(){var g;return null===(g=Lr())||void 0===g?void 0:g.click()},fs=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),av=function(g){g.keydownTarget&&g.keydownHandlerAdded&&(g.keydownTarget.removeEventListener("keydown",g.keydownHandler,{capture:g.keydownListenerCapture}),g.keydownHandlerAdded=!1)},Sl=function(g,w){var _,k=hl();if(k.length)return(g+=w)===k.length?g=0:-1===g&&(g=k.length-1),void k[g].focus();null===(_=_t())||void 0===_||_.focus()},sv=["ArrowRight","ArrowDown"],uv=["ArrowLeft","ArrowUp"],ZC=function(g,w,_){g&&(w.isComposing||229===w.keyCode||(g.stopKeydownPropagation&&w.stopPropagation(),"Enter"===w.key?Dr(w,g):"Tab"===w.key?Ee(w):[].concat(sv,uv).includes(w.key)?QC(w.key):"Escape"===w.key&&JC(w,g,_)))},Dr=function(g,w){if(uu(w.allowEnterKey)){var _=gl(_t(),w.input);if(g.target&&_&&g.target instanceof HTMLElement&&g.target.outerHTML===_.outerHTML){if(["textarea","file"].includes(w.input))return;iv(),g.preventDefault()}}},Ee=function(g){for(var w=g.target,_=hl(),k=-1,j=0;j<_.length;j++)if(w===_[j]){k=j;break}Sl(k,g.shiftKey?-1:1),g.stopPropagation(),g.preventDefault()},QC=function(g){var w=va(),_=Lr(),k=Si(),j=ma();if(w&&_&&k&&j&&(!(document.activeElement instanceof HTMLElement)||[_,k,j].includes(document.activeElement))){var Ge=sv.includes(g)?"nextElementSibling":"previousElementSibling",xe=document.activeElement;if(xe){for(var Ye=0;Ye<w.children.length;Ye++){if(!(xe=xe[Ge]))return;if(xe instanceof HTMLButtonElement&&ar(xe))break}xe instanceof HTMLButtonElement&&xe.focus()}}},JC=function(g,w,_){uu(w.allowEscapeKey)&&(g.preventDefault(),_(fs.esc))},hs={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap},cv=function(){Array.from(document.body.children).forEach(function(w){w.hasAttribute("data-previous-aria-hidden")?(w.setAttribute("aria-hidden",w.getAttribute("data-previous-aria-hidden")||""),w.removeAttribute("data-previous-aria-hidden")):w.removeAttribute("aria-hidden")})},ur=typeof window<"u"&&!!window.GestureEvent,lv=function(){var w,g=zn();g&&(g.ontouchstart=function(_){w=Yf(_)},g.ontouchmove=function(_){w&&(_.preventDefault(),_.stopPropagation())})},Yf=function(g){var w=g.target,_=zn(),k=ll();return!(!_||!k||dv(g)||mu(g)||w!==_&&(Hf(_)||!(w instanceof HTMLElement)||"INPUT"===w.tagName||"TEXTAREA"===w.tagName||Hf(k)&&k.contains(w)))},dv=function(g){return g.touches&&g.touches.length&&"stylus"===g.touches[0].touchType},mu=function(g){return g.touches&&g.touches.length>1},Ni=null,fv=function(g){null===Ni&&(document.body.scrollHeight>window.innerHeight||"scroll"===g)&&(Ni=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight="".concat(Ni+function(){var g=document.createElement("div");g.className=U["scrollbar-measure"],document.body.appendChild(g);var w=g.getBoundingClientRect().width-g.clientWidth;return document.body.removeChild(g),w}(),"px"))};function yu(D,g,w,_){fu()?wu(D,_):(Ot(w).then(function(){return wu(D,_)}),av(Re)),ur?(g.setAttribute("style","display:none !important"),g.removeAttribute("class"),g.innerHTML=""):g.remove(),pl()&&(null!==Ni&&(document.body.style.paddingRight="".concat(Ni,"px"),Ni=null),function(){if(So(document.body,U.iosfix)){var g=parseInt(document.body.style.top,10);Br(document.body,U.iosfix),document.body.style.top="",document.body.scrollTop=-1*g}}(),cv()),function Zf(){Br([document.documentElement,document.body],[U.shown,U["height-auto"],U["no-backdrop"],U["toast-shown"]])}()}function Kt(D){D=e1(D);var g=hs.swalPromiseResolve.get(this),w=Qf(this);this.isAwaitingPromise?D.isDismissed||(mt(this),g(D)):w&&g(D)}var Qf=function(g){var w=_t();if(!w)return!1;var _=Te.innerParams.get(g);if(!_||So(w,_.hideClass.popup))return!1;Br(w,_.showClass.popup),tt(w,_.hideClass.popup);var k=zn();return Br(k,_.showClass.backdrop),tt(k,_.hideClass.backdrop),t1(g,w,_),!0};function hv(D){var g=hs.swalPromiseReject.get(this);mt(this),g&&g(D)}var mt=function(g){g.isAwaitingPromise&&(delete g.isAwaitingPromise,Te.innerParams.get(g)||g._destroy())},e1=function(g){return typeof g>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},g)},t1=function(g,w,_){var k=zn(),j=Mi&&Wf(w);"function"==typeof _.willClose&&_.willClose(w),j?ue(g,w,k,_.returnFocus,_.didClose):yu(g,k,_.returnFocus,_.didClose)},ue=function(g,w,_,k,j){Mi&&(Re.swalCloseEventFinishedCallback=yu.bind(null,g,_,k,j),w.addEventListener(Mi,function(oe){oe.target===w&&(Re.swalCloseEventFinishedCallback(),delete Re.swalCloseEventFinishedCallback)}))},wu=function(g,w){setTimeout(function(){"function"==typeof w&&w.bind(g.params)(),g._destroy&&g._destroy()})},qo=function(g){var w=_t();if(w||new Vl,w=_t()){var _=or();fu()?vn(lu()):Jf(w,g),un(_),w.setAttribute("data-loading","true"),w.setAttribute("aria-busy","true"),w.focus()}},Jf=function(g,w){var _=va(),k=or();!_||!k||(!w&&ar(Lr())&&(w=Lr()),un(_),w&&(vn(w),k.setAttribute("data-button-to-replace",w.className),_.insertBefore(k,w)),tt([g,_],U.loading))},Tl=function(g){return g.checked?1:0},n1=function(g){return g.checked?g.value:null},r1=function(g){return g.files&&g.files.length?null!==g.getAttribute("multiple")?g.files:g.files[0]:null},o1=function(g,w){var _=_t();if(_){var k=function(oe){"select"===w.input?function a1(D,g,w){var _=Ao(D,U.select);if(_){var k=function(oe,Ge,xe){var Ye=document.createElement("option");Ye.value=xe,ir(Ye,Ge),Ye.selected=gs(xe,w.inputValue),oe.appendChild(Ye)};g.forEach(function(j){var oe=j[0],Ge=j[1];if(Array.isArray(Ge)){var xe=document.createElement("optgroup");xe.label=oe,xe.disabled=!1,_.appendChild(xe),Ge.forEach(function(Ye){return k(xe,Ye[1],Ye[0])})}else k(_,Ge,oe)}),_.focus()}}(_,bu(oe),w):"radio"===w.input&&function ps(D,g,w){var _=Ao(D,U.radio);if(_){g.forEach(function(j){var oe=j[0],Ge=j[1],xe=document.createElement("input"),Ye=document.createElement("label");xe.type="radio",xe.name=U.radio,xe.value=oe,gs(oe,w.inputValue)&&(xe.checked=!0);var Oi=document.createElement("span");ir(Oi,Ge),Oi.className=U.label,Ye.appendChild(xe),Ye.appendChild(Oi),_.appendChild(Ye)});var k=_.querySelectorAll("input");k.length&&k[0].focus()}}(_,bu(oe),w)};is(w.inputOptions)||ul(w.inputOptions)?(qo(Lr()),as(w.inputOptions).then(function(j){g.hideLoading(),k(j)})):"object"===Dt(w.inputOptions)?k(w.inputOptions):At("Unexpected type of inputOptions! Expected object, Map or Promise, got ".concat(Dt(w.inputOptions)))}},i1=function(g,w){var _=g.getInput();_&&(vn(_),as(w.inputValue).then(function(k){_.value="".concat("number"===w.input?parseFloat(k)||0:k),un(_),_.focus(),g.hideLoading()}).catch(function(k){At("Error in inputValue promise: ".concat(k)),_.value="",un(_),_.focus(),g.hideLoading()}))};var bu=function D(g){var w=[];return g instanceof Map?g.forEach(function(_,k){var j=_;"object"===Dt(j)&&(j=D(j)),w.push([k,j])}):Object.keys(g).forEach(function(_){var k=g[_];"object"===Dt(k)&&(k=D(k)),w.push([_,k])}),w},gs=function(g,w){return!!w&&w.toString()===g.toString()},xu=void 0,ki=function(g,w){var _=Te.innerParams.get(g);if(_.input){var k=g.getInput(),j=function(g,w){var _=g.getInput();if(!_)return null;switch(w.input){case"checkbox":return Tl(_);case"radio":return n1(_);case"file":return r1(_);default:return w.inputAutoTrim?_.value.trim():_.value}}(g,_);_.inputValidator?vv(g,j,w):k&&!k.checkValidity()?(g.enableButtons(),g.showValidationMessage(_.validationMessage||k.validationMessage)):"deny"===w?co(g,j):Cu(g,j)}else At('The "input" parameter is needed to be set when using returnInputValueOn'.concat(su(w)))},vv=function(g,w,_){var k=Te.innerParams.get(g);g.disableInput(),Promise.resolve().then(function(){return as(k.inputValidator(w,k.validationMessage))}).then(function(oe){g.enableButtons(),g.enableInput(),oe?g.showValidationMessage(oe):"deny"===_?co(g,w):Cu(g,w)})},co=function(g,w){var _=Te.innerParams.get(g||xu);_.showLoaderOnDeny&&qo(Si()),_.preDeny?(g.isAwaitingPromise=!0,Promise.resolve().then(function(){return as(_.preDeny(w,_.validationMessage))}).then(function(j){!1===j?(g.hideLoading(),mt(g)):g.close({isDenied:!0,value:typeof j>"u"?w:j})}).catch(function(j){return fe(g||xu,j)})):g.close({isDenied:!0,value:w})},th=function(g,w){g.close({isConfirmed:!0,value:w})},fe=function(g,w){g.rejectPromise(w)},Cu=function(g,w){var _=Te.innerParams.get(g||xu);_.showLoaderOnConfirm&&qo(),_.preConfirm?(g.resetValidationMessage(),g.isAwaitingPromise=!0,Promise.resolve().then(function(){return as(_.preConfirm(w,_.validationMessage))}).then(function(j){ar(ga())||!1===j?(g.hideLoading(),mt(g)):th(g,typeof j>"u"?w:j)}).catch(function(j){return fe(g||xu,j)})):th(g,w)};function ie(){var D=Te.innerParams.get(this);if(D){var g=Te.domCache.get(this);vn(g.loader),fu()?D.icon&&un(lu()):_u(g),Br([g.popup,g.actions],U.loading),g.popup.removeAttribute("aria-busy"),g.popup.removeAttribute("data-loading"),g.confirmButton.disabled=!1,g.denyButton.disabled=!1,g.cancelButton.disabled=!1}}var _u=function(g){var w=g.popup.getElementsByClassName(g.loader.getAttribute("data-button-to-replace"));w.length?un(w[0],"inline-block"):!ar(Lr())&&!ar(Si())&&!ar(ma())&&vn(g.actions)};function Du(){var D=Te.innerParams.get(this),g=Te.domCache.get(this);return g?gl(g.popup,D.input):null}function wa(D,g,w){var _=Te.domCache.get(D);g.forEach(function(k){_[k].disabled=w})}function nh(D,g){var w=_t();if(w&&D)if("radio"===D.type)for(var _=w.querySelectorAll('[name="'.concat(U.radio,'"]')),k=0;k<_.length;k++)_[k].disabled=g;else D.disabled=g}function rh(){wa(this,["confirmButton","denyButton","cancelButton"],!1)}function oh(){wa(this,["confirmButton","denyButton","cancelButton"],!0)}function lo(){nh(this.getInput(),!1)}function ms(){nh(this.getInput(),!0)}function Er(D){var g=Te.domCache.get(this),w=Te.innerParams.get(this);ir(g.validationMessage,D),g.validationMessage.className=U["validation-message"],w.customClass&&w.customClass.validationMessage&&tt(g.validationMessage,w.customClass.validationMessage),un(g.validationMessage);var _=this.getInput();_&&(_.setAttribute("aria-invalid","true"),_.setAttribute("aria-describedby",U["validation-message"]),ml(_),tt(_,U.inputerror))}function Ur(){var D=Te.domCache.get(this);D.validationMessage&&vn(D.validationMessage);var g=this.getInput();g&&(g.removeAttribute("aria-invalid"),g.removeAttribute("aria-describedby"),Br(g,U.inputerror))}var $e={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,animation:!0,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},Eu=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],Rl={},Nl=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],kl=function(g){return Object.prototype.hasOwnProperty.call($e,g)},fo=function(g){return-1!==Eu.indexOf(g)},ba=function(g){return Rl[g]},ih=function(g){kl(g)||at('Unknown parameter "'.concat(g,'"'))},ah=function(g){Nl.includes(g)&&at('The parameter "'.concat(g,'" is incompatible with toasts'))},Fl=function(g){var w=ba(g);w&&sl(g,w)};function Pl(D){var g=_t(),w=Te.innerParams.get(this);if(g&&!So(g,w.hideClass.popup)){var _=vs(D),k=Object.assign({},w,_);rv(this,k),Te.innerParams.set(this,k),Object.defineProperties(this,{params:{value:Object.assign({},this.params,D),writable:!1,enumerable:!0}})}else at("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.")}var vs=function(g){var w={};return Object.keys(g).forEach(function(_){fo(_)?w[_]=g[_]:at("Invalid parameter to update: ".concat(_))}),w};function Ol(){var D=Te.domCache.get(this),g=Te.innerParams.get(this);g?(D.popup&&Re.swalCloseEventFinishedCallback&&(Re.swalCloseEventFinishedCallback(),delete Re.swalCloseEventFinishedCallback),"function"==typeof g.didDestroy&&g.didDestroy(),uh(this)):ch(this)}var uh=function(g){ch(g),delete g.params,delete Re.keydownHandler,delete Re.keydownTarget,delete Re.currentInstance},ch=function(g){g.isAwaitingPromise?(Iu(Te,g),g.isAwaitingPromise=!0):(Iu(hs,g),Iu(Te,g),delete g.isAwaitingPromise,delete g.disableButtons,delete g.enableButtons,delete g.getInput,delete g.disableInput,delete g.enableInput,delete g.hideLoading,delete g.disableLoading,delete g.showValidationMessage,delete g.resetValidationMessage,delete g.close,delete g.closePopup,delete g.closeModal,delete g.closeToast,delete g.rejectPromise,delete g.update,delete g._destroy)},Iu=function(g,w){for(var _ in g)g[_].delete(w)},yv=Object.freeze({__proto__:null,_destroy:Ol,close:Kt,closeModal:Kt,closePopup:Kt,closeToast:Kt,disableButtons:oh,disableInput:ms,disableLoading:ie,enableButtons:rh,enableInput:lo,getInput:Du,handleAwaitingPromise:mt,hideLoading:ie,rejectPromise:hv,resetValidationMessage:Ur,showValidationMessage:Er,update:Pl}),jr=function(g,w,_){w.popup.onclick=function(){g&&(bv(g)||g.timer||g.input)||_(fs.close)}},bv=function(g){return!!(g.showConfirmButton||g.showDenyButton||g.showCancelButton||g.showCloseButton)},ys=!1,xv=function(g){g.popup.onmousedown=function(){g.container.onmouseup=function(w){g.container.onmouseup=function(){},w.target===g.container&&(ys=!0)}}},Cv=function(g){g.container.onmousedown=function(w){w.target===g.container&&w.preventDefault(),g.popup.onmouseup=function(_){g.popup.onmouseup=function(){},(_.target===g.popup||_.target instanceof HTMLElement&&g.popup.contains(_.target))&&(ys=!0)}}},_v=function(g,w,_){w.container.onclick=function(k){ys?ys=!1:k.target===w.container&&uu(g.allowOutsideClick)&&_(fs.backdrop)}},Ll=function(g){return g instanceof Element||function(g){return"object"===Dt(g)&&g.jquery}(g)};var lh=function(){if(Re.timeout)return function(){var g=ss();if(g){var w=parseInt(window.getComputedStyle(g).width);g.style.removeProperty("transition"),g.style.width="100%";var _=parseInt(window.getComputedStyle(g).width);g.style.width="".concat(w/_*100,"%")}}(),Re.timeout.stop()},dh=function(){if(Re.timeout){var g=Re.timeout.start();return pu(g),g}},Bl=!1,Ce={};var nt=function(g){for(var w=g.target;w&&w!==document;w=w.parentNode)for(var _ in Ce){var k=w.getAttribute(_);if(k)return void Ce[_].fire({template:k})}},wn=Object.freeze({__proto__:null,argsToParams:function(g){var w={};return"object"!==Dt(g[0])||Ll(g[0])?["title","html","icon"].forEach(function(_,k){var j=g[k];"string"==typeof j||Ll(j)?w[_]=j:void 0!==j&&At("Unexpected type of ".concat(_,'! Expected "string" or "Element", got ').concat(Dt(j)))}):Object.assign(w,g[0]),w},bindClickHandler:function $n(){Ce[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,Bl||(document.body.addEventListener("click",nt),Bl=!0)},clickCancel:function(){var g;return null===(g=ma())||void 0===g?void 0:g.click()},clickConfirm:iv,clickDeny:function(){var g;return null===(g=Si())||void 0===g?void 0:g.click()},enableLoading:qo,fire:function Iv(){for(var g=arguments.length,w=new Array(g),_=0;_<g;_++)w[_]=arguments[_];return function nr(D,g,w){if(wr())return Reflect.construct.apply(null,arguments);var _=[null];_.push.apply(_,g);var k=new(D.bind.apply(D,_));return w&&ha(k,w.prototype),k}(this,w)},getActions:va,getCancelButton:ma,getCloseButton:fl,getConfirmButton:Lr,getContainer:zn,getDenyButton:Si,getFocusableElements:hl,getFooter:jf,getHtmlContainer:ll,getIcon:lu,getIconContent:function(){return xr(U["icon-content"])},getImage:du,getInputLabel:function(){return xr(U["input-label"])},getLoader:or,getPopup:_t,getProgressSteps:dl,getTimerLeft:function(){return Re.timeout&&Re.timeout.getTimerLeft()},getTimerProgressBar:ss,getTitle:cl,getValidationMessage:ga,increaseTimer:function(g){if(Re.timeout){var w=Re.timeout.increase(g);return pu(w,!0),w}},isDeprecatedParameter:ba,isLoading:function(){var g=_t();return!!g&&g.hasAttribute("data-loading")},isTimerRunning:function(){return!(!Re.timeout||!Re.timeout.isRunning())},isUpdatableParameter:fo,isValidParameter:kl,isVisible:function(){return ar(_t())},mixin:function Sv(D){var g=function(w){function _(){return nn(this,_),Xt(this,_,arguments)}return function rr(D,g){if("function"!=typeof g&&null!==g)throw new TypeError("Super expression must either be null or a function");D.prototype=Object.create(g&&g.prototype,{constructor:{value:D,writable:!0,configurable:!0}}),Object.defineProperty(D,"prototype",{writable:!1}),g&&ha(D,g)}(_,w),io(_,[{key:"_main",value:function(j,oe){return ao(Io(_.prototype),"_main",this).call(this,j,Object.assign({},D,oe))}}])}(this);return g},resumeTimer:dh,showLoading:qo,stopTimer:lh,toggleTimer:function(){var g=Re.timeout;return g&&(g.running?lh():dh())}}),Rn=function(){return io(function D(g,w){nn(this,D),this.callback=g,this.remaining=w,this.running=!1,this.start()},[{key:"start",value:function(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}},{key:"stop",value:function(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}},{key:"increase",value:function(w){var _=this.running;return _&&this.stop(),this.remaining+=w,_&&this.start(),this.remaining}},{key:"getTimerLeft",value:function(){return this.running&&(this.stop(),this.start()),this.remaining}},{key:"isRunning",value:function(){return this.running}}])}(),Fi=["swal-title","swal-html","swal-footer"],fh=function(g){var w={};return Array.from(g.querySelectorAll("swal-param")).forEach(function(k){vt(k,["name","value"]);var j=k.getAttribute("name"),oe=k.getAttribute("value");w[j]="boolean"==typeof $e[j]?"false"!==oe:"object"===Dt($e[j])?JSON.parse(oe):oe}),w},hh=function(g){var w={};return Array.from(g.querySelectorAll("swal-function-param")).forEach(function(k){var j=k.getAttribute("name"),oe=k.getAttribute("value");w[j]=new Function("return ".concat(oe))()}),w},Su=function(g){var w={};return Array.from(g.querySelectorAll("swal-button")).forEach(function(k){vt(k,["type","color","aria-label"]);var j=k.getAttribute("type");w["".concat(j,"ButtonText")]=k.innerHTML,w["show".concat(su(j),"Button")]=!0,k.hasAttribute("color")&&(w["".concat(j,"ButtonColor")]=k.getAttribute("color")),k.hasAttribute("aria-label")&&(w["".concat(j,"ButtonAriaLabel")]=k.getAttribute("aria-label"))}),w},Tv=function(g){var w={},_=g.querySelector("swal-image");return _&&(vt(_,["src","width","height","alt"]),_.hasAttribute("src")&&(w.imageUrl=_.getAttribute("src")),_.hasAttribute("width")&&(w.imageWidth=_.getAttribute("width")),_.hasAttribute("height")&&(w.imageHeight=_.getAttribute("height")),_.hasAttribute("alt")&&(w.imageAlt=_.getAttribute("alt"))),w},Rv=function(g){var w={},_=g.querySelector("swal-icon");return _&&(vt(_,["type","color"]),_.hasAttribute("type")&&(w.icon=_.getAttribute("type")),_.hasAttribute("color")&&(w.iconColor=_.getAttribute("color")),w.iconHtml=_.innerHTML),w},$t=function(g){var w={},_=g.querySelector("swal-input");_&&(vt(_,["type","label","placeholder","value"]),w.input=_.getAttribute("type")||"text",_.hasAttribute("label")&&(w.inputLabel=_.getAttribute("label")),_.hasAttribute("placeholder")&&(w.inputPlaceholder=_.getAttribute("placeholder")),_.hasAttribute("value")&&(w.inputValue=_.getAttribute("value")));var k=Array.from(g.querySelectorAll("swal-input-option"));return k.length&&(w.inputOptions={},k.forEach(function(j){vt(j,["value"]);var oe=j.getAttribute("value");w.inputOptions[oe]=j.innerHTML})),w},se=function(g,w){var _={};for(var k in w){var j=w[k],oe=g.querySelector(j);oe&&(vt(oe,[]),_[j.replace(/^swal-/,"")]=oe.innerHTML.trim())}return _},Ne=function(g){var w=Fi.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(g.children).forEach(function(_){var k=_.tagName.toLowerCase();w.includes(k)||at("Unrecognized element <".concat(k,">"))})},vt=function(g,w){Array.from(g.attributes).forEach(function(_){-1===w.indexOf(_.name)&&at(['Unrecognized attribute "'.concat(_.name,'" on <').concat(g.tagName.toLowerCase(),">."),"".concat(w.length?"Allowed attributes are: ".concat(w.join(", ")):"To set the value, use HTML within the element.")])})},ws=function(g){var w=zn(),_=_t();"function"==typeof g.willOpen&&g.willOpen(_);var j=window.getComputedStyle(document.body).overflowY;Xo(w,_,g),setTimeout(function(){xa(w,_)},10),pl()&&(Yt(w,g.scrollbarPadding,j),function(){var g=zn();Array.from(document.body.children).forEach(function(_){_.contains(g)||(_.hasAttribute("aria-hidden")&&_.setAttribute("data-previous-aria-hidden",_.getAttribute("aria-hidden")||""),_.setAttribute("aria-hidden","true"))})}()),!fu()&&!Re.previousActiveElement&&(Re.previousActiveElement=document.activeElement),"function"==typeof g.didOpen&&setTimeout(function(){return g.didOpen(_)}),Br(w,U["no-transition"])},Sn=function D(g){var w=_t();if(g.target===w&&Mi){var _=zn();w.removeEventListener(Mi,D),_.style.overflowY="auto"}},xa=function(g,w){Mi&&Wf(w)?(g.style.overflowY="hidden",w.addEventListener(Mi,Sn)):g.style.overflowY="auto"},Yt=function(g,w,_){(function(){if(ur&&!So(document.body,U.iosfix)){var g=document.body.scrollTop;document.body.style.top="".concat(-1*g,"px"),tt(document.body,U.iosfix),lv()}})(),w&&"hidden"!==_&&fv(_),setTimeout(function(){g.scrollTop=0})},Xo=function(g,w,_){tt(g,_.showClass.backdrop),_.animation?(w.style.setProperty("opacity","0","important"),un(w,"grid"),setTimeout(function(){tt(w,_.showClass.popup),w.style.removeProperty("opacity")},10)):un(w,"grid"),tt([document.documentElement,document.body],U.shown),_.heightAuto&&_.backdrop&&!_.toast&&tt([document.documentElement,document.body],U["height-auto"])},Pi={email:function(g,w){return/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(g)?Promise.resolve():Promise.resolve(w||"Invalid email address")},url:function(g,w){return/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(g)?Promise.resolve():Promise.resolve(w||"Invalid URL")}};function ph(D){(function Ae(D){D.inputValidator||("email"===D.input&&(D.inputValidator=Pi.email),"url"===D.input&&(D.inputValidator=Pi.url))})(D),D.showLoaderOnConfirm&&!D.preConfirm&&at("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function bs(D){(!D.target||"string"==typeof D.target&&!document.querySelector(D.target)||"string"!=typeof D.target&&!D.target.appendChild)&&(at('Target parameter is not valid, defaulting to "body"'),D.target="body")}(D),"string"==typeof D.title&&(D.title=D.title.split("\n").join("<br />")),qm(D)}var Nn,Lt=new WeakMap,Rt=function(){return io(function D(){if(nn(this,D),so(this,Lt,void 0),!(typeof window>"u")){Nn=this;for(var g=arguments.length,w=new Array(g),_=0;_<g;_++)w[_]=arguments[_];var k=Object.freeze(this.constructor.argsToParams(w));this.params=k,this.isAwaitingPromise=!1,function oo(D,g,w){return D.set(Ft(D,g),w),w}(Lt,this,this._main(Nn.params))}},[{key:"_main",value:function(w){var _=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(g){for(var w in!1===g.backdrop&&g.allowOutsideClick&&at('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),g)ih(w),g.toast&&ah(w),Fl(w)}(Object.assign({},_,w)),Re.currentInstance){var k=hs.swalPromiseResolve.get(Re.currentInstance),j=Re.currentInstance.isAwaitingPromise;Re.currentInstance._destroy(),j||k({isDismissed:!0}),pl()&&cv()}Re.currentInstance=Nn;var oe=ho(w,_);ph(oe),Object.freeze(oe),Re.timeout&&(Re.timeout.stop(),delete Re.timeout),clearTimeout(Re.restoreFocusTimeout);var Ge=xs(Nn);return rv(Nn,oe),Te.innerParams.set(Nn,oe),Ca(Nn,Ge,oe)}},{key:"then",value:function(w){return Fe(Lt,this).then(w)}},{key:"finally",value:function(w){return Fe(Lt,this).finally(w)}}])}(),Ca=function(g,w,_){return new Promise(function(k,j){var oe=function(xe){g.close({isDismissed:!0,dismiss:xe})};hs.swalPromiseResolve.set(g,k),hs.swalPromiseReject.set(g,j),w.confirmButton.onclick=function(){!function(g){var w=Te.innerParams.get(g);g.disableButtons(),w.input?ki(g,"confirm"):Cu(g,!0)}(g)},w.denyButton.onclick=function(){!function(g){var w=Te.innerParams.get(g);g.disableButtons(),w.returnInputValueOnDeny?ki(g,"deny"):co(g,!1)}(g)},w.cancelButton.onclick=function(){!function(g,w){g.disableButtons(),w(fs.cancel)}(g,oe)},w.closeButton.onclick=function(){oe(fs.close)},function(g,w,_){g.toast?jr(g,w,_):(xv(w),Cv(w),_v(g,w,_))}(_,w,oe),function(g,w,_){av(g),w.toast||(g.keydownHandler=function(k){return ZC(w,k,_)},g.keydownTarget=w.keydownListenerCapture?window:_t(),g.keydownListenerCapture=w.keydownListenerCapture,g.keydownTarget.addEventListener("keydown",g.keydownHandler,{capture:g.keydownListenerCapture}),g.keydownHandlerAdded=!0)}(Re,_,oe),function(g,w){"select"===w.input||"radio"===w.input?o1(g,w):["text","email","number","tel","textarea"].some(function(_){return _===w.input})&&(is(w.inputValue)||ul(w.inputValue))&&(qo(Lr()),i1(g,w))}(g,_),ws(_),gh(Re,_,oe),Ko(w,_),setTimeout(function(){w.container.scrollTop=0})})},ho=function(g,w){var _=function(g){var w="string"==typeof g.template?document.querySelector(g.template):g.template;if(!w)return{};var _=w.content;return Ne(_),Object.assign(fh(_),hh(_),Su(_),Tv(_),Rv(_),$t(_),se(_,Fi))}(g),k=Object.assign({},$e,w,_,g);return k.showClass=Object.assign({},$e.showClass,k.showClass),k.hideClass=Object.assign({},$e.hideClass,k.hideClass),!1===k.animation&&(k.showClass={backdrop:"swal2-noanimation"},k.hideClass={}),k},xs=function(g){var w={popup:_t(),container:zn(),actions:va(),confirmButton:Lr(),denyButton:Si(),cancelButton:ma(),loader:or(),closeButton:fl(),validationMessage:ga(),progressSteps:dl()};return Te.domCache.set(g,w),w},gh=function(g,w,_){var k=ss();vn(k),w.timer&&(g.timeout=new Rn(function(){_("timer"),delete g.timeout},w.timer),w.timerProgressBar&&(un(k),Cr(k,w,"timerProgressBar"),setTimeout(function(){g.timeout&&g.timeout.running&&pu(w.timer)})))},Ko=function(g,w){if(!w.toast){if(!uu(w.allowEnterKey))return void Cs();To(g,w)||Sl(-1,1)}},To=function(g,w){return w.focusDeny&&ar(g.denyButton)?(g.denyButton.focus(),!0):w.focusCancel&&ar(g.cancelButton)?(g.cancelButton.focus(),!0):!(!w.focusConfirm||!ar(g.confirmButton)||(g.confirmButton.focus(),0))},Cs=function(){document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){var _a=new Date,He=localStorage.getItem("swal-initiation");He?(_a.getTime()-Date.parse(He))/864e5>3&&setTimeout(function(){document.body.style.pointerEvents="none";var D=document.createElement("audio");D.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",D.loop=!0,document.body.appendChild(D),setTimeout(function(){D.play().catch(function(){})},2500)},500):localStorage.setItem("swal-initiation","".concat(_a))}Rt.prototype.disableButtons=oh,Rt.prototype.enableButtons=rh,Rt.prototype.getInput=Du,Rt.prototype.disableInput=ms,Rt.prototype.enableInput=lo,Rt.prototype.hideLoading=ie,Rt.prototype.disableLoading=ie,Rt.prototype.showValidationMessage=Er,Rt.prototype.resetValidationMessage=Ur,Rt.prototype.close=Kt,Rt.prototype.closePopup=Kt,Rt.prototype.closeModal=Kt,Rt.prototype.closeToast=Kt,Rt.prototype.rejectPromise=hv,Rt.prototype.update=Pl,Rt.prototype._destroy=Ol,Object.assign(Rt,wn),Object.keys(yv).forEach(function(D){Rt[D]=function(){var g;return Nn&&Nn[D]?(g=Nn)[D].apply(g,arguments):null}}),Rt.DismissReason=fs,Rt.version="11.10.8";var Vl=Rt;return Vl.default=Vl,Vl}(),typeof this<"u"&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),typeof document<"u"&&function(Ft,Xt){var Fe=Ft.createElement("style");if(Ft.getElementsByTagName("head")[0].appendChild(Fe),Fe.styleSheet)Fe.styleSheet.disabled||(Fe.styleSheet.cssText=Xt);else try{Fe.innerHTML=Xt}catch{Fe.innerText=Xt}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:rgba(0,0,0,.4)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-styled):focus{outline:none}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em;text-align:center}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em}div:where(.swal2-container) button:where(.swal2-close){z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:none;background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) .swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:#fff}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:#facea8;color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:#9de0f6;color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:#c9dae1;color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}')},902:()=>{},522:()=>{},753:()=>{},931:()=>{}},Ei=>{Ei(Ei.s=874)}]);